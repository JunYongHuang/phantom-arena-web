"use strict";(()=>{var ED=Object.create;var tu=Object.defineProperty;var cw=Object.getOwnPropertyDescriptor;var wD=Object.getOwnPropertyNames;var TD=Object.getPrototypeOf,CD=Object.prototype.hasOwnProperty;var re=(n,t)=>()=>(n&&(t=n(n=0)),t);var SD=(n,t)=>()=>(t||n((t={exports:{}}).exports,t),t.exports),L0=(n,t)=>{for(var e in t)tu(n,e,{get:t[e],enumerable:!0})},DD=(n,t,e,i)=>{if(t&&typeof t=="object"||typeof t=="function")for(let a of wD(t))!CD.call(n,a)&&a!==e&&tu(n,a,{get:()=>t[a],enumerable:!(i=cw(t,a))||i.enumerable});return n};var AD=(n,t,e)=>(e=n!=null?ED(TD(n)):{},DD(t||!n||!n.__esModule?tu(e,"default",{value:n,enumerable:!0}):e,n));var h=(n,t,e,i)=>{for(var a=i>1?void 0:i?cw(t,e):t,r=n.length-1,s;r>=0;r--)(s=n[r])&&(a=(i?s(t,e,a):s(a))||a);return i&&a&&tu(t,e,a),a};var mw,pw=re(()=>{"use strict";mw="1.0.6"});var Kt,jr=re(()=>{"use strict";pw();Kt=class n extends Error{constructor(t,e={}){let i=e.cause instanceof n?e.cause.details:e.cause?.message?e.cause.message:e.details,a=e.cause instanceof n&&e.cause.docsPath||e.docsPath,r=[t||"An error occurred.","",...e.metaMessages?[...e.metaMessages,""]:[],...a?[`Docs: https://abitype.dev${a}`]:[],...i?[`Details: ${i}`]:[],`Version: abitype@${mw}`].join(`
`);super(r),Object.defineProperty(this,"details",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"docsPath",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"metaMessages",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"shortMessage",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"AbiTypeError"}),e.cause&&(this.cause=e.cause),this.details=i,this.docsPath=a,this.metaMessages=e.metaMessages,this.shortMessage=t}}});function Bi(n,t){return n.exec(t)?.groups}var x0,I0,zu,Do=re(()=>{"use strict";x0=/^bytes([1-9]|1[0-9]|2[0-9]|3[0-2])?$/,I0=/^u?int(8|16|24|32|40|48|56|64|72|80|88|96|104|112|120|128|136|144|152|160|168|176|184|192|200|208|216|224|232|240|248|256)?$/,zu=/^\(.+?\).*?$/});function ju(n){let t=n.type;if(hw.test(n.type)&&"components"in n){t="(";let e=n.components.length;for(let a=0;a<e;a++){let r=n.components[a];t+=ju(r),a<e-1&&(t+=", ")}let i=Bi(hw,n.type);return t+=`)${i?.array??""}`,ju({...n,type:t})}return"indexed"in n&&n.indexed&&(t=`${t} indexed`),n.name?`${t} ${n.name}`:t}var hw,dw=re(()=>{"use strict";Do();hw=/^tuple(?<array>(\[(\d*)\])*)$/});function $r(n){let t="",e=n.length;for(let i=0;i<e;i++){let a=n[i];t+=ju(a),i!==e-1&&(t+=", ")}return t}var fw=re(()=>{"use strict";dw()});function E0(n){return n.type==="function"?`function ${n.name}(${$r(n.inputs)})${n.stateMutability&&n.stateMutability!=="nonpayable"?` ${n.stateMutability}`:""}${n.outputs.length?` returns (${$r(n.outputs)})`:""}`:n.type==="event"?`event ${n.name}(${$r(n.inputs)})`:n.type==="error"?`error ${n.name}(${$r(n.inputs)})`:n.type==="constructor"?`constructor(${$r(n.inputs)})${n.stateMutability==="payable"?" payable":""}`:n.type==="fallback"?"fallback()":"receive() external payable"}var yw=re(()=>{"use strict";fw()});function gw(n){return bw.test(n)}function Lw(n){return Bi(bw,n)}function vw(n){return _w.test(n)}function xw(n){return Bi(_w,n)}function Ew(n){return Iw.test(n)}function ww(n){return Bi(Iw,n)}function $u(n){return Tw.test(n)}function Cw(n){return Bi(Tw,n)}function Dw(n){return Sw.test(n)}function Aw(n){return Bi(Sw,n)}function kw(n){return ND.test(n)}function Bw(n){return OD.test(n)}var bw,_w,Iw,Tw,Sw,ND,OD,Mw,Xu,Qu=re(()=>{"use strict";Do();bw=/^error (?<name>[a-zA-Z$_][a-zA-Z0-9$_]*)\((?<parameters>.*?)\)$/;_w=/^event (?<name>[a-zA-Z$_][a-zA-Z0-9$_]*)\((?<parameters>.*?)\)$/;Iw=/^function (?<name>[a-zA-Z$_][a-zA-Z0-9$_]*)\((?<parameters>.*?)\)(?: (?<scope>external|public{1}))?(?: (?<stateMutability>pure|view|nonpayable|payable{1}))?(?: returns\s?\((?<returns>.*?)\))?$/;Tw=/^struct (?<name>[a-zA-Z$_][a-zA-Z0-9$_]*) \{(?<properties>.*?)\}$/;Sw=/^constructor\((?<parameters>.*?)\)(?:\s(?<stateMutability>payable{1}))?$/;ND=/^fallback\(\) external(?:\s(?<stateMutability>payable{1}))?$/;OD=/^receive\(\) external payable$/;Mw=new Set(["indexed"]),Xu=new Set(["calldata","memory","storage"])});var Ju,Zu,w0=re(()=>{"use strict";jr();Ju=class extends Kt{constructor({type:t}){super("Unknown type.",{metaMessages:[`Type "${t}" is not a valid ABI type. Perhaps you forgot to include a struct signature?`]}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"UnknownTypeError"})}},Zu=class extends Kt{constructor({type:t}){super("Unknown type.",{metaMessages:[`Type "${t}" is not a valid ABI type.`]}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"UnknownSolidityTypeError"})}}});var em,tm,im,am,nm,T0=re(()=>{"use strict";jr();em=class extends Kt{constructor({param:t}){super("Invalid ABI parameter.",{details:t}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"InvalidParameterError"})}},tm=class extends Kt{constructor({param:t,name:e}){super("Invalid ABI parameter.",{details:t,metaMessages:[`"${e}" is a protected Solidity keyword. More info: https://docs.soliditylang.org/en/latest/cheatsheet.html`]}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"SolidityProtectedKeywordError"})}},im=class extends Kt{constructor({param:t,type:e,modifier:i}){super("Invalid ABI parameter.",{details:t,metaMessages:[`Modifier "${i}" not allowed${e?` in "${e}" type`:""}.`]}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"InvalidModifierError"})}},am=class extends Kt{constructor({param:t,type:e,modifier:i}){super("Invalid ABI parameter.",{details:t,metaMessages:[`Modifier "${i}" not allowed${e?` in "${e}" type`:""}.`,`Data location can only be specified for array, struct, or mapping types, but "${i}" was given.`]}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"InvalidFunctionModifierError"})}},nm=class extends Kt{constructor({abiParameter:t}){super("Invalid ABI parameter.",{details:JSON.stringify(t,null,2),metaMessages:["ABI parameter type is invalid."]}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"InvalidAbiTypeParameterError"})}}});var Wa,rm,sm,C0=re(()=>{"use strict";jr();Wa=class extends Kt{constructor({signature:t,type:e}){super(`Invalid ${e} signature.`,{details:t}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"InvalidSignatureError"})}},rm=class extends Kt{constructor({signature:t}){super("Unknown signature.",{details:t}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"UnknownSignatureError"})}},sm=class extends Kt{constructor({signature:t}){super("Invalid struct signature.",{details:t,metaMessages:["No properties exist."]}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"InvalidStructSignatureError"})}}});var om,Rw=re(()=>{"use strict";jr();om=class extends Kt{constructor({type:t}){super("Circular reference detected.",{metaMessages:[`Struct "${t}" is a circular reference.`]}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"CircularReferenceError"})}}});var lm,Pw=re(()=>{"use strict";jr();lm=class extends Kt{constructor({current:t,depth:e}){super("Unbalanced parentheses.",{metaMessages:[`"${t.trim()}" has too many ${e>0?"opening":"closing"} parentheses.`],details:`Depth "${e}"`}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"InvalidParenthesisError"})}}});function Nw(n,t){return t?`${t}:${n}`:n}var cm,Ow=re(()=>{"use strict";cm=new Map([["address",{type:"address"}],["bool",{type:"bool"}],["bytes",{type:"bytes"}],["bytes32",{type:"bytes32"}],["int",{type:"int256"}],["int256",{type:"int256"}],["string",{type:"string"}],["uint",{type:"uint256"}],["uint8",{type:"uint8"}],["uint16",{type:"uint16"}],["uint24",{type:"uint24"}],["uint32",{type:"uint32"}],["uint64",{type:"uint64"}],["uint96",{type:"uint96"}],["uint112",{type:"uint112"}],["uint160",{type:"uint160"}],["uint192",{type:"uint192"}],["uint256",{type:"uint256"}],["address owner",{type:"address",name:"owner"}],["address to",{type:"address",name:"to"}],["bool approved",{type:"bool",name:"approved"}],["bytes _data",{type:"bytes",name:"_data"}],["bytes data",{type:"bytes",name:"data"}],["bytes signature",{type:"bytes",name:"signature"}],["bytes32 hash",{type:"bytes32",name:"hash"}],["bytes32 r",{type:"bytes32",name:"r"}],["bytes32 root",{type:"bytes32",name:"root"}],["bytes32 s",{type:"bytes32",name:"s"}],["string name",{type:"string",name:"name"}],["string symbol",{type:"string",name:"symbol"}],["string tokenURI",{type:"string",name:"tokenURI"}],["uint tokenId",{type:"uint256",name:"tokenId"}],["uint8 v",{type:"uint8",name:"v"}],["uint256 balance",{type:"uint256",name:"balance"}],["uint256 tokenId",{type:"uint256",name:"tokenId"}],["uint256 value",{type:"uint256",name:"value"}],["event:address indexed from",{type:"address",name:"from",indexed:!0}],["event:address indexed to",{type:"address",name:"to",indexed:!0}],["event:uint indexed tokenId",{type:"uint256",name:"tokenId",indexed:!0}],["event:uint256 indexed tokenId",{type:"uint256",name:"tokenId",indexed:!0}]])});function Hw(n,t={}){if(Ew(n)){let e=ww(n);if(!e)throw new Wa({signature:n,type:"function"});let i=Xi(e.parameters),a=[],r=i.length;for(let o=0;o<r;o++)a.push(bn(i[o],{modifiers:Xu,structs:t,type:"function"}));let s=[];if(e.returns){let o=Xi(e.returns),l=o.length;for(let c=0;c<l;c++)s.push(bn(o[c],{modifiers:Xu,structs:t,type:"function"}))}return{name:e.name,type:"function",stateMutability:e.stateMutability??"nonpayable",inputs:a,outputs:s}}if(vw(n)){let e=xw(n);if(!e)throw new Wa({signature:n,type:"event"});let i=Xi(e.parameters),a=[],r=i.length;for(let s=0;s<r;s++)a.push(bn(i[s],{modifiers:Mw,structs:t,type:"event"}));return{name:e.name,type:"event",inputs:a}}if(gw(n)){let e=Lw(n);if(!e)throw new Wa({signature:n,type:"error"});let i=Xi(e.parameters),a=[],r=i.length;for(let s=0;s<r;s++)a.push(bn(i[s],{structs:t,type:"error"}));return{name:e.name,type:"error",inputs:a}}if(Dw(n)){let e=Aw(n);if(!e)throw new Wa({signature:n,type:"constructor"});let i=Xi(e.parameters),a=[],r=i.length;for(let s=0;s<r;s++)a.push(bn(i[s],{structs:t,type:"constructor"}));return{type:"constructor",stateMutability:e.stateMutability??"nonpayable",inputs:a}}if(kw(n))return{type:"fallback"};if(Bw(n))return{type:"receive",stateMutability:"payable"};throw new rm({signature:n})}function bn(n,t){let e=Nw(n,t?.type);if(cm.has(e))return cm.get(e);let i=zu.test(n),a=Bi(i?UD:HD,n);if(!a)throw new em({param:n});if(a.name&&GD(a.name))throw new tm({param:n,name:a.name});let r=a.name?{name:a.name}:{},s=a.modifier==="indexed"?{indexed:!0}:{},o=t?.structs??{},l,c={};if(i){l="tuple";let p=Xi(a.type),d=[],L=p.length;for(let x=0;x<L;x++)d.push(bn(p[x],{structs:o}));c={components:d}}else if(a.type in o)l="tuple",c={components:o[a.type]};else if(VD.test(a.type))l=`${a.type}256`;else if(l=a.type,t?.type!=="struct"&&!S0(l))throw new Zu({type:l});if(a.modifier){if(!t?.modifiers?.has?.(a.modifier))throw new im({param:n,type:t?.type,modifier:a.modifier});if(Xu.has(a.modifier)&&!KD(l,!!a.array))throw new am({param:n,type:t?.type,modifier:a.modifier})}let u={type:`${l}${a.array??""}`,...r,...s,...c};return cm.set(e,u),u}function Xi(n,t=[],e="",i=0){let a=n.trim().length;for(let r=0;r<a;r++){let s=n[r],o=n.slice(r+1);switch(s){case",":return i===0?Xi(o,[...t,e.trim()]):Xi(o,t,`${e}${s}`,i);case"(":return Xi(o,t,`${e}${s}`,i+1);case")":return Xi(o,t,`${e}${s}`,i-1);default:return Xi(o,t,`${e}${s}`,i)}}if(e==="")return t;if(i!==0)throw new lm({current:e,depth:i});return t.push(e.trim()),t}function S0(n){return n==="address"||n==="bool"||n==="function"||n==="string"||x0.test(n)||I0.test(n)}function GD(n){return n==="address"||n==="bool"||n==="function"||n==="string"||n==="tuple"||x0.test(n)||I0.test(n)||FD.test(n)}function KD(n,t){return t||n==="bytes"||n==="string"||n==="tuple"}var HD,UD,VD,FD,D0=re(()=>{"use strict";Do();w0();T0();C0();Pw();Ow();Qu();HD=/^(?<type>[a-zA-Z$_][a-zA-Z0-9$_]*)(?<array>(?:\[\d*?\])+?)?(?:\s(?<modifier>calldata|indexed|memory|storage{1}))?(?:\s(?<name>[a-zA-Z$_][a-zA-Z0-9$_]*))?$/,UD=/^\((?<type>.+?)\)(?<array>(?:\[\d*?\])+?)?(?:\s(?<modifier>calldata|indexed|memory|storage{1}))?(?:\s(?<name>[a-zA-Z$_][a-zA-Z0-9$_]*))?$/,VD=/^u?int$/;FD=/^(?:after|alias|anonymous|apply|auto|byte|calldata|case|catch|constant|copyof|default|defined|error|event|external|false|final|function|immutable|implements|in|indexed|inline|internal|let|mapping|match|memory|mutable|null|of|override|partial|private|promise|public|pure|reference|relocatable|return|returns|sizeof|static|storage|struct|super|supports|switch|this|true|try|typedef|typeof|var|view|virtual)$/});function Uw(n){let t={},e=n.length;for(let s=0;s<e;s++){let o=n[s];if(!$u(o))continue;let l=Cw(o);if(!l)throw new Wa({signature:o,type:"struct"});let c=l.properties.split(";"),u=[],p=c.length;for(let d=0;d<p;d++){let x=c[d].trim();if(!x)continue;let w=bn(x,{type:"struct"});u.push(w)}if(!u.length)throw new sm({signature:o});t[l.name]=u}let i={},a=Object.entries(t),r=a.length;for(let s=0;s<r;s++){let[o,l]=a[s];i[o]=Vw(l,t)}return i}function Vw(n,t,e=new Set){let i=[],a=n.length;for(let r=0;r<a;r++){let s=n[r];if(zu.test(s.type))i.push(s);else{let l=Bi(qD,s.type);if(!l?.type)throw new nm({abiParameter:s});let{array:c,type:u}=l;if(u in t){if(e.has(u))throw new om({type:u});i.push({...s,type:`tuple${c??""}`,components:Vw(t[u]??[],t,new Set([...e,u]))})}else if(S0(u))i.push(s);else throw new Ju({type:u})}}return i}var qD,Fw=re(()=>{"use strict";Do();w0();T0();C0();Rw();Qu();D0();qD=/^(?<type>[a-zA-Z$_][a-zA-Z0-9$_]*)(?<array>(?:\[\d*?\])+?)?$/});function um(n){let t=Uw(n),e=[],i=n.length;for(let a=0;a<i;a++){let r=n[a];$u(r)||e.push(Hw(r,t))}return e}var Gw=re(()=>{"use strict";Qu();Fw();D0()});var A0=re(()=>{"use strict";yw();Gw()});function fi(n,{includeName:t=!1}={}){if(n.type!=="function"&&n.type!=="event"&&n.type!=="error")throw new mm(n.type);return`${n.name}(${Ao(n.inputs,{includeName:t})})`}function Ao(n,{includeName:t=!1}={}){return n?n.map(e=>WD(e,{includeName:t})).join(t?", ":","):""}function WD(n,{includeName:t}){return n.type.startsWith("tuple")?`(${Ao(n.components,{includeName:t})})${n.type.slice(5)}`:n.type+(t&&n.name?` ${n.name}`:"")}var rr=re(()=>{"use strict";Zt()});function Rt(n,{strict:t=!0}={}){return!n||typeof n!="string"?!1:t?/^0x[0-9a-fA-F]*$/.test(n):n.startsWith("0x")}var Qi=re(()=>{"use strict"});function ot(n){return Rt(n,{strict:!1})?Math.ceil((n.length-2)/2):n.length}var Ji=re(()=>{"use strict";Qi()});var k0,Kw=re(()=>{"use strict";k0="2.21.49"});function qw(n,t){return t?.(n)?n:n&&typeof n=="object"&&"cause"in n&&n.cause!==void 0?qw(n.cause,t):t?null:n}var B0,K,$e=re(()=>{"use strict";Kw();B0={getDocsUrl:({docsBaseUrl:n,docsPath:t="",docsSlug:e})=>t?`${n??"https://viem.sh"}${t}${e?`#${e}`:""}`:void 0,version:`viem@${k0}`},K=class n extends Error{constructor(t,e={}){let i=(()=>e.cause instanceof n?e.cause.details:e.cause?.message?e.cause.message:e.details)(),a=(()=>e.cause instanceof n&&e.cause.docsPath||e.docsPath)(),r=B0.getDocsUrl?.({...e,docsPath:a}),s=[t||"An error occurred.","",...e.metaMessages?[...e.metaMessages,""]:[],...r?[`Docs: ${r}`]:[],...i?[`Details: ${i}`]:[],...B0.version?[`Version: ${B0.version}`]:[]].join(`
`);super(s,e.cause?{cause:e.cause}:void 0),Object.defineProperty(this,"details",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"docsPath",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"metaMessages",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"shortMessage",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"version",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"BaseError"}),this.details=i,this.docsPath=a,this.metaMessages=e.metaMessages,this.name=e.name??this.name,this.shortMessage=t,this.version=k0}walk(t){return qw(this,t)}}});var pm,ko,Xr,ya,hm,dm,fm,Qr,ym,Jr,Bo,gn,bm,gm,Lm,Zi,ba,_m,vm,xm,mm,Zt=re(()=>{"use strict";rr();Ji();$e();pm=class extends K{constructor({docsPath:t}){super(["A constructor was not found on the ABI.","Make sure you are using the correct ABI and that the constructor exists on it."].join(`
`),{docsPath:t,name:"AbiConstructorNotFoundError"})}},ko=class extends K{constructor({docsPath:t}){super(["Constructor arguments were provided (`args`), but a constructor parameters (`inputs`) were not found on the ABI.","Make sure you are using the correct ABI, and that the `inputs` attribute on the constructor exists."].join(`
`),{docsPath:t,name:"AbiConstructorParamsNotFoundError"})}},Xr=class extends K{constructor({data:t,params:e,size:i}){super([`Data size of ${i} bytes is too small for given parameters.`].join(`
`),{metaMessages:[`Params: (${Ao(e,{includeName:!0})})`,`Data:   ${t} (${i} bytes)`],name:"AbiDecodingDataSizeTooSmallError"}),Object.defineProperty(this,"data",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"params",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"size",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.data=t,this.params=e,this.size=i}},ya=class extends K{constructor(){super('Cannot decode zero data ("0x") with ABI parameters.',{name:"AbiDecodingZeroDataError"})}},hm=class extends K{constructor({expectedLength:t,givenLength:e,type:i}){super([`ABI encoding array length mismatch for type ${i}.`,`Expected length: ${t}`,`Given length: ${e}`].join(`
`),{name:"AbiEncodingArrayLengthMismatchError"})}},dm=class extends K{constructor({expectedSize:t,value:e}){super(`Size of bytes "${e}" (bytes${ot(e)}) does not match expected size (bytes${t}).`,{name:"AbiEncodingBytesSizeMismatchError"})}},fm=class extends K{constructor({expectedLength:t,givenLength:e}){super(["ABI encoding params/values length mismatch.",`Expected length (params): ${t}`,`Given length (values): ${e}`].join(`
`),{name:"AbiEncodingLengthMismatchError"})}},Qr=class extends K{constructor(t,{docsPath:e}){super([`Encoded error signature "${t}" not found on ABI.`,"Make sure you are using the correct ABI and that the error exists on it.",`You can look up the decoded signature here: https://openchain.xyz/signatures?query=${t}.`].join(`
`),{docsPath:e,name:"AbiErrorSignatureNotFoundError"}),Object.defineProperty(this,"signature",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.signature=t}},ym=class extends K{constructor({docsPath:t}){super("Cannot extract event signature from empty topics.",{docsPath:t,name:"AbiEventSignatureEmptyTopicsError"})}},Jr=class extends K{constructor(t,{docsPath:e}){super([`Encoded event signature "${t}" not found on ABI.`,"Make sure you are using the correct ABI and that the event exists on it.",`You can look up the signature here: https://openchain.xyz/signatures?query=${t}.`].join(`
`),{docsPath:e,name:"AbiEventSignatureNotFoundError"})}},Bo=class extends K{constructor(t,{docsPath:e}={}){super([`Event ${t?`"${t}" `:""}not found on ABI.`,"Make sure you are using the correct ABI and that the event exists on it."].join(`
`),{docsPath:e,name:"AbiEventNotFoundError"})}},gn=class extends K{constructor(t,{docsPath:e}={}){super([`Function ${t?`"${t}" `:""}not found on ABI.`,"Make sure you are using the correct ABI and that the function exists on it."].join(`
`),{docsPath:e,name:"AbiFunctionNotFoundError"})}},bm=class extends K{constructor(t,{docsPath:e}){super([`Function "${t}" does not contain any \`outputs\` on ABI.`,"Cannot decode function result without knowing what the parameter types are.","Make sure you are using the correct ABI and that the function exists on it."].join(`
`),{docsPath:e,name:"AbiFunctionOutputsNotFoundError"})}},gm=class extends K{constructor(t,e){super("Found ambiguous types in overloaded ABI items.",{metaMessages:[`\`${t.type}\` in \`${fi(t.abiItem)}\`, and`,`\`${e.type}\` in \`${fi(e.abiItem)}\``,"","These types encode differently and cannot be distinguished at runtime.","Remove one of the ambiguous items in the ABI."],name:"AbiItemAmbiguityError"})}},Lm=class extends K{constructor({expectedSize:t,givenSize:e}){super(`Expected bytes${t}, got bytes${e}.`,{name:"BytesSizeMismatchError"})}},Zi=class extends K{constructor({abiItem:t,data:e,params:i,size:a}){super([`Data size of ${a} bytes is too small for non-indexed event parameters.`].join(`
`),{metaMessages:[`Params: (${Ao(i,{includeName:!0})})`,`Data:   ${e} (${a} bytes)`],name:"DecodeLogDataMismatch"}),Object.defineProperty(this,"abiItem",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"data",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"params",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"size",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.abiItem=t,this.data=e,this.params=i,this.size=a}},ba=class extends K{constructor({abiItem:t,param:e}){super([`Expected a topic for indexed event parameter${e.name?` "${e.name}"`:""} on event "${fi(t,{includeName:!0})}".`].join(`
`),{name:"DecodeLogTopicsMismatch"}),Object.defineProperty(this,"abiItem",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.abiItem=t}},_m=class extends K{constructor(t,{docsPath:e}){super([`Type "${t}" is not a valid encoding type.`,"Please provide a valid ABI type."].join(`
`),{docsPath:e,name:"InvalidAbiEncodingType"})}},vm=class extends K{constructor(t,{docsPath:e}){super([`Type "${t}" is not a valid decoding type.`,"Please provide a valid ABI type."].join(`
`),{docsPath:e,name:"InvalidAbiDecodingType"})}},xm=class extends K{constructor(t){super([`Value "${t}" is not a valid array.`].join(`
`),{name:"InvalidArrayError"})}},mm=class extends K{constructor(t){super([`"${t}" is not a valid definition type.`,'Valid types: "function", "event", "error"'].join(`
`),{name:"InvalidDefinitionTypeError"})}}});var Mo,Ro,Po,Em=re(()=>{"use strict";$e();Mo=class extends K{constructor({offset:t,position:e,size:i}){super(`Slice ${e==="start"?"starting":"ending"} at offset "${t}" is out-of-bounds (size: ${i}).`,{name:"SliceOffsetOutOfBoundsError"})}},Ro=class extends K{constructor({size:t,targetSize:e,type:i}){super(`${i.charAt(0).toUpperCase()}${i.slice(1).toLowerCase()} size (${t}) exceeds padding size (${e}).`,{name:"SizeExceedsPaddingSizeError"})}},Po=class extends K{constructor({size:t,targetSize:e,type:i}){super(`${i.charAt(0).toUpperCase()}${i.slice(1).toLowerCase()} is expected to be ${e} ${i} long, but is ${t} ${i} long.`,{name:"InvalidBytesLengthError"})}}});function Ln(n,{dir:t,size:e=32}={}){return typeof n=="string"?Ya(n,{dir:t,size:e}):YD(n,{dir:t,size:e})}function Ya(n,{dir:t,size:e=32}={}){if(e===null)return n;let i=n.replace("0x","");if(i.length>e*2)throw new Ro({size:Math.ceil(i.length/2),targetSize:e,type:"hex"});return`0x${i[t==="right"?"padEnd":"padStart"](e*2,"0")}`}function YD(n,{dir:t,size:e=32}={}){if(e===null)return n;if(n.length>e)throw new Ro({size:n.length,targetSize:e,type:"bytes"});let i=new Uint8Array(e);for(let a=0;a<e;a++){let r=t==="right";i[r?a:e-a-1]=n[r?a:n.length-a-1]}return i}var wm=re(()=>{"use strict";Em()});var Tm,Cm,Sm,Dm,Am=re(()=>{"use strict";$e();Tm=class extends K{constructor({max:t,min:e,signed:i,size:a,value:r}){super(`Number "${r}" is not in safe ${a?`${a*8}-bit ${i?"signed":"unsigned"} `:""}integer range ${t?`(${e} to ${t})`:`(above ${e})`}`,{name:"IntegerOutOfRangeError"})}},Cm=class extends K{constructor(t){super(`Bytes value "${t}" is not a valid boolean. The bytes array must contain a single byte of either a 0 or 1 value.`,{name:"InvalidBytesBooleanError"})}},Sm=class extends K{constructor(t){super(`Hex value "${t}" is not a valid boolean. The hex value must be "0x0" (false) or "0x1" (true).`,{name:"InvalidHexBooleanError"})}},Dm=class extends K{constructor({givenSize:t,maxSize:e}){super(`Size cannot exceed ${e} bytes. Given size: ${t} bytes.`,{name:"SizeOverflowError"})}}});function si(n,{dir:t="left"}={}){let e=typeof n=="string"?n.replace("0x",""):n,i=0;for(let a=0;a<e.length-1&&e[t==="left"?a:e.length-a-1].toString()==="0";a++)i++;return e=t==="left"?e.slice(i):e.slice(0,e.length-i),typeof n=="string"?(e.length===1&&t==="right"&&(e=`${e}0`),`0x${e.length%2===1?`0${e}`:e}`):e}var Zr=re(()=>{"use strict"});function vi(n,{size:t}){if(ot(n)>t)throw new Dm({givenSize:ot(n),maxSize:t})}function Ut(n,t={}){let{signed:e}=t;t.size&&vi(n,{size:t.size});let i=BigInt(n);if(!e)return i;let a=(n.length-2)/2,r=(1n<<BigInt(a)*8n-1n)-1n;return i<=r?i:i-BigInt(`0x${"f".padStart(a*2,"f")}`)-1n}function M0(n,t={}){let e=n;if(t.size&&(vi(e,{size:t.size}),e=si(e)),si(e)==="0x00")return!1;if(si(e)==="0x01")return!0;throw new Sm(e)}function Vt(n,t={}){return Number(Ut(n,t))}var oi=re(()=>{"use strict";Am();Ji();Zr()});function De(n,t={}){return typeof n=="number"||typeof n=="bigint"?Ce(n,t):typeof n=="string"?ea(n,t):typeof n=="boolean"?km(n,t):at(n,t)}function km(n,t={}){let e=`0x${Number(n)}`;return typeof t.size=="number"?(vi(e,{size:t.size}),Ln(e,{size:t.size})):e}function at(n,t={}){let e="";for(let a=0;a<n.length;a++)e+=zD[n[a]];let i=`0x${e}`;return typeof t.size=="number"?(vi(i,{size:t.size}),Ln(i,{dir:"right",size:t.size})):i}function Ce(n,t={}){let{signed:e,size:i}=t,a=BigInt(n),r;i?e?r=(1n<<BigInt(i)*8n-1n)-1n:r=2n**(BigInt(i)*8n)-1n:typeof n=="number"&&(r=BigInt(Number.MAX_SAFE_INTEGER));let s=typeof r=="bigint"&&e?-r-1n:0;if(r&&a>r||a<s){let l=typeof n=="bigint"?"n":"";throw new Tm({max:r?`${r}${l}`:void 0,min:`${s}${l}`,signed:e,size:i,value:`${n}${l}`})}let o=`0x${(e&&a<0?(1n<<BigInt(i*8))+BigInt(a):a).toString(16)}`;return i?Ln(o,{size:i}):o}function ea(n,t={}){let e=jD.encode(n);return at(e,t)}var zD,jD,Fe=re(()=>{"use strict";Am();wm();oi();zD=Array.from({length:256},(n,t)=>t.toString(16).padStart(2,"0"));jD=new TextEncoder});function Mi(n,t={}){return typeof n=="number"||typeof n=="bigint"?QD(n,t):typeof n=="boolean"?XD(n,t):Rt(n)?qt(n,t):ta(n,t)}function XD(n,t={}){let e=new Uint8Array(1);return e[0]=Number(n),typeof t.size=="number"?(vi(e,{size:t.size}),Ln(e,{size:t.size})):e}function Ww(n){if(n>=za.zero&&n<=za.nine)return n-za.zero;if(n>=za.A&&n<=za.F)return n-(za.A-10);if(n>=za.a&&n<=za.f)return n-(za.a-10)}function qt(n,t={}){let e=n;t.size&&(vi(e,{size:t.size}),e=Ln(e,{dir:"right",size:t.size}));let i=e.slice(2);i.length%2&&(i=`0${i}`);let a=i.length/2,r=new Uint8Array(a);for(let s=0,o=0;s<a;s++){let l=Ww(i.charCodeAt(o++)),c=Ww(i.charCodeAt(o++));if(l===void 0||c===void 0)throw new K(`Invalid byte sequence ("${i[o-2]}${i[o-1]}" in "${i}").`);r[s]=l*16+c}return r}function QD(n,t){let e=Ce(n,t);return qt(e)}function ta(n,t={}){let e=$D.encode(n);return typeof t.size=="number"?(vi(e,{size:t.size}),Ln(e,{dir:"right",size:t.size})):e}var $D,za,ei=re(()=>{"use strict";$e();Qi();wm();oi();Fe();$D=new TextEncoder;za={zero:48,nine:57,A:65,F:70,a:97,f:102}});function No(n){if(!Number.isSafeInteger(n)||n<0)throw new Error(`positive integer expected, not ${n}`)}function JD(n){return n instanceof Uint8Array||n!=null&&typeof n=="object"&&n.constructor.name==="Uint8Array"}function _n(n,...t){if(!JD(n))throw new Error("Uint8Array expected");if(t.length>0&&!t.includes(n.length))throw new Error(`Uint8Array expected of length ${t}, not of length=${n.length}`)}function Yw(n){if(typeof n!="function"||typeof n.create!="function")throw new Error("Hash should be wrapped by utils.wrapConstructor");No(n.outputLen),No(n.blockLen)}function ja(n,t=!0){if(n.destroyed)throw new Error("Hash instance has been destroyed");if(t&&n.finished)throw new Error("Hash#digest() has already been called")}function Bm(n,t){_n(n);let e=t.outputLen;if(n.length<e)throw new Error(`digestInto() expects output buffer of length at least ${e}`)}var Oo=re(()=>{"use strict"});function ZD(n,t=!1){return t?{h:Number(n&Mm),l:Number(n>>zw&Mm)}:{h:Number(n>>zw&Mm)|0,l:Number(n&Mm)|0}}function jw(n,t=!1){let e=new Uint32Array(n.length),i=new Uint32Array(n.length);for(let a=0;a<n.length;a++){let{h:r,l:s}=ZD(n[a],t);[e[a],i[a]]=[r,s]}return[e,i]}var Mm,zw,$w,Xw,Qw,Jw,Zw=re(()=>{"use strict";Mm=BigInt(4294967295),zw=BigInt(32);$w=(n,t,e)=>n<<e|t>>>32-e,Xw=(n,t,e)=>t<<e|n>>>32-e,Qw=(n,t,e)=>t<<e-32|n>>>64-e,Jw=(n,t,e)=>n<<e-32|t>>>64-e});var sr,eT=re(()=>{"use strict";sr=typeof globalThis=="object"&&"crypto"in globalThis?globalThis.crypto:void 0});function P0(n){for(let t=0;t<n.length;t++)n[t]=eA(n[t])}function tA(n){if(typeof n!="string")throw new Error(`utf8ToBytes expected string, got ${typeof n}`);return new Uint8Array(new TextEncoder().encode(n))}function xn(n){return typeof n=="string"&&(n=tA(n)),_n(n),n}function iT(...n){let t=0;for(let i=0;i<n.length;i++){let a=n[i];_n(a),t+=a.length}let e=new Uint8Array(t);for(let i=0,a=0;i<n.length;i++){let r=n[i];e.set(r,a),a+=r.length}return e}function Pm(n){let t=i=>n().update(xn(i)).digest(),e=n();return t.outputLen=e.outputLen,t.blockLen=e.blockLen,t.create=()=>n(),t}function aT(n){let t=(i,a)=>n(a).update(xn(i)).digest(),e=n({});return t.outputLen=e.outputLen,t.blockLen=e.blockLen,t.create=i=>n(i),t}function Nm(n=32){if(sr&&typeof sr.getRandomValues=="function")return sr.getRandomValues(new Uint8Array(n));if(sr&&typeof sr.randomBytes=="function")return sr.randomBytes(n);throw new Error("crypto.getRandomValues must be defined")}var tT,Rm,ia,R0,eA,vn,QU,or=re(()=>{"use strict";eT();Oo();tT=n=>new Uint32Array(n.buffer,n.byteOffset,Math.floor(n.byteLength/4)),Rm=n=>new DataView(n.buffer,n.byteOffset,n.byteLength),ia=(n,t)=>n<<32-t|n>>>t,R0=new Uint8Array(new Uint32Array([287454020]).buffer)[0]===68,eA=n=>n<<24&4278190080|n<<8&16711680|n>>>8&65280|n>>>24&255;vn=class{clone(){return this._cloneInto()}},QU={}.toString});function cA(n,t=24){let e=new Uint32Array(10);for(let i=24-t;i<24;i++){for(let s=0;s<10;s++)e[s]=n[s]^n[s+10]^n[s+20]^n[s+30]^n[s+40];for(let s=0;s<10;s+=2){let o=(s+8)%10,l=(s+2)%10,c=e[l],u=e[l+1],p=nT(c,u,1)^e[o],d=rT(c,u,1)^e[o+1];for(let L=0;L<50;L+=10)n[s+L]^=p,n[s+L+1]^=d}let a=n[2],r=n[3];for(let s=0;s<24;s++){let o=oT[s],l=nT(a,r,o),c=rT(a,r,o),u=sT[s];a=n[u],r=n[u+1],n[u]=l,n[u+1]=c}for(let s=0;s<50;s+=10){for(let o=0;o<10;o++)e[o]=n[s+o];for(let o=0;o<10;o++)n[s+o]^=~e[(o+2)%10]&e[(o+4)%10]}n[0]^=oA[i],n[1]^=lA[i]}e.fill(0)}var sT,oT,lT,iA,Ho,aA,nA,rA,sA,oA,lA,nT,rT,Om,In,i4,a4,n4,r4,s4,cT,o4,l4,uT,c4,u4,mT=re(()=>{"use strict";Oo();Zw();or();sT=[],oT=[],lT=[],iA=BigInt(0),Ho=BigInt(1),aA=BigInt(2),nA=BigInt(7),rA=BigInt(256),sA=BigInt(113);for(let n=0,t=Ho,e=1,i=0;n<24;n++){[e,i]=[i,(2*e+3*i)%5],sT.push(2*(5*i+e)),oT.push((n+1)*(n+2)/2%64);let a=iA;for(let r=0;r<7;r++)t=(t<<Ho^(t>>nA)*sA)%rA,t&aA&&(a^=Ho<<(Ho<<BigInt(r))-Ho);lT.push(a)}[oA,lA]=jw(lT,!0),nT=(n,t,e)=>e>32?Qw(n,t,e):$w(n,t,e),rT=(n,t,e)=>e>32?Jw(n,t,e):Xw(n,t,e);Om=class n extends vn{constructor(t,e,i,a=!1,r=24){if(super(),this.blockLen=t,this.suffix=e,this.outputLen=i,this.enableXOF=a,this.rounds=r,this.pos=0,this.posOut=0,this.finished=!1,this.destroyed=!1,No(i),0>=this.blockLen||this.blockLen>=200)throw new Error("Sha3 supports only keccak-f1600 function");this.state=new Uint8Array(200),this.state32=tT(this.state)}keccak(){R0||P0(this.state32),cA(this.state32,this.rounds),R0||P0(this.state32),this.posOut=0,this.pos=0}update(t){ja(this);let{blockLen:e,state:i}=this;t=xn(t);let a=t.length;for(let r=0;r<a;){let s=Math.min(e-this.pos,a-r);for(let o=0;o<s;o++)i[this.pos++]^=t[r++];this.pos===e&&this.keccak()}return this}finish(){if(this.finished)return;this.finished=!0;let{state:t,suffix:e,pos:i,blockLen:a}=this;t[i]^=e,e&128&&i===a-1&&this.keccak(),t[a-1]^=128,this.keccak()}writeInto(t){ja(this,!1),_n(t),this.finish();let e=this.state,{blockLen:i}=this;for(let a=0,r=t.length;a<r;){this.posOut>=i&&this.keccak();let s=Math.min(i-this.posOut,r-a);t.set(e.subarray(this.posOut,this.posOut+s),a),this.posOut+=s,a+=s}return t}xofInto(t){if(!this.enableXOF)throw new Error("XOF is not possible for this instance");return this.writeInto(t)}xof(t){return No(t),this.xofInto(new Uint8Array(t))}digestInto(t){if(Bm(t,this),this.finished)throw new Error("digest() was already called");return this.writeInto(t),this.destroy(),t}digest(){return this.digestInto(new Uint8Array(this.outputLen))}destroy(){this.destroyed=!0,this.state.fill(0)}_cloneInto(t){let{blockLen:e,suffix:i,outputLen:a,rounds:r,enableXOF:s}=this;return t||(t=new n(e,i,a,s,r)),t.state32.set(this.state32),t.pos=this.pos,t.posOut=this.posOut,t.finished=this.finished,t.rounds=r,t.suffix=i,t.outputLen=a,t.enableXOF=s,t.destroyed=this.destroyed,t}},In=(n,t,e)=>Pm(()=>new Om(t,n,e)),i4=In(6,144,224/8),a4=In(6,136,256/8),n4=In(6,104,384/8),r4=In(6,72,512/8),s4=In(1,144,224/8),cT=In(1,136,256/8),o4=In(1,104,384/8),l4=In(1,72,512/8),uT=(n,t,e)=>aT((i={})=>new Om(t,n,i.dkLen===void 0?e:i.dkLen,!0)),c4=uT(31,168,128/8),u4=uT(31,136,256/8)});function ht(n,t){let e=t||"hex",i=cT(Rt(n,{strict:!1})?Mi(n):n);return e==="bytes"?i:De(i)}var Ri=re(()=>{"use strict";mT();Qi();ei();Fe()});function pT(n){return uA(n)}var uA,hT=re(()=>{"use strict";ei();Ri();uA=n=>ht(Mi(n))});function dT(n){let t=!0,e="",i=0,a="",r=!1;for(let s=0;s<n.length;s++){let o=n[s];if(["(",")",","].includes(o)&&(t=!0),o==="("&&i++,o===")"&&i--,!!t){if(i===0){if(o===" "&&["event","function",""].includes(a))a="";else if(a+=o,o===")"){r=!0;break}continue}if(o===" "){n[s-1]!==","&&e!==","&&e!==",("&&(e="",t=!1);continue}a+=o,e+=o}}if(!r)throw new K("Unable to normalize signature.");return a}var fT=re(()=>{"use strict";$e()});var yT,bT=re(()=>{"use strict";A0();fT();yT=n=>{let t=(()=>typeof n=="string"?n:E0(n))();return dT(t)}});function Hm(n){return pT(yT(n))}var N0=re(()=>{"use strict";hT();bT()});var En,Uo=re(()=>{"use strict";N0();En=Hm});var Lt,ga=re(()=>{"use strict";$e();Lt=class extends K{constructor({address:t}){super(`Address "${t}" is invalid.`,{metaMessages:["- Address must be a hex value of 20 bytes (40 hex characters).","- Address must match its checksum counterpart."],name:"InvalidAddressError"})}}});var La,Vo=re(()=>{"use strict";La=class extends Map{constructor(t){super(),Object.defineProperty(this,"maxSize",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.maxSize=t}get(t){let e=super.get(t);return super.has(t)&&e!==void 0&&(this.delete(t),super.set(t,e)),e}set(t,e){if(super.set(t,e),this.maxSize&&this.size>this.maxSize){let i=this.keys().next().value;i&&this.delete(i)}return this}}});function $a(n,t){if(O0.has(`${n}.${t}`))return O0.get(`${n}.${t}`);let e=t?`${t}${n.toLowerCase()}`:n.substring(2).toLowerCase(),i=ht(ta(e),"bytes"),a=(t?e.substring(`${t}0x`.length):e).split("");for(let s=0;s<40;s+=2)i[s>>1]>>4>=8&&a[s]&&(a[s]=a[s].toUpperCase()),(i[s>>1]&15)>=8&&a[s+1]&&(a[s+1]=a[s+1].toUpperCase());let r=`0x${a.join("")}`;return O0.set(`${n}.${t}`,r),r}function Um(n,t){if(!ft(n,{strict:!1}))throw new Lt({address:n});return $a(n,t)}var O0,lr=re(()=>{"use strict";ga();ei();Ri();Vo();aa();O0=new La(8192)});function ft(n,t){let{strict:e=!0}=t??{},i=`${n}.${e}`;if(H0.has(i))return H0.get(i);let a=(()=>mA.test(n)?n.toLowerCase()===n?!0:e?$a(n)===n:!0:!1)();return H0.set(i,a),a}var mA,H0,aa=re(()=>{"use strict";Vo();lr();mA=/^0x[a-fA-F0-9]{40}$/,H0=new La(8192)});function yi(n){return typeof n[0]=="string"?li(n):pA(n)}function pA(n){let t=0;for(let a of n)t+=a.length;let e=new Uint8Array(t),i=0;for(let a of n)e.set(a,i),i+=a.length;return e}function li(n){return`0x${n.reduce((t,e)=>t+e.replace("0x",""),"")}`}var Pi=re(()=>{"use strict"});function Xa(n,t,e,{strict:i}={}){return Rt(n,{strict:!1})?V0(n,t,e,{strict:i}):U0(n,t,e,{strict:i})}function gT(n,t){if(typeof t=="number"&&t>0&&t>ot(n)-1)throw new Mo({offset:t,position:"start",size:ot(n)})}function LT(n,t,e){if(typeof t=="number"&&typeof e=="number"&&ot(n)!==e-t)throw new Mo({offset:e,position:"end",size:ot(n)})}function U0(n,t,e,{strict:i}={}){gT(n,t);let a=n.slice(t,e);return i&&LT(a,t,e),a}function V0(n,t,e,{strict:i}={}){gT(n,t);let a=`0x${n.replace("0x","").slice((t??0)*2,(e??n.length)*2)}`;return i&&LT(a,t,e),a}var cr=re(()=>{"use strict";Em();Qi();Ji()});function Di(n,t){if(n.length!==t.length)throw new fm({expectedLength:n.length,givenLength:t.length});let e=hA({params:n,values:t}),i=G0(e);return i.length===0?"0x":i}function hA({params:n,values:t}){let e=[];for(let i=0;i<n.length;i++)e.push(F0({param:n[i],value:t[i]}));return e}function F0({param:n,value:t}){let e=Vm(n.type);if(e){let[i,a]=e;return fA(t,{length:i,param:{...n,type:a}})}if(n.type==="tuple")return _A(t,{param:n});if(n.type==="address")return dA(t);if(n.type==="bool")return bA(t);if(n.type.startsWith("uint")||n.type.startsWith("int")){let i=n.type.startsWith("int");return gA(t,{signed:i})}if(n.type.startsWith("bytes"))return yA(t,{param:n});if(n.type==="string")return LA(t);throw new _m(n.type,{docsPath:"/docs/contract/encodeAbiParameters"})}function G0(n){let t=0;for(let r=0;r<n.length;r++){let{dynamic:s,encoded:o}=n[r];s?t+=32:t+=ot(o)}let e=[],i=[],a=0;for(let r=0;r<n.length;r++){let{dynamic:s,encoded:o}=n[r];s?(e.push(Ce(t+a,{size:32})),i.push(o),a+=ot(o)):e.push(o)}return yi([...e,...i])}function dA(n){if(!ft(n))throw new Lt({address:n});return{dynamic:!1,encoded:Ya(n.toLowerCase())}}function fA(n,{length:t,param:e}){let i=t===null;if(!Array.isArray(n))throw new xm(n);if(!i&&n.length!==t)throw new hm({expectedLength:t,givenLength:n.length,type:`${e.type}[${t}]`});let a=!1,r=[];for(let s=0;s<n.length;s++){let o=F0({param:e,value:n[s]});o.dynamic&&(a=!0),r.push(o)}if(i||a){let s=G0(r);if(i){let o=Ce(r.length,{size:32});return{dynamic:!0,encoded:r.length>0?yi([o,s]):o}}if(a)return{dynamic:!0,encoded:s}}return{dynamic:!1,encoded:yi(r.map(({encoded:s})=>s))}}function yA(n,{param:t}){let[,e]=t.type.split("bytes"),i=ot(n);if(!e){let a=n;return i%32!==0&&(a=Ya(a,{dir:"right",size:Math.ceil((n.length-2)/2/32)*32})),{dynamic:!0,encoded:yi([Ya(Ce(i,{size:32})),a])}}if(i!==Number.parseInt(e))throw new dm({expectedSize:Number.parseInt(e),value:n});return{dynamic:!1,encoded:Ya(n,{dir:"right"})}}function bA(n){if(typeof n!="boolean")throw new K(`Invalid boolean value: "${n}" (type: ${typeof n}). Expected: \`true\` or \`false\`.`);return{dynamic:!1,encoded:Ya(km(n))}}function gA(n,{signed:t}){return{dynamic:!1,encoded:Ce(n,{size:32,signed:t})}}function LA(n){let t=ea(n),e=Math.ceil(ot(t)/32),i=[];for(let a=0;a<e;a++)i.push(Ya(Xa(t,a*32,(a+1)*32),{dir:"right"}));return{dynamic:!0,encoded:yi([Ya(Ce(ot(t),{size:32})),...i])}}function _A(n,{param:t}){let e=!1,i=[];for(let a=0;a<t.components.length;a++){let r=t.components[a],s=Array.isArray(n)?a:r.name,o=F0({param:r,value:n[s]});i.push(o),o.dynamic&&(e=!0)}return{dynamic:e,encoded:e?G0(i):yi(i.map(({encoded:a})=>a))}}function Vm(n){let t=n.match(/^(.*)\[(\d+)?\]$/);return t?[t[2]?Number(t[2]):null,t[1]]:void 0}var wn=re(()=>{"use strict";Zt();ga();$e();aa();Pi();wm();Ji();cr();Fe()});var es,Fm=re(()=>{"use strict";cr();N0();es=n=>Xa(Hm(n),0,4)});function _a(n){let{abi:t,args:e=[],name:i}=n,a=Rt(i,{strict:!1}),r=t.filter(o=>a?o.type==="function"?es(o)===i:o.type==="event"?En(o)===i:!1:"name"in o&&o.name===i);if(r.length===0)return;if(r.length===1)return r[0];let s;for(let o of r){if(!("inputs"in o))continue;if(!e||e.length===0){if(!o.inputs||o.inputs.length===0)return o;continue}if(!o.inputs||o.inputs.length===0||o.inputs.length!==e.length)continue;if(e.every((c,u)=>{let p="inputs"in o&&o.inputs[u];return p?K0(c,p):!1})){if(s&&"inputs"in s&&s.inputs){let c=_T(o.inputs,s.inputs,e);if(c)throw new gm({abiItem:o,type:c[0]},{abiItem:s,type:c[1]})}s=o}}return s||r[0]}function K0(n,t){let e=typeof n,i=t.type;switch(i){case"address":return ft(n,{strict:!1});case"bool":return e==="boolean";case"function":return e==="string";case"string":return e==="string";default:return i==="tuple"&&"components"in t?Object.values(t.components).every((a,r)=>K0(Object.values(n)[r],a)):/^u?int(8|16|24|32|40|48|56|64|72|80|88|96|104|112|120|128|136|144|152|160|168|176|184|192|200|208|216|224|232|240|248|256)?$/.test(i)?e==="number"||e==="bigint":/^bytes([1-9]|1[0-9]|2[0-9]|3[0-2])?$/.test(i)?e==="string"||n instanceof Uint8Array:/[a-z]+[1-9]{0,3}(\[[0-9]{0,}\])+$/.test(i)?Array.isArray(n)&&n.every(a=>K0(a,{...t,type:i.replace(/(\[[0-9]{0,}\])$/,"")})):!1}}function _T(n,t,e){for(let i in n){let a=n[i],r=t[i];if(a.type==="tuple"&&r.type==="tuple"&&"components"in a&&"components"in r)return _T(a.components,r.components,e[i]);let s=[a.type,r.type];if((()=>s.includes("address")&&s.includes("bytes20")?!0:s.includes("address")&&s.includes("string")?ft(e[i],{strict:!1}):s.includes("address")&&s.includes("bytes")?ft(e[i],{strict:!1}):!1)())return s}}var ts=re(()=>{"use strict";Zt();Qi();aa();Uo();Fm()});function _t(n){return typeof n=="string"?{address:n,type:"json-rpc"}:n}var xi=re(()=>{"use strict"});function ET(n){let{abi:t,args:e,functionName:i}=n,a=t[0];if(i){let r=_a({abi:t,args:e,name:i});if(!r)throw new gn(i,{docsPath:IT});a=r}if(a.type!=="function")throw new gn(void 0,{docsPath:IT});return{abi:[a],functionName:es(fi(a))}}var IT,wT=re(()=>{"use strict";Zt();Fm();rr();ts();IT="/docs/contract/encodeFunctionData"});function Wt(n){let{args:t}=n,{abi:e,functionName:i}=(()=>n.abi.length===1&&n.functionName?.startsWith("0x")?n:ET(n))(),a=e[0],r=i,s="inputs"in a&&a.inputs?Di(a.inputs,t??[]):void 0;return li([r,s??"0x"])}var xa=re(()=>{"use strict";Pi();wn();wT()});var Km,TT,CT,qm=re(()=>{"use strict";Km={1:"An `assert` condition failed.",17:"Arithmetic operation resulted in underflow or overflow.",18:"Division or modulo by zero (e.g. `5 / 0` or `23 % 0`).",33:"Attempted to convert to an invalid type.",34:"Attempted to access a storage byte array that is incorrectly encoded.",49:"Performed `.pop()` on an empty array",50:"Array index is out of bounds.",65:"Allocated too much memory or created an array which is too large.",81:"Attempted to call a zero-initialized variable of internal function type."},TT={inputs:[{name:"message",type:"string"}],name:"Error",type:"error"},CT={inputs:[{name:"reason",type:"uint256"}],name:"Panic",type:"error"}});var Fo,is,Wm,q0=re(()=>{"use strict";$e();Fo=class extends K{constructor({offset:t}){super(`Offset \`${t}\` cannot be negative.`,{name:"NegativeOffsetError"})}},is=class extends K{constructor({length:t,position:e}){super(`Position \`${e}\` is out of bounds (\`0 < position < ${t}\`).`,{name:"PositionOutOfBoundsError"})}},Wm=class extends K{constructor({count:t,limit:e}){super(`Recursive read limit of \`${e}\` exceeded (recursive read count: \`${t}\`).`,{name:"RecursiveReadLimitExceededError"})}}});function as(n,{recursiveReadLimit:t=8192}={}){let e=Object.create(vA);return e.bytes=n,e.dataView=new DataView(n.buffer,n.byteOffset,n.byteLength),e.positionReadCount=new Map,e.recursiveReadLimit=t,e}var vA,Ym=re(()=>{"use strict";q0();vA={bytes:new Uint8Array,dataView:new DataView(new ArrayBuffer(0)),position:0,positionReadCount:new Map,recursiveReadCount:0,recursiveReadLimit:Number.POSITIVE_INFINITY,assertReadLimit(){if(this.recursiveReadCount>=this.recursiveReadLimit)throw new Wm({count:this.recursiveReadCount+1,limit:this.recursiveReadLimit})},assertPosition(n){if(n<0||n>this.bytes.length-1)throw new is({length:this.bytes.length,position:n})},decrementPosition(n){if(n<0)throw new Fo({offset:n});let t=this.position-n;this.assertPosition(t),this.position=t},getReadCount(n){return this.positionReadCount.get(n||this.position)||0},incrementPosition(n){if(n<0)throw new Fo({offset:n});let t=this.position+n;this.assertPosition(t),this.position=t},inspectByte(n){let t=n??this.position;return this.assertPosition(t),this.bytes[t]},inspectBytes(n,t){let e=t??this.position;return this.assertPosition(e+n-1),this.bytes.subarray(e,e+n)},inspectUint8(n){let t=n??this.position;return this.assertPosition(t),this.bytes[t]},inspectUint16(n){let t=n??this.position;return this.assertPosition(t+1),this.dataView.getUint16(t)},inspectUint24(n){let t=n??this.position;return this.assertPosition(t+2),(this.dataView.getUint16(t)<<8)+this.dataView.getUint8(t+2)},inspectUint32(n){let t=n??this.position;return this.assertPosition(t+3),this.dataView.getUint32(t)},pushByte(n){this.assertPosition(this.position),this.bytes[this.position]=n,this.position++},pushBytes(n){this.assertPosition(this.position+n.length-1),this.bytes.set(n,this.position),this.position+=n.length},pushUint8(n){this.assertPosition(this.position),this.bytes[this.position]=n,this.position++},pushUint16(n){this.assertPosition(this.position+1),this.dataView.setUint16(this.position,n),this.position+=2},pushUint24(n){this.assertPosition(this.position+2),this.dataView.setUint16(this.position,n>>8),this.dataView.setUint8(this.position+2,n&255),this.position+=3},pushUint32(n){this.assertPosition(this.position+3),this.dataView.setUint32(this.position,n),this.position+=4},readByte(){this.assertReadLimit(),this._touch();let n=this.inspectByte();return this.position++,n},readBytes(n,t){this.assertReadLimit(),this._touch();let e=this.inspectBytes(n);return this.position+=t??n,e},readUint8(){this.assertReadLimit(),this._touch();let n=this.inspectUint8();return this.position+=1,n},readUint16(){this.assertReadLimit(),this._touch();let n=this.inspectUint16();return this.position+=2,n},readUint24(){this.assertReadLimit(),this._touch();let n=this.inspectUint24();return this.position+=3,n},readUint32(){this.assertReadLimit(),this._touch();let n=this.inspectUint32();return this.position+=4,n},get remaining(){return this.bytes.length-this.position},setPosition(n){let t=this.position;return this.assertPosition(n),this.position=n,()=>this.position=t},_touch(){if(this.recursiveReadLimit===Number.POSITIVE_INFINITY)return;let n=this.getReadCount();this.positionReadCount.set(this.position,n+1),n>0&&this.recursiveReadCount++}}});function ST(n,t={}){typeof t.size<"u"&&vi(n,{size:t.size});let e=at(n,t);return Ut(e,t)}function DT(n,t={}){let e=n;if(typeof t.size<"u"&&(vi(e,{size:t.size}),e=si(e)),e.length>1||e[0]>1)throw new Cm(e);return!!e[0]}function Ia(n,t={}){typeof t.size<"u"&&vi(n,{size:t.size});let e=at(n,t);return Vt(e,t)}function AT(n,t={}){let e=n;return typeof t.size<"u"&&(vi(e,{size:t.size}),e=si(e,{dir:"right"})),new TextDecoder().decode(e)}var kT=re(()=>{"use strict";Am();Zr();oi();Fe()});function ur(n,t){let e=typeof t=="string"?qt(t):t,i=as(e);if(ot(e)===0&&n.length>0)throw new ya;if(ot(t)&&ot(t)<32)throw new Xr({data:typeof t=="string"?t:at(t),params:n,size:ot(t)});let a=0,r=[];for(let s=0;s<n.length;++s){let o=n[s];i.setPosition(a);let[l,c]=ns(i,o,{staticPosition:0});a+=c,r.push(l)}return r}function ns(n,t,{staticPosition:e}){let i=Vm(t.type);if(i){let[a,r]=i;return IA(n,{...t,type:r},{length:a,staticPosition:e})}if(t.type==="tuple")return CA(n,t,{staticPosition:e});if(t.type==="address")return xA(n);if(t.type==="bool")return EA(n);if(t.type.startsWith("bytes"))return wA(n,t,{staticPosition:e});if(t.type.startsWith("uint")||t.type.startsWith("int"))return TA(n,t);if(t.type==="string")return SA(n,{staticPosition:e});throw new vm(t.type,{docsPath:"/docs/contract/decodeAbiParameters"})}function xA(n){let t=n.readBytes(32);return[$a(at(U0(t,-20))),32]}function IA(n,t,{length:e,staticPosition:i}){if(!e){let s=Ia(n.readBytes(W0)),o=i+s,l=o+BT;n.setPosition(o);let c=Ia(n.readBytes(BT)),u=Go(t),p=0,d=[];for(let L=0;L<c;++L){n.setPosition(l+(u?L*32:p));let[x,w]=ns(n,t,{staticPosition:l});p+=w,d.push(x)}return n.setPosition(i+32),[d,32]}if(Go(t)){let s=Ia(n.readBytes(W0)),o=i+s,l=[];for(let c=0;c<e;++c){n.setPosition(o+c*32);let[u]=ns(n,t,{staticPosition:o});l.push(u)}return n.setPosition(i+32),[l,32]}let a=0,r=[];for(let s=0;s<e;++s){let[o,l]=ns(n,t,{staticPosition:i+a});a+=l,r.push(o)}return[r,a]}function EA(n){return[DT(n.readBytes(32),{size:32}),32]}function wA(n,t,{staticPosition:e}){let[i,a]=t.type.split("bytes");if(!a){let s=Ia(n.readBytes(32));n.setPosition(e+s);let o=Ia(n.readBytes(32));if(o===0)return n.setPosition(e+32),["0x",32];let l=n.readBytes(o);return n.setPosition(e+32),[at(l),32]}return[at(n.readBytes(Number.parseInt(a),32)),32]}function TA(n,t){let e=t.type.startsWith("int"),i=Number.parseInt(t.type.split("int")[1]||"256"),a=n.readBytes(32);return[i>48?ST(a,{signed:e}):Ia(a,{signed:e}),32]}function CA(n,t,{staticPosition:e}){let i=t.components.length===0||t.components.some(({name:s})=>!s),a=i?[]:{},r=0;if(Go(t)){let s=Ia(n.readBytes(W0)),o=e+s;for(let l=0;l<t.components.length;++l){let c=t.components[l];n.setPosition(o+r);let[u,p]=ns(n,c,{staticPosition:o});r+=p,a[i?l:c?.name]=u}return n.setPosition(e+32),[a,32]}for(let s=0;s<t.components.length;++s){let o=t.components[s],[l,c]=ns(n,o,{staticPosition:e});a[i?s:o?.name]=l,r+=c}return[a,r]}function SA(n,{staticPosition:t}){let e=Ia(n.readBytes(32)),i=t+e;n.setPosition(i);let a=Ia(n.readBytes(32));if(a===0)return n.setPosition(t+32),["",32];let r=n.readBytes(a,32),s=AT(si(r));return n.setPosition(t+32),[s,32]}function Go(n){let{type:t}=n;if(t==="string"||t==="bytes"||t.endsWith("[]"))return!0;if(t==="tuple")return n.components?.some(Go);let e=Vm(n.type);return!!(e&&Go({...n,type:e[1]}))}var BT,W0,zm=re(()=>{"use strict";Zt();lr();Ym();Ji();cr();Zr();kT();ei();Fe();wn();BT=32,W0=32});function jm(n){let{abi:t,data:e}=n,i=Xa(e,0,4);if(i==="0x")throw new ya;let r=[...t||[],TT,CT].find(s=>s.type==="error"&&i===es(fi(s)));if(!r)throw new Qr(i,{docsPath:"/docs/contract/decodeErrorResult"});return{abiItem:r,args:"inputs"in r&&r.inputs&&r.inputs.length>0?ur(r.inputs,Xa(e,4)):void 0,errorName:r.name}}var Y0=re(()=>{"use strict";qm();Zt();cr();Fm();zm();rr()});var nt,bi=re(()=>{"use strict";nt=(n,t,e)=>JSON.stringify(n,(i,a)=>{let r=typeof a=="bigint"?a.toString():a;return typeof t=="function"?t(i,r):r},e)});function z0({abiItem:n,args:t,includeFunctionName:e=!0,includeName:i=!1}){if("name"in n&&"inputs"in n&&n.inputs)return`${e?n.name:""}(${n.inputs.map((a,r)=>`${i&&a.name?`${a.name}: `:""}${typeof t[r]=="object"?nt(t[r]):t[r]}`).join(", ")})`}var MT=re(()=>{"use strict";bi()});var $m,RT,Xm=re(()=>{"use strict";$m={gwei:9,wei:18},RT={ether:-9,wei:9}});function Dt(n,t){let e=n.toString(),i=e.startsWith("-");i&&(e=e.slice(1)),e=e.padStart(t,"0");let[a,r]=[e.slice(0,e.length-t),e.slice(e.length-t)];return r=r.replace(/(0+)$/,""),`${i?"-":""}${a||"0"}${r?`.${r}`:""}`}var Qm=re(()=>{"use strict"});function rs(n,t="wei"){return Dt(n,$m[t])}var Jm=re(()=>{"use strict";Xm();Qm()});function Yt(n,t="wei"){return Dt(n,RT[t])}var ss=re(()=>{"use strict";Xm();Qm()});function PT(n){return n.reduce((t,{slot:e,value:i})=>`${t}        ${e}: ${i}
`,"")}function NT(n){return n.reduce((t,{address:e,...i})=>{let a=`${t}    ${e}:
`;return i.nonce&&(a+=`      nonce: ${i.nonce}
`),i.balance&&(a+=`      balance: ${i.balance}
`),i.code&&(a+=`      code: ${i.code}
`),i.state&&(a+=`      state:
`,a+=PT(i.state)),i.stateDiff&&(a+=`      stateDiff:
`,a+=PT(i.stateDiff)),a},`  State Override:
`).slice(0,-1)}var Zm,ep,j0=re(()=>{"use strict";$e();Zm=class extends K{constructor({address:t}){super(`State for account "${t}" is set multiple times.`,{name:"AccountStateConflictError"})}},ep=class extends K{constructor(){super("state and stateDiff are set on the same account.",{name:"StateAssignmentConflictError"})}}});function mr(n){let t=Object.entries(n).map(([i,a])=>a===void 0||a===!1?null:[i,a]).filter(Boolean),e=t.reduce((i,[a])=>Math.max(i,a.length),0);return t.map(([i,a])=>`  ${`${i}:`.padEnd(e+1)}  ${a}`).join(`
`)}var tp,ip,ap,np,rp,os,ls,sp,na=re(()=>{"use strict";Jm();ss();$e();tp=class extends K{constructor(){super(["Cannot specify both a `gasPrice` and a `maxFeePerGas`/`maxPriorityFeePerGas`.","Use `maxFeePerGas`/`maxPriorityFeePerGas` for EIP-1559 compatible networks, and `gasPrice` for others."].join(`
`),{name:"FeeConflictError"})}},ip=class extends K{constructor({v:t}){super(`Invalid \`v\` value "${t}". Expected 27 or 28.`,{name:"InvalidLegacyVError"})}},ap=class extends K{constructor({transaction:t}){super("Cannot infer a transaction type from provided transaction.",{metaMessages:["Provided Transaction:","{",mr(t),"}","","To infer the type, either provide:","- a `type` to the Transaction, or","- an EIP-1559 Transaction with `maxFeePerGas`, or","- an EIP-2930 Transaction with `gasPrice` & `accessList`, or","- an EIP-4844 Transaction with `blobs`, `blobVersionedHashes`, `sidecars`, or","- an EIP-7702 Transaction with `authorizationList`, or","- a Legacy Transaction with `gasPrice`"],name:"InvalidSerializableTransactionError"})}},np=class extends K{constructor({storageKey:t}){super(`Size for storage key "${t}" is invalid. Expected 32 bytes. Got ${Math.floor((t.length-2)/2)} bytes.`,{name:"InvalidStorageKeySizeError"})}},rp=class extends K{constructor(t,{account:e,docsPath:i,chain:a,data:r,gas:s,gasPrice:o,maxFeePerGas:l,maxPriorityFeePerGas:c,nonce:u,to:p,value:d}){let L=mr({chain:a&&`${a?.name} (id: ${a?.id})`,from:e?.address,to:p,value:typeof d<"u"&&`${rs(d)} ${a?.nativeCurrency?.symbol||"ETH"}`,data:r,gas:s,gasPrice:typeof o<"u"&&`${Yt(o)} gwei`,maxFeePerGas:typeof l<"u"&&`${Yt(l)} gwei`,maxPriorityFeePerGas:typeof c<"u"&&`${Yt(c)} gwei`,nonce:u});super(t.shortMessage,{cause:t,docsPath:i,metaMessages:[...t.metaMessages?[...t.metaMessages," "]:[],"Request Arguments:",L].filter(Boolean),name:"TransactionExecutionError"}),Object.defineProperty(this,"cause",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.cause=t}},os=class extends K{constructor({blockHash:t,blockNumber:e,blockTag:i,hash:a,index:r}){let s="Transaction";i&&r!==void 0&&(s=`Transaction at block time "${i}" at index "${r}"`),t&&r!==void 0&&(s=`Transaction at block hash "${t}" at index "${r}"`),e&&r!==void 0&&(s=`Transaction at block number "${e}" at index "${r}"`),a&&(s=`Transaction with hash "${a}"`),super(`${s} could not be found.`,{name:"TransactionNotFoundError"})}},ls=class extends K{constructor({hash:t}){super(`Transaction receipt with hash "${t}" could not be found. The Transaction may not be processed on a block yet.`,{name:"TransactionReceiptNotFoundError"})}},sp=class extends K{constructor({hash:t}){super(`Timed out while waiting for transaction with hash "${t}" to be confirmed.`,{name:"WaitForTransactionReceiptTimeoutError"})}}});var OT,pr,op=re(()=>{"use strict";OT=n=>n,pr=n=>n});var hr,Ko,vt,qo,Wo,Qa,Cn=re(()=>{"use strict";xi();qm();Y0();rr();MT();ts();Jm();ss();Zt();$e();j0();na();op();hr=class extends K{constructor(t,{account:e,docsPath:i,chain:a,data:r,gas:s,gasPrice:o,maxFeePerGas:l,maxPriorityFeePerGas:c,nonce:u,to:p,value:d,stateOverride:L}){let x=e?_t(e):void 0,w=mr({from:x?.address,to:p,value:typeof d<"u"&&`${rs(d)} ${a?.nativeCurrency?.symbol||"ETH"}`,data:r,gas:s,gasPrice:typeof o<"u"&&`${Yt(o)} gwei`,maxFeePerGas:typeof l<"u"&&`${Yt(l)} gwei`,maxPriorityFeePerGas:typeof c<"u"&&`${Yt(c)} gwei`,nonce:u});L&&(w+=`
${NT(L)}`),super(t.shortMessage,{cause:t,docsPath:i,metaMessages:[...t.metaMessages?[...t.metaMessages," "]:[],"Raw Call Arguments:",w].filter(Boolean),name:"CallExecutionError"}),Object.defineProperty(this,"cause",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.cause=t}},Ko=class extends K{constructor(t,{abi:e,args:i,contractAddress:a,docsPath:r,functionName:s,sender:o}){let l=_a({abi:e,args:i,name:s}),c=l?z0({abiItem:l,args:i,includeFunctionName:!1,includeName:!1}):void 0,u=l?fi(l,{includeName:!0}):void 0,p=mr({address:a&&OT(a),function:u,args:c&&c!=="()"&&`${[...Array(s?.length??0).keys()].map(()=>" ").join("")}${c}`,sender:o});super(t.shortMessage||`An unknown error occurred while executing the contract function "${s}".`,{cause:t,docsPath:r,metaMessages:[...t.metaMessages?[...t.metaMessages," "]:[],p&&"Contract Call:",p].filter(Boolean),name:"ContractFunctionExecutionError"}),Object.defineProperty(this,"abi",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"args",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"cause",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"contractAddress",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"formattedArgs",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"functionName",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"sender",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.abi=e,this.args=i,this.cause=t,this.contractAddress=a,this.functionName=s,this.sender=o}},vt=class extends K{constructor({abi:t,data:e,functionName:i,message:a}){let r,s,o,l;if(e&&e!=="0x")try{s=jm({abi:t,data:e});let{abiItem:u,errorName:p,args:d}=s;if(p==="Error")l=d[0];else if(p==="Panic"){let[L]=d;l=Km[L]}else{let L=u?fi(u,{includeName:!0}):void 0,x=u&&d?z0({abiItem:u,args:d,includeFunctionName:!1,includeName:!1}):void 0;o=[L?`Error: ${L}`:"",x&&x!=="()"?`       ${[...Array(p?.length??0).keys()].map(()=>" ").join("")}${x}`:""]}}catch(u){r=u}else a&&(l=a);let c;r instanceof Qr&&(c=r.signature,o=[`Unable to decode signature "${c}" as it was not found on the provided ABI.`,"Make sure you are using the correct ABI and that the error exists on it.",`You can look up the decoded signature here: https://openchain.xyz/signatures?query=${c}.`]),super(l&&l!=="execution reverted"||c?[`The contract function "${i}" reverted with the following ${c?"signature":"reason"}:`,l||c].join(`
`):`The contract function "${i}" reverted.`,{cause:r,metaMessages:o,name:"ContractFunctionRevertedError"}),Object.defineProperty(this,"data",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"reason",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"signature",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.data=s,this.reason=l,this.signature=c}},qo=class extends K{constructor({functionName:t}){super(`The contract function "${t}" returned no data ("0x").`,{metaMessages:["This could be due to any of the following:",`  - The contract does not have the function "${t}",`,"  - The parameters passed to the contract function may be invalid, or","  - The address is not a contract."],name:"ContractFunctionZeroDataError"})}},Wo=class extends K{constructor({factory:t}){super(`Deployment for counterfactual contract call failed${t?` for factory "${t}".`:""}`,{metaMessages:["Please ensure:","- The `factory` is a valid contract deployment factory (ie. Create2 Factory, ERC-4337 Factory, etc).","- The `factoryData` is a valid encoded function call for contract deployment function on the factory."],name:"CounterfactualDeploymentFailedError"})}},Qa=class extends K{constructor({data:t,message:e}){super(e||"",{name:"RawContractError"}),Object.defineProperty(this,"code",{enumerable:!0,configurable:!0,writable:!0,value:3}),Object.defineProperty(this,"data",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.data=t}}});var Ni,cs,Yo,us=re(()=>{"use strict";bi();$e();op();Ni=class extends K{constructor({body:t,cause:e,details:i,headers:a,status:r,url:s}){super("HTTP request failed.",{cause:e,details:i,metaMessages:[r&&`Status: ${r}`,`URL: ${pr(s)}`,t&&`Request body: ${nt(t)}`].filter(Boolean),name:"HttpRequestError"}),Object.defineProperty(this,"body",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"headers",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"status",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"url",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.body=t,this.headers=a,this.status=r,this.url=s}},cs=class extends K{constructor({body:t,error:e,url:i}){super("RPC Request failed.",{cause:e,details:e.message,metaMessages:[`URL: ${pr(i)}`,`Request body: ${nt(t)}`],name:"RpcRequestError"}),Object.defineProperty(this,"code",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.code=e.code}},Yo=class extends K{constructor({body:t,url:e}){super("The request took too long to respond.",{details:"The request timed out.",metaMessages:[`URL: ${pr(e)}`,`Request body: ${nt(t)}`],name:"TimeoutError"})}}});var DA,ci,Sn,ms,ps,hs,ds,Ja,Ea,fs,ys,bs,gs,dr,Ls,fr,_s,vs,xs,Is,Es,lp,zo=re(()=>{"use strict";$e();us();DA=-1,ci=class extends K{constructor(t,{code:e,docsPath:i,metaMessages:a,name:r,shortMessage:s}){super(s,{cause:t,docsPath:i,metaMessages:a||t?.metaMessages,name:r||"RpcError"}),Object.defineProperty(this,"code",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.name=r||t.name,this.code=t instanceof cs?t.code:e??DA}},Sn=class extends ci{constructor(t,e){super(t,e),Object.defineProperty(this,"data",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.data=e.data}},ms=class n extends ci{constructor(t){super(t,{code:n.code,name:"ParseRpcError",shortMessage:"Invalid JSON was received by the server. An error occurred on the server while parsing the JSON text."})}};Object.defineProperty(ms,"code",{enumerable:!0,configurable:!0,writable:!0,value:-32700});ps=class n extends ci{constructor(t){super(t,{code:n.code,name:"InvalidRequestRpcError",shortMessage:"JSON is not a valid request object."})}};Object.defineProperty(ps,"code",{enumerable:!0,configurable:!0,writable:!0,value:-32600});hs=class n extends ci{constructor(t,{method:e}={}){super(t,{code:n.code,name:"MethodNotFoundRpcError",shortMessage:`The method${e?` "${e}"`:""} does not exist / is not available.`})}};Object.defineProperty(hs,"code",{enumerable:!0,configurable:!0,writable:!0,value:-32601});ds=class n extends ci{constructor(t){super(t,{code:n.code,name:"InvalidParamsRpcError",shortMessage:["Invalid parameters were provided to the RPC method.","Double check you have provided the correct parameters."].join(`
`)})}};Object.defineProperty(ds,"code",{enumerable:!0,configurable:!0,writable:!0,value:-32602});Ja=class n extends ci{constructor(t){super(t,{code:n.code,name:"InternalRpcError",shortMessage:"An internal error was received."})}};Object.defineProperty(Ja,"code",{enumerable:!0,configurable:!0,writable:!0,value:-32603});Ea=class n extends ci{constructor(t){super(t,{code:n.code,name:"InvalidInputRpcError",shortMessage:["Missing or invalid parameters.","Double check you have provided the correct parameters."].join(`
`)})}};Object.defineProperty(Ea,"code",{enumerable:!0,configurable:!0,writable:!0,value:-32e3});fs=class n extends ci{constructor(t){super(t,{code:n.code,name:"ResourceNotFoundRpcError",shortMessage:"Requested resource not found."}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"ResourceNotFoundRpcError"})}};Object.defineProperty(fs,"code",{enumerable:!0,configurable:!0,writable:!0,value:-32001});ys=class n extends ci{constructor(t){super(t,{code:n.code,name:"ResourceUnavailableRpcError",shortMessage:"Requested resource not available."})}};Object.defineProperty(ys,"code",{enumerable:!0,configurable:!0,writable:!0,value:-32002});bs=class n extends ci{constructor(t){super(t,{code:n.code,name:"TransactionRejectedRpcError",shortMessage:"Transaction creation failed."})}};Object.defineProperty(bs,"code",{enumerable:!0,configurable:!0,writable:!0,value:-32003});gs=class n extends ci{constructor(t,{method:e}={}){super(t,{code:n.code,name:"MethodNotSupportedRpcError",shortMessage:`Method${e?` "${e}"`:""} is not implemented.`})}};Object.defineProperty(gs,"code",{enumerable:!0,configurable:!0,writable:!0,value:-32004});dr=class n extends ci{constructor(t){super(t,{code:n.code,name:"LimitExceededRpcError",shortMessage:"Request exceeds defined limit."})}};Object.defineProperty(dr,"code",{enumerable:!0,configurable:!0,writable:!0,value:-32005});Ls=class n extends ci{constructor(t){super(t,{code:n.code,name:"JsonRpcVersionUnsupportedError",shortMessage:"Version of JSON-RPC protocol is not supported."})}};Object.defineProperty(Ls,"code",{enumerable:!0,configurable:!0,writable:!0,value:-32006});fr=class n extends Sn{constructor(t){super(t,{code:n.code,name:"UserRejectedRequestError",shortMessage:"User rejected the request."})}};Object.defineProperty(fr,"code",{enumerable:!0,configurable:!0,writable:!0,value:4001});_s=class n extends Sn{constructor(t){super(t,{code:n.code,name:"UnauthorizedProviderError",shortMessage:"The requested method and/or account has not been authorized by the user."})}};Object.defineProperty(_s,"code",{enumerable:!0,configurable:!0,writable:!0,value:4100});vs=class n extends Sn{constructor(t,{method:e}={}){super(t,{code:n.code,name:"UnsupportedProviderMethodError",shortMessage:`The Provider does not support the requested method${e?` " ${e}"`:""}.`})}};Object.defineProperty(vs,"code",{enumerable:!0,configurable:!0,writable:!0,value:4200});xs=class n extends Sn{constructor(t){super(t,{code:n.code,name:"ProviderDisconnectedError",shortMessage:"The Provider is disconnected from all chains."})}};Object.defineProperty(xs,"code",{enumerable:!0,configurable:!0,writable:!0,value:4900});Is=class n extends Sn{constructor(t){super(t,{code:n.code,name:"ChainDisconnectedError",shortMessage:"The Provider is not connected to the requested chain."})}};Object.defineProperty(Is,"code",{enumerable:!0,configurable:!0,writable:!0,value:4901});Es=class n extends Sn{constructor(t){super(t,{code:n.code,name:"SwitchChainError",shortMessage:"An error occurred when attempting to switch chain."})}};Object.defineProperty(Es,"code",{enumerable:!0,configurable:!0,writable:!0,value:4902});lp=class extends ci{constructor(t){super(t,{name:"UnknownRpcError",shortMessage:"An unknown RPC error occurred."})}}});function kA(n,t,e,i){if(typeof n.setBigUint64=="function")return n.setBigUint64(t,e,i);let a=BigInt(32),r=BigInt(4294967295),s=Number(e>>a&r),o=Number(e&r),l=i?4:0,c=i?0:4;n.setUint32(t+l,s,i),n.setUint32(t+c,o,i)}var UT,VT,cp,FT=re(()=>{"use strict";Oo();or();UT=(n,t,e)=>n&t^~n&e,VT=(n,t,e)=>n&t^n&e^t&e,cp=class extends vn{constructor(t,e,i,a){super(),this.blockLen=t,this.outputLen=e,this.padOffset=i,this.isLE=a,this.finished=!1,this.length=0,this.pos=0,this.destroyed=!1,this.buffer=new Uint8Array(t),this.view=Rm(this.buffer)}update(t){ja(this);let{view:e,buffer:i,blockLen:a}=this;t=xn(t);let r=t.length;for(let s=0;s<r;){let o=Math.min(a-this.pos,r-s);if(o===a){let l=Rm(t);for(;a<=r-s;s+=a)this.process(l,s);continue}i.set(t.subarray(s,s+o),this.pos),this.pos+=o,s+=o,this.pos===a&&(this.process(e,0),this.pos=0)}return this.length+=t.length,this.roundClean(),this}digestInto(t){ja(this),Bm(t,this),this.finished=!0;let{buffer:e,view:i,blockLen:a,isLE:r}=this,{pos:s}=this;e[s++]=128,this.buffer.subarray(s).fill(0),this.padOffset>a-s&&(this.process(i,0),s=0);for(let p=s;p<a;p++)e[p]=0;kA(i,a-8,BigInt(this.length*8),r),this.process(i,0);let o=Rm(t),l=this.outputLen;if(l%4)throw new Error("_sha2: outputLen should be aligned to 32bit");let c=l/4,u=this.get();if(c>u.length)throw new Error("_sha2: outputLen bigger than state");for(let p=0;p<c;p++)o.setUint32(4*p,u[p],r)}digest(){let{buffer:t,outputLen:e}=this;this.digestInto(t);let i=t.slice(0,e);return this.destroy(),i}_cloneInto(t){t||(t=new this.constructor),t.set(...this.get());let{blockLen:e,buffer:i,length:a,finished:r,destroyed:s,pos:o}=this;return t.length=a,t.pos=o,t.finished=r,t.destroyed=s,a%e&&t.buffer.set(i),t}}});var BA,Dn,An,$0,yr,X0=re(()=>{"use strict";FT();or();BA=new Uint32Array([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]),Dn=new Uint32Array([1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225]),An=new Uint32Array(64),$0=class extends cp{constructor(){super(64,32,8,!1),this.A=Dn[0]|0,this.B=Dn[1]|0,this.C=Dn[2]|0,this.D=Dn[3]|0,this.E=Dn[4]|0,this.F=Dn[5]|0,this.G=Dn[6]|0,this.H=Dn[7]|0}get(){let{A:t,B:e,C:i,D:a,E:r,F:s,G:o,H:l}=this;return[t,e,i,a,r,s,o,l]}set(t,e,i,a,r,s,o,l){this.A=t|0,this.B=e|0,this.C=i|0,this.D=a|0,this.E=r|0,this.F=s|0,this.G=o|0,this.H=l|0}process(t,e){for(let p=0;p<16;p++,e+=4)An[p]=t.getUint32(e,!1);for(let p=16;p<64;p++){let d=An[p-15],L=An[p-2],x=ia(d,7)^ia(d,18)^d>>>3,w=ia(L,17)^ia(L,19)^L>>>10;An[p]=w+An[p-7]+x+An[p-16]|0}let{A:i,B:a,C:r,D:s,E:o,F:l,G:c,H:u}=this;for(let p=0;p<64;p++){let d=ia(o,6)^ia(o,11)^ia(o,25),L=u+d+UT(o,l,c)+BA[p]+An[p]|0,w=(ia(i,2)^ia(i,13)^ia(i,22))+VT(i,a,r)|0;u=c,c=l,l=o,o=s+L|0,s=r,r=a,a=i,i=L+w|0}i=i+this.A|0,a=a+this.B|0,r=r+this.C|0,s=s+this.D|0,o=o+this.E|0,l=l+this.F|0,c=c+this.G|0,u=u+this.H|0,this.set(i,a,r,s,o,l,c,u)}roundClean(){An.fill(0)}destroy(){this.set(0,0,0,0,0,0,0,0),this.buffer.fill(0)}},yr=Pm(()=>new $0)});var up,Q0,GT=re(()=>{"use strict";Oo();or();up=class extends vn{constructor(t,e){super(),this.finished=!1,this.destroyed=!1,Yw(t);let i=xn(e);if(this.iHash=t.create(),typeof this.iHash.update!="function")throw new Error("Expected instance of class which extends utils.Hash");this.blockLen=this.iHash.blockLen,this.outputLen=this.iHash.outputLen;let a=this.blockLen,r=new Uint8Array(a);r.set(i.length>a?t.create().update(i).digest():i);for(let s=0;s<r.length;s++)r[s]^=54;this.iHash.update(r),this.oHash=t.create();for(let s=0;s<r.length;s++)r[s]^=106;this.oHash.update(r),r.fill(0)}update(t){return ja(this),this.iHash.update(t),this}digestInto(t){ja(this),_n(t,this.outputLen),this.finished=!0,this.iHash.digestInto(t),this.oHash.update(t),this.oHash.digestInto(t),this.destroy()}digest(){let t=new Uint8Array(this.oHash.outputLen);return this.digestInto(t),t}_cloneInto(t){t||(t=Object.create(Object.getPrototypeOf(this),{}));let{oHash:e,iHash:i,finished:a,destroyed:r,blockLen:s,outputLen:o}=this;return t=t,t.finished=a,t.destroyed=r,t.blockLen=s,t.outputLen=o,t.oHash=e._cloneInto(t.oHash),t.iHash=i._cloneInto(t.iHash),t}destroy(){this.destroyed=!0,this.oHash.destroy(),this.iHash.destroy()}},Q0=(n,t,e)=>new up(n,t).update(e).digest();Q0.create=(n,t)=>new up(n,t)});var nI={};L0(nI,{aInRange:()=>wa,abool:()=>br,abytes:()=>Oi,bitGet:()=>OA,bitLen:()=>iI,bitMask:()=>$o,bitSet:()=>HA,bytesToHex:()=>gr,bytesToNumberBE:()=>Ii,bytesToNumberLE:()=>pp,concatBytes:()=>ui,createHmacDrbg:()=>aI,ensureBytes:()=>zt,equalBytes:()=>NA,hexToBytes:()=>_r,hexToNumber:()=>tI,inRange:()=>Bn,isBytes:()=>kn,memoized:()=>dp,notImplemented:()=>VA,numberToBytesBE:()=>sa,numberToBytesLE:()=>hp,numberToHexUnpadded:()=>Lr,numberToVarBytesBE:()=>PA,utf8ToBytes:()=>jo,validateObject:()=>Ta});function kn(n){return n instanceof Uint8Array||n!=null&&typeof n=="object"&&n.constructor.name==="Uint8Array"}function Oi(n){if(!kn(n))throw new Error("Uint8Array expected")}function br(n,t){if(typeof t!="boolean")throw new Error(`${n} must be valid boolean, got "${t}".`)}function gr(n){Oi(n);let t="";for(let e=0;e<n.length;e++)t+=RA[n[e]];return t}function Lr(n){let t=n.toString(16);return t.length&1?`0${t}`:t}function tI(n){if(typeof n!="string")throw new Error("hex string expected, got "+typeof n);return BigInt(n===""?"0":`0x${n}`)}function KT(n){if(n>=Za._0&&n<=Za._9)return n-Za._0;if(n>=Za._A&&n<=Za._F)return n-(Za._A-10);if(n>=Za._a&&n<=Za._f)return n-(Za._a-10)}function _r(n){if(typeof n!="string")throw new Error("hex string expected, got "+typeof n);let t=n.length,e=t/2;if(t%2)throw new Error("padded hex string expected, got unpadded hex of length "+t);let i=new Uint8Array(e);for(let a=0,r=0;a<e;a++,r+=2){let s=KT(n.charCodeAt(r)),o=KT(n.charCodeAt(r+1));if(s===void 0||o===void 0){let l=n[r]+n[r+1];throw new Error('hex string expected, got non-hex character "'+l+'" at index '+r)}i[a]=s*16+o}return i}function Ii(n){return tI(gr(n))}function pp(n){return Oi(n),tI(gr(Uint8Array.from(n).reverse()))}function sa(n,t){return _r(n.toString(16).padStart(t*2,"0"))}function hp(n,t){return sa(n,t).reverse()}function PA(n){return _r(Lr(n))}function zt(n,t,e){let i;if(typeof t=="string")try{i=_r(t)}catch(r){throw new Error(`${n} must be valid hex string, got "${t}". Cause: ${r}`)}else if(kn(t))i=Uint8Array.from(t);else throw new Error(`${n} must be hex string or Uint8Array`);let a=i.length;if(typeof e=="number"&&a!==e)throw new Error(`${n} expected ${e} bytes, got ${a}`);return i}function ui(...n){let t=0;for(let i=0;i<n.length;i++){let a=n[i];Oi(a),t+=a.length}let e=new Uint8Array(t);for(let i=0,a=0;i<n.length;i++){let r=n[i];e.set(r,a),a+=r.length}return e}function NA(n,t){if(n.length!==t.length)return!1;let e=0;for(let i=0;i<n.length;i++)e|=n[i]^t[i];return e===0}function jo(n){if(typeof n!="string")throw new Error(`utf8ToBytes expected string, got ${typeof n}`);return new Uint8Array(new TextEncoder().encode(n))}function Bn(n,t,e){return J0(n)&&J0(t)&&J0(e)&&t<=n&&n<e}function wa(n,t,e,i){if(!Bn(t,e,i))throw new Error(`expected valid ${n}: ${e} <= n < ${i}, got ${typeof t} ${t}`)}function iI(n){let t;for(t=0;n>eI;n>>=mp,t+=1);return t}function OA(n,t){return n>>BigInt(t)&mp}function HA(n,t,e){return n|(e?mp:eI)<<BigInt(t)}function aI(n,t,e){if(typeof n!="number"||n<2)throw new Error("hashLen must be a number");if(typeof t!="number"||t<2)throw new Error("qByteLen must be a number");if(typeof e!="function")throw new Error("hmacFn must be a function");let i=Z0(n),a=Z0(n),r=0,s=()=>{i.fill(1),a.fill(0),r=0},o=(...p)=>e(a,i,...p),l=(p=Z0())=>{a=o(qT([0]),p),i=o(),p.length!==0&&(a=o(qT([1]),p),i=o())},c=()=>{if(r++>=1e3)throw new Error("drbg: tried 1000 values");let p=0,d=[];for(;p<t;){i=o();let L=i.slice();d.push(L),p+=i.length}return ui(...d)};return(p,d)=>{s(),l(p);let L;for(;!(L=d(c()));)l();return s(),L}}function Ta(n,t,e={}){let i=(a,r,s)=>{let o=UA[r];if(typeof o!="function")throw new Error(`Invalid validator "${r}", expected function`);let l=n[a];if(!(s&&l===void 0)&&!o(l,n))throw new Error(`Invalid param ${String(a)}=${l} (${typeof l}), expected ${r}`)};for(let[a,r]of Object.entries(t))i(a,r,!1);for(let[a,r]of Object.entries(e))i(a,r,!0);return n}function dp(n){let t=new WeakMap;return(e,...i)=>{let a=t.get(e);if(a!==void 0)return a;let r=n(e,...i);return t.set(e,r),r}}var eI,mp,MA,RA,Za,J0,$o,Z0,qT,UA,VA,vr=re(()=>{"use strict";eI=BigInt(0),mp=BigInt(1),MA=BigInt(2);RA=Array.from({length:256},(n,t)=>t.toString(16).padStart(2,"0"));Za={_0:48,_9:57,_A:65,_F:70,_a:97,_f:102};J0=n=>typeof n=="bigint"&&eI<=n;$o=n=>(MA<<BigInt(n-1))-mp,Z0=n=>new Uint8Array(n),qT=n=>Uint8Array.from(n);UA={bigint:n=>typeof n=="bigint",function:n=>typeof n=="function",boolean:n=>typeof n=="boolean",string:n=>typeof n=="string",stringOrUint8Array:n=>typeof n=="string"||kn(n),isSafeInteger:n=>Number.isSafeInteger(n),array:n=>Array.isArray(n),field:(n,t)=>t.Fp.isValid(n),hash:n=>typeof n=="function"&&Number.isSafeInteger(n.outputLen)};VA=()=>{throw new Error("not implemented")}});function Pt(n,t){let e=n%t;return e>=jt?e:t+e}function qA(n,t,e){if(e<=jt||t<jt)throw new Error("Expected power/modulo > 0");if(e===At)return jt;let i=At;for(;t>jt;)t&At&&(i=i*n%e),n=n*n%e,t>>=At;return i}function Ai(n,t,e){let i=n;for(;t-- >jt;)i*=i,i%=e;return i}function fp(n,t){if(n===jt||t<=jt)throw new Error(`invert: expected positive integers, got n=${n} mod=${t}`);let e=Pt(n,t),i=t,a=jt,r=At,s=At,o=jt;for(;e!==jt;){let c=i/e,u=i%e,p=a-s*c,d=r-o*c;i=e,e=u,a=s,r=o,s=p,o=d}if(i!==At)throw new Error("invert: does not exist");return Pt(a,t)}function WA(n){let t=(n-At)/xr,e,i,a;for(e=n-At,i=0;e%xr===jt;e/=xr,i++);for(a=xr;a<n&&qA(a,t,n)!==n-At;a++);if(i===1){let s=(n+At)/rI;return function(l,c){let u=l.pow(c,s);if(!l.eql(l.sqr(u),c))throw new Error("Cannot find square root");return u}}let r=(e+At)/xr;return function(o,l){if(o.pow(l,t)===o.neg(o.ONE))throw new Error("Cannot find square root");let c=i,u=o.pow(o.mul(o.ONE,a),e),p=o.pow(l,r),d=o.pow(l,e);for(;!o.eql(d,o.ONE);){if(o.eql(d,o.ZERO))return o.ZERO;let L=1;for(let w=o.sqr(d);L<c&&!o.eql(w,o.ONE);L++)w=o.sqr(w);let x=o.pow(u,At<<BigInt(c-L-1));u=o.sqr(x),p=o.mul(p,x),d=o.mul(d,u),c=L}return p}}function YA(n){if(n%rI===FA){let t=(n+At)/rI;return function(i,a){let r=i.pow(a,t);if(!i.eql(i.sqr(r),a))throw new Error("Cannot find square root");return r}}if(n%YT===WT){let t=(n-WT)/YT;return function(i,a){let r=i.mul(a,xr),s=i.pow(r,t),o=i.mul(a,s),l=i.mul(i.mul(o,xr),s),c=i.mul(o,i.sub(l,i.ONE));if(!i.eql(i.sqr(c),a))throw new Error("Cannot find square root");return c}}return n%KA,WA(n)}function yp(n){let t={ORDER:"bigint",MASK:"bigint",BYTES:"isSafeInteger",BITS:"isSafeInteger"},e=zA.reduce((i,a)=>(i[a]="function",i),t);return Ta(n,e)}function jA(n,t,e){if(e<jt)throw new Error("Expected power > 0");if(e===jt)return n.ONE;if(e===At)return t;let i=n.ONE,a=t;for(;e>jt;)e&At&&(i=n.mul(i,a)),a=n.sqr(a),e>>=At;return i}function $A(n,t){let e=new Array(t.length),i=t.reduce((r,s,o)=>n.is0(s)?r:(e[o]=r,n.mul(r,s)),n.ONE),a=n.inv(i);return t.reduceRight((r,s,o)=>n.is0(s)?r:(e[o]=n.mul(r,e[o]),n.mul(r,s)),a),e}function sI(n,t){let e=t!==void 0?t:n.toString(2).length,i=Math.ceil(e/8);return{nBitLength:e,nByteLength:i}}function bp(n,t,e=!1,i={}){if(n<=jt)throw new Error(`Expected Field ORDER > 0, got ${n}`);let{nBitLength:a,nByteLength:r}=sI(n,t);if(r>2048)throw new Error("Field lengths over 2048 bytes are not supported");let s=YA(n),o=Object.freeze({ORDER:n,BITS:a,BYTES:r,MASK:$o(a),ZERO:jt,ONE:At,create:l=>Pt(l,n),isValid:l=>{if(typeof l!="bigint")throw new Error(`Invalid field element: expected bigint, got ${typeof l}`);return jt<=l&&l<n},is0:l=>l===jt,isOdd:l=>(l&At)===At,neg:l=>Pt(-l,n),eql:(l,c)=>l===c,sqr:l=>Pt(l*l,n),add:(l,c)=>Pt(l+c,n),sub:(l,c)=>Pt(l-c,n),mul:(l,c)=>Pt(l*c,n),pow:(l,c)=>jA(o,l,c),div:(l,c)=>Pt(l*fp(c,n),n),sqrN:l=>l*l,addN:(l,c)=>l+c,subN:(l,c)=>l-c,mulN:(l,c)=>l*c,inv:l=>fp(l,n),sqrt:i.sqrt||(l=>s(o,l)),invertBatch:l=>$A(o,l),cmov:(l,c,u)=>u?c:l,toBytes:l=>e?hp(l,r):sa(l,r),fromBytes:l=>{if(l.length!==r)throw new Error(`Fp.fromBytes: expected ${r}, got ${l.length}`);return e?pp(l):Ii(l)}});return Object.freeze(o)}function zT(n){if(typeof n!="bigint")throw new Error("field order must be bigint");let t=n.toString(2).length;return Math.ceil(t/8)}function oI(n){let t=zT(n);return t+Math.ceil(t/2)}function jT(n,t,e=!1){let i=n.length,a=zT(t),r=oI(t);if(i<16||i<r||i>1024)throw new Error(`expected ${r}-1024 bytes of input, got ${i}`);let s=e?Ii(n):pp(n),o=Pt(s,t-At)+At;return e?hp(o,a):sa(o,a)}var jt,At,xr,FA,rI,WT,YT,GA,KA,zA,Xo=re(()=>{"use strict";vr();jt=BigInt(0),At=BigInt(1),xr=BigInt(2),FA=BigInt(3),rI=BigInt(4),WT=BigInt(5),YT=BigInt(8),GA=BigInt(9),KA=BigInt(16);zA=["create","isValid","is0","neg","inv","sqrt","sqr","eql","add","sub","mul","pow","div","addN","subN","mulN","sqrN"]});function XT(n,t){let e=(r,s)=>{let o=s.negate();return r?o:s},i=r=>{if(!Number.isSafeInteger(r)||r<=0||r>t)throw new Error(`Wrong window size=${r}, should be [1..${t}]`)},a=r=>{i(r);let s=Math.ceil(t/r)+1,o=2**(r-1);return{windows:s,windowSize:o}};return{constTimeNegate:e,unsafeLadder(r,s){let o=n.ZERO,l=r;for(;s>QA;)s&lI&&(o=o.add(l)),l=l.double(),s>>=lI;return o},precomputeWindow(r,s){let{windows:o,windowSize:l}=a(s),c=[],u=r,p=u;for(let d=0;d<o;d++){p=u,c.push(p);for(let L=1;L<l;L++)p=p.add(u),c.push(p);u=p.double()}return c},wNAF(r,s,o){let{windows:l,windowSize:c}=a(r),u=n.ZERO,p=n.BASE,d=BigInt(2**r-1),L=2**r,x=BigInt(r);for(let w=0;w<l;w++){let I=w*c,M=Number(o&d);o>>=x,M>c&&(M-=L,o+=lI);let H=I,V=I+Math.abs(M)-1,q=w%2!==0,X=M<0;M===0?p=p.add(e(q,s[H])):u=u.add(e(X,s[V]))}return{p:u,f:p}},wNAFCached(r,s,o){let l=$T.get(r)||1,c=cI.get(r);return c||(c=this.precomputeWindow(r,l),l!==1&&cI.set(r,o(c))),this.wNAF(l,c,s)},setWindowSize(r,s){i(s),$T.set(r,s),cI.delete(r)}}}function QT(n,t,e,i){if(!Array.isArray(e)||!Array.isArray(i)||i.length!==e.length)throw new Error("arrays of points and scalars must have equal length");i.forEach((u,p)=>{if(!t.isValid(u))throw new Error(`wrong scalar at index ${p}`)}),e.forEach((u,p)=>{if(!(u instanceof n))throw new Error(`wrong point at index ${p}`)});let a=iI(BigInt(e.length)),r=a>12?a-3:a>4?a-2:a?2:1,s=(1<<r)-1,o=new Array(s+1).fill(n.ZERO),l=Math.floor((t.BITS-1)/r)*r,c=n.ZERO;for(let u=l;u>=0;u-=r){o.fill(n.ZERO);for(let d=0;d<i.length;d++){let L=i[d],x=Number(L>>BigInt(u)&BigInt(s));o[x]=o[x].add(e[d])}let p=n.ZERO;for(let d=o.length-1,L=n.ZERO;d>0;d--)L=L.add(o[d]),p=p.add(L);if(c=c.add(p),u!==0)for(let d=0;d<r;d++)c=c.double()}return c}function uI(n){return yp(n.Fp),Ta(n,{n:"bigint",h:"bigint",Gx:"field",Gy:"field"},{nBitLength:"isSafeInteger",nByteLength:"isSafeInteger"}),Object.freeze({...sI(n.n,n.nBitLength),...n,p:n.Fp.ORDER})}var QA,lI,cI,$T,JT=re(()=>{"use strict";Xo();vr();QA=BigInt(0),lI=BigInt(1),cI=new WeakMap,$T=new WeakMap});function ZT(n){n.lowS!==void 0&&br("lowS",n.lowS),n.prehash!==void 0&&br("prehash",n.prehash)}function JA(n){let t=uI(n);Ta(t,{a:"field",b:"field"},{allowedPrivateKeyLengths:"array",wrapPrivateKey:"boolean",isTorsionFree:"function",clearCofactor:"function",allowInfinityPoint:"boolean",fromBytes:"function",toBytes:"function"});let{endo:e,Fp:i,a}=t;if(e){if(!i.eql(a,i.ZERO))throw new Error("Endomorphism can only be defined for Koblitz curves that have a=0");if(typeof e!="object"||typeof e.beta!="bigint"||typeof e.splitScalar!="function")throw new Error("Expected endomorphism with beta: bigint and splitScalar: function")}return Object.freeze({...t})}function tk(n){let t=JA(n),{Fp:e}=t,i=bp(t.n,t.nBitLength),a=t.toBytes||((w,I,M)=>{let H=I.toAffine();return ui(Uint8Array.from([4]),e.toBytes(H.x),e.toBytes(H.y))}),r=t.fromBytes||(w=>{let I=w.subarray(1),M=e.fromBytes(I.subarray(0,e.BYTES)),H=e.fromBytes(I.subarray(e.BYTES,2*e.BYTES));return{x:M,y:H}});function s(w){let{a:I,b:M}=t,H=e.sqr(w),V=e.mul(H,w);return e.add(e.add(V,e.mul(w,I)),M)}if(!e.eql(e.sqr(t.Gy),s(t.Gx)))throw new Error("bad generator point: equation left != right");function o(w){return Bn(w,yt,t.n)}function l(w){let{allowedPrivateKeyLengths:I,nByteLength:M,wrapPrivateKey:H,n:V}=t;if(I&&typeof w!="bigint"){if(kn(w)&&(w=gr(w)),typeof w!="string"||!I.includes(w.length))throw new Error("Invalid key");w=w.padStart(M*2,"0")}let q;try{q=typeof w=="bigint"?w:Ii(zt("private key",w,M))}catch{throw new Error(`private key must be ${M} bytes, hex or bigint, not ${typeof w}`)}return H&&(q=Pt(q,V)),wa("private key",q,yt,V),q}function c(w){if(!(w instanceof d))throw new Error("ProjectivePoint expected")}let u=dp((w,I)=>{let{px:M,py:H,pz:V}=w;if(e.eql(V,e.ONE))return{x:M,y:H};let q=w.is0();I==null&&(I=q?e.ONE:e.inv(V));let X=e.mul(M,I),Z=e.mul(H,I),Q=e.mul(V,I);if(q)return{x:e.ZERO,y:e.ZERO};if(!e.eql(Q,e.ONE))throw new Error("invZ was invalid");return{x:X,y:Z}}),p=dp(w=>{if(w.is0()){if(t.allowInfinityPoint&&!e.is0(w.py))return;throw new Error("bad point: ZERO")}let{x:I,y:M}=w.toAffine();if(!e.isValid(I)||!e.isValid(M))throw new Error("bad point: x or y not FE");let H=e.sqr(M),V=s(I);if(!e.eql(H,V))throw new Error("bad point: equation left != right");if(!w.isTorsionFree())throw new Error("bad point: not in prime-order subgroup");return!0});class d{constructor(I,M,H){if(this.px=I,this.py=M,this.pz=H,I==null||!e.isValid(I))throw new Error("x required");if(M==null||!e.isValid(M))throw new Error("y required");if(H==null||!e.isValid(H))throw new Error("z required");Object.freeze(this)}static fromAffine(I){let{x:M,y:H}=I||{};if(!I||!e.isValid(M)||!e.isValid(H))throw new Error("invalid affine point");if(I instanceof d)throw new Error("projective point not allowed");let V=q=>e.eql(q,e.ZERO);return V(M)&&V(H)?d.ZERO:new d(M,H,e.ONE)}get x(){return this.toAffine().x}get y(){return this.toAffine().y}static normalizeZ(I){let M=e.invertBatch(I.map(H=>H.pz));return I.map((H,V)=>H.toAffine(M[V])).map(d.fromAffine)}static fromHex(I){let M=d.fromAffine(r(zt("pointHex",I)));return M.assertValidity(),M}static fromPrivateKey(I){return d.BASE.multiply(l(I))}static msm(I,M){return QT(d,i,I,M)}_setWindowSize(I){x.setWindowSize(this,I)}assertValidity(){p(this)}hasEvenY(){let{y:I}=this.toAffine();if(e.isOdd)return!e.isOdd(I);throw new Error("Field doesn't support isOdd")}equals(I){c(I);let{px:M,py:H,pz:V}=this,{px:q,py:X,pz:Z}=I,Q=e.eql(e.mul(M,Z),e.mul(q,V)),ee=e.eql(e.mul(H,Z),e.mul(X,V));return Q&&ee}negate(){return new d(this.px,e.neg(this.py),this.pz)}double(){let{a:I,b:M}=t,H=e.mul(M,gp),{px:V,py:q,pz:X}=this,Z=e.ZERO,Q=e.ZERO,ee=e.ZERO,ae=e.mul(V,V),Be=e.mul(q,q),we=e.mul(X,X),$=e.mul(V,q);return $=e.add($,$),ee=e.mul(V,X),ee=e.add(ee,ee),Z=e.mul(I,ee),Q=e.mul(H,we),Q=e.add(Z,Q),Z=e.sub(Be,Q),Q=e.add(Be,Q),Q=e.mul(Z,Q),Z=e.mul($,Z),ee=e.mul(H,ee),we=e.mul(I,we),$=e.sub(ae,we),$=e.mul(I,$),$=e.add($,ee),ee=e.add(ae,ae),ae=e.add(ee,ae),ae=e.add(ae,we),ae=e.mul(ae,$),Q=e.add(Q,ae),we=e.mul(q,X),we=e.add(we,we),ae=e.mul(we,$),Z=e.sub(Z,ae),ee=e.mul(we,Be),ee=e.add(ee,ee),ee=e.add(ee,ee),new d(Z,Q,ee)}add(I){c(I);let{px:M,py:H,pz:V}=this,{px:q,py:X,pz:Z}=I,Q=e.ZERO,ee=e.ZERO,ae=e.ZERO,Be=t.a,we=e.mul(t.b,gp),$=e.mul(M,q),Oe=e.mul(H,X),ce=e.mul(V,Z),ve=e.add(M,H),Te=e.add(q,X);ve=e.mul(ve,Te),Te=e.add($,Oe),ve=e.sub(ve,Te),Te=e.add(M,V);let N=e.add(q,Z);return Te=e.mul(Te,N),N=e.add($,ce),Te=e.sub(Te,N),N=e.add(H,V),Q=e.add(X,Z),N=e.mul(N,Q),Q=e.add(Oe,ce),N=e.sub(N,Q),ae=e.mul(Be,Te),Q=e.mul(we,ce),ae=e.add(Q,ae),Q=e.sub(Oe,ae),ae=e.add(Oe,ae),ee=e.mul(Q,ae),Oe=e.add($,$),Oe=e.add(Oe,$),ce=e.mul(Be,ce),Te=e.mul(we,Te),Oe=e.add(Oe,ce),ce=e.sub($,ce),ce=e.mul(Be,ce),Te=e.add(Te,ce),$=e.mul(Oe,Te),ee=e.add(ee,$),$=e.mul(N,Te),Q=e.mul(ve,Q),Q=e.sub(Q,$),$=e.mul(ve,Oe),ae=e.mul(N,ae),ae=e.add(ae,$),new d(Q,ee,ae)}subtract(I){return this.add(I.negate())}is0(){return this.equals(d.ZERO)}wNAF(I){return x.wNAFCached(this,I,d.normalizeZ)}multiplyUnsafe(I){wa("scalar",I,oa,t.n);let M=d.ZERO;if(I===oa)return M;if(I===yt)return this;let{endo:H}=t;if(!H)return x.unsafeLadder(this,I);let{k1neg:V,k1:q,k2neg:X,k2:Z}=H.splitScalar(I),Q=M,ee=M,ae=this;for(;q>oa||Z>oa;)q&yt&&(Q=Q.add(ae)),Z&yt&&(ee=ee.add(ae)),ae=ae.double(),q>>=yt,Z>>=yt;return V&&(Q=Q.negate()),X&&(ee=ee.negate()),ee=new d(e.mul(ee.px,H.beta),ee.py,ee.pz),Q.add(ee)}multiply(I){let{endo:M,n:H}=t;wa("scalar",I,yt,H);let V,q;if(M){let{k1neg:X,k1:Z,k2neg:Q,k2:ee}=M.splitScalar(I),{p:ae,f:Be}=this.wNAF(Z),{p:we,f:$}=this.wNAF(ee);ae=x.constTimeNegate(X,ae),we=x.constTimeNegate(Q,we),we=new d(e.mul(we.px,M.beta),we.py,we.pz),V=ae.add(we),q=Be.add($)}else{let{p:X,f:Z}=this.wNAF(I);V=X,q=Z}return d.normalizeZ([V,q])[0]}multiplyAndAddUnsafe(I,M,H){let V=d.BASE,q=(Z,Q)=>Q===oa||Q===yt||!Z.equals(V)?Z.multiplyUnsafe(Q):Z.multiply(Q),X=q(this,M).add(q(I,H));return X.is0()?void 0:X}toAffine(I){return u(this,I)}isTorsionFree(){let{h:I,isTorsionFree:M}=t;if(I===yt)return!0;if(M)return M(d,this);throw new Error("isTorsionFree() has not been declared for the elliptic curve")}clearCofactor(){let{h:I,clearCofactor:M}=t;return I===yt?this:M?M(d,this):this.multiplyUnsafe(t.h)}toRawBytes(I=!0){return br("isCompressed",I),this.assertValidity(),a(d,this,I)}toHex(I=!0){return br("isCompressed",I),gr(this.toRawBytes(I))}}d.BASE=new d(t.Gx,t.Gy,e.ONE),d.ZERO=new d(e.ZERO,e.ONE,e.ZERO);let L=t.nBitLength,x=XT(d,t.endo?Math.ceil(L/2):L);return{CURVE:t,ProjectivePoint:d,normPrivateKeyToScalar:l,weierstrassEquation:s,isWithinCurveOrder:o}}function ik(n){let t=uI(n);return Ta(t,{hash:"hash",hmac:"function",randomBytes:"function"},{bits2int:"function",bits2int_modN:"function",lowS:"boolean"}),Object.freeze({lowS:!0,...t})}function tC(n){let t=ik(n),{Fp:e,n:i}=t,a=e.BYTES+1,r=2*e.BYTES+1;function s(ce){return Pt(ce,i)}function o(ce){return fp(ce,i)}let{ProjectivePoint:l,normPrivateKeyToScalar:c,weierstrassEquation:u,isWithinCurveOrder:p}=tk({...t,toBytes(ce,ve,Te){let N=ve.toAffine(),We=e.toBytes(N.x),Ze=ui;return br("isCompressed",Te),Te?Ze(Uint8Array.from([ve.hasEvenY()?2:3]),We):Ze(Uint8Array.from([4]),We,e.toBytes(N.y))},fromBytes(ce){let ve=ce.length,Te=ce[0],N=ce.subarray(1);if(ve===a&&(Te===2||Te===3)){let We=Ii(N);if(!Bn(We,yt,e.ORDER))throw new Error("Point is not on curve");let Ze=u(We),Qt;try{Qt=e.sqrt(Ze)}catch(Jt){let St=Jt instanceof Error?": "+Jt.message:"";throw new Error("Point is not on curve"+St)}let ai=(Qt&yt)===yt;return(Te&1)===1!==ai&&(Qt=e.neg(Qt)),{x:We,y:Qt}}else if(ve===r&&Te===4){let We=e.fromBytes(N.subarray(0,e.BYTES)),Ze=e.fromBytes(N.subarray(e.BYTES,2*e.BYTES));return{x:We,y:Ze}}else throw new Error(`Point of length ${ve} was invalid. Expected ${a} compressed bytes or ${r} uncompressed bytes`)}}),d=ce=>gr(sa(ce,t.nByteLength));function L(ce){let ve=i>>yt;return ce>ve}function x(ce){return L(ce)?s(-ce):ce}let w=(ce,ve,Te)=>Ii(ce.slice(ve,Te));class I{constructor(ve,Te,N){this.r=ve,this.s=Te,this.recovery=N,this.assertValidity()}static fromCompact(ve){let Te=t.nByteLength;return ve=zt("compactSignature",ve,Te*2),new I(w(ve,0,Te),w(ve,Te,2*Te))}static fromDER(ve){let{r:Te,s:N}=en.toSig(zt("DER",ve));return new I(Te,N)}assertValidity(){wa("r",this.r,yt,i),wa("s",this.s,yt,i)}addRecoveryBit(ve){return new I(this.r,this.s,ve)}recoverPublicKey(ve){let{r:Te,s:N,recovery:We}=this,Ze=Z(zt("msgHash",ve));if(We==null||![0,1,2,3].includes(We))throw new Error("recovery id invalid");let Qt=We===2||We===3?Te+t.n:Te;if(Qt>=e.ORDER)throw new Error("recovery id 2 or 3 invalid");let ai=We&1?"03":"02",Ft=l.fromHex(ai+d(Qt)),Jt=o(Qt),St=s(-Ze*Jt),nr=s(N*Jt),da=l.BASE.multiplyAndAddUnsafe(Ft,St,nr);if(!da)throw new Error("point at infinify");return da.assertValidity(),da}hasHighS(){return L(this.s)}normalizeS(){return this.hasHighS()?new I(this.r,s(-this.s),this.recovery):this}toDERRawBytes(){return _r(this.toDERHex())}toDERHex(){return en.hexFromSig({r:this.r,s:this.s})}toCompactRawBytes(){return _r(this.toCompactHex())}toCompactHex(){return d(this.r)+d(this.s)}}let M={isValidPrivateKey(ce){try{return c(ce),!0}catch{return!1}},normPrivateKeyToScalar:c,randomPrivateKey:()=>{let ce=oI(t.n);return jT(t.randomBytes(ce),t.n)},precompute(ce=8,ve=l.BASE){return ve._setWindowSize(ce),ve.multiply(BigInt(3)),ve}};function H(ce,ve=!0){return l.fromPrivateKey(ce).toRawBytes(ve)}function V(ce){let ve=kn(ce),Te=typeof ce=="string",N=(ve||Te)&&ce.length;return ve?N===a||N===r:Te?N===2*a||N===2*r:ce instanceof l}function q(ce,ve,Te=!0){if(V(ce))throw new Error("first arg must be private key");if(!V(ve))throw new Error("second arg must be public key");return l.fromHex(ve).multiply(c(ce)).toRawBytes(Te)}let X=t.bits2int||function(ce){let ve=Ii(ce),Te=ce.length*8-t.nBitLength;return Te>0?ve>>BigInt(Te):ve},Z=t.bits2int_modN||function(ce){return s(X(ce))},Q=$o(t.nBitLength);function ee(ce){return wa(`num < 2^${t.nBitLength}`,ce,oa,Q),sa(ce,t.nByteLength)}function ae(ce,ve,Te=Be){if(["recovered","canonical"].some(Va=>Va in Te))throw new Error("sign() legacy options not supported");let{hash:N,randomBytes:We}=t,{lowS:Ze,prehash:Qt,extraEntropy:ai}=Te;Ze==null&&(Ze=!0),ce=zt("msgHash",ce),ZT(Te),Qt&&(ce=zt("prehashed msgHash",N(ce)));let Ft=Z(ce),Jt=c(ve),St=[ee(Jt),ee(Ft)];if(ai!=null&&ai!==!1){let Va=ai===!0?We(e.BYTES):ai;St.push(zt("extraEntropy",Va))}let nr=ui(...St),da=Ft;function Ua(Va){let yn=X(Va);if(!p(yn))return;let $c=o(yn),Ci=l.BASE.multiply(yn).toAffine(),Fa=s(Ci.x);if(Fa===oa)return;let Gr=s($c*s(da+Fa*Jt));if(Gr===oa)return;let Xc=(Ci.x===Fa?0:2)|Number(Ci.y&yt),Qc=Gr;return Ze&&L(Gr)&&(Qc=x(Gr),Xc^=1),new I(Fa,Qc,Xc)}return{seed:nr,k2sig:Ua}}let Be={lowS:t.lowS,prehash:!1},we={lowS:t.lowS,prehash:!1};function $(ce,ve,Te=Be){let{seed:N,k2sig:We}=ae(ce,ve,Te),Ze=t;return aI(Ze.hash.outputLen,Ze.nByteLength,Ze.hmac)(N,We)}l.BASE._setWindowSize(8);function Oe(ce,ve,Te,N=we){let We=ce;if(ve=zt("msgHash",ve),Te=zt("publicKey",Te),"strict"in N)throw new Error("options.strict was renamed to lowS");ZT(N);let{lowS:Ze,prehash:Qt}=N,ai,Ft;try{if(typeof We=="string"||kn(We))try{ai=I.fromDER(We)}catch(Ci){if(!(Ci instanceof en.Err))throw Ci;ai=I.fromCompact(We)}else if(typeof We=="object"&&typeof We.r=="bigint"&&typeof We.s=="bigint"){let{r:Ci,s:Fa}=We;ai=new I(Ci,Fa)}else throw new Error("PARSE");Ft=l.fromHex(Te)}catch(Ci){if(Ci.message==="PARSE")throw new Error("signature must be Signature instance, Uint8Array or hex string");return!1}if(Ze&&ai.hasHighS())return!1;Qt&&(ve=t.hash(ve));let{r:Jt,s:St}=ai,nr=Z(ve),da=o(St),Ua=s(nr*da),Va=s(Jt*da),yn=l.BASE.multiplyAndAddUnsafe(Ft,Ua,Va)?.toAffine();return yn?s(yn.x)===Jt:!1}return{CURVE:t,getPublicKey:H,getSharedSecret:q,sign:$,verify:Oe,ProjectivePoint:l,Signature:I,utils:M}}function ak(n,t){let e=n.ORDER,i=oa;for(let x=e-yt;x%Mn===oa;x/=Mn)i+=yt;let a=i,r=Mn<<a-yt-yt,s=r*Mn,o=(e-yt)/s,l=(o-yt)/Mn,c=s-yt,u=r,p=n.pow(t,o),d=n.pow(t,(o+yt)/Mn),L=(x,w)=>{let I=p,M=n.pow(w,c),H=n.sqr(M);H=n.mul(H,w);let V=n.mul(x,H);V=n.pow(V,l),V=n.mul(V,M),M=n.mul(V,w),H=n.mul(V,x);let q=n.mul(H,M);V=n.pow(q,u);let X=n.eql(V,n.ONE);M=n.mul(H,d),V=n.mul(q,I),H=n.cmov(M,H,X),q=n.cmov(V,q,X);for(let Z=a;Z>yt;Z--){let Q=Z-Mn;Q=Mn<<Q-yt;let ee=n.pow(q,Q),ae=n.eql(ee,n.ONE);M=n.mul(H,I),I=n.mul(I,I),ee=n.mul(q,I),H=n.cmov(M,H,ae),q=n.cmov(ee,q,ae)}return{isValid:X,value:H}};if(n.ORDER%eC===gp){let x=(n.ORDER-gp)/eC,w=n.sqrt(n.neg(t));L=(I,M)=>{let H=n.sqr(M),V=n.mul(I,M);H=n.mul(H,V);let q=n.pow(H,x);q=n.mul(q,V);let X=n.mul(q,w),Z=n.mul(n.sqr(q),M),Q=n.eql(Z,I),ee=n.cmov(X,q,Q);return{isValid:Q,value:ee}}}return L}function iC(n,t){if(yp(n),!n.isValid(t.A)||!n.isValid(t.B)||!n.isValid(t.Z))throw new Error("mapToCurveSimpleSWU: invalid opts");let e=ak(n,t.Z);if(!n.isOdd)throw new Error("Fp.isOdd is not implemented!");return i=>{let a,r,s,o,l,c,u,p;a=n.sqr(i),a=n.mul(a,t.Z),r=n.sqr(a),r=n.add(r,a),s=n.add(r,n.ONE),s=n.mul(s,t.B),o=n.cmov(t.Z,n.neg(r),!n.eql(r,n.ZERO)),o=n.mul(o,t.A),r=n.sqr(s),c=n.sqr(o),l=n.mul(c,t.A),r=n.add(r,l),r=n.mul(r,s),c=n.mul(c,o),l=n.mul(c,t.B),r=n.add(r,l),u=n.mul(a,s);let{isValid:d,value:L}=e(r,c);p=n.mul(a,i),p=n.mul(p,L),u=n.cmov(u,s,d),p=n.cmov(p,L,d);let x=n.isOdd(i)===n.isOdd(p);return p=n.cmov(n.neg(p),p,x),u=n.div(u,o),{x:u,y:p}}}var ZA,ek,en,oa,yt,Mn,gp,eC,mI=re(()=>{"use strict";JT();Xo();vr();vr();({bytesToNumberBE:ZA,hexToBytes:ek}=nI),en={Err:class extends Error{constructor(t=""){super(t)}},_tlv:{encode:(n,t)=>{let{Err:e}=en;if(n<0||n>256)throw new e("tlv.encode: wrong tag");if(t.length&1)throw new e("tlv.encode: unpadded data");let i=t.length/2,a=Lr(i);if(a.length/2&128)throw new e("tlv.encode: long form length too big");let r=i>127?Lr(a.length/2|128):"";return`${Lr(n)}${r}${a}${t}`},decode(n,t){let{Err:e}=en,i=0;if(n<0||n>256)throw new e("tlv.encode: wrong tag");if(t.length<2||t[i++]!==n)throw new e("tlv.decode: wrong tlv");let a=t[i++],r=!!(a&128),s=0;if(!r)s=a;else{let l=a&127;if(!l)throw new e("tlv.decode(long): indefinite length not supported");if(l>4)throw new e("tlv.decode(long): byte length is too big");let c=t.subarray(i,i+l);if(c.length!==l)throw new e("tlv.decode: length bytes not complete");if(c[0]===0)throw new e("tlv.decode(long): zero leftmost byte");for(let u of c)s=s<<8|u;if(i+=l,s<128)throw new e("tlv.decode(long): not minimal encoding")}let o=t.subarray(i,i+s);if(o.length!==s)throw new e("tlv.decode: wrong value length");return{v:o,l:t.subarray(i+s)}}},_int:{encode(n){let{Err:t}=en;if(n<oa)throw new t("integer: negative integers are not allowed");let e=Lr(n);if(Number.parseInt(e[0],16)&8&&(e="00"+e),e.length&1)throw new t("unexpected assertion");return e},decode(n){let{Err:t}=en;if(n[0]&128)throw new t("Invalid signature integer: negative");if(n[0]===0&&!(n[1]&128))throw new t("Invalid signature integer: unnecessary leading zero");return ZA(n)}},toSig(n){let{Err:t,_int:e,_tlv:i}=en,a=typeof n=="string"?ek(n):n;Oi(a);let{v:r,l:s}=i.decode(48,a);if(s.length)throw new t("Invalid signature: left bytes after parsing");let{v:o,l}=i.decode(2,r),{v:c,l:u}=i.decode(2,l);if(u.length)throw new t("Invalid signature: left bytes after parsing");return{r:e.decode(o),s:e.decode(c)}},hexFromSig(n){let{_tlv:t,_int:e}=en,i=`${t.encode(2,e.encode(n.r))}${t.encode(2,e.encode(n.s))}`;return t.encode(48,i)}},oa=BigInt(0),yt=BigInt(1),Mn=BigInt(2),gp=BigInt(3),eC=BigInt(4)});function nk(n){return{hash:n,hmac:(t,...e)=>Q0(n,t,iT(...e)),randomBytes:Nm}}function aC(n,t){let e=i=>tC({...n,...nk(i)});return Object.freeze({...e(t),create:e})}var nC=re(()=>{"use strict";GT();or();mI();});function Rn(n,t){if(Qo(n),Qo(t),n<0||n>=1<<8*t)throw new Error(`bad I2OSP call: value=${n} length=${t}`);let e=Array.from({length:t}).fill(0);for(let i=t-1;i>=0;i--)e[i]=n&255,n>>>=8;return new Uint8Array(e)}function sk(n,t){let e=new Uint8Array(n.length);for(let i=0;i<n.length;i++)e[i]=n[i]^t[i];return e}function Qo(n){if(!Number.isSafeInteger(n))throw new Error("number expected")}function ok(n,t,e,i){Oi(n),Oi(t),Qo(e),t.length>255&&(t=i(ui(jo("H2C-OVERSIZE-DST-"),t)));let{outputLen:a,blockLen:r}=i,s=Math.ceil(e/a);if(e>65535||s>255)throw new Error("expand_message_xmd: invalid lenInBytes");let o=ui(t,Rn(t.length,1)),l=Rn(0,r),c=Rn(e,2),u=new Array(s),p=i(ui(l,n,c,Rn(0,1),o));u[0]=i(ui(p,Rn(1,1),o));for(let L=1;L<=s;L++){let x=[sk(p,u[L-1]),Rn(L+1,1),o];u[L]=i(ui(...x))}return ui(...u).slice(0,e)}function lk(n,t,e,i,a){if(Oi(n),Oi(t),Qo(e),t.length>255){let r=Math.ceil(2*i/8);t=a.create({dkLen:r}).update(jo("H2C-OVERSIZE-DST-")).update(t).digest()}if(e>65535||t.length>255)throw new Error("expand_message_xof: invalid lenInBytes");return a.create({dkLen:e}).update(n).update(Rn(e,2)).update(t).update(Rn(t.length,1)).digest()}function rC(n,t,e){Ta(e,{DST:"stringOrUint8Array",p:"bigint",m:"isSafeInteger",k:"isSafeInteger",hash:"hash"});let{p:i,k:a,m:r,hash:s,expand:o,DST:l}=e;Oi(n),Qo(t);let c=typeof l=="string"?jo(l):l,u=i.toString(2).length,p=Math.ceil((u+a)/8),d=t*r*p,L;if(o==="xmd")L=ok(n,c,d,s);else if(o==="xof")L=lk(n,c,d,a,s);else if(o==="_internal_pass")L=n;else throw new Error('expand must be "xmd" or "xof"');let x=new Array(t);for(let w=0;w<t;w++){let I=new Array(r);for(let M=0;M<r;M++){let H=p*(M+w*r),V=L.subarray(H,H+p);I[M]=Pt(rk(V),i)}x[w]=I}return x}function sC(n,t){let e=t.map(i=>Array.from(i).reverse());return(i,a)=>{let[r,s,o,l]=e.map(c=>c.reduce((u,p)=>n.add(n.mul(u,i),p)));return i=n.div(r,s),a=n.mul(a,n.div(o,l)),{x:i,y:a}}}function oC(n,t,e){if(typeof t!="function")throw new Error("mapToCurve() must be defined");return{hashToCurve(i,a){let r=rC(i,2,{...e,DST:e.DST,...a}),s=n.fromAffine(t(r[0])),o=n.fromAffine(t(r[1])),l=s.add(o).clearCofactor();return l.assertValidity(),l},encodeToCurve(i,a){let r=rC(i,1,{...e,DST:e.encodeDST,...a}),s=n.fromAffine(t(r[0])).clearCofactor();return s.assertValidity(),s},mapToCurve(i){if(!Array.isArray(i))throw new Error("mapToCurve: expected array of bigints");for(let r of i)if(typeof r!="bigint")throw new Error(`mapToCurve: expected array of bigints, got ${r} in array`);let a=n.fromAffine(t(i)).clearCofactor();return a.assertValidity(),a}}}var rk,lC=re(()=>{"use strict";Xo();vr();rk=Ii});var bC={};L0(bC,{encodeToCurve:()=>yk,hashToCurve:()=>fk,schnorr:()=>pk,secp256k1:()=>tn});function mC(n){let t=el,e=BigInt(3),i=BigInt(6),a=BigInt(11),r=BigInt(22),s=BigInt(23),o=BigInt(44),l=BigInt(88),c=n*n*n%t,u=c*c*n%t,p=Ai(u,e,t)*u%t,d=Ai(p,e,t)*u%t,L=Ai(d,_p,t)*c%t,x=Ai(L,a,t)*L%t,w=Ai(x,r,t)*x%t,I=Ai(w,o,t)*w%t,M=Ai(I,l,t)*I%t,H=Ai(M,o,t)*w%t,V=Ai(H,e,t)*u%t,q=Ai(V,s,t)*x%t,X=Ai(q,i,t)*c%t,Z=Ai(X,_p,t);if(!Pn.eql(Pn.sqr(Z),n))throw new Error("Cannot find square root");return Z}function vp(n,...t){let e=uC[n];if(e===void 0){let i=yr(Uint8Array.from(n,a=>a.charCodeAt(0)));e=ui(i,i),uC[n]=e}return yr(ui(e,...t))}function dI(n){let t=tn.utils.normPrivateKeyToScalar(n),e=yI.fromPrivateKey(t);return{scalar:e.hasEvenY()?t:Zo(-t),bytes:fI(e)}}function hC(n){wa("x",n,Jo,el);let t=pI(n*n),e=pI(t*n+BigInt(7)),i=mC(e);i%_p!==pC&&(i=pI(-i));let a=new yI(n,i,Jo);return a.assertValidity(),a}function dC(...n){return Zo(ws(vp("BIP0340/challenge",...n)))}function uk(n){return dI(n).bytes}function mk(n,t,e=Nm(32)){let i=zt("message",n),{bytes:a,scalar:r}=dI(t),s=zt("auxRand",e,32),o=hI(r^ws(vp("BIP0340/aux",s))),l=vp("BIP0340/nonce",o,a,i),c=Zo(ws(l));if(c===pC)throw new Error("sign failed: k is zero");let{bytes:u,scalar:p}=dI(c),d=dC(u,a,i),L=new Uint8Array(64);if(L.set(u,0),L.set(hI(Zo(p+d*r)),32),!fC(L,i,a))throw new Error("sign: Invalid signature produced");return L}function fC(n,t,e){let i=zt("signature",n,64),a=zt("message",t),r=zt("publicKey",e,32);try{let s=hC(ws(r)),o=ws(i.subarray(0,32));if(!Bn(o,Jo,el))return!1;let l=ws(i.subarray(32,64));if(!Bn(l,Jo,Lp))return!1;let c=dC(hI(o),fI(s),a),u=ck(s,l,Zo(-c));return!(!u||!u.hasEvenY()||u.toAffine().x!==o)}catch{return!1}}var el,Lp,Jo,_p,cC,Pn,tn,pC,uC,fI,hI,pI,Zo,yI,ck,ws,pk,hk,dk,yC,fk,yk,xp=re(()=>{"use strict";X0();or();nC();lC();Xo();vr();mI();el=BigInt("0xfffffffffffffffffffffffffffffffffffffffffffffffffffffffefffffc2f"),Lp=BigInt("0xfffffffffffffffffffffffffffffffebaaedce6af48a03bbfd25e8cd0364141"),Jo=BigInt(1),_p=BigInt(2),cC=(n,t)=>(n+t/_p)/t;Pn=bp(el,void 0,void 0,{sqrt:mC}),tn=aC({a:BigInt(0),b:BigInt(7),Fp:Pn,n:Lp,Gx:BigInt("55066263022277343669578718895168534326250603453777594175500187360389116729240"),Gy:BigInt("32670510020758816978083085130507043184471273380659243275938904335757337482424"),h:BigInt(1),lowS:!0,endo:{beta:BigInt("0x7ae96a2b657c07106e64479eac3434e99cf0497512f58995c1396c28719501ee"),splitScalar:n=>{let t=Lp,e=BigInt("0x3086d221a7d46bcde86c90e49284eb15"),i=-Jo*BigInt("0xe4437ed6010e88286f547fa90abfe4c3"),a=BigInt("0x114ca50f7a8e2f3f657c1108d9d44cfd8"),r=e,s=BigInt("0x100000000000000000000000000000000"),o=cC(r*n,t),l=cC(-i*n,t),c=Pt(n-o*e-l*a,t),u=Pt(-o*i-l*r,t),p=c>s,d=u>s;if(p&&(c=t-c),d&&(u=t-u),c>s||u>s)throw new Error("splitScalar: Endomorphism failed, k="+n);return{k1neg:p,k1:c,k2neg:d,k2:u}}}},yr),pC=BigInt(0),uC={};fI=n=>n.toRawBytes(!0).slice(1),hI=n=>sa(n,32),pI=n=>Pt(n,el),Zo=n=>Pt(n,Lp),yI=tn.ProjectivePoint,ck=(n,t,e)=>yI.BASE.multiplyAndAddUnsafe(n,t,e);ws=Ii;pk=(()=>({getPublicKey:uk,sign:mk,verify:fC,utils:{randomPrivateKey:tn.utils.randomPrivateKey,lift_x:hC,pointToBytes:fI,numberToBytesBE:sa,bytesToNumberBE:Ii,taggedHash:vp,mod:Pt}}))(),hk=(()=>sC(Pn,[["0x8e38e38e38e38e38e38e38e38e38e38e38e38e38e38e38e38e38e38daaaaa8c7","0x7d3d4c80bc321d5b9f315cea7fd44c5d595d2fc0bf63b92dfff1044f17c6581","0x534c328d23f234e6e2a413deca25caece4506144037c40314ecbd0b53d9dd262","0x8e38e38e38e38e38e38e38e38e38e38e38e38e38e38e38e38e38e38daaaaa88c"],["0xd35771193d94918a9ca34ccbb7b640dd86cd409542f8487d9fe6b745781eb49b","0xedadc6f64383dc1df7c4b2d51b54225406d36b641f5e41bbc52a56612a8c6d14","0x0000000000000000000000000000000000000000000000000000000000000001"],["0x4bda12f684bda12f684bda12f684bda12f684bda12f684bda12f684b8e38e23c","0xc75e0c32d5cb7c0fa9d0a54b12a0a6d5647ab046d686da6fdffc90fc201d71a3","0x29a6194691f91a73715209ef6512e576722830a201be2018a765e85a9ecee931","0x2f684bda12f684bda12f684bda12f684bda12f684bda12f684bda12f38e38d84"],["0xfffffffffffffffffffffffffffffffffffffffffffffffffffffffefffff93b","0x7a06534bb8bdb49fd5e9e6632722c2989467c1bfc8e8d978dfb425d2685c2573","0x6484aa716545ca2cf3a70c3fa8fe337e0a3d21162f0d6299a7bf8192bfd2a76f","0x0000000000000000000000000000000000000000000000000000000000000001"]].map(n=>n.map(t=>BigInt(t)))))(),dk=(()=>iC(Pn,{A:BigInt("0x3f8731abdd661adca08a5558f0f5d272e953d363cb6f0e5d405447c01a444533"),B:BigInt("1771"),Z:Pn.create(BigInt("-11"))}))(),yC=(()=>oC(tn.ProjectivePoint,n=>{let{x:t,y:e}=dk(Pn.create(n[0]));return hk(t,e)},{DST:"secp256k1_XMD:SHA-256_SSWU_RO_",encodeDST:"secp256k1_XMD:SHA-256_SSWU_NU_",p:Pn.ORDER,m:1,k:128,expand:"xmd",hash:yr}))(),fk=(()=>yC.hashToCurve)(),yk=(()=>yC.encodeToCurve)()});var an,Hi,Ts,Cs,Ss,Ds,As,ks,Bs,Ms,Ca,Sa,Ir=re(()=>{"use strict";ss();$e();an=class extends K{constructor({cause:t,message:e}={}){let i=e?.replace("execution reverted: ","")?.replace("execution reverted","");super(`Execution reverted ${i?`with reason: ${i}`:"for an unknown reason"}.`,{cause:t,name:"ExecutionRevertedError"})}};Object.defineProperty(an,"code",{enumerable:!0,configurable:!0,writable:!0,value:3});Object.defineProperty(an,"nodeMessage",{enumerable:!0,configurable:!0,writable:!0,value:/execution reverted/});Hi=class extends K{constructor({cause:t,maxFeePerGas:e}={}){super(`The fee cap (\`maxFeePerGas\`${e?` = ${Yt(e)} gwei`:""}) cannot be higher than the maximum allowed value (2^256-1).`,{cause:t,name:"FeeCapTooHighError"})}};Object.defineProperty(Hi,"nodeMessage",{enumerable:!0,configurable:!0,writable:!0,value:/max fee per gas higher than 2\^256-1|fee cap higher than 2\^256-1/});Ts=class extends K{constructor({cause:t,maxFeePerGas:e}={}){super(`The fee cap (\`maxFeePerGas\`${e?` = ${Yt(e)}`:""} gwei) cannot be lower than the block base fee.`,{cause:t,name:"FeeCapTooLowError"})}};Object.defineProperty(Ts,"nodeMessage",{enumerable:!0,configurable:!0,writable:!0,value:/max fee per gas less than block base fee|fee cap less than block base fee|transaction is outdated/});Cs=class extends K{constructor({cause:t,nonce:e}={}){super(`Nonce provided for the transaction ${e?`(${e}) `:""}is higher than the next one expected.`,{cause:t,name:"NonceTooHighError"})}};Object.defineProperty(Cs,"nodeMessage",{enumerable:!0,configurable:!0,writable:!0,value:/nonce too high/});Ss=class extends K{constructor({cause:t,nonce:e}={}){super([`Nonce provided for the transaction ${e?`(${e}) `:""}is lower than the current nonce of the account.`,"Try increasing the nonce or find the latest nonce with `getTransactionCount`."].join(`
`),{cause:t,name:"NonceTooLowError"})}};Object.defineProperty(Ss,"nodeMessage",{enumerable:!0,configurable:!0,writable:!0,value:/nonce too low|transaction already imported|already known/});Ds=class extends K{constructor({cause:t,nonce:e}={}){super(`Nonce provided for the transaction ${e?`(${e}) `:""}exceeds the maximum allowed nonce.`,{cause:t,name:"NonceMaxValueError"})}};Object.defineProperty(Ds,"nodeMessage",{enumerable:!0,configurable:!0,writable:!0,value:/nonce has max value/});As=class extends K{constructor({cause:t}={}){super(["The total cost (gas * gas fee + value) of executing this transaction exceeds the balance of the account."].join(`
`),{cause:t,metaMessages:["This error could arise when the account does not have enough funds to:"," - pay for the total gas fee,"," - pay for the value to send."," ","The cost of the transaction is calculated as `gas * gas fee + value`, where:"," - `gas` is the amount of gas needed for transaction to execute,"," - `gas fee` is the gas fee,"," - `value` is the amount of ether to send to the recipient."],name:"InsufficientFundsError"})}};Object.defineProperty(As,"nodeMessage",{enumerable:!0,configurable:!0,writable:!0,value:/insufficient funds|exceeds transaction sender account balance/});ks=class extends K{constructor({cause:t,gas:e}={}){super(`The amount of gas ${e?`(${e}) `:""}provided for the transaction exceeds the limit allowed for the block.`,{cause:t,name:"IntrinsicGasTooHighError"})}};Object.defineProperty(ks,"nodeMessage",{enumerable:!0,configurable:!0,writable:!0,value:/intrinsic gas too high|gas limit reached/});Bs=class extends K{constructor({cause:t,gas:e}={}){super(`The amount of gas ${e?`(${e}) `:""}provided for the transaction is too low.`,{cause:t,name:"IntrinsicGasTooLowError"})}};Object.defineProperty(Bs,"nodeMessage",{enumerable:!0,configurable:!0,writable:!0,value:/intrinsic gas too low/});Ms=class extends K{constructor({cause:t}){super("The transaction type is not supported for this chain.",{cause:t,name:"TransactionTypeNotSupportedError"})}};Object.defineProperty(Ms,"nodeMessage",{enumerable:!0,configurable:!0,writable:!0,value:/transaction type not valid/});Ca=class extends K{constructor({cause:t,maxPriorityFeePerGas:e,maxFeePerGas:i}={}){super([`The provided tip (\`maxPriorityFeePerGas\`${e?` = ${Yt(e)} gwei`:""}) cannot be higher than the fee cap (\`maxFeePerGas\`${i?` = ${Yt(i)} gwei`:""}).`].join(`
`),{cause:t,name:"TipAboveFeeCapError"})}};Object.defineProperty(Ca,"nodeMessage",{enumerable:!0,configurable:!0,writable:!0,value:/max priority fee per gas higher than max fee per gas|tip higher than fee cap/});Sa=class extends K{constructor({cause:t}){super(`An error occurred while executing: ${t?.shortMessage}`,{cause:t,name:"UnknownNodeError"})}}});function Rs(n,t){let e=(n.details||"").toLowerCase(),i=n instanceof K?n.walk(a=>a?.code===an.code):n;return i instanceof K?new an({cause:n,message:i.details}):an.nodeMessage.test(e)?new an({cause:n,message:n.details}):Hi.nodeMessage.test(e)?new Hi({cause:n,maxFeePerGas:t?.maxFeePerGas}):Ts.nodeMessage.test(e)?new Ts({cause:n,maxFeePerGas:t?.maxFeePerGas}):Cs.nodeMessage.test(e)?new Cs({cause:n,nonce:t?.nonce}):Ss.nodeMessage.test(e)?new Ss({cause:n,nonce:t?.nonce}):Ds.nodeMessage.test(e)?new Ds({cause:n,nonce:t?.nonce}):As.nodeMessage.test(e)?new As({cause:n}):ks.nodeMessage.test(e)?new ks({cause:n,gas:t?.gas}):Bs.nodeMessage.test(e)?new Bs({cause:n,gas:t?.gas}):Ms.nodeMessage.test(e)?new Ms({cause:n}):Ca.nodeMessage.test(e)?new Ca({cause:n,maxFeePerGas:t?.maxFeePerGas,maxPriorityFeePerGas:t?.maxPriorityFeePerGas}):new Sa({cause:n})}var Tp=re(()=>{"use strict";$e();Ir()});function Ps(n,{format:t}){if(!t)return{};let e={};function i(r){let s=Object.keys(r);for(let o of s)o in n&&(e[o]=n[o]),r[o]&&typeof r[o]=="object"&&!Array.isArray(r[o])&&i(r[o])}let a=t(n||{});return i(a),e}var Cp=re(()=>{"use strict"});function Ns(n,t){return({exclude:e,format:i})=>({exclude:e,format:a=>{let r=t(a);if(e)for(let s of e)delete r[s];return{...r,...i(a)}},type:n})}var Sp=re(()=>{"use strict"});function Nn(n){let t={};return typeof n.authorizationList<"u"&&(t.authorizationList=_k(n.authorizationList)),typeof n.accessList<"u"&&(t.accessList=n.accessList),typeof n.blobVersionedHashes<"u"&&(t.blobVersionedHashes=n.blobVersionedHashes),typeof n.blobs<"u"&&(typeof n.blobs[0]!="string"?t.blobs=n.blobs.map(e=>at(e)):t.blobs=n.blobs),typeof n.data<"u"&&(t.data=n.data),typeof n.from<"u"&&(t.from=n.from),typeof n.gas<"u"&&(t.gas=Ce(n.gas)),typeof n.gasPrice<"u"&&(t.gasPrice=Ce(n.gasPrice)),typeof n.maxFeePerBlobGas<"u"&&(t.maxFeePerBlobGas=Ce(n.maxFeePerBlobGas)),typeof n.maxFeePerGas<"u"&&(t.maxFeePerGas=Ce(n.maxFeePerGas)),typeof n.maxPriorityFeePerGas<"u"&&(t.maxPriorityFeePerGas=Ce(n.maxPriorityFeePerGas)),typeof n.nonce<"u"&&(t.nonce=Ce(n.nonce)),typeof n.to<"u"&&(t.to=n.to),typeof n.type<"u"&&(t.type=Lk[n.type]),typeof n.value<"u"&&(t.value=Ce(n.value)),t}function _k(n){return n.map(t=>({address:t.contractAddress,r:t.r,s:t.s,chainId:Ce(t.chainId),nonce:Ce(t.nonce),...typeof t.yParity<"u"?{yParity:Ce(t.yParity)}:{},...typeof t.v<"u"&&typeof t.yParity>"u"?{v:Ce(t.v)}:{}}))}var Lk,tl=re(()=>{"use strict";Fe();Lk={legacy:"0x0",eip2930:"0x1",eip1559:"0x2",eip4844:"0x3",eip7702:"0x4"}});function EC(n){if(!(!n||n.length===0))return n.reduce((t,{slot:e,value:i})=>{if(e.length!==66)throw new Po({size:e.length,targetSize:66,type:"hex"});if(i.length!==66)throw new Po({size:i.length,targetSize:66,type:"hex"});return t[e]=i,t},{})}function vk(n){let{balance:t,nonce:e,state:i,stateDiff:a,code:r}=n,s={};if(r!==void 0&&(s.code=r),t!==void 0&&(s.balance=Ce(t)),e!==void 0&&(s.nonce=Ce(e)),i!==void 0&&(s.state=EC(i)),a!==void 0){if(s.state)throw new ep;s.stateDiff=EC(a)}return s}function Dp(n){if(!n)return;let t={};for(let{address:e,...i}of n){if(!ft(e,{strict:!1}))throw new Lt({address:e});if(t[e])throw new Zm({address:e});t[e]=vk(i)}return t}var bI=re(()=>{"use strict";ga();Em();j0();aa();Fe()});var TG,CG,SG,DG,AG,kG,BG,MG,RG,PG,NG,OG,HG,UG,VG,FG,GG,KG,qG,WG,YG,zG,jG,$G,XG,QG,JG,ZG,e7,t7,i7,a7,n7,r7,s7,o7,l7,c7,u7,m7,p7,h7,d7,f7,y7,b7,g7,L7,_7,v7,x7,I7,E7,w7,T7,C7,S7,D7,A7,k7,B7,M7,R7,P7,N7,O7,H7,U7,V7,F7,G7,K7,q7,W7,Y7,z7,j7,$7,X7,Q7,J7,Z7,e9,t9,i9,a9,n9,r9,s9,o9,l9,c9,u9,m9,p9,Os,gI=re(()=>{"use strict";TG=2n**(8n-1n)-1n,CG=2n**(16n-1n)-1n,SG=2n**(24n-1n)-1n,DG=2n**(32n-1n)-1n,AG=2n**(40n-1n)-1n,kG=2n**(48n-1n)-1n,BG=2n**(56n-1n)-1n,MG=2n**(64n-1n)-1n,RG=2n**(72n-1n)-1n,PG=2n**(80n-1n)-1n,NG=2n**(88n-1n)-1n,OG=2n**(96n-1n)-1n,HG=2n**(104n-1n)-1n,UG=2n**(112n-1n)-1n,VG=2n**(120n-1n)-1n,FG=2n**(128n-1n)-1n,GG=2n**(136n-1n)-1n,KG=2n**(144n-1n)-1n,qG=2n**(152n-1n)-1n,WG=2n**(160n-1n)-1n,YG=2n**(168n-1n)-1n,zG=2n**(176n-1n)-1n,jG=2n**(184n-1n)-1n,$G=2n**(192n-1n)-1n,XG=2n**(200n-1n)-1n,QG=2n**(208n-1n)-1n,JG=2n**(216n-1n)-1n,ZG=2n**(224n-1n)-1n,e7=2n**(232n-1n)-1n,t7=2n**(240n-1n)-1n,i7=2n**(248n-1n)-1n,a7=2n**(256n-1n)-1n,n7=-(2n**(8n-1n)),r7=-(2n**(16n-1n)),s7=-(2n**(24n-1n)),o7=-(2n**(32n-1n)),l7=-(2n**(40n-1n)),c7=-(2n**(48n-1n)),u7=-(2n**(56n-1n)),m7=-(2n**(64n-1n)),p7=-(2n**(72n-1n)),h7=-(2n**(80n-1n)),d7=-(2n**(88n-1n)),f7=-(2n**(96n-1n)),y7=-(2n**(104n-1n)),b7=-(2n**(112n-1n)),g7=-(2n**(120n-1n)),L7=-(2n**(128n-1n)),_7=-(2n**(136n-1n)),v7=-(2n**(144n-1n)),x7=-(2n**(152n-1n)),I7=-(2n**(160n-1n)),E7=-(2n**(168n-1n)),w7=-(2n**(176n-1n)),T7=-(2n**(184n-1n)),C7=-(2n**(192n-1n)),S7=-(2n**(200n-1n)),D7=-(2n**(208n-1n)),A7=-(2n**(216n-1n)),k7=-(2n**(224n-1n)),B7=-(2n**(232n-1n)),M7=-(2n**(240n-1n)),R7=-(2n**(248n-1n)),P7=-(2n**(256n-1n)),N7=2n**8n-1n,O7=2n**16n-1n,H7=2n**24n-1n,U7=2n**32n-1n,V7=2n**40n-1n,F7=2n**48n-1n,G7=2n**56n-1n,K7=2n**64n-1n,q7=2n**72n-1n,W7=2n**80n-1n,Y7=2n**88n-1n,z7=2n**96n-1n,j7=2n**104n-1n,$7=2n**112n-1n,X7=2n**120n-1n,Q7=2n**128n-1n,J7=2n**136n-1n,Z7=2n**144n-1n,e9=2n**152n-1n,t9=2n**160n-1n,i9=2n**168n-1n,a9=2n**176n-1n,n9=2n**184n-1n,r9=2n**192n-1n,s9=2n**200n-1n,o9=2n**208n-1n,l9=2n**216n-1n,c9=2n**224n-1n,u9=2n**232n-1n,m9=2n**240n-1n,p9=2n**248n-1n,Os=2n**256n-1n});function Da(n){let{account:t,gasPrice:e,maxFeePerGas:i,maxPriorityFeePerGas:a,to:r}=n,s=t?_t(t):void 0;if(s&&!ft(s.address))throw new Lt({address:s.address});if(r&&!ft(r))throw new Lt({address:r});if(typeof e<"u"&&(typeof i<"u"||typeof a<"u"))throw new tp;if(i&&i>Os)throw new Hi({maxFeePerGas:i});if(a&&i&&a>i)throw new Ca({maxFeePerGas:i,maxPriorityFeePerGas:a})}var Hs=re(()=>{"use strict";xi();gI();ga();Ir();na();aa()});function Un(n,t){if(!ft(n,{strict:!1}))throw new Lt({address:n});if(!ft(t,{strict:!1}))throw new Lt({address:t});return n.toLowerCase()===t.toLowerCase()}var il=re(()=>{"use strict";ga();aa()});function Ui(n){let{abi:t,args:e,functionName:i,data:a}=n,r=t[0];if(i){let o=_a({abi:t,args:e,name:i});if(!o)throw new gn(i,{docsPath:II});r=o}if(r.type!=="function")throw new gn(void 0,{docsPath:II});if(!r.outputs)throw new bm(r.name,{docsPath:II});let s=ur(r.outputs,a);if(s&&s.length>1)return s;if(s&&s.length===1)return s[0]}var II,wr=re(()=>{"use strict";Zt();zm();ts();II="/docs/contract/decodeFunctionResult"});var al,RC,Gp,PC,EI,wI,TI,Tr=re(()=>{"use strict";al=[{inputs:[{components:[{name:"target",type:"address"},{name:"allowFailure",type:"bool"},{name:"callData",type:"bytes"}],name:"calls",type:"tuple[]"}],name:"aggregate3",outputs:[{components:[{name:"success",type:"bool"},{name:"returnData",type:"bytes"}],name:"returnData",type:"tuple[]"}],stateMutability:"view",type:"function"}],RC=[{inputs:[],name:"ResolverNotFound",type:"error"},{inputs:[],name:"ResolverWildcardNotSupported",type:"error"},{inputs:[],name:"ResolverNotContract",type:"error"},{inputs:[{name:"returnData",type:"bytes"}],name:"ResolverError",type:"error"},{inputs:[{components:[{name:"status",type:"uint16"},{name:"message",type:"string"}],name:"errors",type:"tuple[]"}],name:"HttpError",type:"error"}],Gp=[...RC,{name:"resolve",type:"function",stateMutability:"view",inputs:[{name:"name",type:"bytes"},{name:"data",type:"bytes"}],outputs:[{name:"",type:"bytes"},{name:"address",type:"address"}]},{name:"resolve",type:"function",stateMutability:"view",inputs:[{name:"name",type:"bytes"},{name:"data",type:"bytes"},{name:"gateways",type:"string[]"}],outputs:[{name:"",type:"bytes"},{name:"address",type:"address"}]}],PC=[...RC,{name:"reverse",type:"function",stateMutability:"view",inputs:[{type:"bytes",name:"reverseName"}],outputs:[{type:"string",name:"resolvedName"},{type:"address",name:"resolvedAddress"},{type:"address",name:"reverseResolver"},{type:"address",name:"resolver"}]},{name:"reverse",type:"function",stateMutability:"view",inputs:[{type:"bytes",name:"reverseName"},{type:"string[]",name:"gateways"}],outputs:[{type:"string",name:"resolvedName"},{type:"address",name:"resolvedAddress"},{type:"address",name:"reverseResolver"},{type:"address",name:"resolver"}]}],EI=[{name:"text",type:"function",stateMutability:"view",inputs:[{name:"name",type:"bytes32"},{name:"key",type:"string"}],outputs:[{name:"",type:"string"}]}],wI=[{name:"addr",type:"function",stateMutability:"view",inputs:[{name:"name",type:"bytes32"}],outputs:[{name:"",type:"address"}]},{name:"addr",type:"function",stateMutability:"view",inputs:[{name:"name",type:"bytes32"},{name:"coinType",type:"uint256"}],outputs:[{name:"",type:"bytes"}]}],TI=[{inputs:[{name:"_signer",type:"address"},{name:"_hash",type:"bytes32"},{name:"_signature",type:"bytes"}],stateMutability:"nonpayable",type:"constructor"},{inputs:[{name:"_signer",type:"address"},{name:"_hash",type:"bytes32"},{name:"_signature",type:"bytes"}],outputs:[{type:"bool"}],stateMutability:"nonpayable",type:"function",name:"isValidSig"}]});var NC,OC=re(()=>{"use strict";NC="0x82ad56cb"});var HC,UC,VC,CI=re(()=>{"use strict";HC="0x608060405234801561001057600080fd5b5060405161018e38038061018e83398101604081905261002f91610124565b6000808351602085016000f59050803b61004857600080fd5b6000808351602085016000855af16040513d6000823e81610067573d81fd5b3d81f35b634e487b7160e01b600052604160045260246000fd5b600082601f83011261009257600080fd5b81516001600160401b038111156100ab576100ab61006b565b604051601f8201601f19908116603f011681016001600160401b03811182821017156100d9576100d961006b565b6040528181528382016020018510156100f157600080fd5b60005b82811015610110576020818601810151838301820152016100f4565b506000918101602001919091529392505050565b6000806040838503121561013757600080fd5b82516001600160401b0381111561014d57600080fd5b61015985828601610081565b602085015190935090506001600160401b0381111561017757600080fd5b61018385828601610081565b915050925092905056fe",UC="0x608060405234801561001057600080fd5b506040516102c03803806102c083398101604081905261002f916101e6565b836001600160a01b03163b6000036100e457600080836001600160a01b03168360405161005c9190610270565b6000604051808303816000865af19150503d8060008114610099576040519150601f19603f3d011682016040523d82523d6000602084013e61009e565b606091505b50915091508115806100b857506001600160a01b0386163b155b156100e1578060405163101bb98d60e01b81526004016100d8919061028c565b60405180910390fd5b50505b6000808451602086016000885af16040513d6000823e81610103573d81fd5b3d81f35b80516001600160a01b038116811461011e57600080fd5b919050565b634e487b7160e01b600052604160045260246000fd5b60005b8381101561015457818101518382015260200161013c565b50506000910152565b600082601f83011261016e57600080fd5b81516001600160401b0381111561018757610187610123565b604051601f8201601f19908116603f011681016001600160401b03811182821017156101b5576101b5610123565b6040528181528382016020018510156101cd57600080fd5b6101de826020830160208701610139565b949350505050565b600080600080608085870312156101fc57600080fd5b61020585610107565b60208601519094506001600160401b0381111561022157600080fd5b61022d8782880161015d565b93505061023c60408601610107565b60608601519092506001600160401b0381111561025857600080fd5b6102648782880161015d565b91505092959194509250565b60008251610282818460208701610139565b9190910192915050565b60208152600082518060208401526102ab816040850160208701610139565b601f01601f1916919091016040019291505056fe",VC="0x608060405234801561001057600080fd5b5060405161069438038061069483398101604081905261002f9161051e565b600061003c848484610048565b9050806000526001601ff35b60007f64926492649264926492649264926492649264926492649264926492649264926100748361040c565b036101e7576000606080848060200190518101906100929190610577565b60405192955090935091506000906001600160a01b038516906100b69085906105dd565b6000604051808303816000865af19150503d80600081146100f3576040519150601f19603f3d011682016040523d82523d6000602084013e6100f8565b606091505b50509050876001600160a01b03163b60000361016057806101605760405162461bcd60e51b815260206004820152601e60248201527f5369676e617475726556616c696461746f723a206465706c6f796d656e74000060448201526064015b60405180910390fd5b604051630b135d3f60e11b808252906001600160a01b038a1690631626ba7e90610190908b9087906004016105f9565b602060405180830381865afa1580156101ad573d6000803e3d6000fd5b505050506040513d601f19601f820116820180604052508101906101d19190610633565b6001600160e01b03191614945050505050610405565b6001600160a01b0384163b1561027a57604051630b135d3f60e11b808252906001600160a01b03861690631626ba7e9061022790879087906004016105f9565b602060405180830381865afa158015610244573d6000803e3d6000fd5b505050506040513d601f19601f820116820180604052508101906102689190610633565b6001600160e01b031916149050610405565b81516041146102df5760405162461bcd60e51b815260206004820152603a602482015260008051602061067483398151915260448201527f3a20696e76616c6964207369676e6174757265206c656e6774680000000000006064820152608401610157565b6102e7610425565b5060208201516040808401518451859392600091859190811061030c5761030c61065d565b016020015160f81c9050601b811480159061032b57508060ff16601c14155b1561038c5760405162461bcd60e51b815260206004820152603b602482015260008051602061067483398151915260448201527f3a20696e76616c6964207369676e617475726520762076616c756500000000006064820152608401610157565b60408051600081526020810180835289905260ff83169181019190915260608101849052608081018390526001600160a01b0389169060019060a0016020604051602081039080840390855afa1580156103ea573d6000803e3d6000fd5b505050602060405103516001600160a01b0316149450505050505b9392505050565b600060208251101561041d57600080fd5b508051015190565b60405180606001604052806003906020820280368337509192915050565b6001600160a01b038116811461045857600080fd5b50565b634e487b7160e01b600052604160045260246000fd5b60005b8381101561048c578181015183820152602001610474565b50506000910152565b600082601f8301126104a657600080fd5b81516001600160401b038111156104bf576104bf61045b565b604051601f8201601f19908116603f011681016001600160401b03811182821017156104ed576104ed61045b565b60405281815283820160200185101561050557600080fd5b610516826020830160208701610471565b949350505050565b60008060006060848603121561053357600080fd5b835161053e81610443565b6020850151604086015191945092506001600160401b0381111561056157600080fd5b61056d86828701610495565b9150509250925092565b60008060006060848603121561058c57600080fd5b835161059781610443565b60208501519093506001600160401b038111156105b357600080fd5b6105bf86828701610495565b604086015190935090506001600160401b0381111561056157600080fd5b600082516105ef818460208701610471565b9190910192915050565b828152604060208201526000825180604084015261061e816060850160208701610471565b601f01601f1916919091016060019392505050565b60006020828403121561064557600080fd5b81516001600160e01b03198116811461040557600080fd5b634e487b7160e01b600052603260045260246000fdfe5369676e617475726556616c696461746f72237265636f7665725369676e6572"});var Cr,Kp,qp,nl,Sr,rl=re(()=>{"use strict";$e();Cr=class extends K{constructor({blockNumber:t,chain:e,contract:i}){super(`Chain "${e.name}" does not support contract "${i.name}".`,{metaMessages:["This could be due to any of the following:",...t&&i.blockCreated&&i.blockCreated>t?[`- The contract "${i.name}" was not deployed until block ${i.blockCreated} (current block ${t}).`]:[`- The chain does not have the contract "${i.name}" configured.`]],name:"ChainDoesNotSupportContract"})}},Kp=class extends K{constructor({chain:t,currentChainId:e}){super(`The current chain of the wallet (id: ${e}) does not match the target chain for the transaction (id: ${t.id} – ${t.name}).`,{metaMessages:[`Current Chain ID:  ${e}`,`Expected Chain ID: ${t.id} – ${t.name}`],name:"ChainMismatchError"})}},qp=class extends K{constructor(){super(["No chain was provided to the request.","Please provide a chain with the `chain` argument on the Action, or by supplying a `chain` to WalletClient."].join(`
`),{name:"ChainNotFoundError"})}},nl=class extends K{constructor(){super("No chain was provided to the Client.",{name:"ClientChainNotConfiguredError"})}},Sr=class extends K{constructor({chainId:t}){super(typeof t=="number"?`Chain ID "${t}" is invalid.`:"Chain ID is invalid.",{name:"InvalidChainIdError"})}}});function Dr(n){let{abi:t,args:e,bytecode:i}=n;if(!e||e.length===0)return i;let a=t.find(s=>"type"in s&&s.type==="constructor");if(!a)throw new pm({docsPath:SI});if(!("inputs"in a))throw new ko({docsPath:SI});if(!a.inputs||a.inputs.length===0)throw new ko({docsPath:SI});let r=Di(a.inputs,e);return li([i,r])}var SI,Wp=re(()=>{"use strict";Zt();Pi();wn();SI="/docs/contract/encodeDeployData"});function Vi({blockNumber:n,chain:t,contract:e}){let i=t?.contracts?.[e];if(!i)throw new Cr({chain:t,contract:{name:e}});if(n&&i.blockCreated&&i.blockCreated>n)throw new Cr({blockNumber:n,chain:t,contract:{name:e,blockCreated:i.blockCreated}});return i.address}var Ar=re(()=>{"use strict";rl()});function FC(n,{docsPath:t,...e}){let i=(()=>{let a=Rs(n,e);return a instanceof Sa?n:a})();return new hr(i,{docsPath:t,...e})}var GC=re(()=>{"use strict";Cn();Ir();Tp()});function Yp(){let n=()=>{},t=()=>{};return{promise:new Promise((i,a)=>{n=i,t=a}),resolve:n,reject:t}}var DI=re(()=>{"use strict"});function zp({fn:n,id:t,shouldSplitBatch:e,wait:i=0,sort:a}){let r=async()=>{let u=l();s();let p=u.map(({args:d})=>d);p.length!==0&&n(p).then(d=>{a&&Array.isArray(d)&&d.sort(a);for(let L=0;L<u.length;L++){let{resolve:x}=u[L];x?.([d[L],d])}}).catch(d=>{for(let L=0;L<u.length;L++){let{reject:x}=u[L];x?.(d)}})},s=()=>AI.delete(t),o=()=>l().map(({args:u})=>u),l=()=>AI.get(t)||[],c=u=>AI.set(t,[...l(),u]);return{flush:s,async schedule(u){let{promise:p,resolve:d,reject:L}=Yp();return e?.([...o(),u])&&r(),l().length>0?(c({args:u,resolve:d,reject:L}),p):(c({args:u,resolve:d,reject:L}),setTimeout(r,i),p)}}}var AI,kI=re(()=>{"use strict";DI();AI=new Map});var jp,$p,Xp,KC=re(()=>{"use strict";bi();$e();op();jp=class extends K{constructor({callbackSelector:t,cause:e,data:i,extraData:a,sender:r,urls:s}){super(e.shortMessage||"An error occurred while fetching for an offchain result.",{cause:e,metaMessages:[...e.metaMessages||[],e.metaMessages?.length?"":[],"Offchain Gateway Call:",s&&["  Gateway URL(s):",...s.map(o=>`    ${pr(o)}`)],`  Sender: ${r}`,`  Data: ${i}`,`  Callback selector: ${t}`,`  Extra data: ${a}`].flat(),name:"OffchainLookupError"})}},$p=class extends K{constructor({result:t,url:e}){super("Offchain gateway response is malformed. Response data must be a hex value.",{metaMessages:[`Gateway URL: ${pr(e)}`,`Response: ${nt(t)}`],name:"OffchainLookupResponseMalformedError"})}},Xp=class extends K{constructor({sender:t,to:e}){super("Reverted sender address does not match target contract address (`to`).",{metaMessages:[`Contract address: ${e}`,`OffchainLookup sender address: ${t}`],name:"OffchainLookupSenderMismatchError"})}}});var YC={};L0(YC,{ccipRequest:()=>WC,offchainLookup:()=>Sk,offchainLookupAbiItem:()=>qC,offchainLookupSignature:()=>Ck});async function Sk(n,{blockNumber:t,blockTag:e,data:i,to:a}){let{args:r}=jm({data:i,abi:[qC]}),[s,o,l,c,u]=r,{ccipRead:p}=n,d=p&&typeof p?.request=="function"?p.request:WC;try{if(!Un(a,s))throw new Xp({sender:s,to:a});let L=await d({data:l,sender:s,urls:o}),{data:x}=await ka(n,{blockNumber:t,blockTag:e,data:yi([c,Di([{type:"bytes"},{type:"bytes"}],[L,u])]),to:a});return x}catch(L){throw new jp({callbackSelector:c,cause:L,data:i,extraData:u,sender:s,urls:o})}}async function WC({data:n,sender:t,urls:e}){let i=new Error("An unknown error occurred.");for(let a=0;a<e.length;a++){let r=e[a],s=r.includes("{data}")?"GET":"POST",o=s==="POST"?{data:n,sender:t}:void 0,l=s==="POST"?{"Content-Type":"application/json"}:{};try{let c=await fetch(r.replace("{sender}",t).replace("{data}",n),{body:JSON.stringify(o),headers:l,method:s}),u;if(c.headers.get("Content-Type")?.startsWith("application/json")?u=(await c.json()).data:u=await c.text(),!c.ok){i=new Ni({body:o,details:u?.error?nt(u.error):c.statusText,headers:c.headers,status:c.status,url:r});continue}if(!Rt(u)){i=new $p({result:u,url:r});continue}return u}catch(c){i=new Ni({body:o,details:c.message,url:r})}}throw i}var Ck,qC,zC=re(()=>{"use strict";js();KC();us();Y0();wn();il();Pi();Qi();bi();Ck="0x556f1830",qC={name:"OffchainLookup",type:"error",inputs:[{name:"sender",type:"address"},{name:"urls",type:"string[]"},{name:"callData",type:"bytes"},{name:"callbackFunction",type:"bytes4"},{name:"extraData",type:"bytes"}]}});async function ka(n,t){let{account:e=n.account,batch:i=!!n.batch?.multicall,blockNumber:a,blockTag:r="latest",accessList:s,blobs:o,code:l,data:c,factory:u,factoryData:p,gas:d,gasPrice:L,maxFeePerBlobGas:x,maxFeePerGas:w,maxPriorityFeePerGas:I,nonce:M,to:H,value:V,stateOverride:q,...X}=t,Z=e?_t(e):void 0;if(l&&(u||p))throw new K("Cannot provide both `code` & `factory`/`factoryData` as parameters.");if(l&&H)throw new K("Cannot provide both `code` & `to` as parameters.");let Q=l&&c,ee=u&&p&&H&&c,ae=Q||ee,Be=(()=>Q?kk({code:l,data:c}):ee?Bk({data:c,factory:u,factoryData:p,to:H}):c)();try{Da(t);let $=(a?Ce(a):void 0)||r,Oe=Dp(q),ce=n.chain?.formatters?.transactionRequest?.format,Te=(ce||Nn)({...Ps(X,{format:ce}),from:Z?.address,accessList:s,blobs:o,data:Be,gas:d,gasPrice:L,maxFeePerBlobGas:x,maxFeePerGas:w,maxPriorityFeePerGas:I,nonce:M,to:ae?void 0:H,value:V});if(i&&Dk({request:Te})&&!Oe)try{return await Ak(n,{...Te,blockNumber:a,blockTag:r})}catch(We){if(!(We instanceof nl)&&!(We instanceof Cr))throw We}let N=await n.request({method:"eth_call",params:Oe?[Te,$,Oe]:[Te,$]});return N==="0x"?{data:void 0}:{data:N}}catch(we){let $=Mk(we),{offchainLookup:Oe,offchainLookupSignature:ce}=await Promise.resolve().then(()=>(zC(),YC));if(n.ccipRead!==!1&&$?.slice(0,10)===ce&&H)return{data:await Oe(n,{data:$,to:H})};throw ae&&$?.slice(0,10)==="0x101bb98d"?new Wo({factory:u}):FC(we,{...t,account:Z,chain:n.chain})}}function Dk({request:n}){let{data:t,to:e,...i}=n;return!(!t||t.startsWith(NC)||!e||Object.values(i).filter(a=>typeof a<"u").length>0)}async function Ak(n,t){let{batchSize:e=1024,wait:i=0}=typeof n.batch?.multicall=="object"?n.batch.multicall:{},{blockNumber:a,blockTag:r="latest",data:s,multicallAddress:o,to:l}=t,c=o;if(!c){if(!n.chain)throw new nl;c=Vi({blockNumber:a,chain:n.chain,contract:"multicall3"})}let p=(a?Ce(a):void 0)||r,{schedule:d}=zp({id:`${n.uid}.${p}`,wait:i,shouldSplitBatch(w){return w.reduce((M,{data:H})=>M+(H.length-2),0)>e*2},fn:async w=>{let I=w.map(V=>({allowFailure:!0,callData:V.data,target:V.to})),M=Wt({abi:al,args:[I],functionName:"aggregate3"}),H=await n.request({method:"eth_call",params:[{data:M,to:c},p]});return Ui({abi:al,args:[I],functionName:"aggregate3",data:H||"0x"})}}),[{returnData:L,success:x}]=await d({data:s,to:l});if(!x)throw new Qa({data:L});return L==="0x"?{data:void 0}:{data:L}}function kk(n){let{code:t,data:e}=n;return Dr({abi:um(["constructor(bytes, bytes)"]),bytecode:HC,args:[t,e]})}function Bk(n){let{data:t,factory:e,factoryData:i,to:a}=n;return Dr({abi:um(["constructor(address, bytes, address, bytes)"]),bytecode:UC,args:[a,t,e,i]})}function Mk(n){if(!(n instanceof K))return;let t=n.walk();return typeof t?.data=="object"?t.data?.data:t.data}var js=re(()=>{"use strict";A0();xi();Tr();OC();CI();$e();rl();Cn();wr();Wp();xa();Ar();Fe();GC();Cp();tl();kI();bI();Hs()});var iD=SD((WE,YE)=>{"use strict";(function(n,t){typeof WE=="object"&&typeof YE<"u"?YE.exports=t():typeof define=="function"&&define.amd?define(t):(n=typeof globalThis<"u"?globalThis:n||self).jsSHA=t()})(WE,function(){"use strict";var n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";function t(U,T,R,O){var G,D,ie,ne=T||[0],ue=(R=R||0)>>>3,_e=O===-1?3:0;for(G=0;G<U.length;G+=1)D=(ie=G+ue)>>>2,ne.length<=D&&ne.push(0),ne[D]|=U[G]<<8*(_e+O*(ie%4));return{value:ne,binLen:8*U.length+R}}function e(U,T,R){switch(T){case"UTF8":case"UTF16BE":case"UTF16LE":break;default:throw new Error("encoding must be UTF8, UTF16BE, or UTF16LE")}switch(U){case"HEX":return function(O,G,D){return function(ie,ne,ue,_e){var Pe,be,Se,Ye;if(ie.length%2!=0)throw new Error("String of HEX type must be in byte increments");var ye=ne||[0],st=(ue=ue||0)>>>3,it=_e===-1?3:0;for(Pe=0;Pe<ie.length;Pe+=2){if(be=parseInt(ie.substr(Pe,2),16),isNaN(be))throw new Error("String of HEX type contains invalid characters");for(Se=(Ye=(Pe>>>1)+st)>>>2;ye.length<=Se;)ye.push(0);ye[Se]|=be<<8*(it+_e*(Ye%4))}return{value:ye,binLen:4*ie.length+ue}}(O,G,D,R)};case"TEXT":return function(O,G,D){return function(ie,ne,ue,_e,Pe){var be,Se,Ye,ye,st,it,pt,It,Ga=0,Si=ue||[0],$i=(_e=_e||0)>>>3;if(ne==="UTF8")for(pt=Pe===-1?3:0,Ye=0;Ye<ie.length;Ye+=1)for(Se=[],128>(be=ie.charCodeAt(Ye))?Se.push(be):2048>be?(Se.push(192|be>>>6),Se.push(128|63&be)):55296>be||57344<=be?Se.push(224|be>>>12,128|be>>>6&63,128|63&be):(Ye+=1,be=65536+((1023&be)<<10|1023&ie.charCodeAt(Ye)),Se.push(240|be>>>18,128|be>>>12&63,128|be>>>6&63,128|63&be)),ye=0;ye<Se.length;ye+=1){for(st=(it=Ga+$i)>>>2;Si.length<=st;)Si.push(0);Si[st]|=Se[ye]<<8*(pt+Pe*(it%4)),Ga+=1}else for(pt=Pe===-1?2:0,It=ne==="UTF16LE"&&Pe!==1||ne!=="UTF16LE"&&Pe===1,Ye=0;Ye<ie.length;Ye+=1){for(be=ie.charCodeAt(Ye),It===!0&&(be=(ye=255&be)<<8|be>>>8),st=(it=Ga+$i)>>>2;Si.length<=st;)Si.push(0);Si[st]|=be<<8*(pt+Pe*(it%4)),Ga+=2}return{value:Si,binLen:8*Ga+_e}}(O,T,G,D,R)};case"B64":return function(O,G,D){return function(ie,ne,ue,_e){var Pe,be,Se,Ye,ye,st,it=0,pt=ne||[0],It=(ue=ue||0)>>>3,Ga=_e===-1?3:0,Si=ie.indexOf("=");if(ie.search(/^[a-zA-Z0-9=+/]+$/)===-1)throw new Error("Invalid character in base-64 string");if(ie=ie.replace(/=/g,""),Si!==-1&&Si<ie.length)throw new Error("Invalid '=' found in base-64 string");for(Pe=0;Pe<ie.length;Pe+=4){for(Ye=ie.substr(Pe,4),Se=0,be=0;be<Ye.length;be+=1)Se|=n.indexOf(Ye.charAt(be))<<18-6*be;for(be=0;be<Ye.length-1;be+=1){for(ye=(st=it+It)>>>2;pt.length<=ye;)pt.push(0);pt[ye]|=(Se>>>16-8*be&255)<<8*(Ga+_e*(st%4)),it+=1}}return{value:pt,binLen:8*it+ue}}(O,G,D,R)};case"BYTES":return function(O,G,D){return function(ie,ne,ue,_e){var Pe,be,Se,Ye,ye=ne||[0],st=(ue=ue||0)>>>3,it=_e===-1?3:0;for(be=0;be<ie.length;be+=1)Pe=ie.charCodeAt(be),Se=(Ye=be+st)>>>2,ye.length<=Se&&ye.push(0),ye[Se]|=Pe<<8*(it+_e*(Ye%4));return{value:ye,binLen:8*ie.length+ue}}(O,G,D,R)};case"ARRAYBUFFER":try{new ArrayBuffer(0)}catch{throw new Error("ARRAYBUFFER not supported by this environment")}return function(O,G,D){return function(ie,ne,ue,_e){return t(new Uint8Array(ie),ne,ue,_e)}(O,G,D,R)};case"UINT8ARRAY":try{new Uint8Array(0)}catch{throw new Error("UINT8ARRAY not supported by this environment")}return function(O,G,D){return t(O,G,D,R)};default:throw new Error("format must be HEX, TEXT, B64, BYTES, ARRAYBUFFER, or UINT8ARRAY")}}function i(U,T,R,O){switch(U){case"HEX":return function(G){return function(D,ie,ne,ue){var _e,Pe,be="",Se=ie/8,Ye=ne===-1?3:0;for(_e=0;_e<Se;_e+=1)Pe=D[_e>>>2]>>>8*(Ye+ne*(_e%4)),be+="0123456789abcdef".charAt(Pe>>>4&15)+"0123456789abcdef".charAt(15&Pe);return ue.outputUpper?be.toUpperCase():be}(G,T,R,O)};case"B64":return function(G){return function(D,ie,ne,ue){var _e,Pe,be,Se,Ye,ye="",st=ie/8,it=ne===-1?3:0;for(_e=0;_e<st;_e+=3)for(Se=_e+1<st?D[_e+1>>>2]:0,Ye=_e+2<st?D[_e+2>>>2]:0,be=(D[_e>>>2]>>>8*(it+ne*(_e%4))&255)<<16|(Se>>>8*(it+ne*((_e+1)%4))&255)<<8|Ye>>>8*(it+ne*((_e+2)%4))&255,Pe=0;Pe<4;Pe+=1)ye+=8*_e+6*Pe<=ie?n.charAt(be>>>6*(3-Pe)&63):ue.b64Pad;return ye}(G,T,R,O)};case"BYTES":return function(G){return function(D,ie,ne){var ue,_e,Pe="",be=ie/8,Se=ne===-1?3:0;for(ue=0;ue<be;ue+=1)_e=D[ue>>>2]>>>8*(Se+ne*(ue%4))&255,Pe+=String.fromCharCode(_e);return Pe}(G,T,R)};case"ARRAYBUFFER":try{new ArrayBuffer(0)}catch{throw new Error("ARRAYBUFFER not supported by this environment")}return function(G){return function(D,ie,ne){var ue,_e=ie/8,Pe=new ArrayBuffer(_e),be=new Uint8Array(Pe),Se=ne===-1?3:0;for(ue=0;ue<_e;ue+=1)be[ue]=D[ue>>>2]>>>8*(Se+ne*(ue%4))&255;return Pe}(G,T,R)};case"UINT8ARRAY":try{new Uint8Array(0)}catch{throw new Error("UINT8ARRAY not supported by this environment")}return function(G){return function(D,ie,ne){var ue,_e=ie/8,Pe=ne===-1?3:0,be=new Uint8Array(_e);for(ue=0;ue<_e;ue+=1)be[ue]=D[ue>>>2]>>>8*(Pe+ne*(ue%4))&255;return be}(G,T,R)};default:throw new Error("format must be HEX, B64, BYTES, ARRAYBUFFER, or UINT8ARRAY")}}var a=[1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298],r=[3238371032,914150663,812702999,4144912697,4290775857,1750603025,1694076839,3204075428],s=[1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225],o="Chosen SHA variant is not supported";function l(U,T){var R,O,G=U.binLen>>>3,D=T.binLen>>>3,ie=G<<3,ne=4-G<<3;if(G%4!=0){for(R=0;R<D;R+=4)O=G+R>>>2,U.value[O]|=T.value[R>>>2]<<ie,U.value.push(0),U.value[O+1]|=T.value[R>>>2]>>>ne;return(U.value.length<<2)-4>=D+G&&U.value.pop(),{value:U.value,binLen:U.binLen+T.binLen}}return{value:U.value.concat(T.value),binLen:U.binLen+T.binLen}}function c(U){var T={outputUpper:!1,b64Pad:"=",outputLen:-1},R=U||{},O="Output length must be a multiple of 8";if(T.outputUpper=R.outputUpper||!1,R.b64Pad&&(T.b64Pad=R.b64Pad),R.outputLen){if(R.outputLen%8!=0)throw new Error(O);T.outputLen=R.outputLen}else if(R.shakeLen){if(R.shakeLen%8!=0)throw new Error(O);T.outputLen=R.shakeLen}if(typeof T.outputUpper!="boolean")throw new Error("Invalid outputUpper formatting option");if(typeof T.b64Pad!="string")throw new Error("Invalid b64Pad formatting option");return T}function u(U,T,R,O){var G=U+" must include a value and format";if(!T){if(!O)throw new Error(G);return O}if(T.value===void 0||!T.format)throw new Error(G);return e(T.format,T.encoding||"UTF8",R)(T.value)}var p=function(){function U(T,R,O){var G=O||{};if(this.t=R,this.i=G.encoding||"UTF8",this.numRounds=G.numRounds||1,isNaN(this.numRounds)||this.numRounds!==parseInt(this.numRounds,10)||1>this.numRounds)throw new Error("numRounds must a integer >= 1");this.o=T,this.u=[],this.s=0,this.h=!1,this.v=0,this.A=!1,this.l=[],this.H=[]}return U.prototype.update=function(T){var R,O=0,G=this.S>>>5,D=this.p(T,this.u,this.s),ie=D.binLen,ne=D.value,ue=ie>>>5;for(R=0;R<ue;R+=G)O+this.S<=ie&&(this.m=this.R(ne.slice(R,R+G),this.m),O+=this.S);this.v+=O,this.u=ne.slice(O>>>5),this.s=ie%this.S,this.h=!0},U.prototype.getHash=function(T,R){var O,G,D=this.U,ie=c(R);if(this.T){if(ie.outputLen===-1)throw new Error("Output length must be specified in options");D=ie.outputLen}var ne=i(T,D,this.C,ie);if(this.A&&this.F)return ne(this.F(ie));for(G=this.K(this.u.slice(),this.s,this.v,this.B(this.m),D),O=1;O<this.numRounds;O+=1)this.T&&D%32!=0&&(G[G.length-1]&=16777215>>>24-D%32),G=this.K(G,D,0,this.L(this.o),D);return ne(G)},U.prototype.setHMACKey=function(T,R,O){if(!this.g)throw new Error("Variant does not support HMAC");if(this.h)throw new Error("Cannot set MAC key after calling update");var G=e(R,(O||{}).encoding||"UTF8",this.C);this.k(G(T))},U.prototype.k=function(T){var R,O=this.S>>>3,G=O/4-1;if(this.numRounds!==1)throw new Error("Cannot set numRounds with MAC");if(this.A)throw new Error("MAC key already set");for(O<T.binLen/8&&(T.value=this.K(T.value,T.binLen,0,this.L(this.o),this.U));T.value.length<=G;)T.value.push(0);for(R=0;R<=G;R+=1)this.l[R]=909522486^T.value[R],this.H[R]=1549556828^T.value[R];this.m=this.R(this.l,this.m),this.v=this.S,this.A=!0},U.prototype.getHMAC=function(T,R){var O=c(R);return i(T,this.U,this.C,O)(this.Y())},U.prototype.Y=function(){var T;if(!this.A)throw new Error("Cannot call getHMAC without first setting MAC key");var R=this.K(this.u.slice(),this.s,this.v,this.B(this.m),this.U);return T=this.R(this.H,this.L(this.o)),T=this.K(R,this.U,this.S,T,this.U)},U}(),d=function(U,T){return(d=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(R,O){R.__proto__=O}||function(R,O){for(var G in O)Object.prototype.hasOwnProperty.call(O,G)&&(R[G]=O[G])})(U,T)};function L(U,T){function R(){this.constructor=U}d(U,T),U.prototype=T===null?Object.create(T):(R.prototype=T.prototype,new R)}function x(U,T){return U<<T|U>>>32-T}function w(U,T){return U>>>T|U<<32-T}function I(U,T){return U>>>T}function M(U,T,R){return U^T^R}function H(U,T,R){return U&T^~U&R}function V(U,T,R){return U&T^U&R^T&R}function q(U){return w(U,2)^w(U,13)^w(U,22)}function X(U,T){var R=(65535&U)+(65535&T);return(65535&(U>>>16)+(T>>>16)+(R>>>16))<<16|65535&R}function Z(U,T,R,O){var G=(65535&U)+(65535&T)+(65535&R)+(65535&O);return(65535&(U>>>16)+(T>>>16)+(R>>>16)+(O>>>16)+(G>>>16))<<16|65535&G}function Q(U,T,R,O,G){var D=(65535&U)+(65535&T)+(65535&R)+(65535&O)+(65535&G);return(65535&(U>>>16)+(T>>>16)+(R>>>16)+(O>>>16)+(G>>>16)+(D>>>16))<<16|65535&D}function ee(U){return w(U,7)^w(U,18)^I(U,3)}function ae(U){return w(U,6)^w(U,11)^w(U,25)}function Be(U){return[1732584193,4023233417,2562383102,271733878,3285377520]}function we(U,T){var R,O,G,D,ie,ne,ue,_e=[];for(R=T[0],O=T[1],G=T[2],D=T[3],ie=T[4],ue=0;ue<80;ue+=1)_e[ue]=ue<16?U[ue]:x(_e[ue-3]^_e[ue-8]^_e[ue-14]^_e[ue-16],1),ne=ue<20?Q(x(R,5),H(O,G,D),ie,1518500249,_e[ue]):ue<40?Q(x(R,5),M(O,G,D),ie,1859775393,_e[ue]):ue<60?Q(x(R,5),V(O,G,D),ie,2400959708,_e[ue]):Q(x(R,5),M(O,G,D),ie,3395469782,_e[ue]),ie=D,D=G,G=x(O,30),O=R,R=ne;return T[0]=X(R,T[0]),T[1]=X(O,T[1]),T[2]=X(G,T[2]),T[3]=X(D,T[3]),T[4]=X(ie,T[4]),T}function $(U,T,R,O){for(var G,D=15+(T+65>>>9<<4),ie=T+R;U.length<=D;)U.push(0);for(U[T>>>5]|=128<<24-T%32,U[D]=4294967295&ie,U[D-1]=ie/4294967296|0,G=0;G<U.length;G+=16)O=we(U.slice(G,G+16),O);return O}var Oe=function(U){function T(R,O,G){var D=this;if(R!=="SHA-1")throw new Error(o);var ie=G||{};return(D=U.call(this,R,O,G)||this).g=!0,D.F=D.Y,D.C=-1,D.p=e(D.t,D.i,D.C),D.R=we,D.B=function(ne){return ne.slice()},D.L=Be,D.K=$,D.m=[1732584193,4023233417,2562383102,271733878,3285377520],D.S=512,D.U=160,D.T=!1,ie.hmacKey&&D.k(u("hmacKey",ie.hmacKey,D.C)),D}return L(T,U),T}(p);function ce(U){return U=="SHA-224"?r.slice():s.slice()}function ve(U,T){var R,O,G,D,ie,ne,ue,_e,Pe,be,Se,Ye,ye=[];for(R=T[0],O=T[1],G=T[2],D=T[3],ie=T[4],ne=T[5],ue=T[6],_e=T[7],Se=0;Se<64;Se+=1)ye[Se]=Se<16?U[Se]:Z(w(Ye=ye[Se-2],17)^w(Ye,19)^I(Ye,10),ye[Se-7],ee(ye[Se-15]),ye[Se-16]),Pe=Q(_e,ae(ie),H(ie,ne,ue),a[Se],ye[Se]),be=X(q(R),V(R,O,G)),_e=ue,ue=ne,ne=ie,ie=X(D,Pe),D=G,G=O,O=R,R=X(Pe,be);return T[0]=X(R,T[0]),T[1]=X(O,T[1]),T[2]=X(G,T[2]),T[3]=X(D,T[3]),T[4]=X(ie,T[4]),T[5]=X(ne,T[5]),T[6]=X(ue,T[6]),T[7]=X(_e,T[7]),T}var Te=function(U){function T(R,O,G){var D=this;if(R!=="SHA-224"&&R!=="SHA-256")throw new Error(o);var ie=G||{};return(D=U.call(this,R,O,G)||this).F=D.Y,D.g=!0,D.C=-1,D.p=e(D.t,D.i,D.C),D.R=ve,D.B=function(ne){return ne.slice()},D.L=ce,D.K=function(ne,ue,_e,Pe){return function(be,Se,Ye,ye,st){for(var it,pt=15+(Se+65>>>9<<4),It=Se+Ye;be.length<=pt;)be.push(0);for(be[Se>>>5]|=128<<24-Se%32,be[pt]=4294967295&It,be[pt-1]=It/4294967296|0,it=0;it<be.length;it+=16)ye=ve(be.slice(it,it+16),ye);return st==="SHA-224"?[ye[0],ye[1],ye[2],ye[3],ye[4],ye[5],ye[6]]:ye}(ne,ue,_e,Pe,R)},D.m=ce(R),D.S=512,D.U=R==="SHA-224"?224:256,D.T=!1,ie.hmacKey&&D.k(u("hmacKey",ie.hmacKey,D.C)),D}return L(T,U),T}(p),N=function(U,T){this.N=U,this.I=T};function We(U,T){var R;return T>32?(R=64-T,new N(U.I<<T|U.N>>>R,U.N<<T|U.I>>>R)):T!==0?(R=32-T,new N(U.N<<T|U.I>>>R,U.I<<T|U.N>>>R)):U}function Ze(U,T){var R;return T<32?(R=32-T,new N(U.N>>>T|U.I<<R,U.I>>>T|U.N<<R)):(R=64-T,new N(U.I>>>T|U.N<<R,U.N>>>T|U.I<<R))}function Qt(U,T){return new N(U.N>>>T,U.I>>>T|U.N<<32-T)}function ai(U,T,R){return new N(U.N&T.N^~U.N&R.N,U.I&T.I^~U.I&R.I)}function Ft(U,T,R){return new N(U.N&T.N^U.N&R.N^T.N&R.N,U.I&T.I^U.I&R.I^T.I&R.I)}function Jt(U){var T=Ze(U,28),R=Ze(U,34),O=Ze(U,39);return new N(T.N^R.N^O.N,T.I^R.I^O.I)}function St(U,T){var R,O;R=(65535&U.I)+(65535&T.I);var G=(65535&(O=(U.I>>>16)+(T.I>>>16)+(R>>>16)))<<16|65535&R;return R=(65535&U.N)+(65535&T.N)+(O>>>16),O=(U.N>>>16)+(T.N>>>16)+(R>>>16),new N((65535&O)<<16|65535&R,G)}function nr(U,T,R,O){var G,D;G=(65535&U.I)+(65535&T.I)+(65535&R.I)+(65535&O.I);var ie=(65535&(D=(U.I>>>16)+(T.I>>>16)+(R.I>>>16)+(O.I>>>16)+(G>>>16)))<<16|65535&G;return G=(65535&U.N)+(65535&T.N)+(65535&R.N)+(65535&O.N)+(D>>>16),D=(U.N>>>16)+(T.N>>>16)+(R.N>>>16)+(O.N>>>16)+(G>>>16),new N((65535&D)<<16|65535&G,ie)}function da(U,T,R,O,G){var D,ie;D=(65535&U.I)+(65535&T.I)+(65535&R.I)+(65535&O.I)+(65535&G.I);var ne=(65535&(ie=(U.I>>>16)+(T.I>>>16)+(R.I>>>16)+(O.I>>>16)+(G.I>>>16)+(D>>>16)))<<16|65535&D;return D=(65535&U.N)+(65535&T.N)+(65535&R.N)+(65535&O.N)+(65535&G.N)+(ie>>>16),ie=(U.N>>>16)+(T.N>>>16)+(R.N>>>16)+(O.N>>>16)+(G.N>>>16)+(D>>>16),new N((65535&ie)<<16|65535&D,ne)}function Ua(U,T){return new N(U.N^T.N,U.I^T.I)}function Va(U){var T=Ze(U,1),R=Ze(U,8),O=Qt(U,7);return new N(T.N^R.N^O.N,T.I^R.I^O.I)}function yn(U){var T=Ze(U,14),R=Ze(U,18),O=Ze(U,41);return new N(T.N^R.N^O.N,T.I^R.I^O.I)}var $c=[new N(a[0],3609767458),new N(a[1],602891725),new N(a[2],3964484399),new N(a[3],2173295548),new N(a[4],4081628472),new N(a[5],3053834265),new N(a[6],2937671579),new N(a[7],3664609560),new N(a[8],2734883394),new N(a[9],1164996542),new N(a[10],1323610764),new N(a[11],3590304994),new N(a[12],4068182383),new N(a[13],991336113),new N(a[14],633803317),new N(a[15],3479774868),new N(a[16],2666613458),new N(a[17],944711139),new N(a[18],2341262773),new N(a[19],2007800933),new N(a[20],1495990901),new N(a[21],1856431235),new N(a[22],3175218132),new N(a[23],2198950837),new N(a[24],3999719339),new N(a[25],766784016),new N(a[26],2566594879),new N(a[27],3203337956),new N(a[28],1034457026),new N(a[29],2466948901),new N(a[30],3758326383),new N(a[31],168717936),new N(a[32],1188179964),new N(a[33],1546045734),new N(a[34],1522805485),new N(a[35],2643833823),new N(a[36],2343527390),new N(a[37],1014477480),new N(a[38],1206759142),new N(a[39],344077627),new N(a[40],1290863460),new N(a[41],3158454273),new N(a[42],3505952657),new N(a[43],106217008),new N(a[44],3606008344),new N(a[45],1432725776),new N(a[46],1467031594),new N(a[47],851169720),new N(a[48],3100823752),new N(a[49],1363258195),new N(a[50],3750685593),new N(a[51],3785050280),new N(a[52],3318307427),new N(a[53],3812723403),new N(a[54],2003034995),new N(a[55],3602036899),new N(a[56],1575990012),new N(a[57],1125592928),new N(a[58],2716904306),new N(a[59],442776044),new N(a[60],593698344),new N(a[61],3733110249),new N(a[62],2999351573),new N(a[63],3815920427),new N(3391569614,3928383900),new N(3515267271,566280711),new N(3940187606,3454069534),new N(4118630271,4000239992),new N(116418474,1914138554),new N(174292421,2731055270),new N(289380356,3203993006),new N(460393269,320620315),new N(685471733,587496836),new N(852142971,1086792851),new N(1017036298,365543100),new N(1126000580,2618297676),new N(1288033470,3409855158),new N(1501505948,4234509866),new N(1607167915,987167468),new N(1816402316,1246189591)];function Ci(U){return U==="SHA-384"?[new N(3418070365,r[0]),new N(1654270250,r[1]),new N(2438529370,r[2]),new N(355462360,r[3]),new N(1731405415,r[4]),new N(41048885895,r[5]),new N(3675008525,r[6]),new N(1203062813,r[7])]:[new N(s[0],4089235720),new N(s[1],2227873595),new N(s[2],4271175723),new N(s[3],1595750129),new N(s[4],2917565137),new N(s[5],725511199),new N(s[6],4215389547),new N(s[7],327033209)]}function Fa(U,T){var R,O,G,D,ie,ne,ue,_e,Pe,be,Se,Ye,ye,st,it,pt,It=[];for(R=T[0],O=T[1],G=T[2],D=T[3],ie=T[4],ne=T[5],ue=T[6],_e=T[7],Se=0;Se<80;Se+=1)Se<16?(Ye=2*Se,It[Se]=new N(U[Ye],U[Ye+1])):It[Se]=nr((ye=It[Se-2],st=void 0,it=void 0,pt=void 0,st=Ze(ye,19),it=Ze(ye,61),pt=Qt(ye,6),new N(st.N^it.N^pt.N,st.I^it.I^pt.I)),It[Se-7],Va(It[Se-15]),It[Se-16]),Pe=da(_e,yn(ie),ai(ie,ne,ue),$c[Se],It[Se]),be=St(Jt(R),Ft(R,O,G)),_e=ue,ue=ne,ne=ie,ie=St(D,Pe),D=G,G=O,O=R,R=St(Pe,be);return T[0]=St(R,T[0]),T[1]=St(O,T[1]),T[2]=St(G,T[2]),T[3]=St(D,T[3]),T[4]=St(ie,T[4]),T[5]=St(ne,T[5]),T[6]=St(ue,T[6]),T[7]=St(_e,T[7]),T}var Gr=function(U){function T(R,O,G){var D=this;if(R!=="SHA-384"&&R!=="SHA-512")throw new Error(o);var ie=G||{};return(D=U.call(this,R,O,G)||this).F=D.Y,D.g=!0,D.C=-1,D.p=e(D.t,D.i,D.C),D.R=Fa,D.B=function(ne){return ne.slice()},D.L=Ci,D.K=function(ne,ue,_e,Pe){return function(be,Se,Ye,ye,st){for(var it,pt=31+(Se+129>>>10<<5),It=Se+Ye;be.length<=pt;)be.push(0);for(be[Se>>>5]|=128<<24-Se%32,be[pt]=4294967295&It,be[pt-1]=It/4294967296|0,it=0;it<be.length;it+=32)ye=Fa(be.slice(it,it+32),ye);return st==="SHA-384"?[(ye=ye)[0].N,ye[0].I,ye[1].N,ye[1].I,ye[2].N,ye[2].I,ye[3].N,ye[3].I,ye[4].N,ye[4].I,ye[5].N,ye[5].I]:[ye[0].N,ye[0].I,ye[1].N,ye[1].I,ye[2].N,ye[2].I,ye[3].N,ye[3].I,ye[4].N,ye[4].I,ye[5].N,ye[5].I,ye[6].N,ye[6].I,ye[7].N,ye[7].I]}(ne,ue,_e,Pe,R)},D.m=Ci(R),D.S=1024,D.U=R==="SHA-384"?384:512,D.T=!1,ie.hmacKey&&D.k(u("hmacKey",ie.hmacKey,D.C)),D}return L(T,U),T}(p),Xc=[new N(0,1),new N(0,32898),new N(2147483648,32906),new N(2147483648,2147516416),new N(0,32907),new N(0,2147483649),new N(2147483648,2147516545),new N(2147483648,32777),new N(0,138),new N(0,136),new N(0,2147516425),new N(0,2147483658),new N(0,2147516555),new N(2147483648,139),new N(2147483648,32905),new N(2147483648,32771),new N(2147483648,32770),new N(2147483648,128),new N(0,32778),new N(2147483648,2147483658),new N(2147483648,2147516545),new N(2147483648,32896),new N(0,2147483649),new N(2147483648,2147516424)],Qc=[[0,36,3,41,18],[1,44,10,45,2],[62,6,43,15,61],[28,55,25,21,56],[27,20,39,8,14]];function y0(U){var T,R=[];for(T=0;T<5;T+=1)R[T]=[new N(0,0),new N(0,0),new N(0,0),new N(0,0),new N(0,0)];return R}function vD(U){var T,R=[];for(T=0;T<5;T+=1)R[T]=U[T].slice();return R}function Jc(U,T){var R,O,G,D,ie,ne,ue,_e,Pe,be=[],Se=[];if(U!==null)for(O=0;O<U.length;O+=2)T[(O>>>1)%5][(O>>>1)/5|0]=Ua(T[(O>>>1)%5][(O>>>1)/5|0],new N(U[O+1],U[O]));for(R=0;R<24;R+=1){for(D=y0(),O=0;O<5;O+=1)be[O]=(ie=T[O][0],ne=T[O][1],ue=T[O][2],_e=T[O][3],Pe=T[O][4],new N(ie.N^ne.N^ue.N^_e.N^Pe.N,ie.I^ne.I^ue.I^_e.I^Pe.I));for(O=0;O<5;O+=1)Se[O]=Ua(be[(O+4)%5],We(be[(O+1)%5],1));for(O=0;O<5;O+=1)for(G=0;G<5;G+=1)T[O][G]=Ua(T[O][G],Se[O]);for(O=0;O<5;O+=1)for(G=0;G<5;G+=1)D[G][(2*O+3*G)%5]=We(T[O][G],Qc[O][G]);for(O=0;O<5;O+=1)for(G=0;G<5;G+=1)T[O][G]=Ua(D[O][G],new N(~D[(O+1)%5][G].N&D[(O+2)%5][G].N,~D[(O+1)%5][G].I&D[(O+2)%5][G].I));T[0][0]=Ua(T[0][0],Xc[R])}return T}function ow(U){var T,R,O=0,G=[0,0],D=[4294967295&U,U/4294967296&2097151];for(T=6;T>=0;T--)(R=D[T>>2]>>>8*T&255)===0&&O===0||(G[O+1>>2]|=R<<8*(O+1),O+=1);return O=O!==0?O:1,G[0]|=O,{value:O+1>4?G:[G[0]],binLen:8+8*O}}function b0(U){return l(ow(U.binLen),U)}function lw(U,T){var R,O=ow(T),G=T>>>2,D=(G-(O=l(O,U)).value.length%G)%G;for(R=0;R<D;R++)O.value.push(0);return O.value}var xD=function(U){function T(R,O,G){var D=this,ie=6,ne=0,ue=G||{};if((D=U.call(this,R,O,G)||this).numRounds!==1){if(ue.kmacKey||ue.hmacKey)throw new Error("Cannot set numRounds with MAC");if(D.o==="CSHAKE128"||D.o==="CSHAKE256")throw new Error("Cannot set numRounds for CSHAKE variants")}switch(D.C=1,D.p=e(D.t,D.i,D.C),D.R=Jc,D.B=vD,D.L=y0,D.m=y0(),D.T=!1,R){case"SHA3-224":D.S=ne=1152,D.U=224,D.g=!0,D.F=D.Y;break;case"SHA3-256":D.S=ne=1088,D.U=256,D.g=!0,D.F=D.Y;break;case"SHA3-384":D.S=ne=832,D.U=384,D.g=!0,D.F=D.Y;break;case"SHA3-512":D.S=ne=576,D.U=512,D.g=!0,D.F=D.Y;break;case"SHAKE128":ie=31,D.S=ne=1344,D.U=-1,D.T=!0,D.g=!1,D.F=null;break;case"SHAKE256":ie=31,D.S=ne=1088,D.U=-1,D.T=!0,D.g=!1,D.F=null;break;case"KMAC128":ie=4,D.S=ne=1344,D.M(G),D.U=-1,D.T=!0,D.g=!1,D.F=D.X;break;case"KMAC256":ie=4,D.S=ne=1088,D.M(G),D.U=-1,D.T=!0,D.g=!1,D.F=D.X;break;case"CSHAKE128":D.S=ne=1344,ie=D.O(G),D.U=-1,D.T=!0,D.g=!1,D.F=null;break;case"CSHAKE256":D.S=ne=1088,ie=D.O(G),D.U=-1,D.T=!0,D.g=!1,D.F=null;break;default:throw new Error(o)}return D.K=function(_e,Pe,be,Se,Ye){return function(ye,st,it,pt,It,Ga,Si){var $i,g0,Zc=0,Io=[],eu=It>>>5,ID=st>>>5;for($i=0;$i<ID&&st>=It;$i+=eu)pt=Jc(ye.slice($i,$i+eu),pt),st-=It;for(ye=ye.slice($i),st%=It;ye.length<eu;)ye.push(0);for(ye[($i=st>>>3)>>2]^=Ga<<$i%4*8,ye[eu-1]^=2147483648,pt=Jc(ye,pt);32*Io.length<Si&&(g0=pt[Zc%5][Zc/5|0],Io.push(g0.I),!(32*Io.length>=Si));)Io.push(g0.N),64*(Zc+=1)%It==0&&(Jc(null,pt),Zc=0);return Io}(_e,Pe,0,Se,ne,ie,Ye)},ue.hmacKey&&D.k(u("hmacKey",ue.hmacKey,D.C)),D}return L(T,U),T.prototype.O=function(R,O){var G=function(ue){var _e=ue||{};return{funcName:u("funcName",_e.funcName,1,{value:[],binLen:0}),customization:u("Customization",_e.customization,1,{value:[],binLen:0})}}(R||{});O&&(G.funcName=O);var D=l(b0(G.funcName),b0(G.customization));if(G.customization.binLen!==0||G.funcName.binLen!==0){for(var ie=lw(D,this.S>>>3),ne=0;ne<ie.length;ne+=this.S>>>5)this.m=this.R(ie.slice(ne,ne+(this.S>>>5)),this.m),this.v+=this.S;return 4}return 31},T.prototype.M=function(R){var O=function(ie){var ne=ie||{};return{kmacKey:u("kmacKey",ne.kmacKey,1),funcName:{value:[1128353099],binLen:32},customization:u("Customization",ne.customization,1,{value:[],binLen:0})}}(R||{});this.O(R,O.funcName);for(var G=lw(b0(O.kmacKey),this.S>>>3),D=0;D<G.length;D+=this.S>>>5)this.m=this.R(G.slice(D,D+(this.S>>>5)),this.m),this.v+=this.S;this.A=!0},T.prototype.X=function(R){var O=l({value:this.u.slice(),binLen:this.s},function(G){var D,ie,ne=0,ue=[0,0],_e=[4294967295&G,G/4294967296&2097151];for(D=6;D>=0;D--)(ie=_e[D>>2]>>>8*D&255)==0&&ne===0||(ue[ne>>2]|=ie<<8*ne,ne+=1);return ue[(ne=ne!==0?ne:1)>>2]|=ne<<8*ne,{value:ne+1>4?ue:[ue[0]],binLen:8+8*ne}}(R.outputLen));return this.K(O.value,O.binLen,this.v,this.B(this.m),R.outputLen)},T}(p);return function(){function U(T,R,O){if(T=="SHA-1")this.j=new Oe(T,R,O);else if(T=="SHA-224"||T=="SHA-256")this.j=new Te(T,R,O);else if(T=="SHA-384"||T=="SHA-512")this.j=new Gr(T,R,O);else{if(T!="SHA3-224"&&T!="SHA3-256"&&T!="SHA3-384"&&T!="SHA3-512"&&T!="SHAKE128"&&T!="SHAKE256"&&T!="CSHAKE128"&&T!="CSHAKE256"&&T!="KMAC128"&&T!="KMAC256")throw new Error(o);this.j=new xD(T,R,O)}}return U.prototype.update=function(T){this.j.update(T)},U.prototype.getHash=function(T,R){return this.j.getHash(T,R)},U.prototype.setHMACKey=function(T,R,O){this.j.setHMACKey(T,R,O)},U.prototype.getHMAC=function(T,R){return this.j.getHMAC(T,R)},U}()})});var iu=class extends Laya.Scene{};var{regClass:kD,property:FN}=Laya,Eo=class extends iu{constructor(){super()}onEnable(){console.log("IndexRT onEnable"),this.uiBtn.on(Laya.Event.CLICK,this,()=>{console.log("uiBtn"),Laya.Scene.open("scenes/UiMain.ls")}),this.phyBtn.on(Laya.Event.CLICK,this,()=>{console.log("phyBtn"),Laya.Scene.open("scenes/PhysicsGameMain.ls")}),this.d3Btn.on(Laya.Event.CLICK,this,()=>{console.log("d3Btn"),Laya.Scene.open("scenes/D3Main.ls")})}onDestroy(){}};Eo=h([kD("wtSVevJMRPCBIPp2HPhqpw")],Eo);var au=class extends Laya.Scene{};var{regClass:BD,property:MD}=Laya,wo=class extends au{constructor(){super();this.text=""}get dataSource(){return super.dataSource}set dataSource(e){if(super.dataSource=e,!!e){if(e.avatar){let i=this.getChildByName("avatar").getChildByName("redHot");i.visible=e.avatar.redHot.visible}if(e.flag){let i=this.getChildByName("flag").getChildByName("flagText");i.text=e.flag.flagText.text}}}};h([MD({type:"string"})],wo.prototype,"text",2),wo=h([BD("c-3Sonu7RWOm5ETy2TrBcg")],wo);var nu=class extends Laya.Scene{};var me=class{constructor(){this._keys=[];this.THIS_ID="id"}init(t){for(let e in t){this._keys.push(e);let i=t[e];t[e]instanceof String&&String(t[e]).indexOf("[[")>=0&&(i=JSON.parse(t[e])),this[e]=i}}checkItems(){}};var To=class extends me{};var le=class{constructor(){this._values=[];this._keys=[];this.SERIALIZATION_NUM=new Date().getTime()}get values(){return this._values}get keys(){return this._keys}set(t,e){let i=this.indexOf(t);if(i>=0){this._values[i]=e;return}this._keys.push(t),this._values.push(e)}unshift(t,e){let i=this.indexOf(t);if(i>=0){this._values[i]=e;return}this._keys.unshift(t),this._values.unshift(e)}indexOf(t){let e=this._keys.indexOf(t);return e>=0?e:(t=t instanceof String?Number(t):t instanceof Number?t.toString():t,this._keys.indexOf(t))}get(t){let e=this.indexOf(t);return e<0?null:this._values[e]}remove(t){let e=this.indexOf(t);return e>=0?(this._keys.splice(e,1),this._values.splice(e,1),!0):!1}clear(){this._values.length=0,this._keys.length=0}};var ke=class ke{constructor(){}static get LoginType(){return ke._LoginType}static set LoginType(t){ke._LoginType=t,ke._LoginType&&ke._LoginType!=""&&Laya.LocalStorage.setItem(ke.COOKIE_CF_LoginType,ke._LoginType)}static get isWhiteList(){return!0}static get intance(){return ke._instance||(ke._instance=new ke),ke._instance}init(){}static get server(){return getServer()}static get vType(){return getVType()}static get requestTime(){return 0}static get loginTime(){return 0}static set m_iTimeFrame(t){if(t>1500){let e=function(){ke._m_iTimeFrame=0};ke._m_iTimeFrame=t,Laya.timer.clear(Laya.timer,e),Laya.timer.once(500,Laya.timer,e)}}static get m_iTimeFrame(){return ke._m_iTimeFrame}};ke.IsRelease=!1,ke.m_bInstantGame=!1,ke.useWebVersion=!1,ke.m_strVersionEX="V003",ke.m_bIsMobWeb=!1,ke.m_strWebTag="",ke.Js_Version="1",ke.Game_Version="20231227_01",ke.App_Version="1.0.0",ke.SDK_Version="1.0.0",ke.M_strCountry="1",ke.M_bAppData=!1,ke.bookingId=0,ke.teamId=0,ke.showHeartLog=!1,ke.ignoreLang=!1,ke.ignoreSheetNo=!1,ke.m_bIsIphoneX=!1,ke.Debug=0,ke.Res=0,ke.isTest=!0,ke.Server_URL="",ke.IP_User="",ke.Plantform_APPID="17",ke.ServerId=22310001,ke.Login_UID="-1",ke._LoginType="gamecenter",ke.isInto=!1,ke.isFull=!1,ke.justFull=!1,ke.Login_UDID="81BC19A8-B49B-47CC-BEFE-193E723B521A",ke.Device_Info="",ke.FCM_Token="",ke.APP_IsRelease=!0,ke.User_Lan="en",ke.UserAgent="",ke.Login_UserName="",ke.isWhite=!1,ke.APP_RES="",ke.COOKIE_CF_LAN="COOKIE_GG_LAN",ke.COOKIE_CF_LoginType="COOKIE_CF_LoginType",ke.IPHONEX_SCARE=1.22,ke.IPHONEX_TOP=44,ke.IPHONEX_BUTTOM=34,ke.DESIGN_WIDTH=1334,ke.DESIGN_HEIGHT=750,ke._m_iTimeFrame=0,ke.isStopPhysics=!1,ke.isDown=!1;var z=ke;var fe=class fe{constructor(){this._touchEnabled=!0;if(fe._instance)throw new Error("LayerManager是单例,不可new.");fe._instance=this}get m_sprPanelLayer(){return this._m_sprPanelLayer}set m_sprPanelLayer(t){this._m_sprPanelLayer=t}get m_sprMainUILayer(){return this._m_sprMainUILayer}set m_sprMainUILayer(t){this._m_sprMainUILayer=t}get m_sprTipLayer(){return this._m_sprTipLayer}set m_sprTipLayer(t){this._m_sprTipLayer=t}static get instence(){return fe._instance||(fe._instance=new fe),fe._instance}init(){this.m_sprSceneLayer=new Laya.Sprite,Laya.stage.addChild(this.m_sprSceneLayer),this.m_sprMainUILayer=new Laya.Sprite,Laya.stage.addChild(this.m_sprMainUILayer),this.m_sprPanelLayer=new Laya.Sprite,Laya.stage.addChild(this.m_sprPanelLayer),this.m_sprPopLayer=new Laya.Sprite,this.m_sprPopLayer.mouseThrough=!0,Laya.stage.addChild(this.m_sprPopLayer),this.m_sprTipLayer=new Laya.Sprite,Laya.stage.addChild(this.m_sprTipLayer),this.m_sprGuideLayer=new Laya.Sprite,Laya.stage.addChild(this.m_sprGuideLayer),this.m_sprTopLayer=new Laya.Sprite,Laya.stage.addChild(this.m_sprTopLayer)}get touchEnabled(){return this._touchEnabled}set touchEnabled(t){this._touchEnabled!=t&&(this._touchEnabled=t,this.m_sprSceneLayer.mouseEnabled=this._touchEnabled,this.m_sprMainUILayer.mouseEnabled=this._touchEnabled,this.m_sprPanelLayer.mouseEnabled=this._touchEnabled,this.m_sprPopLayer.mouseEnabled=this._touchEnabled,this.m_sprTipLayer.mouseEnabled=this._touchEnabled,this.m_sprGuideLayer.mouseEnabled=this._touchEnabled,this.m_sprTopLayer.mouseEnabled=this._touchEnabled)}addToLayerAndSet(t,e=fe.M_PANEL,i=fe.CENTER){this.addToLayer(t,e),this.setPosition(t,i)}getLayerIndex(t,e=fe.M_PANEL){let i;switch(e){case fe.M_SCENE:i=this.m_sprSceneLayer.getChildIndex(t);break;case fe.M_MAINUI:i=this.m_sprMainUILayer.getChildIndex(t);break;case fe.M_PANEL:i=this.m_sprPanelLayer.getChildIndex(t);break;case fe.M_POP:i=this.m_sprPopLayer.getChildIndex(t);break;case fe.M_TIP:i=this.m_sprTipLayer.getChildIndex(t);break;case fe.M_GUIDE:i=this.m_sprGuideLayer.getChildIndex(t);break;case fe.M_TOP:i=this.m_sprTopLayer.getChildIndex(t);break}return i}addToLayerAt(t,e=fe.M_PANEL,i=0){switch(e){case fe.M_SCENE:this.m_sprSceneLayer.addChildAt(t,i);break;case fe.M_MAINUI:this.m_sprMainUILayer.addChildAt(t,i);break;case fe.M_PANEL:this.m_sprPanelLayer.addChildAt(t,i);break;case fe.M_POP:this.m_sprPopLayer.addChildAt(t,i);break;case fe.M_TIP:this.m_sprTipLayer.addChildAt(t,i);break;case fe.M_GUIDE:this.m_sprGuideLayer.addChildAt(t,i);break;case fe.M_TOP:this.m_sprTopLayer.addChildAt(t,i);break}}addToLayer(t,e=fe.M_PANEL){switch(e){case fe.M_SCENE:this.m_sprSceneLayer.addChild(t);break;case fe.M_MAINUI:this.m_sprMainUILayer.addChild(t);break;case fe.M_PANEL:this.m_sprPanelLayer.addChild(t);break;case fe.M_POP:this.m_sprPopLayer.addChild(t);break;case fe.M_TIP:this.m_sprTipLayer.addChild(t);break;case fe.M_GUIDE:this.m_sprGuideLayer.addChild(t);break;case fe.M_TOP:this.m_sprTopLayer.addChild(t);break}}removeFromLayer(t,e){switch(e){case fe.M_SCENE:this.m_sprSceneLayer.removeChild(t);break;case fe.M_MAINUI:this.m_sprMainUILayer.removeChild(t);break;case fe.M_PANEL:this.m_sprPanelLayer.removeChild(t);break;case fe.M_POP:this.m_sprPopLayer.removeChild(t);break;case fe.M_GUIDE:this.m_sprGuideLayer.removeChild(t);break;case fe.M_TOP:this.m_sprTopLayer.removeChild(t);break}}clearLayer(t){switch(t){case fe.M_SCENE:this.m_sprSceneLayer.removeChildren();break;case fe.M_MAINUI:this.m_sprSceneLayer.removeChildren();break;case fe.M_PANEL:this.m_sprSceneLayer.removeChildren();break;case fe.M_POP:this.m_sprSceneLayer.removeChildren();break;case fe.M_TOP:this.m_sprSceneLayer.removeChildren();break}}get stageWidth(){let t;return t=Laya.stage.width,t}get stageHeight(){let t;return t=Laya.stage.height,t}setPosition(t,e,i=0,a=0,r=!1,s=!1){let o=Laya.stage.width,l=Laya.stage.height;switch(this.m_iStageWidth=o,this.m_iStageHeight=l,e){case fe.UP:t.x=r?o/2:(o-t.width*t.scaleX)/2,t.y=0;break;case fe.DOWN:t.x=r?o/2:(o-t.width*t.scaleX)/2,t.y=l-t.height*t.scaleY;break;case fe.LEFT:t.x=0,t.y=s?l/2:(l-t.height*t.scaleY)/2;break;case fe.RIGHT:t.x=o-t.width*t.scaleX,t.y=s?l/2:(l-t.height*t.scaleY)/2;break;case fe.LEFTUP:t.x=0,t.y=0;break;case fe.RIGHTUP:t.x=o-t.width*t.scaleX,t.y=0;break;case fe.LEFTDOWN:t.x=0,t.y=l-t.height*t.scaleY;break;case fe.RIGHTDOWN:t.x=o-t.width*t.scaleX,t.y=l-t.height*t.scaleY;break;case fe.CENTERLEFT:t.x=o/2-t.width*t.scaleX,t.y=s?l/2:(l-t.height*t.scaleY)/2;break;case fe.CENTERRIGHT:t.x=o/2,t.y=s?l/2:(l-t.height*t.scaleY)/2;break;case fe.CENTER:t.x=r?o/2:(o-t.width*t.scaleX)/2,t.y=s?l/2:(l-t.height*t.scaleY)/2;break;default:break}t.x+=i,t.y+=a}setLayer(t,e,i){if(!t||!e||t.parent!=e.parent)return;let a=t.parent.getChildIndex(t),r=e.parent.getChildIndex(e);i?a>r&&(t.parent.setChildIndex(t,r),t.parent.setChildIndex(e,a)):a<r&&(t.parent.setChildIndex(t,r),t.parent.setChildIndex(e,a))}};fe.M_SCENE=1,fe.M_MAINUI=2,fe.M_PANEL=3,fe.M_POP=4,fe.M_TIP=5,fe.M_GUIDE=7,fe.M_TOP=6,fe.UP=1,fe.DOWN=16,fe.LEFT=256,fe.RIGHT=4096,fe.CENTER=65536,fe.LEFTUP=fe.LEFT|fe.UP,fe.RIGHTUP=fe.RIGHT|fe.UP,fe.LEFTDOWN=fe.LEFT|fe.DOWN,fe.RIGHTDOWN=fe.RIGHT|fe.DOWN,fe.CENTERLEFT=fe.CENTER|fe.LEFT,fe.CENTERRIGHT=fe.CENTER|fe.RIGHT,fe.MOVE=-1;var C=fe;var Ka=class extends me{constructor(){super()}};var Kr=class{constructor(t,e){this._valuesObject={};this.sheetObject=t,this.BaseItemClass=e}get keys(){if(this._keys)return this._keys;this._keys=[];let t;for(let e in this.sheetObject)!e||e==""||this._keys.push(e);return this._keys}get values(){if(this._values)return this._values;this._values=[];let t;for(let e in this.sheetObject)this._valuesObject[e]?t=this._valuesObject[e]:(t=new this.BaseItemClass,t.init(this.sheetObject[e]),this._valuesObject[e]=t),this._values.push(t);return this._values}get(t){return this._valuesObject[t]?this._valuesObject[t]:this.sheetObject[t]}get1(t){if(this._valuesObject[t])return this._valuesObject[t];let e=this.sheetObject[t];if(e)return e;let i;this.BaseItemClass&&(i=new this.BaseItemClass,i.init==null&&console.log("ERROR :<BaseItem> SheetDataManager -->initConfig()  class : "+this.BaseItemClass),i.init(e)),this._valuesObject;let a=i||e;return this._valuesObject[t]=a,a}indexOf(t){let e=this._keys.indexOf(t);return e>=0?e:(t=t instanceof String?Number(t):t instanceof Number?t.toString():t,this._keys.indexOf(t))}clear(){this.sheetObject=null}};var qr=class n{constructor(){}static get instance(){return n._instance||(n._instance=new n),n._instance}initSpotCfgData(){if(this.spotDic==null){let t=S.instance.getResByURL("config/spot.json");this.spotDic=new Kr(t.data,Ka)}}getSpotById(t){return this.initSpotCfgData(),this.spotDic.get(t)}get getSpotDic(){return this.initSpotCfgData(),this.spotDic}};var He=class n{constructor(){}registerCommCallBack(t=null){Laya.LayaEnv.isConch}static get instance(){return n._instance||(n._instance=new n),n._instance}sendCustumEvent(t,e=null,i=null){let a;if(i?a=i:a=qr.instance.getSpotById(t),!a||!a.Event)return;let r,s=new Object;s.id=a.ID,s.eventKey=a.Event,s.type=a.type,this.sendWebEvent(s)}sendWebEvent(t){}dispose(){}reload(){Laya.Browser.window.location.reload()}testEvnt(){}};var de=class n{constructor(){this._isLoading=!1}static get instance(){return n._instance||(n._instance=new n),n._instance}get isLoading(){return this._isLoading}init(){if(!this.txtLoadingView){var t=Laya.loader.getRes("scenes/notice/TxtLoadingView.lh");this.txtLoadingView=t.create()}}showLoading(t=!1){if(console.log("showLoading..."+t),this.txtLoadingView)t?(this._isLoading=!0,this.showMaskLoading(),this.showLazyLoading(),this._isLoading=!1):(this._isLoading=!0,this.showMaskLoading(),Laya.timer.once(3e3,this,this.showLazyLoading)),this.txtLoadingView.m_txtLabel&&(this.txtLoadingView.m_txtLabel.visible=!1);else return}showLoadingByInfo(t=""){console.log("showLoadingByInfo..."+t),this._isLoading=!0,this.showMaskLoading(),this.showLazyLoading(),this.txtLoadingView.m_txtLabel.text=t,this.txtLoadingView.m_txtLabel.visible=!0}showMaskLoading(){this._isLoading&&(this.txtLoadingView.backLayer.name="backLayer",this.txtLoadingView.backLayer.mouseEnabled=!0,this.txtLoadingView.backLayer.mouseThrough=!1,this.txtLoadingView.backLayer.visible=!0)}showLazyLoading(){this._isLoading&&(console.log("showLazyLoading..."),this.txtLoadingView.visible=!0,Laya.stage.addChild(this.txtLoadingView),this.txtLoadingView.x=(Laya.stage.width-this.txtLoadingView.width)/2,this.txtLoadingView.y=(Laya.stage.height-this.txtLoadingView.height)/2),Laya.timer.clear(this,this.showLazyLoading)}hideLoading(){if(console.log("hideLoading..."),this._isLoading=!1,this.txtLoadingView)this.txtLoadingView.removeSelf();else return}dispose(){this.txtLoadingView&&(this.txtLoadingView.destroy(),this.txtLoadingView.removeSelf(),this.txtLoadingView=null),this.txtLoadingView.backLayer&&(this.txtLoadingView.backLayer.destroy(),this.txtLoadingView.backLayer.removeSelf(),this.txtLoadingView.backLayer=null)}};var Ke=class Ke{constructor(){this._m_bPlayMusic=!0;this._m_bPlayeSound=!0}static get instance(){return Ke._instance||(Ke._instance=new Ke),Ke._instance}get m_bPlayMusic(){return this._m_bPlayMusic}set m_bPlayMusic(t){this._m_bPlayMusic=t,t?this.m_strMusicURL!=null&&this.playMusicByURL(this.m_strMusicURL):this.musicChannel&&this.musicChannel.stop()}init(){Laya.SoundManager.autoStopMusic=!1;let t=Laya.LocalStorage.getItem(Ke.COOKIE_CF_MUSIC);t!=null&&t!=""&&(Ke.instance.m_bPlayMusic=parseInt(t)==1);let e=Laya.LocalStorage.getItem(Ke.COOKIE_CF_SOUND);e!=null&&e!=""&&(Ke.instance.m_bPlayeSound=parseInt(e)==1)}get m_bPlayeSound(){return this._m_bPlayeSound}set m_bPlayeSound(t){this._m_bPlayeSound=t}playMusicByURL(t){this.m_bPlayMusic&&(this.m_strMusicURL,this.m_strMusicURL==t&&this.musicChannel,this.m_strMusicURL=t,Laya.SoundManager.stopMusic(),this.musicChannel=Laya.SoundManager.playMusic(t,0,new Laya.Handler(this,this.onComplete)))}playMusicByName(t,e=".ogg"){let i=S.instance.getSoundURL(t,e);this.playMusicByURL(i)}playSound(t,e=1){this.m_bPlayeSound&&Laya.SoundManager.playSound(t,e,new Laya.Handler(this,this.onComplete))}playSoundByName(t,e=1){let i=S.instance.getSoundURLogg(t);this.playSound(i,e)}stopSoundByName(t){let e=S.instance.getSoundURLogg(t);Laya.SoundManager.stopSound(e)}switchMusic(t){let e=t?1:0;Ke.instance.m_bPlayMusic=t,Laya.LocalStorage.setItem(Ke.COOKIE_CF_MUSIC,e.toString())}switchSound(t){let e=t?1:0;Ke.instance.m_bPlayeSound=t,Laya.LocalStorage.setItem(Ke.COOKIE_CF_SOUND,e.toString())}onComplete(){}};Ke.COOKIE_CF_MUSIC="COOKIE_CF_MUSIC",Ke.COOKIE_CF_SOUND="COOKIE_CF_SOUND",Ke.soundName_bg="bgm",Ke.soundName2="ui02.ogg",Ke.soundName3="ui03.ogg",Ke.soundName4="hit.wav",Ke.soundName30_1="ui30_1.ogg",Ke.soundName28_1_star="ui28_1_star.ogg",Ke.soundName28_2_star="ui28_2_stars.ogg",Ke.soundName28_3_star="ui28_3_stars.ogg",Ke.soundName28_bar="ui28_bar_rise.ogg",Ke.soundName32="ui32.ogg",Ke.soundName33="ui33.ogg",Ke.soundName34="ui34.ogg",Ke.soundName35="ui35.ogg",Ke.soundName36="ui36.ogg",Ke.soundName37="ui37.ogg",Ke.soundName38="ui38.ogg",Ke.soundName39="ui39.ogg",Ke.soundName41="ui41.ogg",Ke.soundName42="ui42.ogg",Ke.soundName43="ui43.ogg",Ke.soundName44="ui44.ogg",Ke.soundName45="ui45.ogg",Ke.soundNameUi40_1="ui40_1.ogg",Ke.soundNameUi40_2="ui40_2.ogg",Ke.soundNameUi40_3="ui40_3.ogg",Ke.soundNameDressing="dressing_score_sfx.ogg",Ke.soundNameAnswer="answer_bonus_points.ogg";var Xe=Ke;var y=class{};y.FindView="FindView",y.FindEndView="FindEndView",y.FindAskDialog="FindAskDialog",y.FindRankUpDialog="FindRankUpDialog",y.QuickTipDialog="QuickTipDialog",y.QuickEndView="QuickEndView",y.QuickShareView="QuickShareView",y.QuickOperatorDialog="QuickOperatorDialog",y.MainView="MainView",y.RoleDialog="RoleDialog",y.RemGetDialog="RemGetDialog",y.QuickRechargeDialog="QuickRechargeDialog",y.CreateNameDialog="CreateNameDialog",y.DailyTaskDialog="DailyTaskDialog",y.ActivityTaskDialog="ActivityTaskDialog",y.ShareDialog="ShareDialog",y.InvitationCenterDialog="InvitationCenterDialog",y.DailyTaskDrawDialog="DailyTaskDrawDialog",y.GuideView="GuideView",y.GuideDialogView="GuideDialogView",y.ShareView="ShareView",y.MainTopView="MainTopView",y.GetMoreDialog="GetMoreDialog",y.ShopView="ShopView",y.ItemGetDialog="ItemGetDialog",y.EquipStarUpDialog="EquipStarUpDialog",y.RewardGetDialog="RewardGetDialog",y.GetTitleDialog="GetTitleDialog",y.NewFunUnLockDialog="NewFunUnLockDialog",y.DialogView="DialogView",y.MallView="MallView",y.MallCardView="MallCardView",y.MallBuyDialog="MallBuyDialog",y.FittingUiView="FittingUiView",y.TaskDialog="TaskDialog",y.CommentDialog="CommentDialog",y.PotraitChangDialog="PotraitChangDialog",y.ClothespressView="ClothespressView",y.ItemSellDialog="ItemSellDialog",y.ItemInfoDialog="ItemInfoDialog",y.OnlineAward="OnlineAward",y.MaillView="MailView",y.MailSendView="MailSendView",y.GameSettingDialog="GameSettingDialog",y.GamesettingSoundView="GamesettingSoundView",y.GameSettingLanguageDialog="GameSettingLanguageDialog",y.GameSettingVersionDialog="GameSettingVersionDialog",y.FriendMainView="FriendMainView",y.FriendSearchView="FriendSearchView",y.FriendGetRewardDialog="FriendGetRewardDialog",y.FriendRewardDialog="FriendRewardDialog",y.PreLoadingView="PreLoadingView",y.RechargeDialog="RechargeDialog",y.WalletChooseHeroDialog="WalletChooseHeroDialog",y.EmployInfoDialog="EmployInfoDialog",y.WalletChoosePropsDialog="WalletChoosePropsDialog",y.FirstRechargeDialog="FirstRechargeDialog",y.FirstWeekRechargeView="FirstWeekRechargeView",y.ClientErrView="ClientErrView",y.RoleUpgradeView="RoleUpgradeView",y.ActiveRechargeView="ActiveRechargeView",y.SmallSaleView="SmallSaleView",y.RechargeSelectDialog="RechargeSelectDialog",y.FBLikeView="FBLikeView",y.TurnSuitPreView="TurnSuitPreView",y.SlotMachineView="SlotMachineView",y.SlotMachineRewardPreDialog="SlotMachineRewardPreDialog",y.SlotMachineResultDialog="SlotMachineResultDialog",y.GashaponView="GashaponView",y.GashaponRewardView="GashaponRewardView",y.ActivityRankRewardView="ActivityRankRewardView",y.AddRechargeView="AddRechargeView",y.CupMatchStartDialog="CupMatchStartDialog",y.CupMatchEndDialog="CupMatchEndDialog",y.CreateLoginView="CreateLoginView",y.SelectHeadDialog="SelectHeadDialog",y.RoleInfoDialog="RoleInfoDialog",y.SelectHeroDialog="SelectHeroDialog",y.CreateSubWalletDialog="CreateSubWalletDialog",y.FriendMemberDialog="FriendMemberDialog",y.FriendMemberMoreDialog="FriendMemberMoreDialog",y.FriendAddDialog="FriendAddDialog",y.FriendApplyBackDialog="FriendApplyBackDialog",y.FriendApplyDialog="FriendApplyDialog",y.WalletDialog="WalletDialog",y.WalletTransferDialog="WalletTransferDialog",y.CardPayView="CardPayView",y.UnionApplyDialog="UnionApplyDialog",y.GuildEntranceView="GuildEntranceView",y.UnionApplyDialogView="UnionApplyDialogView",y.UnionApplyMemberDialog="UnionApplyMemberDialog",y.CreateNoticeDialog="CreateNoticeDialog",y.UnionNoticeView="UnionNoticeView",y.GuildInfoDialog="GuildInfoDialog",y.CreateUnionDialog="CreateUnionDialog",y.UnionInfoView="UnionInfoView",y.UnionEarningView="UnionEarningView",y.UnionRevenueDetailDialog="UnionRevenueDetailDialog",y.UnionSetRevenueDialog="UnionSetRevenueDialog",y.UnionBattleRecordDialog="UnionBattleRecordDialog",y.UnionRevenueRecordDialog="UnionRevenueRecordDialog",y.RankUnionView="RankUnionView",y.UnionWarView="UnionWarView",y.UnionWarTipDialog="UnionWarTipDialog",y.UnionWarSuccessDialog="UnionWarSuccessDialog",y.UnionWarFailDialog="UnionWarFailDialog",y.GamesettingView="GamesettingView",y.GameSettingGameAccountView="GameSettingGameAccountView",y.GuildMessageView="GuildMessageView",y.GuildMessageEditorView="GuildMessageEditorView",y.UnionMemberView="UnionMemberView",y.UnionListView="UnionListView",y.CreateSubUnionView="CreateSubUnionView",y.ChangeUnionIconDialog="ChangeUnionIconDialog",y.MySubUnionView="MySubUnionView",y.UnionMemberApplyView="UnionMemberApplyView",y.UnionReferralView="UnionReferralView",y.UnionTransferView="UnionTransferView",y.TicketTransferView="TicketTransferView",y.HeroTransferView="HeroTransferView",y.BanAccountView="BanAccountView",y.GuildChiefPrivilegeView="GuildChiefPrivilegeView",y.GuildDonationView="GuildDonationView",y.NoticeDialog="NoticeDialog",y.HelpDialog="HelpDialog",y.ImgDialog="ImgDialog",y.ChampDetailDialog="ChampDetailDialog",y.ChampRecordDialog="ChampRecordDialog",y.LoadDialog="LoadDialog",y.ChangeHeadDialog="ChangeHeadDialog",y.CreateRoomDialog="CreateRoomDialog",y.CreateRentalDialog="CreateRentalDialog",y.MyLeasedDialog="MyLeasedDialog",y.MyRentedDialog="MyRentedDialog",y.MyRentalBuyDialog="MyRentalBuyDialog",y.BuyTicketDialog="BuyTicketDialog",y.EnterRoomView="EnterRoomView",y.MatchEndRankView="MatchEndRankView",y.MatchEndTeamRankView="MatchEndTeamRankView",y.MatchReadyView="MatchReadyView",y.MatchEndView="MatchEndView",y.HeroGetDialog="HeroGetDialog",y.InputPwdDialog="InputPwdDialog",y.RoomInfoDialog="RoomInfoDialog",y.MailDialog="MailDialog",y.TeamCreateShareDialog="TeamCreateShareDialog",y.TeamShareDialog="TeamShareDialog",y.TeamJoinUsingDialog="TeamJoinUsingDialog",y.MyTeamDialog="MyTeamDialog",y.TeamInfoDialog="TeamInfoDialog",y.MyFriendDialog="MyFriendDialog",y.UnionAttrView="UnionAttrView",y.UnionAttrLvUpDialog="UnionAttrLvUpDialog",y.UnionAttributeDetailsDialog="UnionAttributeDetailsDialog",y.NoServerView="NoServerView",y.UnionMemberMoreDialog="UnionMemberMoreDialog",y.HeroUpgradeDialog="HeroUpgradeDialog",y.HeroDetailDialog="HeroDetailDialog",y.SkillTipDialog="SkillTipDialog",y.TransferRecordDialog="TransferRecordDialog",y.AFKView="AFKView",y.AFKBagDialog="AFKBagDialog",y.AFKDropDetailDialog="AFKDropDetailDialog",y.AFKMapView="AFKMapView",y.AFKSelectLevelDialog="AFKSelectLevelDialog",y.Knapsack="Knapsack",y.KnapsackTipDialog="KnapsackTipDialog",y.HeroFormationDialog="HeroFormationDialog",y.SignInDialog="SignInDialog",y.InviteRewardDialog="InviteRewardDialog",y.ChallengLoseDialog="ChallengLoseDialog",y.ChallengWinDialog="ChallengWinDialog",y.ChallengBossDialog="ChallengBossDialog",y.ThirbleDropDialog="ThirbleDropDialog",y.LevelDropDialog="LevelDropDialog",y.UseCardDialog="UseCardDialog",y.ArenaView="ArenaView",y.MyBookingView="MyBookingView",y.ArenaLoseDialog="ArenaLoseDialog",y.ArenaBattleDialog="ArenaBattleDialog",y.ArenaWinDialog="ArenaWinDialog",y.ArenaWarNotesView="ArenaWarNotesView",y.ArenaRuleDialog="ArenaRuleDialog",y.EquipSelectDialog="EquipSelectDialog",y.EquipDetailDialog="EquipDetailDialog",y.HireDetailDialog="HireDetailDialog",y.ProxyDetailDialog="ProxyDetailDialog",y.WithDrawRecordDialog="WithDrawRecordDialog",y.NodeRevenueRecordDialog="NodeRevenueRecordDialog",y.RentalRecordDialog="RentalRecordDialog",y.PrivateChatDialog="PrivateChatDialog",y.AirdropRecordDialog="AirdropRecordDialog",y.ActivityInfoDialog="ActivityInfoDialog",y.CharacterStarDialog="CharacterStarDialog",y.LastDrawDialog="LastDrawDialog",y.IgoPageView="IgoPageView",y.IgoJoinDialog="IgoJoinDialog",y.IgoRecordDialog="IgoRecordDialog",y.DailyTaskPropsDialog="DailyTaskPropsDialog",y.DailyTaskNoPropsDialog="DailyTaskNoPropsDialog",y.PveSponsorView="PveSponsorView",y.PveRecordView="PveRecordView",y.PveChoosePropsDialog="PveChoosePropsDialog",y.ReferralDialog="ReferralDialog",y.ReferralL2Dialog="ReferralL2Dialog",y.TotalBattlesDialog="TotalBattlesDialog";var f=class{};f.MOUSE_HOLDON="MOUSE_HOLDON",f.EVENT_OPEN_MODULE="EVENT_OPEN_MODULE",f.EVENT_MODULE_ADDED="EVENT_MODULE_ADDED",f.EVENT_CLOSE_MODULE="EVENT_CLOSE_MODULE",f.EVENT_CHECK_REMAIN="EVENT_CHECK_REMAIN",f.EVENT_LOADED_COMPLETE="EVENT_LOAD_COMPLETE",f.EVENT_LOADED_SCENE_BG_COM="EVENT_LOADED_SCENE_BG_COM",f.EVENT_LOAD_SKIN_COMPLETE="EVENT_LOAD_SKIN_COMPLETE",f.EVENT_LOAD_HEAD_SKIN_COMPLETE="EVENT_LOAD_HEAD_SKIN_COMPLETE",f.EVENT_LOADING_SUC="EVENT_LOADING_SUC",f.EVENT_BACK_TO_LOGIN="EVENT_BACK_TO_LOGIN",f.EVENT_LOGIN_GAME_END="EVENT_LOGIN_GAME_END",f.EVENT_ENTER_MAIN="EVENT_ENTER_MAIN",f.EVENT_CHANGE_HEAD="EVENT_CHANGE_HEAD",f.EVENT_MODIFY_HEAD="EVENT_MODIFY_HEAD",f.EVENT_ITEM_UPDATE="EVENT_ITEM_UPDATE",f.EVENT_ROLE_UPDATE="EVENT_ROLE_UPDATE",f.STAGE_ON_BLUR="STAGE_ON_BLUR",f.STAGE_ON_FOCUS="STAGE_ON_FOCUS",f.ACCOUNTVO_UPDATE="ACCOUNTVO_UPDATE",f.EVENT_WAIT_PLAYERINFO="EVENT_WAIT_PLAYERINFO",f.EVENT_END_HEROBUY="EVENT_END_HEROBUY",f.EVENT_END_HEROTRANSFER="EVENT_END_HEROTRANSFER",f.EVENT_REFRESH_HEROTRANSFER="EVENT_REFRESH_HEROTRANSFER",f.EVENT_REFRESH_QUAN_STATUS="EVENT_REFRESH_QUAN_STATUS",f.EVENT_REFRESH_ITEM_ONCHAIN_STATUS="EVENT_REFRESH_ITEM_ONCHAIN_STATUS",f.EVENT_REFRESH_RENT_HERO_ONCHAIN_STATUS="EVENT_REFRESH_RENT_HERO_ONCHAIN_STATUS",f.EVENT_REFRESH_NODE_ONCHAIN_STATUS="EVENT_REFRESH_NODE_ONCHAIN_STATUS",f.EVENT_REFRESH_UNIONMEMBER_TRANSFER="EVENT_REFRESH_UNIONMEMBER_TRANSFER",f.EVENT_REFRESH_KNAPSACK="EVENT_REFRESH_KNAPSACK",f.EVENT_ADD_UNIONMEMBER_ADDRESS="EVENT_ADD_UNIONMEMBER_ADDRESS",f.EVENT_ADD_TICKET_ADDRESS="EVENT_ADD_TICKET_ADDRESS",f.EVENT_EMOJI_ICON_SELECT="EVENT_EMOJI_ICON_SELECT",f.EVENT_COLOR_ICON_SELECT="EVENT_COLOR_ICON_SELECT",f.EVENT_CHECK_ICON_SELECT="EVENT_CHECK_ICON_SELECT",f.EVENT_CHECK_PLAYER_NUM_SELECT="EVENT_CHECK_PLAYER_NUM_SELECT",f.EVENT_CHECK_NODE_SELECT="EVENT_CHECK_NODE_SELECT",f.PACKAGE_UPDATE_ITEM="PACKAGE_UPDATE_ITEM",f.IMPROVE_SUCESS_EVENT="IMPROVE_SUCESS_EVENT",f.CHANG_POTRAIT="CHANG_POTRAIT",f.ROLE_INFO_CHANGE="ROLE_INFO_CHANGE",f.UPDATE_ASSETS="UPDATE_ASSETS",f.REFRESH_MAIN_TASK="REFRESH_MAIN_TASK",f.RECIVE_SUCESS_SERVICE="RECIVE_SUCESS_SERVICE",f.SCENE_ROLE_COMPELTE="SCENE_ROLE_COMPELTE",f.FITTING_CLOTH_BTN="FITTING_CLOTH_BTN",f.STORE_CLICKBG_EVENT="STORE_CLICKBG_EVENT",f.CLOSE_BG_VIEW="CLOSE_BG_VIEW",f.EVENT_UPDATE_ONLINE="EVENT_UPDATE_ONLINE",f.VIP_INFO_CHANGE="VIP_INFO_CHANGE",f.EVENT_FUNCTION_OPEN_UPDATE="EVENT_FUNCTION_OPEN_UPDATE",f.EVENT_ADD_ACTIVITY="EVENT_ADD_ACTIVITY",f.EVENT_REMOVE_ACTIVITY="EVENT_REMOVE_ACTIVITY",f.UPDATE_CHAO_PIAO="UPDATE_CHAO_PIAO",f.UPDATE_EXCHANGE_INFO="UPDATE_EXCHANGE_INFO",f.UPDATE_RED_STATE_EVENT="UPDATE_RED_STATE_EVENT",f.SYSTEM_OPEN_TIME_INITED="SYSTEM_OPEN_TIME_INITED",f.EVENT_OPEN_SHARE="EVENT_OPEN_SHARE",f.CHANGE_SCENE_BASE_ROLE_LAYER="CHANGE_SCENE_BASE_ROLE_LAYER",f.EVENT_CLICK_NUM="EVENT_CLICK_NUM",f.EVENT_HERO_DRAW_BACK="EVENT_HERO_DRAW_BACK",f.EVENT_Close_CreateRoom="EVENT_Close_CreateRoom",f.EVENT_ENTER_MATCH_ROOM="EVENT_ENTER_MATCH_ROOM",f.EVENT_UPDATE_MATCH_ROOM="EVENT_UPDATE_MATCH_ROOM",f.EVENT_CLICK_HERO="EVENT_CLICK_HERO",f.UPDATE_KILL_NUM="UPDATE_KILL_NUM",f.EVENT_RESTORE_DATA="EVENT_RESTORE_DATA",f.EVENT_FirstBlood="EVENT_FirstBlood",f.EVENT_MutiKill="EVENT_MutiKill",f.EVENT_GameScene_Gray="EVENT_GameScene_Gray",f.EVENT_Game_Delay="EVENT_Game_Delay",f.EVENT_UPDATE_ITEM_SKILL_COOL="UPDATE_SKILL_COOLTIME",f.EVENT_UPDATE_GLOBAL_COOL="EVENT_UPDATE_GLOBAL_COOL",f.EVENT_UPDATE_REDECE_COOL="EVENT_UPDATE_REDECE_COOL",f.EVENT_REFRESH_BAN_ACCOUNT="EVENT_REFRESH_BAN_ACCOUNT",f.EVENT_SUB_GUILD_UPDATE="EVENT_SUB_GUILD_UPDATE",f.EVENT_UNION_APPLY_MEMBER_UPDATE="EVENT_UNION_APPLY_MEMBER_UPDATE",f.EVENT_WELFARE_CLAIM="EVENT_WELFARE_CLAIM",f.EVENT_RECHARGE_GET="EVENT_RECHARGE_GET",f.CHANGE_WALLET_HERO="CHANGE_WALLET_HERO",f.CHANGE_ASSET_CHAIN="CHANGE_ASSET_CHAIN",f.CHANGE_WALLET_PROP="CHANGE_WALLET_PROP",f.CREATE_SUB_WALLET_SUCCESS="CREATE_SUB_WALLET_SUCCESS",f.REFRESH_ALL_WITHDRAW_DATA="REFRESH_ALL_WITHDRAW_DATA",f.CHANGE_FRIEND_APPLY_LIST="CHANGE_FRIEND_APPLY_LIST",f.CHANGE_FRIEND_LIST="CHANGE_FRIEND_LIST",f.REFRSH_RED="REFRSH_RED",f.REFRSH_APPLY_FRIEND_LIST="REFRSH_APPLY_FRIEND_LIST",f.ADD_AIR_WALLET_ITEM="ADD_AIR_WALLET_ITEM",f.ADD_AIR_SUB_WALLET_NAME="ADD_AIR_SUB_WALLET_NAME",f.AIR_SUB_WALLET_OPENHERO="AIR_SUB_WALLET_OPENHERO",f.CHANGE_WALLET_HERO_AIR="CHANGE_WALLET_HERO_AIR",f.UPDATE_UNION_MEMBER_LIST="UPDATE_UNION_MEMBER_LIST",f.EVENT_ADD_MONEY_ADDRESS="EVENT_ADD_MONEY_ADDRESS",f.REFRESH_MAINSCENE_HEAD_RED="REFRESH_MAINSCENE_HEAD_RED",f.REFRESH_ROLEINFO_RED="REFRESH_ROLEINFO_RED",f.REFRESH_ACTIVITY_RED="REFRESH_ACTIVITY_RED",f.SHOW_EQUIP_TIP="SHOW_EQUIP_TIP",f.REFRESH_RANK_DIALOG_RED="REFRESH_RANK_DIALOG_RED",f.REFRESH_MAIL_RED="REFRESH_MAIL_RED",f.SHOW_EQUIP_SHOP_TIP="SHOW_EQUIP_SHOP_TIP",f.REFRESH_IGO_RED="REFRESH_IGO_RED",f.SEND_WHEEL_RESULT="SEND_WHEEL_RESULT",f.REFRESH_WHEEL_RED="REFRESH_WHEEL_RED",f.EVENT_PVE_CHOOSE_PROP="EVENT_PVE_CHOOSE_PROP",f.CHANGE_PVE_EXP_HERO="CHANGE_PVE_EXP_HERO",f.EVENT_PVE_HAVE_PROP="EVENT_PVE_HAVE_PROP";var g=class n extends Laya.EventDispatcher{static get intance(){return n._instance||(n._instance=new n),n._instance}};var Wr=class extends Laya.Script{constructor(){super();this.m_ioffsetX=0;this.m_ioffsetY=0}onAdded(){this.m_iLayerType=C.M_POP,this.m_iPositionType=C.CENTER,this.m_canTouch_all=!1,this.selfMaskAlpha=.8,this.m_arrMapEvent=[],this.canClickMask=!0,this.maskLayer=new Laya.Sprite,this.useShowAnimation=!0,this.useHideAnimation=!0,this.isAutoRealseRes=!0,this.m_strSound=Xe.soundName3}onClickMask(e){this.canClickMask&&this.maskClose()}maskClose(){this.close()}onStageResize(){}onEnable(){this._view=this.owner,this._view.addChild(this.maskLayer),this.createUI(),this.createUIEnd(),this.initializeLater()}createUI(){}createUIEnd(){}initializeLater(){this._addEvent(),this.initData(),this.useShowAnimation?(this._view.visible=!1,this.showAnimationEnd=!1,Laya.timer.frameOnce(5,this,this.popTimeOut,[this._view])):this.showAnimationEnd=!0}popTimeOut(e){Laya.timer.clear(this,this.popTimeOut),e.scale(.5,.5),e.visible=!0,Laya.Tween.to(e,{scaleX:1,scaleY:1,ease:Laya.Ease.backOut},300,null,Laya.Handler.create(this,this.onShowAnimationEnd),2),Xe.instance.playSoundByName(this.m_strSound),this._view.event(Laya.Event.OPEN)}onShowAnimationEnd(){this.showAnimationEnd=!0}_addEvent(){this.maskLayer.on(Laya.Event.CLICK,this,this.onClickMask),Laya.stage.on(Laya.Event.RESIZE,this,this.onStageResize),this.btn_com_back&&this.btn_com_back.on(Laya.Event.CLICK,this,this.onBack),this.btn_com_help&&this.btn_com_help.on(Laya.Event.CLICK,this,this.onHelp),this.addEvent()}addEvent(){}initData(){}_removeEvent(){this.maskLayer.offAll(),Laya.stage.off(Laya.Event.RESIZE,this,this.onStageResize),this.removeEvent()}removeEvent(){}addMapEvent(e,i,a,r,s=null){e.on(i,a,r,s),this.m_arrMapEvent.push(e)}removeAllMapEvent(){if(this.m_arrMapEvent){for(let e=0;e<this.m_arrMapEvent.length;e++)this.m_arrMapEvent[e].offAll();this.m_arrMapEvent.splice(0,this.m_arrMapEvent.length)}}dispose(){if(this.newRoleSpr){for(;this.newRoleSpr.numChildren>0;)this.newRoleSpr.removeChildAt(0);this.newRoleSpr=null}this.isDispose=!0,A.intance.removeViewFromModuleManger(this),this.m_strName=null,this.m_strSound=null,this._removeEvent(),this.removeAllMapEvent(),Laya.Tween.clearAll(this._view),this.m_arrMapEvent=null,this.btn_com_back&&this.btn_com_back.offAll(),this.btn_com_help&&this.btn_com_help.offAll(),this.maskLayer&&(Laya.timer.clearAll(this.maskLayer),Laya.Tween.clearAll(this.maskLayer),this.maskLayer.offAll(),this.maskLayer.graphics.destroy(),this.maskLayer.removeSelf(),this.maskLayer.destroy(!0)),this.isAutoRealseRes&&S.instance.clearModuleUrl(this.m_strName),this._view&&(Laya.timer.clearAll(this._view),Laya.Tween.clearAll(this._view),this._view.offAll(),this._view.graphics.destroy(),this._view.removeSelf(),this._view.destroy(!0),this._view=null),Laya.timer.clearAll(this),Laya.Tween.clearAll(this),g.intance.event(f.EVENT_CLOSE_MODULE)}sendData(e,i=null){i==null&&(i=[])}close(e=null){this.useHideAnimation&&this._view?Laya.Tween.to(this._view,{scaleX:.5,scaleY:.5,ease:Laya.Ease.backIn},200,null,Laya.Handler.create(this,this.dispose,null),2):this.dispose()}static closeAll(){A.intance.closeAll()}backToPreScene(){let e=oe.intance.getPreSceneData();oe.intance.setCurrentScene(e[0],e[1],e[2],e[3],!1)}get btn_com_back(){return this._view?this._view.getChildByName("btn_com_back"):null}get btn_com_help(){return this._view?this._view.getChildByName("btn_com_help"):null}onHelp(){this.m_helpId&&A.intance.openModule(y.HelpDialog,this.m_helpId)}onBack(){this.close()}};var A=class n extends Laya.DialogManager{constructor(){super();this.views=new le;this.m_arrLoadingArr=[];if(n._instance)throw new Error("LayerManager是单例,不可new.");n._instance=this,Laya.Dialog.manager=this}static get intance(){return n._instance||(n._instance=new n),n._instance}openModule(e,i=null){g.intance.event(f.EVENT_OPEN_MODULE,[e,i])}hasOpenView(e){return this.views.get(e)!=null}getOpenView(e){return this.views.get(e)}disposeView(e){if(this.getOpenView(e)){let i=this.getOpenView(e);if(i instanceof Array)for(let a=0;a<i.length;a++)i[a].close();else i.close()}}init(){g.intance.on(f.EVENT_OPEN_MODULE,this,this.onModulePanel),g.intance.on(f.EVENT_CLOSE_MODULE,this,this.disposeView)}initMainView(){}onModulePanel(e,i=null){console.log("ModuleManager.onModulePanel moudleName:"+e),this.m_arrLoadingArr.indexOf(e)==-1&&(this.getOpenView(e)||(de.instance.showLoading(!1),this.m_arrLoadingArr.push(e),S.instance.loadModuleUrl(e,Laya.Handler.create(this,this.onLoaded,[e,i]))))}onLoaded(e,i=null){let a=this.m_arrLoadingArr.indexOf(e);a!=-1&&this.m_arrLoadingArr.splice(a,1);let r;var s=S.instance.m_objModuleViews[e];console.log("onLoaded: ",e,s),Laya.loader.load(s).then(o=>{if(r=o.create(),i&&r.setOpenData(i),r.m_strName=e,r instanceof Laya.Box)C.instence.addToLayer(r,r.m_iLayerType),C.instence.setPosition(r,r.m_iPositionType,r.m_ioffsetX,r.m_ioffsetY),this.addViewToModuleManger(r);else if(r instanceof Laya.Dialog){let l=r;l.m_iLayerType==C.M_POP?(l.isModal=!0,l.isShowEffect=!0,this.open(l,!1,!0)):(l.isShowEffect=!1,this.open(l)),this.addViewToModuleManger(l)}r&&g.intance.event(f.EVENT_MODULE_ADDED,r),r.hideLoadingBySelf||de.instance.hideLoading()}).catch(o=>{console.error("onLoaded 加载失败",o)})}addViewToModuleManger(e){let i=e.m_strName;this.views.get(i)?this.views.get(i)instanceof Array?this.views.get(i).push(e):this.views.set(i,[this.views.get(i),e]):this.views.set(i,e),this.on(Laya.Event.CLOSE,this,this.removeViewFromModuleManger)}removeViewFromModuleManger(e){if(!e||!this.views)return;let i=e.m_strName;console.log("removeViewFromModuleManger viewName: "+i),e.off(Laya.Event.CLOSE,this,this.removeViewFromModuleManger);let a=this.views.get(i);if(a instanceof Array){let r=a.indexOf(e);r!=-1&&(a.splice(r,1),a.length==0&&this.views.remove(i))}else this.views.remove(i)}closeAll(){let e=[];for(let i of this.views.values)if(i instanceof Array)for(let a=0;a<i.length;a++){let r=i[a];r instanceof Wr&&e.push(r)}else i instanceof Wr&&e.push(i);for(let i=0;i<e.length;i++)e[i].dispose();e=[],super.closeAll()}doClose(e){super.doClose(e),this.event(Laya.Event.CLOSE,e)}};var Co=class n{constructor(){this._mapUrl="";this._mapWidth=0;this._mapHeight=0;this._gridWidth=0;this._gridHeight=0;this._xPics=0;this._yPics=0;this._fuzzyName=""}static get instance(){return n._instance||(n._instance=new n),n._instance}loadScene(t,e,i,a,r,s,o){this._fuzzyName!=""&&this._fuzzyName!=s&&this.dispose(),this._mapWidth=t,this._mapHeight=e,this._gridWidth=i,this._gridHeight=a,this._fuzzySprite=r,this._xPics=Math.floor(this._mapWidth/i),this._yPics=Math.floor(this._mapHeight/a),this._fuzzyName=s,this._fuzzyCallBack=o;let l=S.instance.setResURL("scene/subScene/test1/"+s+".json");Laya.loader.load([{url:l,type:Laya.Loader.ATLAS}],Laya.Handler.create(this,this.loadSceneComplete),Laya.Handler.create(this,this.loadProcess,null,!1),null,0,!0,null,!0)}loadProcess(){}loadSceneComplete(){let t=Laya.Loader.getAtlas(S.instance.setResURL("scene/subScene/test1/"+this._fuzzyName+".json"));if(this._fuzzySprite){this._fuzzySprite.graphics.clear();let e=0,i=new Laya.Sprite;i.name="mapSprite",this._fuzzySprite.addChildAt(i,0);for(let a=0;a<this._yPics;a++)for(let r=0;r<this._xPics;r++){let s=Laya.loader.getRes(t[e]),o=new Laya.Image;i.addChild(o),o.texture=s,o.size(s.width,s.height),o.pos(r*this._gridWidth,a*this._gridHeight),e++}}this._fuzzyCallBack!=null&&this._fuzzyCallBack.run()}dispose(){this._fuzzyCallBack=null,this._fuzzyName&&this._fuzzyName!=""&&Laya.loader.clearRes(S.instance.setResURL("atlas/"+this._fuzzyName+".json"))}};var Y=class{};Y.M_SCENE_MAIN="M_SCENE_MAIN",Y.M_SCENE_SHOP="M_SCENE_SHOP",Y.M_SCENE_AIRDROP="M_SCENE_AIRDROP",Y.M_SCENE_HERO="M_SCENE_HERO",Y.M_SCENE_PRE_LOAD="M_SCENE_PRE_LOAD",Y.M_SCENE_MATCH_READY="M_SCENE_MATCH_READY",Y.M_SCENE_MATCH="M_SCENE_MATCH",Y.M_SCENE_AFKBATTLE="M_SCENE_AFKBATTLE",Y.M_SCENE_GUILD="M_SCENE_GUILD",Y.M_SCENE_RANK="M_SCENE_RANK",Y.M_SCENE_SHOLARSHIP="M_SCENE_SHOLARSHIP",Y.M_SCENE_GET_MAT="M_SCENE_GET_MAT",Y.M_SCENE_OPEN_GAME="M_SCENE_OPEN_GAME",Y.M_SCENE_ASSET="M_SCENE_ASSET",Y.M_SCENE_DIG="M_SCENE_DIG",Y.M_SCENE_MAIL="M_SCENE_MAIL",Y.M_SCENE_KNAPSACK="M_SCENE_KNAPSACK",Y.M_SCENE_UNION="M_SCENE_UNION",Y.M_SCENE_MYUNION="M_SCENE_MYUNION",Y.M_SCENE_LCPOOL="M_SCENE_LCPOOL",Y.M_SCENE_ARENA="M_SCENE_ARENA",Y.M_SCENE_FRIEND="M_SCENE_FRIEND",Y.M_SCENE_IGO_PAGE="M_SCENE_IGO_PAGE",Y.M_SCENE_DAILY_TASK="M_SCENE_DAILY_TASK",Y.M_SCENE_PVE="M_SCENE_PVE";var ru=class extends me{constructor(){super()}};var su=class{constructor(t,e,i){this._idKeyName="";this._jsonName="";this._sheetItemCls=null;this._isParse=!1;this._idKeyName=e,this._jsonName=t,this._sheetItemCls=i,this._idToValueMap=new le,this._items=[]}parseJson(){if(this._isParse)return;let t=S.instance.getResByURL("config/"+this._jsonName+".json");if(!t)throw new Error("无效的配置数据"+this._jsonName);for(let e of t){let i=new this._sheetItemCls;i.beFill(e),this._idToValueMap.set(e[this._idKeyName],i),this._items.push(i),this.addItemProcess(i)}this._isParse=!0}addItemProcess(t){}getItemById(t){return this.excuteIsParse()&&this._idToValueMap.get(t)?this._idToValueMap.get(t):null}getAllItems(){return this.excuteIsParse()?this._items:null}excuteIsParse(){return this._isParse,this._isParse}};var ou=class extends su{constructor(){super("","","");this._itemsTypeMap=null;this._itemsTypeMap=new le}getCombineKey(e,i,a){return e+a.toString()+i}getItemsByChildType(e,i){let a=this.getCombineKey(e,i,"childType_itemType");if(this._itemsTypeMap.get(a))return this._itemsTypeMap.get(a);this._itemsTypeMap.set(a,[]);let r=_.intance.m_dicItems.values;for(let s of r)s.child_type==e&&s.itm_type==i&&this._itemsTypeMap.get(a).push(s);return this._itemsTypeMap.get(a)}};var lu=class extends me{realIcon(){return"https://cdn.bunnyswap.cc/images/items/"+this.icon}get starArr(){if(this._starArr)return this._starArr;if(this._starArr=[],this.max_quality==0)return this._starArr;let e=this.quality/this.max_quality*5;for(let i=1;i<=5;i++)e>=i?this._starArr.push(0):i-e<=.5?this._starArr.push(2):this._starArr.push(1);return this._starArr}};var cu=class extends me{};var uu=class extends me{constructor(){super()}};var mu=class extends me{constructor(){super()}};var pu=class extends me{};var hu=class extends me{};var du=class extends me{};var fu=class extends me{};var yu=class extends me{constructor(){super()}};var bu=class extends me{};var gu=class extends me{};var Lu=class extends me{};var _u=class extends me{};var vu=class extends me{};var xu=class extends me{};var So=class extends me{};var Iu=class extends me{constructor(){super()}};var Eu=class extends me{};var wu=class extends me{constructor(){super(...arguments);this.dT=1e4}async testUrl(){this.getUrl()}getUrl(){var e=this.url;let i=new Date().getTime(),a=this,r=new XMLHttpRequest;r.open("GET",e,!0),r.onload=function(){if(r.status>=200&&r.status<300)try{let o=r.responseText;var s=new Date().getTime()-i;a.dT=s}catch{console.log("Response is not valid JSON")}else console.error(`Error: ${r.status}`)},r.onerror=function(){console.error("Network error")},r.send()}};var Tu=class extends me{};var Cu=class extends me{};var Su=class extends me{};var Du=class extends me{constructor(){super()}};var Au=class extends me{constructor(){super()}};var ku=class extends me{constructor(){super()}};var Bu=class extends me{};var Mu=class extends me{};var Ru=class extends me{};var Pu=class extends me{};var Nu=class extends me{};var Ou=class extends me{constructor(){super()}};var Hu=class extends me{constructor(){super()}};var Uu=class extends me{};var Yr=class extends me{};var Vu=class extends me{constructor(){super()}};var Fu=class extends me{};var Gu=class extends me{};var Ku=class extends me{};var qu=class extends me{};var Wu=class extends me{};var je=class je{constructor(){if(je._instance)throw new Error("SheetDataManager是单例,不可new.");je._instance=this,this._modelList=new le}static get intance(){return je._instance||(je._instance=new je),je._instance}init(){let t=Laya.Browser.now();b.instance.systemOpenModel.parseJson(),this.m_dicMail=this.initConfigObject("mailmessage",Eu),this.m_dicItems=this.initConfigObject("item",lu),this.m_dicLikeIt=this.initConfigObject("likeIt",ku),this.m_dicShops=new le,this.m_dicShopMulDic=this.initConfig("shop",["type","icon"],cu,!0,Laya.Handler.create(this,this.onSetShopItem,null,!1)),this.m_dicWinNumbers=this.initConfig("winNumbers",["id"],Wu),this.m_dicUnions=this.initConfig("union",["id"],bu),this.m_dicMonsters=this.initConfigObject("monster",Fu),this.m_dicPveLuckyDraws=this.initConfigObject("pveLuckyDraw",Ku),this.m_dicHeros=this.initConfigObject("hero",pu),this.m_dicSkills=this.initConfigObject("skill",du),this.m_dicBuffs=this.initConfigObject("buff",fu),this.m_dicEffects=this.initConfigObject("effect",Nu),this.m_dicArenaDic=new le,this.m_dicArenaNumMulDic=new le,this.m_dicArenaMulDic=this.initConfig("arena",["type","lv","coinType"],hu,!0,Laya.Handler.create(this,this.onSetArena,null,!1)),this.m_dicArenaTypes=this.initConfig("arenaType",["id"],Tu),this.m_dicCharacterStars=this.initConfig("characterStar",["id"],qu);var e=this.initConfig("node",["id"],wu);this.m_dicNodes=this.initNodes(e),this.m_dicWelfareBags=this.initConfig("welfarebag",["id"],Lu),this.m_dicMaps=this.initConfigObject("map",gu),console.log("-----------------------sheetdata-time1:"+(Laya.Browser.now()-t)),this.m_dicHead=this.initConfig("head",["id"],mu),this.m_dicIconBadge=this.initConfig("iconBadge",["id"],Iu),this.m_dicCountry=this.initConfig("country",["id"],yu),this.m_dicGroupWar=this.initConfig("groupWar",["id"],Ou),this.m_dicTeamName=this.initConfigObject("teamName",Hu),this.m_dicHeroRent=this.initConfig("heroRent",["id"],Vu),this.m_dicExpression=this.initConfig("expression",["id"],Du),this.m_dicFontColor=this.initConfig("fontColor",["id"],Au),this.m_dicCurrencyAddressMulDic=new le,this.m_dicCurrencyAddress=this.initConfig("currencyAddress",["sn"],_u,!0,Laya.Handler.create(this,this.onSetCurrencyAddress,null,!1)),this.m_dicCoinAddress=this.initConfig("coinAddress",["id"],xu),this.m_dicBuyHeroes=this.initConfig("buyHeroes",["id"],So),this.m_dicACoin=this.initConfigObject("aCoin",vu),this.m_dicBuyHeroes=this.initConfig("buyHeroes",["id"],So),this.m_dicPuzzleExchange=this.initConfig("puzzleExchange",["id"],Cu),this.m_dicDropCashAddresse=this.initConfig("DropCashAddress",["sn"],Su),this.m_dicOtcTelegram=this.initConfig("otcTelegram",["id"],Bu),this.m_dicTurntable=this.initConfig("turntable",["id"],Uu),this.m_dicWheel=this.initConfig("wheel",["id"],Yr),this.m_dicWheel1=this.initConfig("wheel1",["id"],Yr),this.m_dicWheel2=this.initConfig("wheelPC",["id"],Yr),this.m_dicEquip=this.initConfig("equip",["id"],Mu),this.m_dicAttributes=this.initConfig("attributes",["id"],Ru),this.m_dicEquipSuit=this.initConfig("equipSuit",["id"],Pu),this.m_dicHeroStar=this.initConfig("heroStar",["id"],Gu),this.m_dicGenerate=this.initConfigObject("general",ru),this.m_dicWorldMapChildTypeItem=new le,console.log("-----------------------sheetdata-time2:"+(Laya.Browser.now()-t))}getCharacterStars(t){t>4&&(t=4);for(let e of this.m_dicCharacterStars.values)if(e.starLv>t)return e;return null}getArenaTypesInSub(){var t=[];for(let e of this.m_dicArenaTypes.values)e.inSub==1&&t.push(e);return t}getArenaTypesInSubByType(t){var e=[];for(let i of this.m_dicArenaTypes.values)if(i.arenaType==t)return i;return[]}getArenaTypesInSubByItemId(t,e){for(let i of this.m_dicArenaDic.values)if(i.type==t&&i.item[0]==e)return i}onSetShopItem(t){var e=this.m_dicLikeIt.get(t.id);e&&(t.totalLike=e.likeN),this.m_dicShops.set(t.id,t)}onSetCurrencyAddress(t){var e=t.token.toLowerCase();this.m_dicCurrencyAddressMulDic.set(this.getCompoundKey([t.isSN,e,t.chainId]),t)}onSetArena(t){this.m_dicArenaDic.set(t.id,t),this.m_dicArenaNumMulDic.set(this.getCompoundKey([t.type,t.lv,t.coinType]),t)}preInit(){this.m_dicScene=this.initConfig("scene",["name"],uu)}getItemModel(){return this.getDataModel(je.DataType_Items)}getGeneralValueById(t){return this.m_dicGenerate&&this.m_dicGenerate.get(t)?this.m_dicGenerate.get(t).value:0}getSocialShareValueById(t){return this.m_dicSocialShare&&this.m_dicSocialShare.get(t)?this.m_dicSocialShare.get(t).parameter:0}getDataModel(t){if(!this._modelList.get(t))switch(t){case je.DataType_Items:this._modelList.set(t,new ou);break}return this._modelList.get(t)}getWelfareBagId(t){var e=this.m_dicWelfareBags;for(let a=0;a<e.values.length;a++){var i=e.values[a];if(t>=i.rankingMin&&t<=i.rankingMax)return i.id}return 0}initNodes(t){var e=new le;for(let a=0;a<t.values.length;a++){var i=t.values[a];i.open==1&&(z.vType==2?i.type==2&&(e.set(i.id,i),i.testUrl()):i.type==1&&(e.set(i.id,i),i.testUrl()))}return e}testNodes(){var t=this.m_dicNodes;for(let i=0;i<t.values.length;i++){var e=t.values[i];e.testUrl()}}getNodeByAddr(t){var e=this.m_dicNodes;for(let a=0;a<e.values.length;a++){var i=e.values[a];if(i&&i.socketUrl==t)return i}return null}getCurrencyAddress(t){let i=je.intance.m_dicCurrencyAddress.values;for(let r=0;r<i.length;r++){var a=i[r];if(z.vType==a.isSN&&t==a.id)return a.token}}getNodeRevenueCurrency(t){let i=je.intance.m_dicCurrencyAddress.values;for(let r=0;r<i.length;r++){var a=i[r];if(z.vType==a.isSN&&t==a.id&&a.nodeRevenueAddress)return a}return null}getNodeCurrencyByTokenAndChainId(t,e){t=t.toLowerCase();var i=je.intance.getSheetDataByMultiKey(je.intance.m_dicCurrencyAddressMulDic,[z.vType,t,e]);return i}getRentCurrency(t){let i=je.intance.m_dicCurrencyAddress.values;for(let r=0;r<i.length;r++){var a=i[r];if(z.vType==a.isSN&&t==a.id&&a.rentNftAddress)return a}return null}getCurrencyByChainType(t,e){let a=je.intance.m_dicCurrencyAddress.values;for(let s=0;s<a.length;s++){var r=a[s];if(z.vType==r.isSN&&t==r.id&&e==r.chainType)return r}}getCurrency(t,e){let a=je.intance.m_dicCurrencyAddress.values;for(let s=0;s<a.length;s++){var r=a[s];if(z.vType==r.isSN&&t==r.id&&e==r.chainId)return r}}getTokensByChainId(t,e){let a=je.intance.m_dicCurrencyAddress.values;var r=[];for(let o=0;o<a.length;o++){var s=a[o];e==1?z.vType==s.isSN&&s.openRecharge==1&&t==s.chainId&&r.push(s):e==2&&z.vType==s.isSN&&s.openExtract==1&&t==s.chainId&&r.push(s)}return r}getDropCashAddress(t,e){let a=je.intance.m_dicDropCashAddresse.values;for(let s=0;s<a.length;s++){var r=a[s];if(z.vType==r.isSN&&t==r.chainId&&e==r.name)return r}}getOtcTelegrams(t){let i=je.intance.m_dicOtcTelegram.values;for(let r=0;r<i.length;r++){var a=i[r];if(t==a.id)return a}}getPuzzleExchange(t){let i=je.intance.m_dicPuzzleExchange.values;for(let r=0;r<i.length;r++){var a=i[r];if(t==a.id)return a}}getPuzzleExchangeByName(t){let i=je.intance.m_dicPuzzleExchange.values;for(let r=0;r<i.length;r++){var a=i[r];if(t==a.name)return a}}getNetAddress(t){let i=je.intance.m_dicCoinAddress.values;for(let r=0;r<i.length;r++){var a=i[r];if(z.vType==a.type&&t==a.tokenid)return a.tokenAddress}}getBuyHeroAddress(t){let i=je.intance.m_dicBuyHeroes.values;for(let r=0;r<i.length;r++){var a=i[r];if(z.vType==a.type&&t==a.tokenid)return a.tokenAddress}}getACoin(t,e){let a=je.intance.m_dicACoin.values;for(let s=0;s<a.length;s++){var r=a[s];if(t==r.token&&e==r.currency)return r}}static getArrFromDictionary(t,e,i){let a=[];for(let r=0;r<t.values.length;r++)t.values[r][e]+""==i+""&&a.push(t.values[r]);return a}getArrFromDicItemByKey(t,e){let i=[];for(let a=0;a<this.m_dicItems.values.length;a++)this.m_dicItems.values[a][t]+""==e+""&&i.push(this.m_dicItems.values[a]);return i}initConfigObject(t,e=null,i=null){let a="config/"+t+".json",r=S.instance.getResByURL(a).data;return new Kr(r,e)}initConfig(t,e,i=null,a=!1,r=null){let s="config/"+t+".json",o=S.instance.getResByURL(s).data,l=new le;if(!o)return console.log("ERROR : SheetDataManager -->initConfig()  url:"+s),l;let c;for(let u=0;u<o.length;u++){let p=this.compoundKey(o[u],e);i?(c=new i,c.init==null&&console.log("ERROR :BaseItem> SheetDataManager -->initConfig()  url:"+s),c.init(o[u]),l.set(p,c),r&&r.runWith(c)):(l.set(p,o[u]),r&&r.runWith(o[u]))}if(a){let u=S.instance.setResURL(s);Laya.Loader.clearRes(u)}return l}compoundKey(t,e){let i="",a=e.length;if(a>1)for(let r=0;r<a;r++)i+=t[e[r]],r!=a-1&&(i+="_");else i=t[e[0]];return i}getCompoundKey(t){let e="",i=t.length;if(i>1)for(let a=0;a<i;a++)e+=t[a],a!=i-1&&(e+="_");else e=t[0];return e}initConfig2(t,e,i,a=!0){let r="config/"+t+".json",s=S.instance.getResByURL(r).data,o=new le;if(!s)return console.log("ERROR : SheetDataManager -->initConfig2()  url:"+r),o;let l;for(let c=0;c<s.length;c++){let u=s[c][e],p;o.get(u)==null?(p=[],o.set(u,p)):p=o.get(u),l=new i,l.init==null&&console.log("ERROR :<BaseItem> SheetDataManager -->initConfig2()  url:"+r),l.init(s[c]),p.push(l)}if(a&&t!="items"){let c=S.instance.setResURL(r);Laya.Loader.clearRes(c)}return o}getItemsBy(t,e){let i=this.getArrFromDicItemByKey("itm_type",t),a=[];for(let r of i)r.child_type.toString()==e.toString()&&a.push(r);return a}getSheetDataByMultiKey(t,e){let i=this.getCompoundKey(e);return t.get(i)}getEquipDataById(t,e=null){let a=je.intance.m_dicEquip.values;for(let s=0;s<a.length;s++){var r=a[s];if(e){if(t==r.id&&e==r.quality)return r}else if(t==r.id)return r}}getAttributeDataById(t){let i=je.intance.m_dicAttributes.values;for(let r=0;r<i.length;r++){var a=i[r];if(t==a.id)return a}}getEquipSuitDataById(t){let i=je.intance.m_dicEquipSuit.values;for(let r=0;r<i.length;r++){var a=i[r];if(a.parts.indexOf(t)>-1)return a}}getTurntableByid(t){let i=je.intance.m_dicTurntable.values;for(let r=0;r<i.length;r++){var a=i[r];if(t==a.id)return a}}getWheelByType(t){let i=je.intance.m_dicWheel.values,a=[];for(let s=0;s<i.length;s++){var r=i[s];t==r.type&&a.push(r)}return a}getWheel1ByType(t){let i=je.intance.m_dicWheel1.values,a=[];for(let s=0;s<i.length;s++){var r=i[s];t==r.type&&a.push(r)}return a}getWheel2ByType(t){let i=je.intance.m_dicWheel2.values,a=[];for(let s=0;s<i.length;s++){var r=i[s];t==r.type&&a.push(r)}return a}getConsumptionByLevel(t){let i=je.intance.m_dicHeroStar.values,a=[];for(let s=0;s<i.length;s++){var r=i[s];t==r.level&&a.push(r)}return a}};je.DataType_Items="SheetDataManager:items",je.DataType_CatagoryChildType="SheetDataManager:CatagoryChildType",je.DataType_BeautyPiece="SheetDataManager:beautypiece",je.DataType_BeautyExp="SheetDataManager:beautyexp",je.DataType_ClothStyleScore="SheetDataManager:clothStyleScore";var _=je;var P=class{constructor(){}};P.NO_ALL=-1,P.YES=1,P.NO=2,P.SURE=4,P.CANCEL=8,P.CLOSE=16,P.RETURN_YES=1,P.RETURN_NO=2,P.RETURN_NONE=3,P.BASEALERTVIEW="BaseAlertDialog",P.MatchConfimDialog="MatchConfimDialog",P.InviteConfimDialog="InviteConfimDialog",P.ApplyConfimDialog="ApplyConfimDialog",P.BUYCONFIRMVIEW="BuyConfirmView",P.GUILDQUITVIEW="GuildQuitView",P.BuyItemConfirmView="BuyItemConfirmView",P.DOWNLOADALERT="DownLoadAlert";var pe=class n{constructor(){}static instance(){return n._instance||(n._instance=new n),n._instance}AlertByType(t,e=null,i=0,a=null,r=null,s=!1,o=null){i==0&&(i=P.YES|P.NO),this.onLoaded(i,t,e,a,r,s,o)}onLoaded(t,e,i,a=null,r=null,s=!1,o=null){A.intance.openModule(e,{flag:t,okHandler:a,cancelHandler:r,data:i,destroyDoCancel:s,initHandler:o})}};var ge=class{};ge.TYPE_EXP=3003,ge.TYPE_GOLD=3005,ge.TYPE_TOX=3001,ge.TYPE_USDT=3004,ge.TYPE_BTC=3006,ge.TYPE_ETH=3007,ge.TYPE_BTOX=3011,ge.TYPE_GALA=3010,ge.TYPE_BNB=3013,ge.TYPE_GGG=3017,ge.TYPE_KLAY=3015,ge.TYPE_BNRY=3016,ge.TYPE_LLE=3017,ge.TYPE_PC=3022,ge.TYPE_SOL=3023,ge.TYPE_MNT=3024,ge.TYPE_PAS=3025,ge.TYPE_QUAN_PVE=1980,ge.TYPE_QUAN_MNT=4001;var Ve=class Ve{static getColorText(t,e="#FFFF00"){return'<font color="'+e+'">'+t+"</font>"}static getChildByName(t,e,i="name"){if(t&&t.hasOwnProperty(i)&&t[i]==e)return t;let a=t;if(a){let r=a.numChildren,s;for(let o=0;o<r;++o)if(s=a.getChildAt(o),s instanceof Laya.Sprite&&(s=Ve.getChildByName(s,e,i)),s&&s.hasOwnProperty(i)&&s[i]==e)return s}return null}static getChildByAttri(t,e){if(t&&t.hasOwnProperty(e)&&t[e])return t[e];let i=t;if(i){let a=i.numChildren,r;for(let s=0;s<a;++s)if(r=i.getChildAt(s),r instanceof Laya.Sprite){if(r=Ve.getChildByAttri(r,e),r)return r}else if(r&&r.hasOwnProperty(e)&&r[e])return r[e]}return null}static logs(t,e=0,i=!0,a=16777215){if(t=Ve.GetLogTime+" "+t,i)switch(e){case 0:a=16777215;break;case 1:a=16777215;break;case 2:a=16711680;break;case 3:a=16777215;break;case 4:a=13434777;break;case 5:a=16742399;break}}static get GetLogTime(){let t=new Date;return t.getHours()+":"+t.getMinutes()+":"+t.getSeconds()+":"+t.getMilliseconds()}static get GRAY(){return Ve._GRAY||(Ve._GRAY=new Laya.ColorFilter([.3,.59,.11,0,0,.3,.59,.11,0,0,.3,.59,.11,0,0,0,0,0,1,0])),Ve._GRAY}static get GRAY1(){if(!Ve._GRAY1){let t=[.3086,.16094,.082,0,0,.2086,.26094,.082,0,0,.1086,.36094,.082,0,0,0,0,0,1,0];Ve._GRAY1=new Laya.ColorFilter(t)}return Ve._GRAY1}static get GLOW(){return Ve._GLOW||(Ve._GLOW=new Laya.GlowFilter("#ffffff",12,0,0)),Ve._GLOW}static get BLUR(){if(!Ve._BLUR){let t=new Laya.BlurFilter;t.strength=5,Ve._BLUR=[t]}return Ve._BLUR}static share(t=1001,e=2,i=null,a=null,r=0,s=0,o=null){}static get isParseWWhiteUser(){return Ve._isParseWWhiteUser}static get isWhiteName(){return z.isWhiteList}static itemListHandler(t,e){let i=t.dataSource,a=i[0],r=i[1],s=2,o=t.skin;o&&(o.indexOf("xinSmall")!=-1?s=1:o.indexOf("xinBig")!=-1&&(s=3));let l;s==1?l="common/common_clip/clip_xinSmall"+r+".png":s==3?l="common/common_clip/clip_xinBig"+r+".png":l="common/common_clip/clip_xinMiddle"+r+".png",t.skin=l,t.dataSource=a}static setStarList(t,e){t.renderHandler=new Laya.Handler(Ve,Ve.itemListHandler),t.dataSource=e}static get BLACK(){return Ve._BLACK||(Ve._BLACK=new Laya.ColorFilter,Ve._BLACK.setColor("#000000")),Ve._BLACK}static get YELLOW(){return Ve._YELLOW||(Ve._YELLOW=new Laya.ColorFilter,Ve._YELLOW.setColor("#ffe64b")),Ve._YELLOW}static get YELLOW1(){return Ve._YELLOW1||(Ve._YELLOW1=new Laya.ColorFilter,Ve._YELLOW1.setColor("#fee14e")),Ve._YELLOW1}static get RED1(){return Ve._RED1||(Ve._RED1=new Laya.ColorFilter,Ve._RED1.setColor("#ff4537")),Ve._RED1}static get BLUE(){return Ve._BLUE||(Ve._BLUE=new Laya.ColorFilter,Ve._BLUE.setColor("#2f72a7")),Ve._BLUE}static setColor(t="#13e2cf"){let e=new Laya.ColorFilter;return e.setColor(t),e}static heroNotEnought(t=1286){pe.instance().AlertByType(P.BASEALERTVIEW,m.instance.getLanguage(t),P.YES,null)}static popTip(t){pe.instance().AlertByType(P.BASEALERTVIEW,m.instance.getLanguage(t),P.YES,null)}static onGetHero(t=-1){oe.intance.setCurrentScene(Y.M_SCENE_SHOP,[1,t])}static isFightHero(t){return b.instance.playerDto.fightHeroPk==t||t==b.instance.playerDto.newFightHeroPk}static titickNotEnought(t=-1){var e=2,i=_.intance.getSheetDataByMultiKey(_.intance.m_dicShopMulDic,[e,t]);if(i&&i.open==1)pe.instance().AlertByType(P.BASEALERTVIEW,m.instance.getLanguage(1060),P.CANCEL,Laya.Handler.create(this,this.onGetTitck,[t]));else{var a=_.intance.m_dicItems.get(t);a?E.instance.notice(m.instance.getLanguage(1282,m.instance.getLanguage(a.name))):Ee.instance.showErrorWord(18)}}static RemError(){pe.instance().AlertByType(P.BASEALERTVIEW,m.instance.getLanguage(1124),P.YES,null)}static NoHeroError(t){pe.instance().AlertByType(P.BASEALERTVIEW,t,P.YES,null)}static TransactionErrorTip(){pe.instance().AlertByType(P.BASEALERTVIEW,m.instance.getLanguage(1224),P.YES,null)}static alertNoAll(t){pe.instance().AlertByType(P.BASEALERTVIEW,t,P.NO_ALL)}static onGetTitck(t=-1){oe.intance.setCurrentScene(Y.M_SCENE_SHOP,[2,t])}static moneyNotEnought(t=ge.TYPE_TOX){var e=_.intance.m_dicItems.get(t),i=m.instance.getLanguage(e.name);E.instance.notice(m.instance.getLanguage(1170,i))}static onGetMoney(t){oe.intance.setCurrentScene(Y.M_SCENE_ASSET,[1,t])}static openSquidGame(){pe.instance().AlertByType(P.BASEALERTVIEW,m.instance.getLanguage(6056),P.CANCEL,Laya.Handler.create(this,this.onOpenSquidGame))}static onOpenSquidGame(){window.location.href="https://squidgamefi.io/?invitationCode=2oi"}static otherLogin(){pe.instance().AlertByType(P.BASEALERTVIEW,m.instance.getLanguage(6054),P.YES,Laya.Handler.create(this,He.instance.reload))}static netError(){pe.instance().AlertByType(P.BASEALERTVIEW,m.instance.getLanguage(1307),P.YES,Laya.Handler.create(this,He.instance.reload))}static commTipWithYes(t){pe.instance().AlertByType(P.BASEALERTVIEW,t,P.YES)}static shakeSprs(t,e=2,i=4,a=32){if(Ve.isShake)return;Ve.isShake=!0;let r=t.length,s=[];for(let u=0;u<r;u++){let p=t[u];s.push([p.x,p.y])}let o=[0,0],l=0,c=function(){o[l%2]=l++%4<2?0:i,l>e*4+1&&(Laya.timer.clear(Laya.stage,c),l=0,Ve.isShake=!1);for(let u=0;u<r;u++){let p=t[u];p.x=o[0]+s[u][0],p.y=o[1]+s[u][1]}};Laya.timer.loop(a,Laya.stage,c)}static shake(t,e=2,i=4,a=32){if(Ve.isShake)return;Ve.isShake=!0;let r=new Laya.Point(t.x,t.y),s=[0,0],o=0,l=function(){s[o%2]=o++%4<2?0:i,o>e*4+1&&(Laya.timer.clear(Laya.stage,l),o=0,Ve.isShake=!1),t.x=s[0]+r.x,t.y=s[1]+r.y};Laya.timer.loop(a,Laya.stage,l)}static checkIsFull(){}static fullScreen(t){var e,i=Laya.Browser.window.location.href;t?(i+="&isFull=1",e={type:"openChildPage",data:{url:i,fullScreen:"1",close:"0"}}):e={type:"closePage",data:""};var a=JSON.stringify(e);Laya.Browser.onIOS?(console.log("onIOS"),typeof webkit<"u"&&(console.log("onIOS1"),webkit.messageHandlers._tw_.postMessage(a),console.log("onIOS2"))):Laya.Browser.onAndroid&&(console.log("onAndriod0"),window&&typeof window._tw_<"u"&&(console.log("onAndriod1 str: "+a),window._tw_.callInto(a),console.log("onAndriod2")))}};Ve._isParseWWhiteUser=!1,Ve.isWWhiteUser=!1,Ve.isShake=!1,Ve.isFullScreen=!1;var Le=Ve;var fa=class fa{constructor(){this.mainSceneX=10086;this.isCloseAll=!0;this.enterMainSceneTimes=0;this.isTopOpening=!1;this.isBottomOpening=!1;g.intance.on(f.EVENT_MODULE_ADDED,this,this.onAdded)}static get intance(){return fa._instance||(fa._instance=new fa),fa._instance}init(){}setup(){}onAdded(t){}getPreSceneData(){if(this.m_arrFromScenes.length<1)return[Y.M_SCENE_MAIN,!0,1,null];{let t=this.m_arrFromScenes.pop();return console.log("pop-----------route："+this.m_arrFromScenes.join(" | ")),t}return[Y.M_SCENE_MAIN,!0,1,null]}removePreSceneData(){this.m_arrFromScenes=[]}setBackScene(){let t=this.getPreSceneData();this.setCurrentScene(t[0],t[1],!1)}setMainScene(t=1,e=null){this.setCurrentScene(Y.M_SCENE_MAIN,e)}async setCurrentScene(t,e=null,i=!1,a=!0){console.log("setCurrentScene: ",t,e),this.preSceneName=t;let r=!1;if(this.m_sceneCurrent&&this.m_sceneCurrent.name==t){console.log("currentScene："+this.m_sceneCurrent.name+"  openScene：："+t);return}this.isCloseAll?A.intance.closeAll():this.isCloseAll=!0,this.m_sceneCurrent&&(this.m_arrFromScenes||(this.m_arrFromScenes=[]),i&&this.m_sceneCurrent.m_arrOpenSceneData[3]&&this.m_arrFromScenes.push(this.m_sceneCurrent.m_arrOpenSceneData),console.log("open-----------scene："+this.m_arrFromScenes),this.fromScene=this.m_sceneCurrent.name,console.log("fromSceneName: "+this.fromScene),fa.m_arrSceneToDialog.indexOf(t)==-1?(this.m_sceneCurrent==this.m_preScene&&(this.m_preScene=null),this.m_sceneCurrent.toScene=t,this.m_sceneCurrent.removeSelf(),this.m_sceneCurrent=null,Laya.loader.clearUnLoaded(),Co.instance.dispose()):this.m_preScene=this.m_sceneCurrent,!i&&fa.m_arrSceneToDialog.indexOf(t)==-1&&this.m_preScene&&(this.m_sceneCurrent=this.m_preScene,this.m_sceneCurrent.toScene=t,this.m_sceneCurrent.removeSelf(),this.m_sceneCurrent=null,Laya.loader.clearUnLoaded(),Co.instance.dispose()));let s=_.intance.m_dicScene.get(t);switch(s&&s.music!=null&&s.music!="0"&&s.music!=""&&(console.log("SceneManager.setCurrentScene sceneItem.music: "+s.music),Xe.instance.playMusicByName(s.music)),t){case Y.M_SCENE_MAIN:this.m_arrFromScenes=[],this.m_sceneCurrent=await Laya.Scene.open("scenes/mainView/MainScene.ls"),this.enterMainSceneTimes++;break;case Y.M_SCENE_AIRDROP:this.m_sceneCurrent=await Laya.Scene.open("scenes/airdrop/AirdropScene.ls",!0,e);break;case Y.M_SCENE_SHOP:this.m_sceneCurrent=await Laya.Scene.open("scenes/shop/ShopScene.ls",!0,e);break;case Y.M_SCENE_RANK:this.m_sceneCurrent=await Laya.Scene.open("scenes/rank/RankScene.ls");break;case Y.M_SCENE_SHOLARSHIP:this.m_sceneCurrent=await Laya.Scene.open("scenes/scholarship/ScholarshipScene.ls");break;case Y.M_SCENE_FRIEND:this.m_sceneCurrent=await Laya.Scene.open("scenes/friend/FriendScene.ls");break;case Y.M_SCENE_HERO:this.m_sceneCurrent=await Laya.Scene.open("scenes/hero/MyHeroScene.ls");break;case Y.M_SCENE_KNAPSACK:this.m_sceneCurrent=await Laya.Scene.open("scenes/item/KnapsackScene.ls",!0,e);break;case Y.M_SCENE_MAIL:this.m_sceneCurrent=await Laya.Scene.open("scenes/mail/MailScene.ls");break;case Y.M_SCENE_UNION:this.m_sceneCurrent=await Laya.Scene.open("scenes/union/UnionScene.ls");break;case Y.M_SCENE_MYUNION:this.m_sceneCurrent=await Laya.Scene.open("scenes/union/MyUnionScene.ls",!0,e);break;case Y.M_SCENE_LCPOOL:this.m_sceneCurrent=await Laya.Scene.open("scenes/lcPool/LcPoolScene.ls",!0,e);break;case Y.M_SCENE_MATCH_READY:this.m_sceneCurrent=await Laya.Scene.open("scenes/match/MatchReady.ls");break;case Y.M_SCENE_MATCH:this.m_sceneCurrent=await Laya.Scene.open("scenes/match/Match.ls");break;case Y.M_SCENE_ASSET:this.m_sceneCurrent=await Laya.Scene.open("scenes/asset/AssetScene.ls",!0,e);break;case Y.M_SCENE_GET_MAT:this.m_sceneCurrent=await Laya.Scene.open("scenes/getMat/GetMatScene.ls",!1,e);break;case Y.M_SCENE_OPEN_GAME:this.m_sceneCurrent=await Laya.Scene.open("scenes/getMat/OpenGameScene.ls",!1,e);break;case Y.M_SCENE_IGO_PAGE:this.m_sceneCurrent=await Laya.Scene.open("scenes/igoPage/IgoPageScene.ls");break;case Y.M_SCENE_DAILY_TASK:this.m_sceneCurrent=await Laya.Scene.open("scenes/dailyTasks/GhostRaffleScene.ls",!1,e);break;case Y.M_SCENE_PVE:this.m_sceneCurrent=await Laya.Scene.open("scenes/pve/PveScene.ls",!1,e);break;default:break}Le.logs("======================  打开Scene: "+t+"  ======================"),this.m_sceneCurrent.name=t,this.m_sceneCurrent.fromScene=this.fromScene,this.m_sceneCurrent.m_arrOpenSceneData=[t,e,i,a];let o=C.M_SCENE}initPreload(){let t=_.intance.m_dicScene.get(Y.M_SCENE_PRE_LOAD);t&&t.music!=null&&t.music!="0"&&t.music!=""&&(console.log("SceneManager.initPreload sceneItem.music: "+t.music),Xe.instance.playMusicByName(t.music))}get currSceneName(){return this.m_sceneCurrent?this.m_sceneCurrent.name:""}};fa.m_arrSceneToDialog=[];var oe=fa;var W=class{};W.ARENA_TYPE_PROFESSIONAL=1,W.ARENA_TYPE_AIRDROP=2,W.ARENA_TYPE_TRAINING=3,W.ARENA_TYPE_PVE=4,W.ARENA_TYPE_TEAM=5,W.ACTION_CREATE=1,W.ACTION_JOIN=2,W.ACTION_SIGNUP=3,W.ACTION_WATCH=4,W.ACTION_CREATE_BOOKING=5,W.ACTION_JOIN_BOOKING=6,W.STATE_WAIT=0,W.STATE_SIGNUP=2,W.STATE_GROUPED=3,W.STATE_START=10,W.CAMERA_IDLE=0,W.CAMERA_FOLLOW_ME=1,W.CAMERA_MAP_CLICK=2,W.CAMERA_DIRECT_OPERATE=3,W.CAMERA_FOLLOW_OTHER=4,W.MATCHEND_REWARD=1,W.MATCHEND_QUAN=2,W.MATCHEND_DIEJIA=3;var Ht=class{constructor(){this._color=1;this.isLvUp=!1;this.newAddCnt=0}get simgurl(){return S.instance.getHeroHeadRes(this.heroItem.serialId,this.color)}get sk(){return S.instance.getHeroSkRes(this.heroItem.serialId,this.color)}get id(){return this._id}set id(t){this._id=t,this.heroItem=_.intance.m_dicHeros.get(t+"")}get name(){return m.instance.getLanguage(this.heroItem.name)}set name(t){this._name=t}get color(){return this._color}set color(t){t&&(this._color=t)}get m_iNum(){return this._m_iNum}set m_iNum(t){this._m_iNum=t}};var Ne=class n{constructor(t=0){this._m_iLevel=0;this._m_arrDisc=[];this.newAddCnt=0;this.isScholarship=!1;this.isLvUp=!1;this.needTip=!0;this.m_bSalon=!1;this.m_bIsSetId=!1;t!=0&&(this.m_iId=t)}get m_sIcon(){return this._m_sIcon}set m_sIcon(t){this._m_sIcon=t}get m_iLevel(){return this._m_iLevel>0?this._m_iLevel:1}set m_iLevel(t){this._m_iLevel=t||0}get m_iNum(){return this._m_iNum}set m_iNum(t){this._m_iNum=t}get m_iPk(){return this._m_iPk}set m_iPk(t){this._m_iPk=t}copyItem(){let t=new n;return t.m_iId=this.m_iId,t.m_iOriginalId=this.m_iOriginalId,t}get m_bTry(){return this.m_iId==this.m_iOriginalId?this._m_bSet=!1:this._m_bSet=!0,this._m_bSet}get m_strName(){return m.instance.getLanguage(this.itemItem.name)}set m_bTry(t){this._m_bSet=t}get m_iId(){return this._m_iId}set m_iId(t){this._m_iId=t,this.m_bIsSetId||(this.m_bIsSetId=!0,this.m_iOriginalId=t),this.setConfigData()}setConfigData(){if(this.m_iId!=0){if(this.itemItem=_.intance.m_dicItems.get(this.m_iId.toString()),!this.itemItem){console.log("[          <items> find out id:"+this.m_iId+"             ]");return}if(this.subType=parseInt(this.itemItem.subType+""),this.backType=parseInt(this.itemItem.backPack+""),this.type=parseInt(this.itemItem.type+""),this.m_sIcon=this.itemItem.icon,this.itemItem.buy_price){this.m_iPrice=this.itemItem.buy_price[0][1];let t=this.itemItem.buy_price[0][0],e=_.intance.m_dicItems.get(t);e&&(this.m_strBuyIcon=S.instance.getItemIcon(e.icon))}this.itemItem.sell_price&&(this.m_iSellPrice=parseFloat(this.itemItem.sell_price[0][1])),this.m_iQuality=this.itemItem.quality,this.setQualityData()}}setQualityData(){this.m_arrQualityData=this.itemItem.starArr}get getIconURL(){return S.instance.getItemIcon(this.itemItem.icon)}copy(){let t=new n(this.m_iId);return t.m_iLevel=this.m_iLevel,t}compareName(){return m.instance.getLanguage(this.itemItem.name)}compareQuality(){return parseFloat(this.m_iQuality+"")}compareSellPrice(){return parseFloat(this.itemItem.sell_price[1]+"")}compareNum(){return parseFloat(this.m_iNum+"")}compareLevel(){return parseFloat(this.m_iLevel+"")}compareFragment(){let t=this.itemItem.id;return 0}compareTypeId(){return parseInt(this.m_iId+"")}};var Li=class n{constructor(){this._isPop=!1;g.intance.on(f.EVENT_CHECK_REMAIN,this,this.onCheckRemain)}static get instance(){return n._instance||(n._instance=new n),n._instance}get model(){return ut.instance}get isPop(){return this._isPop}startShow(){console.log("startShow");var t=this.model.hasRemain();!this._isPop&&t&&(this._isPop=!0,t instanceof Ht?g.intance.event(f.EVENT_OPEN_MODULE,y.HeroGetDialog):g.intance.event(f.EVENT_OPEN_MODULE,y.ItemGetDialog))}onCheckRemain(t){if(t==y.ItemGetDialog||t==y.HeroGetDialog){var e=this.model.hasRemain();e?e instanceof Ht?g.intance.event(f.EVENT_OPEN_MODULE,y.HeroGetDialog):g.intance.event(f.EVENT_OPEN_MODULE,y.ItemGetDialog):this._isPop=!1}}};var ut=class n{constructor(t){this._list=[];this.needPop=!0;this.autoPop=!0}static get instance(){return n._instance||(n._instance=new n(new _0)),n._instance}get service(){return Li.instance}addItem(t,e=!1){let i=new Ne;i.m_iId=t.m_iId,i.newAddCnt=t.newAddCnt,i.m_iLevel=t.m_iLevel,i.isLvUp=t.isLvUp,i.m_bNew=t.m_bNew,this._list.push(i),e&&this.service.startShow()}addHeroItem(t,e=!1){let i=new Ht;i.id=t.id,i.newAddCnt=t.newAddCnt,i.lv=t.lv,i.isLvUp=t.isLvUp,i.m_bNew=t.m_bNew,this._list.push(i),e&&this.service.startShow()}addItems(t,e=!1){this._list=this._list.concat(t),e&&this.service.startShow()}hasRemain(){return this._list.length>0?this._list[0]:null}get needListener(){return this._list.length>=2}addConsumeByServer(t){this._list.push(t)}addConsume(t,e){this._list.push([t,e])}getNextItem(){return this._list.length>0?this._list[0]:null}getOneItem(){return this._list.length>0?this._list.shift():null}},_0=class{};var Gt=class{constructor(){}};Gt.TYPE_NORMAL=0,Gt.TYPE_TRUST=1,Gt.TYPE_WEB3=2,Gt.type=0;async function RD({timeout:n}={timeout:3e3}){let t=uw();return t||PD({timeout:n})}async function PD({timeout:n}={timeout:3e3}){return new Promise(t=>{let e=()=>{t(uw())};window.addEventListener("trustwallet#initialized",e,{once:!0}),setTimeout(()=>{window.removeEventListener("trustwallet#initialized",e,{once:!0}),t(null)},n)})}function uw(){let n=e=>!!e.isTrust;return typeof window<"u"&&typeof window.ethereum<"u"?n(window.ethereum)?window.ethereum:window.ethereum?.providers?window.ethereum.providers.find(n)??null:window.trustwallet??null:null}async function v0(){if(console.log("initWeb3 -0"),console.log("initWeb3 -1"),typeof window<"u"&&typeof window.ethereum<"u"&&!!window.ethereum.isTrust){let t=await RD();console.log("initWeb3 -2"+t),Gt.trustProvider=t,Gt.type=Gt.TYPE_TRUST,console.log("initWeb3 -6")}else typeof web3<"u"&&(console.log("initWeb3 2"),web3=new Web3(web3.currentProvider),Gt.web3Provider=web3,Gt.type=Gt.TYPE_WEB3,console.log("initWeb3 3"))}var qa=class n{constructor(){this.walletDic=new le}static get instance(){return n._instance||(n._instance=new n),n._instance}getEthValue(t){return n.instance.walletDic.get(t)?n.instance.walletDic.get(t).ethValue:0}getValue(t){return n.instance.walletDic.get(t)?n.instance.walletDic.get(t).value:0}};var _i=class{};_i.ASSETS_TOX=1e4,_i.ASSETS_ARCANITE=10001,_i.ASSETS_CRYSTAL=10002,_i.ASSETS_MITHRIL=10003,_i.ASSETS_REDSTONE=10004,_i.ASSETS_TRUEIRON=10005;var J=class{static initConfig(t){this.configDic=new le;for(let e of t){let i=e.sstringvalue;e.sadditional==="JSON"&&(i=JSON.parse(i)),this.configDic.set(e.skey2,i),this[e.skey2]=i}}};J.ADDRESS0="0x0000000000000000000000000000000000000000",J.TOKEN_ERC20ABI=[{inputs:[],stateMutability:"nonpayable",type:"constructor"},{anonymous:!1,inputs:[{indexed:!0,internalType:"address",name:"owner",type:"address"},{indexed:!0,internalType:"address",name:"spender",type:"address"},{indexed:!1,internalType:"uint256",name:"value",type:"uint256"}],name:"Approval",type:"event"},{anonymous:!1,inputs:[{indexed:!0,internalType:"address",name:"previousOwner",type:"address"},{indexed:!0,internalType:"address",name:"newOwner",type:"address"}],name:"OwnershipTransferred",type:"event"},{anonymous:!1,inputs:[{indexed:!0,internalType:"address",name:"from",type:"address"},{indexed:!0,internalType:"address",name:"to",type:"address"},{indexed:!1,internalType:"uint256",name:"value",type:"uint256"}],name:"Transfer",type:"event"},{inputs:[{internalType:"address",name:"miner",type:"address"}],name:"addMinter",outputs:[{internalType:"bool",name:"",type:"bool"}],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address",name:"owner",type:"address"},{internalType:"address",name:"spender",type:"address"}],name:"allowance",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"address",name:"spender",type:"address"},{internalType:"uint256",name:"amount",type:"uint256"}],name:"approve",outputs:[{internalType:"bool",name:"",type:"bool"}],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address",name:"account",type:"address"}],name:"balanceOf",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"uint256",name:"amount",type:"uint256"}],name:"burn",outputs:[{internalType:"bool",name:"",type:"bool"}],stateMutability:"nonpayable",type:"function"},{inputs:[],name:"decimals",outputs:[{internalType:"uint8",name:"",type:"uint8"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"address",name:"spender",type:"address"},{internalType:"uint256",name:"subtractedValue",type:"uint256"}],name:"decreaseAllowance",outputs:[{internalType:"bool",name:"",type:"bool"}],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address",name:"_delMinter",type:"address"}],name:"delMinter",outputs:[{internalType:"bool",name:"",type:"bool"}],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"uint256",name:"idx",type:"uint256"}],name:"getMinter",outputs:[{internalType:"address",name:"",type:"address"}],stateMutability:"view",type:"function"},{inputs:[],name:"getMinterLength",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"address",name:"spender",type:"address"},{internalType:"uint256",name:"addedValue",type:"uint256"}],name:"increaseAllowance",outputs:[{internalType:"bool",name:"",type:"bool"}],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address",name:"account",type:"address"}],name:"isMinter",outputs:[{internalType:"bool",name:"",type:"bool"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"address",name:"to",type:"address"},{internalType:"uint256",name:"amount",type:"uint256"}],name:"mint",outputs:[{internalType:"bool",name:"",type:"bool"}],stateMutability:"nonpayable",type:"function"},{inputs:[],name:"name",outputs:[{internalType:"string",name:"",type:"string"}],stateMutability:"view",type:"function"},{inputs:[],name:"owner",outputs:[{internalType:"address",name:"",type:"address"}],stateMutability:"view",type:"function"},{inputs:[],name:"renounceOwnership",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[],name:"symbol",outputs:[{internalType:"string",name:"",type:"string"}],stateMutability:"view",type:"function"},{inputs:[],name:"totalSupply",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"address",name:"recipient",type:"address"},{internalType:"uint256",name:"amount",type:"uint256"}],name:"transfer",outputs:[{internalType:"bool",name:"",type:"bool"}],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address",name:"sender",type:"address"},{internalType:"address",name:"recipient",type:"address"},{internalType:"uint256",name:"amount",type:"uint256"}],name:"transferFrom",outputs:[{internalType:"bool",name:"",type:"bool"}],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address",name:"newOwner",type:"address"}],name:"transferOwnership",outputs:[],stateMutability:"nonpayable",type:"function"}],J.PUZZLE_ABI=[{inputs:[{internalType:"address",name:"_signAddress",type:"address"}],stateMutability:"nonpayable",type:"constructor"},{inputs:[],name:"InvalidShortString",type:"error"},{inputs:[{internalType:"string",name:"str",type:"string"}],name:"StringTooLong",type:"error"},{anonymous:!1,inputs:[],name:"EIP712DomainChanged",type:"event"},{anonymous:!1,inputs:[{indexed:!0,internalType:"address",name:"previousOwner",type:"address"},{indexed:!0,internalType:"address",name:"newOwner",type:"address"}],name:"OwnershipTransferred",type:"event"},{anonymous:!1,inputs:[{indexed:!1,internalType:"address",name:"token",type:"address"},{indexed:!1,internalType:"address",name:"to",type:"address"},{indexed:!1,internalType:"uint256",name:"tokenAmount",type:"uint256"},{indexed:!1,internalType:"uint256",name:"orderId",type:"uint256"},{indexed:!1,internalType:"uint256",name:"deadline",type:"uint256"},{indexed:!1,internalType:"bytes",name:"signature",type:"bytes"},{indexed:!1,internalType:"uint256",name:"amount",type:"uint256"}],name:"WithdrawToken",type:"event"},{inputs:[],name:"TOX",outputs:[{internalType:"address",name:"",type:"address"}],stateMutability:"view",type:"function"},{inputs:[],name:"USDT",outputs:[{internalType:"address",name:"",type:"address"}],stateMutability:"view",type:"function"},{inputs:[],name:"WBNB",outputs:[{internalType:"address",name:"",type:"address"}],stateMutability:"view",type:"function"},{inputs:[],name:"eip712Domain",outputs:[{internalType:"bytes1",name:"fields",type:"bytes1"},{internalType:"string",name:"name",type:"string"},{internalType:"string",name:"version",type:"string"},{internalType:"uint256",name:"chainId",type:"uint256"},{internalType:"address",name:"verifyingContract",type:"address"},{internalType:"bytes32",name:"salt",type:"bytes32"},{internalType:"uint256[]",name:"extensions",type:"uint256[]"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"uint256",name:"amountIn",type:"uint256"}],name:"getAmountsOut",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"uint256",name:"amountIn",type:"uint256"},{internalType:"address",name:"token",type:"address"}],name:"getTokenAmountsOut",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"uint256",name:"",type:"uint256"}],name:"hasUsed",outputs:[{internalType:"bool",name:"",type:"bool"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"bytes",name:"",type:"bytes"}],name:"hashList",outputs:[{internalType:"bool",name:"",type:"bool"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"address",name:"token",type:"address"},{internalType:"address",name:"to",type:"address"},{internalType:"uint256",name:"tokenAmount",type:"uint256"},{internalType:"uint256",name:"orderId",type:"uint256"},{internalType:"uint256",name:"deadline",type:"uint256"},{internalType:"bytes",name:"signature",type:"bytes"}],name:"isSigner",outputs:[{internalType:"bool",name:"",type:"bool"}],stateMutability:"view",type:"function"},{inputs:[],name:"owner",outputs:[{internalType:"address",name:"",type:"address"}],stateMutability:"view",type:"function"},{inputs:[],name:"renounceOwnership",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[],name:"router",outputs:[{internalType:"address",name:"",type:"address"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"address",name:"_signAddress",type:"address"}],name:"setSigner",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[],name:"signAddress",outputs:[{internalType:"address",name:"",type:"address"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"address",name:"newOwner",type:"address"}],name:"transferOwnership",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address",name:"token",type:"address"},{internalType:"address",name:"to",type:"address"},{internalType:"uint256",name:"tokenAmount",type:"uint256"}],name:"withdraw",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address",name:"token",type:"address"},{internalType:"address",name:"to",type:"address"},{internalType:"uint256",name:"tokenAmount",type:"uint256"},{internalType:"uint256",name:"orderId",type:"uint256"},{internalType:"uint256",name:"deadline",type:"uint256"},{internalType:"bytes",name:"signature",type:"bytes"}],name:"withdrawToken",outputs:[],stateMutability:"nonpayable",type:"function"},{stateMutability:"payable",type:"receive"}],J.PUZZLE_ABI_ETH=[{inputs:[{internalType:"address",name:"_signAddress",type:"address"}],stateMutability:"nonpayable",type:"constructor"},{inputs:[],name:"InvalidShortString",type:"error"},{inputs:[{internalType:"string",name:"str",type:"string"}],name:"StringTooLong",type:"error"},{anonymous:!1,inputs:[],name:"EIP712DomainChanged",type:"event"},{anonymous:!1,inputs:[{indexed:!0,internalType:"address",name:"previousOwner",type:"address"},{indexed:!0,internalType:"address",name:"newOwner",type:"address"}],name:"OwnershipTransferred",type:"event"},{anonymous:!1,inputs:[{indexed:!1,internalType:"address",name:"token",type:"address"},{indexed:!1,internalType:"address",name:"to",type:"address"},{indexed:!1,internalType:"uint256",name:"tokenAmount",type:"uint256"},{indexed:!1,internalType:"uint256",name:"orderId",type:"uint256"},{indexed:!1,internalType:"uint256",name:"deadline",type:"uint256"},{indexed:!1,internalType:"bytes",name:"signature",type:"bytes"},{indexed:!1,internalType:"uint256",name:"amount",type:"uint256"}],name:"WithdrawToken",type:"event"},{inputs:[],name:"GALA",outputs:[{internalType:"address",name:"",type:"address"}],stateMutability:"view",type:"function"},{inputs:[],name:"USDT",outputs:[{internalType:"address",name:"",type:"address"}],stateMutability:"view",type:"function"},{inputs:[],name:"WETH",outputs:[{internalType:"address",name:"",type:"address"}],stateMutability:"view",type:"function"},{inputs:[],name:"eip712Domain",outputs:[{internalType:"bytes1",name:"fields",type:"bytes1"},{internalType:"string",name:"name",type:"string"},{internalType:"string",name:"version",type:"string"},{internalType:"uint256",name:"chainId",type:"uint256"},{internalType:"address",name:"verifyingContract",type:"address"},{internalType:"bytes32",name:"salt",type:"bytes32"},{internalType:"uint256[]",name:"extensions",type:"uint256[]"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"uint256",name:"amountIn",type:"uint256"}],name:"getAmountsOut",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"uint256",name:"",type:"uint256"}],name:"hasUsed",outputs:[{internalType:"bool",name:"",type:"bool"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"bytes",name:"",type:"bytes"}],name:"hashList",outputs:[{internalType:"bool",name:"",type:"bool"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"address",name:"token",type:"address"},{internalType:"address",name:"to",type:"address"},{internalType:"uint256",name:"tokenAmount",type:"uint256"},{internalType:"uint256",name:"orderId",type:"uint256"},{internalType:"uint256",name:"deadline",type:"uint256"},{internalType:"bytes",name:"signature",type:"bytes"}],name:"isSigner",outputs:[{internalType:"bool",name:"",type:"bool"}],stateMutability:"view",type:"function"},{inputs:[],name:"owner",outputs:[{internalType:"address",name:"",type:"address"}],stateMutability:"view",type:"function"},{inputs:[],name:"renounceOwnership",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[],name:"router",outputs:[{internalType:"address",name:"",type:"address"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"address",name:"_signAddress",type:"address"}],name:"setSigner",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[],name:"signAddress",outputs:[{internalType:"address",name:"",type:"address"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"address",name:"newOwner",type:"address"}],name:"transferOwnership",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address",name:"token",type:"address"},{internalType:"address",name:"to",type:"address"},{internalType:"uint256",name:"tokenAmount",type:"uint256"}],name:"withdraw",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address",name:"token",type:"address"},{internalType:"address",name:"to",type:"address"},{internalType:"uint256",name:"tokenAmount",type:"uint256"},{internalType:"uint256",name:"orderId",type:"uint256"},{internalType:"uint256",name:"deadline",type:"uint256"},{internalType:"bytes",name:"signature",type:"bytes"}],name:"withdrawToken",outputs:[],stateMutability:"nonpayable",type:"function"}],J.ACCOUNT_ADDRESS="0x5ff2123b0Aa4bD97eeF5F6388EFCB56cd29D6835",J.ACCOUNT_ABI=[{anonymous:!1,inputs:[{indexed:!0,internalType:"address",name:"owner",type:"address"},{indexed:!0,internalType:"address",name:"approved",type:"address"},{indexed:!0,internalType:"uint256",name:"tokenId",type:"uint256"}],name:"Approval",type:"event"},{anonymous:!1,inputs:[{indexed:!0,internalType:"address",name:"owner",type:"address"},{indexed:!0,internalType:"address",name:"operator",type:"address"},{indexed:!1,internalType:"bool",name:"approved",type:"bool"}],name:"ApprovalForAll",type:"event"},{anonymous:!1,inputs:[{indexed:!0,internalType:"address",name:"from",type:"address"},{indexed:!0,internalType:"address",name:"to",type:"address"},{indexed:!0,internalType:"uint256",name:"tokenId",type:"uint256"},{indexed:!1,internalType:"string",name:"nickName",type:"string"},{indexed:!1,internalType:"string",name:"avatar",type:"string"},{indexed:!1,internalType:"uint256",name:"level",type:"uint256"},{indexed:!1,internalType:"uint256",name:"birthHeight",type:"uint256"},{indexed:!1,internalType:"uint256",name:"birthPlace",type:"uint256"},{indexed:!1,internalType:"uint256",name:"gender",type:"uint256"},{indexed:!1,internalType:"uint256",name:"influence",type:"uint256"}],name:"Mint",type:"event"},{anonymous:!1,inputs:[{indexed:!0,internalType:"address",name:"previousOwner",type:"address"},{indexed:!0,internalType:"address",name:"newOwner",type:"address"}],name:"OwnershipTransferred",type:"event"},{anonymous:!1,inputs:[{indexed:!0,internalType:"address",name:"from",type:"address"},{indexed:!0,internalType:"address",name:"to",type:"address"},{indexed:!0,internalType:"uint256",name:"tokenId",type:"uint256"}],name:"Transfer",type:"event"},{inputs:[{internalType:"address",name:"government",type:"address"}],name:"addGovernment",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address",name:"to",type:"address"},{internalType:"uint256",name:"tokenId",type:"uint256"}],name:"approve",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address",name:"owner",type:"address"}],name:"balanceOf",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[],name:"baseURI",outputs:[{internalType:"string",name:"",type:"string"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"uint256",name:"tokenId",type:"uint256"}],name:"burn",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"uint256",name:"tokenId",type:"uint256"},{internalType:"string",name:"_avatar",type:"string"}],name:"changeAvatar",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"uint256",name:"tokenId",type:"uint256"},{internalType:"uint256",name:"_gender",type:"uint256"}],name:"changeGender",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"uint256",name:"tokenId",type:"uint256"},{internalType:"uint256",name:"_influence",type:"uint256"}],name:"changeInfluence",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"uint256",name:"tokenId",type:"uint256"},{internalType:"uint256",name:"_level",type:"uint256"}],name:"changeLevel",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"uint256",name:"tokenId",type:"uint256"},{internalType:"string",name:"_nickname",type:"string"}],name:"changeNickName",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address",name:"to",type:"address"},{internalType:"string",name:"_nickname",type:"string"},{internalType:"string",name:"_avatar",type:"string"},{internalType:"uint256",name:"_level",type:"uint256"},{internalType:"uint256",name:"_birthHeight",type:"uint256"},{internalType:"uint256",name:"_birthPlace",type:"uint256"},{internalType:"uint256",name:"_gender",type:"uint256"},{internalType:"uint256",name:"_influence",type:"uint256"}],name:"createAccount",outputs:[{internalType:"bool",name:"",type:"bool"}],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address",name:"government",type:"address"}],name:"deletedGovernment",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"uint256",name:"tokenId",type:"uint256"}],name:"getAccountInfo",outputs:[{components:[{internalType:"uint256",name:"id",type:"uint256"},{internalType:"string",name:"nickName",type:"string"},{internalType:"string",name:"avatar",type:"string"},{internalType:"uint256",name:"level",type:"uint256"},{internalType:"uint256",name:"birthHeight",type:"uint256"},{internalType:"uint256",name:"birthPlace",type:"uint256"},{internalType:"uint256",name:"gender",type:"uint256"},{internalType:"uint256",name:"influence",type:"uint256"}],internalType:"struct AccountInfo",name:"",type:"tuple"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"uint256",name:"tokenId",type:"uint256"}],name:"getApproved",outputs:[{internalType:"address",name:"",type:"address"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"uint256",name:"index",type:"uint256"}],name:"getGovernment",outputs:[{internalType:"address",name:"",type:"address"}],stateMutability:"view",type:"function"},{inputs:[],name:"getGovernmentLength",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"address",name:"owner",type:"address"},{internalType:"address",name:"operator",type:"address"}],name:"isApprovedForAll",outputs:[{internalType:"bool",name:"",type:"bool"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"address",name:"account",type:"address"}],name:"isGovernment",outputs:[{internalType:"bool",name:"",type:"bool"}],stateMutability:"view",type:"function"},{inputs:[],name:"name",outputs:[{internalType:"string",name:"",type:"string"}],stateMutability:"view",type:"function"},{inputs:[],name:"owner",outputs:[{internalType:"address",name:"",type:"address"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"uint256",name:"tokenId",type:"uint256"}],name:"ownerOf",outputs:[{internalType:"address",name:"",type:"address"}],stateMutability:"view",type:"function"},{inputs:[],name:"renounceOwnership",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address",name:"from",type:"address"},{internalType:"address",name:"to",type:"address"},{internalType:"uint256",name:"tokenId",type:"uint256"}],name:"safeTransferFrom",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address",name:"from",type:"address"},{internalType:"address",name:"to",type:"address"},{internalType:"uint256",name:"tokenId",type:"uint256"},{internalType:"bytes",name:"_data",type:"bytes"}],name:"safeTransferFrom",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address",name:"operator",type:"address"},{internalType:"bool",name:"approved",type:"bool"}],name:"setApprovalForAll",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"string",name:"newBaseURI",type:"string"}],name:"setBaseURI",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"uint256",name:"tokenId",type:"uint256"},{internalType:"string",name:"newTokenURI",type:"string"}],name:"setTokenURI",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"bytes4",name:"interfaceId",type:"bytes4"}],name:"supportsInterface",outputs:[{internalType:"bool",name:"",type:"bool"}],stateMutability:"view",type:"function"},{inputs:[],name:"symbol",outputs:[{internalType:"string",name:"",type:"string"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"uint256",name:"index",type:"uint256"}],name:"tokenByIndex",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"address",name:"owner",type:"address"},{internalType:"uint256",name:"index",type:"uint256"}],name:"tokenOfOwnerByIndex",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"uint256",name:"tokenId",type:"uint256"}],name:"tokenURI",outputs:[{internalType:"string",name:"",type:"string"}],stateMutability:"view",type:"function"},{inputs:[],name:"totalSupply",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"address",name:"from",type:"address"},{internalType:"address",name:"to",type:"address"},{internalType:"uint256",name:"tokenId",type:"uint256"}],name:"transferFrom",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address",name:"newOwner",type:"address"}],name:"transferOwnership",outputs:[],stateMutability:"nonpayable",type:"function"}],J.CREATE_ACCOUNT_ABI=[{inputs:[{internalType:"address",name:"AccountToken",type:"address"}],stateMutability:"nonpayable",type:"constructor"},{anonymous:!1,inputs:[{indexed:!1,internalType:"address[]",name:"accounts",type:"address[]"}],name:"BurnAccount",type:"event"},{anonymous:!1,inputs:[{indexed:!1,internalType:"address",name:"sender",type:"address"},{indexed:!1,internalType:"uint256",name:"id",type:"uint256"},{indexed:!1,internalType:"string",name:"nickname",type:"string"},{indexed:!1,internalType:"uint256",name:"country",type:"uint256"},{indexed:!1,internalType:"uint256",name:"gender",type:"uint256"},{indexed:!1,internalType:"string",name:"icon",type:"string"}],name:"RegisterAccount",type:"event"},{anonymous:!1,inputs:[{indexed:!0,internalType:"bytes32",name:"role",type:"bytes32"},{indexed:!0,internalType:"bytes32",name:"previousAdminRole",type:"bytes32"},{indexed:!0,internalType:"bytes32",name:"newAdminRole",type:"bytes32"}],name:"RoleAdminChanged",type:"event"},{anonymous:!1,inputs:[{indexed:!0,internalType:"bytes32",name:"role",type:"bytes32"},{indexed:!0,internalType:"address",name:"account",type:"address"},{indexed:!0,internalType:"address",name:"sender",type:"address"}],name:"RoleGranted",type:"event"},{anonymous:!1,inputs:[{indexed:!0,internalType:"bytes32",name:"role",type:"bytes32"},{indexed:!0,internalType:"address",name:"account",type:"address"},{indexed:!0,internalType:"address",name:"sender",type:"address"}],name:"RoleRevoked",type:"event"},{inputs:[],name:"DEFAULT_ADMIN_ROLE",outputs:[{internalType:"bytes32",name:"",type:"bytes32"}],stateMutability:"view",type:"function"},{inputs:[],name:"MANAGER_ROLE",outputs:[{internalType:"bytes32",name:"",type:"bytes32"}],stateMutability:"view",type:"function"},{inputs:[],name:"MAX",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"address[]",name:"accounts",type:"address[]"}],name:"burnAccount",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[],name:"currentId",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"bytes32",name:"role",type:"bytes32"}],name:"getRoleAdmin",outputs:[{internalType:"bytes32",name:"",type:"bytes32"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"bytes32",name:"role",type:"bytes32"},{internalType:"address",name:"account",type:"address"}],name:"grantRole",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"bytes32",name:"role",type:"bytes32"},{internalType:"address",name:"account",type:"address"}],name:"hasRole",outputs:[{internalType:"bool",name:"",type:"bool"}],stateMutability:"view",type:"function"},{inputs:[],name:"iAccount",outputs:[{internalType:"contract IAccount",name:"",type:"address"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"string",name:"",type:"string"}],name:"isExists",outputs:[{internalType:"bool",name:"",type:"bool"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"string",name:"nickname",type:"string"},{internalType:"uint256",name:"country",type:"uint256"},{internalType:"uint256",name:"gender",type:"uint256"},{internalType:"string",name:"icon",type:"string"}],name:"register",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address",name:"",type:"address"}],name:"registerId",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"bytes32",name:"role",type:"bytes32"},{internalType:"address",name:"account",type:"address"}],name:"renounceRole",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"bytes32",name:"role",type:"bytes32"},{internalType:"address",name:"account",type:"address"}],name:"revokeRole",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"bytes4",name:"interfaceId",type:"bytes4"}],name:"supportsInterface",outputs:[{internalType:"bool",name:"",type:"bool"}],stateMutability:"view",type:"function"}],J.BUY_HERO_ABI=[{inputs:[{internalType:"address",name:"_Phantom",type:"address"},{internalType:"address",name:"_TOX",type:"address"}],stateMutability:"nonpayable",type:"constructor"},{anonymous:!1,inputs:[{indexed:!0,internalType:"address",name:"previousOwner",type:"address"},{indexed:!0,internalType:"address",name:"newOwner",type:"address"}],name:"OwnershipTransferred",type:"event"},{inputs:[],name:"Phantom",outputs:[{internalType:"address",name:"",type:"address"}],stateMutability:"view",type:"function"},{inputs:[],name:"TOX",outputs:[{internalType:"address",name:"",type:"address"}],stateMutability:"view",type:"function"},{inputs:[],name:"TOXPrice",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[],name:"getNFTParams",outputs:[{components:[{internalType:"string",name:"name",type:"string"},{internalType:"uint256",name:"series",type:"uint256"},{internalType:"uint256",name:"level",type:"uint256"}],internalType:"struct PhantomMall.Params[]",name:"",type:"tuple[]"}],stateMutability:"view",type:"function"},{inputs:[],name:"getNameIndex",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"address",name:"account",type:"address"},{internalType:"address",name:"union",type:"address"}],name:"list",outputs:[{internalType:"uint256[]",name:"",type:"uint256[]"}],stateMutability:"view",type:"function"},{inputs:[],name:"maxSeriesCount",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"address[]",name:"tos",type:"address[]"}],name:"mintByOwner",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[],name:"mintByTOX",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[],name:"mintCount",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"string",name:"",type:"string"}],name:"nameCount",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[],name:"owner",outputs:[{internalType:"address",name:"",type:"address"}],stateMutability:"view",type:"function"},{inputs:[],name:"random",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[],name:"renounceOwnership",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"bool",name:"_isOpen",type:"bool"}],name:"setOpen",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"uint256",name:"_toxPrice",type:"uint256"}],name:"setPrice",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[],name:"totalSupply",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"address",name:"newOwner",type:"address"}],name:"transferOwnership",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address",name:"token",type:"address"},{internalType:"uint256",name:"amount",type:"uint256"}],name:"withdraw",outputs:[],stateMutability:"nonpayable",type:"function"}],J.HERO_LIST_ABI=[{inputs:[],stateMutability:"nonpayable",type:"constructor"},{anonymous:!1,inputs:[{indexed:!0,internalType:"address",name:"owner",type:"address"},{indexed:!0,internalType:"address",name:"approved",type:"address"},{indexed:!0,internalType:"uint256",name:"tokenId",type:"uint256"}],name:"Approval",type:"event"},{anonymous:!1,inputs:[{indexed:!0,internalType:"address",name:"owner",type:"address"},{indexed:!0,internalType:"address",name:"operator",type:"address"},{indexed:!1,internalType:"bool",name:"approved",type:"bool"}],name:"ApprovalForAll",type:"event"},{anonymous:!1,inputs:[{indexed:!1,internalType:"uint256",name:"_fromTokenId",type:"uint256"},{indexed:!1,internalType:"uint256",name:"_toTokenId",type:"uint256"}],name:"BatchMetadataUpdate",type:"event"},{anonymous:!1,inputs:[{indexed:!1,internalType:"uint256",name:"_tokenId",type:"uint256"}],name:"MetadataUpdate",type:"event"},{anonymous:!1,inputs:[{indexed:!1,internalType:"address",name:"to",type:"address"},{indexed:!1,internalType:"uint256",name:"tokenId",type:"uint256"},{indexed:!1,internalType:"string",name:"name",type:"string"},{indexed:!1,internalType:"uint256",name:"level",type:"uint256"},{indexed:!1,internalType:"uint256",name:"series",type:"uint256"}],name:"Mint",type:"event"},{anonymous:!1,inputs:[{indexed:!0,internalType:"bytes32",name:"role",type:"bytes32"},{indexed:!0,internalType:"bytes32",name:"previousAdminRole",type:"bytes32"},{indexed:!0,internalType:"bytes32",name:"newAdminRole",type:"bytes32"}],name:"RoleAdminChanged",type:"event"},{anonymous:!1,inputs:[{indexed:!0,internalType:"bytes32",name:"role",type:"bytes32"},{indexed:!0,internalType:"address",name:"account",type:"address"},{indexed:!0,internalType:"address",name:"sender",type:"address"}],name:"RoleGranted",type:"event"},{anonymous:!1,inputs:[{indexed:!0,internalType:"bytes32",name:"role",type:"bytes32"},{indexed:!0,internalType:"address",name:"account",type:"address"},{indexed:!0,internalType:"address",name:"sender",type:"address"}],name:"RoleRevoked",type:"event"},{anonymous:!1,inputs:[{indexed:!1,internalType:"string",name:"uri",type:"string"}],name:"TokenBaseURIUpdated",type:"event"},{anonymous:!1,inputs:[{indexed:!0,internalType:"address",name:"from",type:"address"},{indexed:!0,internalType:"address",name:"to",type:"address"},{indexed:!0,internalType:"uint256",name:"tokenId",type:"uint256"}],name:"Transfer",type:"event"},{anonymous:!1,inputs:[{indexed:!1,internalType:"uint256",name:"tokenId",type:"uint256"},{indexed:!1,internalType:"uint256",name:"level",type:"uint256"}],name:"UpdateLevel",type:"event"},{anonymous:!1,inputs:[{indexed:!1,internalType:"uint256",name:"tokenId",type:"uint256"},{indexed:!1,internalType:"string",name:"name",type:"string"}],name:"UpdateName",type:"event"},{anonymous:!1,inputs:[{indexed:!1,internalType:"uint256",name:"tokenId",type:"uint256"},{indexed:!1,internalType:"uint256",name:"series",type:"uint256"}],name:"UpdateSeries",type:"event"},{inputs:[],name:"DEFAULT_ADMIN_ROLE",outputs:[{internalType:"bytes32",name:"",type:"bytes32"}],stateMutability:"view",type:"function"},{inputs:[],name:"MANAGER_ROLE",outputs:[{internalType:"bytes32",name:"",type:"bytes32"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"address",name:"to",type:"address"},{internalType:"uint256",name:"tokenId",type:"uint256"}],name:"approve",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address",name:"owner",type:"address"}],name:"balanceOf",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[],name:"baseURI",outputs:[{internalType:"string",name:"",type:"string"}],stateMutability:"view",type:"function"},{inputs:[],name:"currentId",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[],name:"endId",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"uint256",name:"tokenId",type:"uint256"}],name:"exist",outputs:[{internalType:"bool",name:"",type:"bool"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"uint256",name:"tokenId",type:"uint256"}],name:"getApproved",outputs:[{internalType:"address",name:"",type:"address"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"uint256",name:"tokenId",type:"uint256"}],name:"getParams",outputs:[{components:[{internalType:"string",name:"name",type:"string"},{internalType:"uint256",name:"level",type:"uint256"},{internalType:"uint256",name:"series",type:"uint256"}],internalType:"struct PhantomHero.Params",name:"",type:"tuple"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"bytes32",name:"role",type:"bytes32"}],name:"getRoleAdmin",outputs:[{internalType:"bytes32",name:"",type:"bytes32"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"bytes32",name:"role",type:"bytes32"},{internalType:"address",name:"account",type:"address"}],name:"grantRole",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"bytes32",name:"role",type:"bytes32"},{internalType:"address",name:"account",type:"address"}],name:"hasRole",outputs:[{internalType:"bool",name:"",type:"bool"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"address",name:"owner",type:"address"},{internalType:"address",name:"operator",type:"address"}],name:"isApprovedForAll",outputs:[{internalType:"bool",name:"",type:"bool"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"address",name:"account",type:"address"}],name:"list",outputs:[{internalType:"uint256[]",name:"",type:"uint256[]"}],stateMutability:"view",type:"function"},{inputs:[],name:"name",outputs:[{internalType:"string",name:"",type:"string"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"uint256",name:"tokenId",type:"uint256"}],name:"ownerOf",outputs:[{internalType:"address",name:"",type:"address"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"bytes32",name:"role",type:"bytes32"},{internalType:"address",name:"account",type:"address"}],name:"renounceRole",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"bytes32",name:"role",type:"bytes32"},{internalType:"address",name:"account",type:"address"}],name:"revokeRole",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address",name:"to",type:"address"}],name:"safeMint",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address",name:"to",type:"address"},{internalType:"string",name:"name",type:"string"},{internalType:"uint256",name:"level",type:"uint256"},{internalType:"uint256",name:"series",type:"uint256"},{internalType:"string",name:"uri",type:"string"}],name:"safeMint",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address",name:"from",type:"address"},{internalType:"address",name:"to",type:"address"},{internalType:"uint256",name:"tokenId",type:"uint256"}],name:"safeTransferFrom",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address",name:"from",type:"address"},{internalType:"address",name:"to",type:"address"},{internalType:"uint256",name:"tokenId",type:"uint256"},{internalType:"bytes",name:"data",type:"bytes"}],name:"safeTransferFrom",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address",name:"operator",type:"address"},{internalType:"bool",name:"approved",type:"bool"}],name:"setApprovalForAll",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"string",name:"newURI",type:"string"}],name:"setBaseURI",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"uint256",name:"_endId",type:"uint256"}],name:"setEndId",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"uint256",name:"tokenId",type:"uint256"},{internalType:"string",name:"uri",type:"string"}],name:"setTokenURI",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"bytes4",name:"interfaceId",type:"bytes4"}],name:"supportsInterface",outputs:[{internalType:"bool",name:"",type:"bool"}],stateMutability:"view",type:"function"},{inputs:[],name:"symbol",outputs:[{internalType:"string",name:"",type:"string"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"uint256",name:"index",type:"uint256"}],name:"tokenByIndex",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"address",name:"owner",type:"address"},{internalType:"uint256",name:"index",type:"uint256"}],name:"tokenOfOwnerByIndex",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"uint256",name:"tokenId",type:"uint256"}],name:"tokenURI",outputs:[{internalType:"string",name:"",type:"string"}],stateMutability:"view",type:"function"},{inputs:[],name:"totalSupply",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"address",name:"from",type:"address"},{internalType:"address",name:"to",type:"address"},{internalType:"uint256",name:"tokenId",type:"uint256"}],name:"transferFrom",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"uint256",name:"tokenId",type:"uint256"},{internalType:"uint256",name:"level",type:"uint256"}],name:"updateLevel",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"uint256",name:"tokenId",type:"uint256"},{internalType:"string",name:"name",type:"string"}],name:"updateName",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"uint256",name:"tokenId",type:"uint256"},{internalType:"uint256",name:"series",type:"uint256"}],name:"updateSeries",outputs:[],stateMutability:"nonpayable",type:"function"}],J.TRANSFER_HERO_ABI=[{anonymous:!1,inputs:[{indexed:!1,internalType:"address",name:"sender",type:"address"},{indexed:!1,internalType:"address",name:"to",type:"address"},{indexed:!1,internalType:"uint256[]",name:"uids",type:"uint256[]"}],name:"BatchTransfer",type:"event"},{inputs:[{internalType:"address",name:"to",type:"address"},{internalType:"uint256[]",name:"uids",type:"uint256[]"}],name:"batchTransfer",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[],name:"hero",outputs:[{internalType:"address",name:"",type:"address"}],stateMutability:"view",type:"function"}],J.EDIT_ACCOUNT_ADDRESS="0xaa1B8FA74Ed295123a6336C2D3a88cB973160dfa",J.EDIT_ACCOUNT_ABI=[{inputs:[{internalType:"address",name:"_accountContract",type:"address"},{internalType:"string",name:"_website",type:"string"}],stateMutability:"nonpayable",type:"constructor"},{anonymous:!1,inputs:[{indexed:!0,internalType:"address",name:"previousOwner",type:"address"},{indexed:!0,internalType:"address",name:"newOwner",type:"address"}],name:"OwnershipTransferred",type:"event"},{inputs:[{internalType:"address",name:"government",type:"address"}],name:"addGovernment",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address",name:"government",type:"address"}],name:"deletedGovernment",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"uint256",name:"index",type:"uint256"}],name:"getGovernment",outputs:[{internalType:"address",name:"",type:"address"}],stateMutability:"view",type:"function"},{inputs:[],name:"getGovernmentLength",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[],name:"getPirce",outputs:[{components:[{internalType:"address",name:"exchangeToken",type:"address"},{internalType:"uint256",name:"rate",type:"uint256"}],internalType:"struct UpdateProfile.Price",name:"",type:"tuple"}],stateMutability:"view",type:"function"},{inputs:[],name:"getWebsite",outputs:[{internalType:"string",name:"",type:"string"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"address",name:"account",type:"address"}],name:"isGovernment",outputs:[{internalType:"bool",name:"",type:"bool"}],stateMutability:"view",type:"function"},{inputs:[],name:"owner",outputs:[{internalType:"address",name:"",type:"address"}],stateMutability:"view",type:"function"},{inputs:[],name:"renounceOwnership",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"bool",name:"_isOpen",type:"bool"}],name:"setOpen",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address",name:"_exchangeToken",type:"address"},{internalType:"uint256",name:"_rate",type:"uint256"}],name:"setPrice",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"string",name:"_website",type:"string"}],name:"setWebsite",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address",name:"newOwner",type:"address"}],name:"transferOwnership",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"uint256",name:"tokenId",type:"uint256"},{internalType:"string",name:"nickName",type:"string"},{internalType:"string",name:"avatar",type:"string"}],name:"updateProfile",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address",name:"account",type:"address"}],name:"withdraw",outputs:[],stateMutability:"nonpayable",type:"function"}],J.STAKING_POOL_ABI=[{inputs:[{internalType:"uint256",name:"_poolPlace",type:"uint256"},{internalType:"address",name:"_stakeToken",type:"address"},{internalType:"address",name:"_accountContract",type:"address"},{internalType:"address",name:"_rewardsContract",type:"address"},{internalType:"address",name:"_empowerContract",type:"address"},{internalType:"uint256",name:"_dailyRewards",type:"uint256"}],stateMutability:"nonpayable",type:"constructor"},{anonymous:!1,inputs:[{indexed:!0,internalType:"address",name:"previousOwner",type:"address"},{indexed:!0,internalType:"address",name:"newOwner",type:"address"}],name:"OwnershipTransferred",type:"event"},{anonymous:!1,inputs:[{indexed:!1,internalType:"uint256",name:"rewards",type:"uint256"}],name:"RewardAdded",type:"event"},{anonymous:!1,inputs:[{indexed:!0,internalType:"address",name:"account",type:"address"},{indexed:!1,internalType:"uint256",name:"rewards",type:"uint256"}],name:"RewardPaid",type:"event"},{anonymous:!1,inputs:[{indexed:!0,internalType:"address",name:"account",type:"address"},{indexed:!1,internalType:"uint256",name:"tokenId",type:"uint256"}],name:"Staked",type:"event"},{anonymous:!1,inputs:[{indexed:!0,internalType:"address",name:"account",type:"address"},{indexed:!1,internalType:"uint256",name:"tokenId",type:"uint256"}],name:"Withdrawn",type:"event"},{inputs:[{internalType:"address",name:"government",type:"address"}],name:"addGovernment",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"uint256",name:"tokenId",type:"uint256"}],name:"calcCapacity",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"uint256",name:"tokenId",type:"uint256"}],name:"calcPerSecondsRewards",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"uint256",name:"tokenId",type:"uint256"}],name:"capacityOf",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"uint256",name:"_dailyRewards",type:"uint256"}],name:"changeDailyRewards",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[],name:"claimAllReward",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"uint256",name:"tokenId",type:"uint256"}],name:"claimReward",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address",name:"government",type:"address"}],name:"deletedGovernment",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"uint256",name:"tokenId",type:"uint256"}],name:"earned",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"address",name:"account",type:"address"}],name:"earnedAll",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"uint256",name:"tokenId",type:"uint256"}],name:"estimatePerSecondsRewards",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"address",name:"account",type:"address"}],name:"getAccountCapacity",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[],name:"getAccountContractAddress",outputs:[{internalType:"address",name:"",type:"address"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"address",name:"account",type:"address"}],name:"getAccountTokens",outputs:[{internalType:"uint256[]",name:"",type:"uint256[]"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"address",name:"account",type:"address"}],name:"getAccountTokensNumber",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[],name:"getDailyRewards",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[],name:"getEmpowerContractAddress",outputs:[{internalType:"address",name:"",type:"address"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"uint256",name:"index",type:"uint256"}],name:"getGovernment",outputs:[{internalType:"address",name:"",type:"address"}],stateMutability:"view",type:"function"},{inputs:[],name:"getGovernmentLength",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[],name:"getLastUpdateTime",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[],name:"getLimitTokensNumber",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[],name:"getPoolPlace",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[],name:"getRewardsContractAddress",outputs:[{internalType:"address",name:"",type:"address"}],stateMutability:"view",type:"function"},{inputs:[],name:"getRewardsPerUnitStored",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[],name:"getRewardsRate",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[],name:"getStakeTokenAddress",outputs:[{internalType:"address",name:"",type:"address"}],stateMutability:"view",type:"function"},{inputs:[],name:"getTokenIdleStatus",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[],name:"getTokenMiningStatus",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"address",name:"account",type:"address"},{internalType:"uint256",name:"tokenId",type:"uint256"}],name:"isAccountStakeToken",outputs:[{internalType:"bool",name:"",type:"bool"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"address",name:"account",type:"address"}],name:"isGovernment",outputs:[{internalType:"bool",name:"",type:"bool"}],stateMutability:"view",type:"function"},{inputs:[],name:"owner",outputs:[{internalType:"address",name:"",type:"address"}],stateMutability:"view",type:"function"},{inputs:[],name:"renounceOwnership",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address",name:"_empowerContract",type:"address"}],name:"setEmpowerContract",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"uint256",name:"_limitTokensNumber",type:"uint256"}],name:"setLimitTokensNumber",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"uint256",name:"_idleStatus",type:"uint256"}],name:"setTokenIdleStatus",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"uint256",name:"_miningStatus",type:"uint256"}],name:"setTokenMiningStatus",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"uint256",name:"tokenId",type:"uint256"}],name:"stake",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[],name:"totalCapacity",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[],name:"totalSupply",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"address",name:"newOwner",type:"address"}],name:"transferOwnership",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[],name:"withdrawAllAndClaim",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"uint256",name:"tokenId",type:"uint256"}],name:"withdrawAndClaim",outputs:[],stateMutability:"nonpayable",type:"function"}],J.STAKING_HERO_POWERCALC_ABI=[{inputs:[{internalType:"uint256",name:"_constantValue",type:"uint256"},{internalType:"uint256",name:"_linearCoefficient",type:"uint256"},{internalType:"uint256",name:"_quadraticCoefficient",type:"uint256"},{internalType:"uint256",name:"_percentage",type:"uint256"}],stateMutability:"nonpayable",type:"constructor"},{anonymous:!1,inputs:[{indexed:!0,internalType:"address",name:"previousOwner",type:"address"},{indexed:!0,internalType:"address",name:"newOwner",type:"address"}],name:"OwnershipTransferred",type:"event"},{inputs:[{internalType:"address",name:"government",type:"address"}],name:"addGovernment",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"uint256",name:"tokenLevel",type:"uint256"},{internalType:"bool",name:"isMatchProfession",type:"bool"}],name:"calcCapacity",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"address",name:"government",type:"address"}],name:"deletedGovernment",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[],name:"getFormulaParams",outputs:[{components:[{internalType:"uint256",name:"constantValue",type:"uint256"},{internalType:"uint256",name:"linearCoefficient",type:"uint256"},{internalType:"uint256",name:"quadraticCoefficient",type:"uint256"},{internalType:"uint256",name:"percentage",type:"uint256"}],internalType:"struct EmpowerCalcFormula.FormulaParams",name:"",type:"tuple"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"uint256",name:"index",type:"uint256"}],name:"getGovernment",outputs:[{internalType:"address",name:"",type:"address"}],stateMutability:"view",type:"function"},{inputs:[],name:"getGovernmentLength",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"address",name:"account",type:"address"}],name:"isGovernment",outputs:[{internalType:"bool",name:"",type:"bool"}],stateMutability:"view",type:"function"},{inputs:[],name:"owner",outputs:[{internalType:"address",name:"",type:"address"}],stateMutability:"view",type:"function"},{inputs:[],name:"renounceOwnership",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"uint256",name:"_constantValue",type:"uint256"},{internalType:"uint256",name:"_linearCoefficient",type:"uint256"},{internalType:"uint256",name:"_quadraticCoefficient",type:"uint256"},{internalType:"uint256",name:"_percentage",type:"uint256"}],name:"setFormulaParams",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address",name:"newOwner",type:"address"}],name:"transferOwnership",outputs:[],stateMutability:"nonpayable",type:"function"}],J.BLINDBOX_ADDRESS="0xaf8d3eb0f0e0a454Ec9B3Fb7207dD70Ba302d653",J.BLINDBOX_ABI=[{inputs:[{internalType:"address",name:"_heroAddress",type:"address"},{internalType:"uint256",name:"_maxTotalSupply",type:"uint256"},{internalType:"string",name:"_baseName",type:"string"}],stateMutability:"nonpayable",type:"constructor"},{anonymous:!1,inputs:[{indexed:!0,internalType:"address",name:"previousOwner",type:"address"},{indexed:!0,internalType:"address",name:"newOwner",type:"address"}],name:"OwnershipTransferred",type:"event"},{inputs:[{internalType:"address",name:"account",type:"address"}],name:"accountIsInWhiteList",outputs:[{internalType:"bool",name:"",type:"bool"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"address",name:"government",type:"address"}],name:"addGovernment",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"uint256[]",name:"_races",type:"uint256[]"}],name:"addRaces",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address",name:"government",type:"address"}],name:"deletedGovernment",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[],name:"getBaseName",outputs:[{internalType:"string",name:"",type:"string"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"address",name:"account",type:"address"}],name:"getBuyTimes",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"uint256",name:"index",type:"uint256"}],name:"getGovernment",outputs:[{internalType:"address",name:"",type:"address"}],stateMutability:"view",type:"function"},{inputs:[],name:"getGovernmentLength",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[],name:"getIsOpen",outputs:[{internalType:"bool",name:"",type:"bool"}],stateMutability:"view",type:"function"},{inputs:[],name:"getMaxBuyTimes",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[],name:"getMaxTotalSupply",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[],name:"getPirce",outputs:[{components:[{internalType:"address",name:"exchangeToken",type:"address"},{internalType:"uint256",name:"price",type:"uint256"}],internalType:"struct HeroMallV1.Price",name:"",type:"tuple"}],stateMutability:"view",type:"function"},{inputs:[],name:"getRaces",outputs:[{internalType:"uint256[]",name:"",type:"uint256[]"}],stateMutability:"view",type:"function"},{inputs:[],name:"getReceiverAddress",outputs:[{internalType:"address",name:"",type:"address"}],stateMutability:"view",type:"function"},{inputs:[],name:"getTotalSupply",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[],name:"getWhiteListContract",outputs:[{internalType:"address",name:"",type:"address"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"address",name:"account",type:"address"}],name:"isGovernment",outputs:[{internalType:"bool",name:"",type:"bool"}],stateMutability:"view",type:"function"},{inputs:[],name:"owner",outputs:[{internalType:"address",name:"",type:"address"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"uint256",name:"amount",type:"uint256"}],name:"recruit",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[],name:"renounceOwnership",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"string",name:"_name",type:"string"}],name:"setBaseName",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"uint256",name:"_maxBuyTimes",type:"uint256"}],name:"setMaxBuyTimes",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"uint256",name:"_maxTotalSupply",type:"uint256"}],name:"setMaxTotalSupply",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"bool",name:"_isOpen",type:"bool"}],name:"setOpen",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address",name:"_exchangeToken",type:"address"},{internalType:"uint256",name:"_price",type:"uint256"}],name:"setPrice",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address",name:"_receiverAddress",type:"address"}],name:"setReceiverAddress",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address",name:"_whiteListContract",type:"address"}],name:"setWhiteListContract",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address",name:"newOwner",type:"address"}],name:"transferOwnership",outputs:[],stateMutability:"nonpayable",type:"function"}],J.BLINDBOX_ADDRESS_V2="0xaf8d3eb0f0e0a454Ec9B3Fb7207dD70Ba302d653",J.BLINDBOX_ABI_V2=[{inputs:[{internalType:"address",name:"_heroAddress",type:"address"},{internalType:"uint256",name:"_maxTotalSupply",type:"uint256"},{internalType:"string",name:"_baseName",type:"string"}],stateMutability:"nonpayable",type:"constructor"},{anonymous:!1,inputs:[{indexed:!0,internalType:"address",name:"previousOwner",type:"address"},{indexed:!0,internalType:"address",name:"newOwner",type:"address"}],name:"OwnershipTransferred",type:"event"},{inputs:[{internalType:"address",name:"account",type:"address"}],name:"accountIsInWhiteList",outputs:[{internalType:"bool",name:"",type:"bool"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"address",name:"government",type:"address"}],name:"addGovernment",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"uint256[]",name:"_races",type:"uint256[]"}],name:"addRaces",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address",name:"government",type:"address"}],name:"deletedGovernment",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[],name:"getBaseName",outputs:[{internalType:"string",name:"",type:"string"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"address",name:"account",type:"address"}],name:"getBuyTimes",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"uint256",name:"index",type:"uint256"}],name:"getGovernment",outputs:[{internalType:"address",name:"",type:"address"}],stateMutability:"view",type:"function"},{inputs:[],name:"getGovernmentLength",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[],name:"getIsOpen",outputs:[{internalType:"bool",name:"",type:"bool"}],stateMutability:"view",type:"function"},{inputs:[],name:"getMaxBuyTimes",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[],name:"getMaxTotalSupply",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[],name:"getPirce",outputs:[{components:[{internalType:"address",name:"exchangeToken",type:"address"},{internalType:"uint256",name:"price",type:"uint256"}],internalType:"struct HeroMallV1.Price",name:"",type:"tuple"}],stateMutability:"view",type:"function"},{inputs:[],name:"getRaces",outputs:[{internalType:"uint256[]",name:"",type:"uint256[]"}],stateMutability:"view",type:"function"},{inputs:[],name:"getReceiverAddress",outputs:[{internalType:"address",name:"",type:"address"}],stateMutability:"view",type:"function"},{inputs:[],name:"getTotalSupply",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[],name:"getWhiteListContract",outputs:[{internalType:"address",name:"",type:"address"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"address",name:"account",type:"address"}],name:"isGovernment",outputs:[{internalType:"bool",name:"",type:"bool"}],stateMutability:"view",type:"function"},{inputs:[],name:"owner",outputs:[{internalType:"address",name:"",type:"address"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"uint256",name:"amount",type:"uint256"}],name:"recruit",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[],name:"renounceOwnership",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"string",name:"_name",type:"string"}],name:"setBaseName",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"uint256",name:"_maxBuyTimes",type:"uint256"}],name:"setMaxBuyTimes",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"uint256",name:"_maxTotalSupply",type:"uint256"}],name:"setMaxTotalSupply",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"bool",name:"_isOpen",type:"bool"}],name:"setOpen",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address",name:"_exchangeToken",type:"address"},{internalType:"uint256",name:"_price",type:"uint256"}],name:"setPrice",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address",name:"_receiverAddress",type:"address"}],name:"setReceiverAddress",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address",name:"_whiteListContract",type:"address"}],name:"setWhiteListContract",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address",name:"newOwner",type:"address"}],name:"transferOwnership",outputs:[],stateMutability:"nonpayable",type:"function"}],J.HERO_ADDRESS="0xCC0A4E3Bd1D49D7Ef9C431C0aD87D36B0B342018",J.HERO_ABI=[{anonymous:!1,inputs:[{indexed:!0,internalType:"address",name:"owner",type:"address"},{indexed:!0,internalType:"address",name:"approved",type:"address"},{indexed:!0,internalType:"uint256",name:"tokenId",type:"uint256"}],name:"Approval",type:"event"},{anonymous:!1,inputs:[{indexed:!0,internalType:"address",name:"owner",type:"address"},{indexed:!0,internalType:"address",name:"operator",type:"address"},{indexed:!1,internalType:"bool",name:"approved",type:"bool"}],name:"ApprovalForAll",type:"event"},{anonymous:!1,inputs:[{indexed:!0,internalType:"address",name:"from",type:"address"},{indexed:!0,internalType:"address",name:"to",type:"address"},{indexed:!0,internalType:"uint256",name:"tokenId",type:"uint256"},{indexed:!1,internalType:"string",name:"name",type:"string"},{indexed:!1,internalType:"uint256",name:"level",type:"uint256"},{indexed:!1,internalType:"uint256",name:"rarity",type:"uint256"},{indexed:!1,internalType:"uint256",name:"series",type:"uint256"},{indexed:!1,internalType:"uint256",name:"race",type:"uint256"},{indexed:!1,internalType:"uint256",name:"mineralLevel",type:"uint256"}],name:"Mint",type:"event"},{anonymous:!1,inputs:[{indexed:!0,internalType:"address",name:"previousOwner",type:"address"},{indexed:!0,internalType:"address",name:"newOwner",type:"address"}],name:"OwnershipTransferred",type:"event"},{anonymous:!1,inputs:[{indexed:!0,internalType:"address",name:"from",type:"address"},{indexed:!0,internalType:"address",name:"to",type:"address"},{indexed:!0,internalType:"uint256",name:"tokenId",type:"uint256"}],name:"Transfer",type:"event"},{anonymous:!1,inputs:[{indexed:!0,internalType:"uint256",name:"tokenId",type:"uint256"},{indexed:!0,internalType:"uint256",name:"level",type:"uint256"}],name:"UpdateLevel",type:"event"},{anonymous:!1,inputs:[{indexed:!0,internalType:"uint256",name:"tokenId",type:"uint256"},{indexed:!0,internalType:"uint256",name:"mineralLevel",type:"uint256"}],name:"UpdateMineralLevel",type:"event"},{anonymous:!1,inputs:[{indexed:!0,internalType:"uint256",name:"tokenId",type:"uint256"},{indexed:!0,internalType:"string",name:"name",type:"string"}],name:"UpdateName",type:"event"},{anonymous:!1,inputs:[{indexed:!0,internalType:"uint256",name:"tokenId",type:"uint256"},{indexed:!0,internalType:"uint256",name:"race",type:"uint256"}],name:"UpdateRace",type:"event"},{anonymous:!1,inputs:[{indexed:!0,internalType:"uint256",name:"tokenId",type:"uint256"},{indexed:!0,internalType:"uint256",name:"rarity",type:"uint256"}],name:"UpdateRatity",type:"event"},{anonymous:!1,inputs:[{indexed:!0,internalType:"uint256",name:"tokenId",type:"uint256"},{indexed:!0,internalType:"uint256",name:"series",type:"uint256"}],name:"UpdateSeries",type:"event"},{anonymous:!1,inputs:[{indexed:!0,internalType:"uint256",name:"tokenId",type:"uint256"},{indexed:!0,internalType:"uint256",name:"status",type:"uint256"}],name:"UpdateStatus",type:"event"},{inputs:[{internalType:"address",name:"government",type:"address"}],name:"addGovernment",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address",name:"to",type:"address"},{internalType:"uint256",name:"tokenId",type:"uint256"}],name:"approve",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address",name:"owner",type:"address"}],name:"balanceOf",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[],name:"baseURI",outputs:[{internalType:"string",name:"",type:"string"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"uint256",name:"tokenId",type:"uint256"}],name:"burn",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address",name:"government",type:"address"}],name:"deletedGovernment",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"uint256",name:"tokenId",type:"uint256"}],name:"getApproved",outputs:[{internalType:"address",name:"",type:"address"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"uint256",name:"index",type:"uint256"}],name:"getGovernment",outputs:[{internalType:"address",name:"",type:"address"}],stateMutability:"view",type:"function"},{inputs:[],name:"getGovernmentLength",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"uint256",name:"tokenId",type:"uint256"}],name:"getNFTParams",outputs:[{components:[{internalType:"string",name:"name",type:"string"},{internalType:"uint256",name:"level",type:"uint256"},{internalType:"uint256",name:"rarity",type:"uint256"},{internalType:"uint256",name:"series",type:"uint256"},{internalType:"uint256",name:"race",type:"uint256"},{internalType:"uint256",name:"mineralLevel",type:"uint256"}],internalType:"struct Parmas",name:"",type:"tuple"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"uint256",name:"tokenId",type:"uint256"}],name:"getStatus",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"address",name:"owner",type:"address"},{internalType:"address",name:"operator",type:"address"}],name:"isApprovedForAll",outputs:[{internalType:"bool",name:"",type:"bool"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"address",name:"account",type:"address"}],name:"isGovernment",outputs:[{internalType:"bool",name:"",type:"bool"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"address",name:"to",type:"address"},{internalType:"string",name:"_name",type:"string"},{internalType:"uint256",name:"_level",type:"uint256"},{internalType:"uint256",name:"_rarity",type:"uint256"},{internalType:"uint256",name:"_series",type:"uint256"},{internalType:"uint256",name:"_race",type:"uint256"},{internalType:"uint256",name:"_mineralLevel",type:"uint256"}],name:"mint",outputs:[{internalType:"bool",name:"",type:"bool"}],stateMutability:"nonpayable",type:"function"},{inputs:[],name:"name",outputs:[{internalType:"string",name:"",type:"string"}],stateMutability:"view",type:"function"},{inputs:[],name:"owner",outputs:[{internalType:"address",name:"",type:"address"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"uint256",name:"tokenId",type:"uint256"}],name:"ownerOf",outputs:[{internalType:"address",name:"",type:"address"}],stateMutability:"view",type:"function"},{inputs:[],name:"renounceOwnership",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address",name:"from",type:"address"},{internalType:"address",name:"to",type:"address"},{internalType:"uint256",name:"tokenId",type:"uint256"}],name:"safeTransferFrom",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address",name:"from",type:"address"},{internalType:"address",name:"to",type:"address"},{internalType:"uint256",name:"tokenId",type:"uint256"},{internalType:"bytes",name:"_data",type:"bytes"}],name:"safeTransferFrom",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address",name:"operator",type:"address"},{internalType:"bool",name:"approved",type:"bool"}],name:"setApprovalForAll",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"string",name:"newBaseURI",type:"string"}],name:"setBaseURI",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"uint256",name:"tokenId",type:"uint256"},{internalType:"string",name:"newTokenURI",type:"string"}],name:"setTokenURI",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"bytes4",name:"interfaceId",type:"bytes4"}],name:"supportsInterface",outputs:[{internalType:"bool",name:"",type:"bool"}],stateMutability:"view",type:"function"},{inputs:[],name:"symbol",outputs:[{internalType:"string",name:"",type:"string"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"uint256",name:"index",type:"uint256"}],name:"tokenByIndex",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"address",name:"owner",type:"address"},{internalType:"uint256",name:"index",type:"uint256"}],name:"tokenOfOwnerByIndex",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"uint256",name:"tokenId",type:"uint256"}],name:"tokenURI",outputs:[{internalType:"string",name:"",type:"string"}],stateMutability:"view",type:"function"},{inputs:[],name:"totalSupply",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"address",name:"from",type:"address"},{internalType:"address",name:"to",type:"address"},{internalType:"uint256",name:"tokenId",type:"uint256"}],name:"transferFrom",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address",name:"newOwner",type:"address"}],name:"transferOwnership",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"uint256",name:"tokenId",type:"uint256"},{internalType:"uint256",name:"_level",type:"uint256"}],name:"updateLevel",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"uint256",name:"tokenId",type:"uint256"},{internalType:"uint256",name:"_mineralLevel",type:"uint256"}],name:"updateMineralLevel",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"uint256",name:"tokenId",type:"uint256"},{internalType:"string",name:"_name",type:"string"}],name:"updateName",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"uint256",name:"tokenId",type:"uint256"},{internalType:"uint256",name:"race",type:"uint256"}],name:"updateRace",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"uint256",name:"tokenId",type:"uint256"},{internalType:"uint256",name:"_rarity",type:"uint256"}],name:"updateRatity",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"uint256",name:"tokenId",type:"uint256"},{internalType:"uint256",name:"_series",type:"uint256"}],name:"updateSeries",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"uint256",name:"tokenId",type:"uint256"},{internalType:"uint256",name:"status",type:"uint256"}],name:"updateStatus",outputs:[],stateMutability:"nonpayable",type:"function"}],J.CREATE_UNION_ADDRESS="0xcd62E6a07072Bed38F4126ba5C9361901c71846e",J.CREATE_UNION_ABI="",J.UNION_NUMBER_SYS_ADDRESS="0x45F0de10fA3982c4d18AbaE89a5F0663123f955c",J.UNION_NUMBER_SYS_ABI="",J.UPGRADE_UNION_ADDRESS="0x18320fD38F3806C0A9fb2B41202Ed0bD3f826894",J.UPGRADE_UNION_ABI="",J.UNION_DISTRIBUTE_ADDRESS="0x0f6b4bBa8b01B6ee2CC3232ea963ac702CaDCe04",J.UNION_WAR_ADDRESS="0xF8489Bb617F9DCaBF33bEaeBdA4CCD029E9E247E",J.UNION_DISTRIBUTE_ABI="",J.UNION_WAR_ABI="",J.HERO_TO_TOKEN_POOL_ADDRESS="",J.HERO_TO_TOKEN_POOL_ABI="",J.WITHDRAW_AND_RECHARGE_ADDRESS="",J.WITHDRAW_AND_RECHARGE_ABI="",J.SERIESHEROMALL_ADDRESS="",J.SERIESHEROMALL_ABI="",J.HEROFORMATION_ADDRESS="",J.HEROFORMATION_ABI="",J.HERO_MINT_ADDRESS="",J.HERO_MINT_ABI="",J.RECHANGE_ADDRESS_TOX="0x32926612d9399C1088045AEB821CCB5Ba904D697",J.RECHANGE_ADDRESS="0x4952981D44cb95c52F0a62D4Fe8702081338D824",J.RECHANGE_ABI_NEW=[{inputs:[],stateMutability:"nonpayable",type:"constructor"},{anonymous:!1,inputs:[{indexed:!1,internalType:"address",name:"sender",type:"address"},{indexed:!1,internalType:"address",name:"token",type:"address"},{indexed:!1,internalType:"address",name:"to",type:"address"},{indexed:!1,internalType:"uint256",name:"amount",type:"uint256"}],name:"Deposit",type:"event"},{anonymous:!1,inputs:[{indexed:!0,internalType:"bytes32",name:"role",type:"bytes32"},{indexed:!0,internalType:"bytes32",name:"previousAdminRole",type:"bytes32"},{indexed:!0,internalType:"bytes32",name:"newAdminRole",type:"bytes32"}],name:"RoleAdminChanged",type:"event"},{anonymous:!1,inputs:[{indexed:!0,internalType:"bytes32",name:"role",type:"bytes32"},{indexed:!0,internalType:"address",name:"account",type:"address"},{indexed:!0,internalType:"address",name:"sender",type:"address"}],name:"RoleGranted",type:"event"},{anonymous:!1,inputs:[{indexed:!0,internalType:"bytes32",name:"role",type:"bytes32"},{indexed:!0,internalType:"address",name:"account",type:"address"},{indexed:!0,internalType:"address",name:"sender",type:"address"}],name:"RoleRevoked",type:"event"},{anonymous:!1,inputs:[{indexed:!1,internalType:"address",name:"sender",type:"address"},{indexed:!1,internalType:"address",name:"to",type:"address"},{indexed:!1,internalType:"address",name:"token",type:"address"},{indexed:!1,internalType:"uint256",name:"amount",type:"uint256"},{indexed:!1,internalType:"uint256",name:"orderId",type:"uint256"}],name:"WithdrawToken",type:"event"},{inputs:[],name:"DEFAULT_ADMIN_ROLE",outputs:[{internalType:"bytes32",name:"",type:"bytes32"}],stateMutability:"view",type:"function"},{inputs:[],name:"MANAGER_ROLE",outputs:[{internalType:"bytes32",name:"",type:"bytes32"}],stateMutability:"view",type:"function"},{inputs:[],name:"bank",outputs:[{internalType:"address",name:"",type:"address"}],stateMutability:"view",type:"function"},{inputs:[],name:"depositETH",outputs:[],stateMutability:"payable",type:"function"},{inputs:[{internalType:"address",name:"token",type:"address"},{internalType:"uint256",name:"amount",type:"uint256"}],name:"depositToken",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"bytes32",name:"role",type:"bytes32"}],name:"getRoleAdmin",outputs:[{internalType:"bytes32",name:"",type:"bytes32"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"bytes32",name:"role",type:"bytes32"},{internalType:"address",name:"account",type:"address"}],name:"grantRole",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"bytes32",name:"role",type:"bytes32"},{internalType:"address",name:"account",type:"address"}],name:"hasRole",outputs:[{internalType:"bool",name:"",type:"bool"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"uint256",name:"",type:"uint256"}],name:"hasUsed",outputs:[{internalType:"bool",name:"",type:"bool"}],stateMutability:"view",type:"function"},{inputs:[],name:"receiveAddress",outputs:[{internalType:"address",name:"",type:"address"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"bytes32",name:"role",type:"bytes32"},{internalType:"address",name:"account",type:"address"}],name:"renounceRole",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"bytes32",name:"role",type:"bytes32"},{internalType:"address",name:"account",type:"address"}],name:"revokeRole",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address",name:"_receiveAddress",type:"address"}],name:"setAddress",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"bytes4",name:"interfaceId",type:"bytes4"}],name:"supportsInterface",outputs:[{internalType:"bool",name:"",type:"bool"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"address",name:"to",type:"address"},{internalType:"address",name:"token",type:"address"},{internalType:"uint256",name:"amount",type:"uint256"},{internalType:"uint256",name:"orderId",type:"uint256"}],name:"withdrawToken",outputs:[],stateMutability:"nonpayable",type:"function"}],J.ADDLOG_ADDRESS_TEST="0xfE561eebd0240cFb9c85339258784715100B237A",J.ADDLOG_ADDRESS="0x50FB876efe6AD1b4df2f23DFc85f5B8d4DCd4f72",J.ADDLOG_ABI=[{anonymous:!1,inputs:[{indexed:!1,internalType:"string",name:"target",type:"string"},{indexed:!1,internalType:"uint256",name:"pid",type:"uint256"},{indexed:!1,internalType:"string",name:"tid",type:"string"},{indexed:!1,internalType:"uint256",name:"_type",type:"uint256"}],name:"AddTicketLog",type:"event"},{anonymous:!1,inputs:[{indexed:!1,internalType:"string",name:"target",type:"string"},{indexed:!1,internalType:"string",name:"data",type:"string"}],name:"log",type:"event"},{inputs:[{internalType:"string",name:"data",type:"string"}],name:"addLog",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"uint256",name:"pid",type:"uint256"},{internalType:"string",name:"tid",type:"string"},{internalType:"uint256",name:"_type",type:"uint256"}],name:"addTicketLog",outputs:[],stateMutability:"nonpayable",type:"function"}],J.buyTicket_ABI=[{inputs:[],stateMutability:"nonpayable",type:"constructor"},{anonymous:!1,inputs:[{indexed:!1,internalType:"address",name:"sender",type:"address"},{indexed:!1,internalType:"uint256",name:"pid",type:"uint256"},{indexed:!1,internalType:"uint256",name:"ticketId",type:"uint256"},{indexed:!1,internalType:"uint256",name:"count",type:"uint256"},{indexed:!1,internalType:"address",name:"token",type:"address"},{indexed:!1,internalType:"uint256",name:"totalAmount",type:"uint256"},{indexed:!1,internalType:"uint256",name:"receiveAmount",type:"uint256"},{indexed:!1,internalType:"uint256",name:"feePoolAmount",type:"uint256"},{indexed:!1,internalType:"uint256",name:"dividendFeePoolAmount",type:"uint256"}],name:"BuyTicket",type:"event"},{anonymous:!1,inputs:[{indexed:!0,internalType:"address",name:"previousOwner",type:"address"},{indexed:!0,internalType:"address",name:"newOwner",type:"address"}],name:"OwnershipTransferred",type:"event"},{inputs:[{components:[{internalType:"uint256",name:"id",type:"uint256"},{internalType:"address",name:"token",type:"address"},{internalType:"uint256",name:"price",type:"uint256"},{internalType:"uint256",name:"fee",type:"uint256"},{internalType:"uint256",name:"dividendFeePoolRatio",type:"uint256"},{internalType:"uint256",name:"feePoolRatio",type:"uint256"},{internalType:"bool",name:"status",type:"bool"}],internalType:"struct TicketMall.TicketDetail[]",name:"tickets",type:"tuple[]"}],name:"addTicket",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"uint256",name:"pid",type:"uint256"},{internalType:"uint256",name:"ticketId",type:"uint256"},{internalType:"uint256",name:"count",type:"uint256"}],name:"buyTicket",outputs:[],stateMutability:"payable",type:"function"},{inputs:[],name:"dividendFeePool",outputs:[{internalType:"address",name:"",type:"address"}],stateMutability:"view",type:"function"},{inputs:[],name:"feePool",outputs:[{internalType:"address",name:"",type:"address"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"uint256",name:"ticketId",type:"uint256"},{internalType:"uint256",name:"count",type:"uint256"}],name:"getPayAmount",outputs:[{internalType:"uint256",name:"",type:"uint256"},{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[],name:"getTicketDetailList",outputs:[{components:[{internalType:"uint256",name:"id",type:"uint256"},{internalType:"address",name:"token",type:"address"},{internalType:"uint256",name:"price",type:"uint256"},{internalType:"uint256",name:"fee",type:"uint256"},{internalType:"uint256",name:"dividendFeePoolRatio",type:"uint256"},{internalType:"uint256",name:"feePoolRatio",type:"uint256"},{internalType:"bool",name:"status",type:"bool"}],internalType:"struct TicketMall.TicketDetail[]",name:"",type:"tuple[]"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"uint256",name:"",type:"uint256"}],name:"idPosition",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[],name:"isOpen",outputs:[{internalType:"bool",name:"",type:"bool"}],stateMutability:"view",type:"function"},{inputs:[],name:"owner",outputs:[{internalType:"address",name:"",type:"address"}],stateMutability:"view",type:"function"},{inputs:[],name:"receiveAddress",outputs:[{internalType:"address",name:"",type:"address"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"uint256",name:"ticketId",type:"uint256"}],name:"removeTicket",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[],name:"renounceOwnership",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"bool",name:"_isOpen",type:"bool"}],name:"setOpen",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address",name:"_feePool",type:"address"},{internalType:"address",name:"_dividendFeePool",type:"address"}],name:"setPool",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"uint256",name:"",type:"uint256"}],name:"ticketDetails",outputs:[{internalType:"uint256",name:"id",type:"uint256"},{internalType:"address",name:"token",type:"address"},{internalType:"uint256",name:"price",type:"uint256"},{internalType:"uint256",name:"fee",type:"uint256"},{internalType:"uint256",name:"dividendFeePoolRatio",type:"uint256"},{internalType:"uint256",name:"feePoolRatio",type:"uint256"},{internalType:"bool",name:"status",type:"bool"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"address",name:"newOwner",type:"address"}],name:"transferOwnership",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"uint256",name:"ticketId",type:"uint256"},{components:[{internalType:"uint256",name:"id",type:"uint256"},{internalType:"address",name:"token",type:"address"},{internalType:"uint256",name:"price",type:"uint256"},{internalType:"uint256",name:"fee",type:"uint256"},{internalType:"uint256",name:"dividendFeePoolRatio",type:"uint256"},{internalType:"uint256",name:"feePoolRatio",type:"uint256"},{internalType:"bool",name:"status",type:"bool"}],internalType:"struct TicketMall.TicketDetail",name:"ticketDetail",type:"tuple"}],name:"updateTicketDetail",outputs:[],stateMutability:"nonpayable",type:"function"}],J.buySkillCard_ABI=[{inputs:[],stateMutability:"nonpayable",type:"constructor"},{anonymous:!1,inputs:[{indexed:!1,internalType:"address",name:"sender",type:"address"},{indexed:!1,internalType:"uint256",name:"pid",type:"uint256"},{indexed:!1,internalType:"uint256",name:"cardId",type:"uint256"},{indexed:!1,internalType:"uint256",name:"count",type:"uint256"},{indexed:!1,internalType:"address",name:"token",type:"address"},{indexed:!1,internalType:"uint256",name:"totalAmount",type:"uint256"},{indexed:!1,internalType:"uint256",name:"receiveAmount",type:"uint256"},{indexed:!1,internalType:"uint256",name:"feePoolAmount",type:"uint256"},{indexed:!1,internalType:"uint256",name:"dividendFeePoolAmount",type:"uint256"}],name:"BuySkillCard",type:"event"},{anonymous:!1,inputs:[{indexed:!0,internalType:"address",name:"previousOwner",type:"address"},{indexed:!0,internalType:"address",name:"newOwner",type:"address"}],name:"OwnershipTransferred",type:"event"},{inputs:[{components:[{internalType:"uint256",name:"id",type:"uint256"},{internalType:"address",name:"token",type:"address"},{internalType:"uint256",name:"price",type:"uint256"},{internalType:"uint256",name:"fee",type:"uint256"},{internalType:"uint256",name:"dividendFeePoolRatio",type:"uint256"},{internalType:"uint256",name:"feePoolRatio",type:"uint256"},{internalType:"bool",name:"status",type:"bool"}],internalType:"struct SkillCardMall.SkillCardDetail[]",name:"cards",type:"tuple[]"}],name:"addSkillCard",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"uint256",name:"pid",type:"uint256"},{internalType:"uint256",name:"cardId",type:"uint256"},{internalType:"uint256",name:"count",type:"uint256"}],name:"buySkillCard",outputs:[],stateMutability:"payable",type:"function"},{inputs:[],name:"dividendFeePool",outputs:[{internalType:"address",name:"",type:"address"}],stateMutability:"view",type:"function"},{inputs:[],name:"feePool",outputs:[{internalType:"address",name:"",type:"address"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"uint256",name:"cardId",type:"uint256"},{internalType:"uint256",name:"count",type:"uint256"}],name:"getPayAmount",outputs:[{internalType:"uint256",name:"",type:"uint256"},{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[],name:"getSkillCardDetailList",outputs:[{components:[{internalType:"uint256",name:"id",type:"uint256"},{internalType:"address",name:"token",type:"address"},{internalType:"uint256",name:"price",type:"uint256"},{internalType:"uint256",name:"fee",type:"uint256"},{internalType:"uint256",name:"dividendFeePoolRatio",type:"uint256"},{internalType:"uint256",name:"feePoolRatio",type:"uint256"},{internalType:"bool",name:"status",type:"bool"}],internalType:"struct SkillCardMall.SkillCardDetail[]",name:"",type:"tuple[]"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"uint256",name:"",type:"uint256"}],name:"idPosition",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[],name:"isOpen",outputs:[{internalType:"bool",name:"",type:"bool"}],stateMutability:"view",type:"function"},{inputs:[],name:"owner",outputs:[{internalType:"address",name:"",type:"address"}],stateMutability:"view",type:"function"},{inputs:[],name:"receiveAddress",outputs:[{internalType:"address",name:"",type:"address"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"uint256",name:"cardId",type:"uint256"}],name:"removeSkillCard",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[],name:"renounceOwnership",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"bool",name:"_isOpen",type:"bool"}],name:"setOpen",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address",name:"_feePool",type:"address"},{internalType:"address",name:"_dividendFeePool",type:"address"}],name:"setPool",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"uint256",name:"",type:"uint256"}],name:"skillCardDetails",outputs:[{internalType:"uint256",name:"id",type:"uint256"},{internalType:"address",name:"token",type:"address"},{internalType:"uint256",name:"price",type:"uint256"},{internalType:"uint256",name:"fee",type:"uint256"},{internalType:"uint256",name:"dividendFeePoolRatio",type:"uint256"},{internalType:"uint256",name:"feePoolRatio",type:"uint256"},{internalType:"bool",name:"status",type:"bool"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"address",name:"newOwner",type:"address"}],name:"transferOwnership",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"uint256",name:"cardId",type:"uint256"},{components:[{internalType:"uint256",name:"id",type:"uint256"},{internalType:"address",name:"token",type:"address"},{internalType:"uint256",name:"price",type:"uint256"},{internalType:"uint256",name:"fee",type:"uint256"},{internalType:"uint256",name:"dividendFeePoolRatio",type:"uint256"},{internalType:"uint256",name:"feePoolRatio",type:"uint256"},{internalType:"bool",name:"status",type:"bool"}],internalType:"struct SkillCardMall.SkillCardDetail",name:"skillCardDetail",type:"tuple"}],name:"updateSkillCardDetail",outputs:[],stateMutability:"nonpayable",type:"function"}],J.rentNft_ABI=[{inputs:[],stateMutability:"nonpayable",type:"constructor"},{inputs:[],name:"InvalidShortString",type:"error"},{inputs:[{internalType:"string",name:"str",type:"string"}],name:"StringTooLong",type:"error"},{anonymous:!1,inputs:[],name:"EIP712DomainChanged",type:"event"},{anonymous:!1,inputs:[{indexed:!0,internalType:"address",name:"previousOwner",type:"address"},{indexed:!0,internalType:"address",name:"newOwner",type:"address"}],name:"OwnershipTransferred",type:"event"},{anonymous:!1,inputs:[{indexed:!1,internalType:"address",name:"sender",type:"address"},{indexed:!1,internalType:"address",name:"to",type:"address"},{indexed:!1,internalType:"address",name:"token",type:"address"},{indexed:!1,internalType:"uint256",name:"amount",type:"uint256"},{indexed:!1,internalType:"uint256",name:"orderId",type:"uint256"},{indexed:!1,internalType:"uint256",name:"_days",type:"uint256"},{indexed:!1,internalType:"uint256",name:"deadline",type:"uint256"},{indexed:!1,internalType:"bytes",name:"signature",type:"bytes"},{indexed:!1,internalType:"uint256",name:"receiveAmount",type:"uint256"},{indexed:!1,internalType:"uint256",name:"feePoolAmount",type:"uint256"},{indexed:!1,internalType:"uint256",name:"dividendFeePoolAmount",type:"uint256"}],name:"Rent",type:"event"},{inputs:[],name:"dividendFeePool",outputs:[{internalType:"address",name:"",type:"address"}],stateMutability:"view",type:"function"},{inputs:[],name:"eip712Domain",outputs:[{internalType:"bytes1",name:"fields",type:"bytes1"},{internalType:"string",name:"name",type:"string"},{internalType:"string",name:"version",type:"string"},{internalType:"uint256",name:"chainId",type:"uint256"},{internalType:"address",name:"verifyingContract",type:"address"},{internalType:"bytes32",name:"salt",type:"bytes32"},{internalType:"uint256[]",name:"extensions",type:"uint256[]"}],stateMutability:"view",type:"function"},{inputs:[],name:"feePool",outputs:[{internalType:"address",name:"",type:"address"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"uint256",name:"",type:"uint256"}],name:"hasUsed",outputs:[{internalType:"bool",name:"",type:"bool"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"bytes",name:"",type:"bytes"}],name:"hashList",outputs:[{internalType:"bool",name:"",type:"bool"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"address",name:"sender",type:"address"},{internalType:"address",name:"to",type:"address"},{internalType:"address",name:"token",type:"address"},{internalType:"uint256",name:"amount",type:"uint256"},{internalType:"uint256",name:"orderId",type:"uint256"},{internalType:"uint256",name:"_days",type:"uint256"},{internalType:"uint256",name:"deadline",type:"uint256"},{internalType:"bytes",name:"signature",type:"bytes"}],name:"isSigner",outputs:[{internalType:"bool",name:"",type:"bool"}],stateMutability:"view",type:"function"},{inputs:[],name:"owner",outputs:[{internalType:"address",name:"",type:"address"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"address",name:"",type:"address"}],name:"ratios",outputs:[{internalType:"address",name:"token",type:"address"},{internalType:"uint256",name:"fee",type:"uint256"},{internalType:"uint256",name:"dividendFeePoolRatio",type:"uint256"},{internalType:"uint256",name:"feePoolRatio",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[],name:"renounceOwnership",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address",name:"sender",type:"address"},{internalType:"address",name:"to",type:"address"},{internalType:"address",name:"token",type:"address"},{internalType:"uint256",name:"amount",type:"uint256"},{internalType:"uint256",name:"orderId",type:"uint256"},{internalType:"uint256",name:"_days",type:"uint256"},{internalType:"uint256",name:"deadline",type:"uint256"},{internalType:"bytes",name:"signature",type:"bytes"}],name:"rent",outputs:[],stateMutability:"payable",type:"function"},{inputs:[{components:[{internalType:"address",name:"token",type:"address"},{internalType:"uint256",name:"fee",type:"uint256"},{internalType:"uint256",name:"dividendFeePoolRatio",type:"uint256"},{internalType:"uint256",name:"feePoolRatio",type:"uint256"}],internalType:"struct RentNFT.Ratio[]",name:"_ratios",type:"tuple[]"}],name:"setRatios",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address",name:"_signer",type:"address"}],name:"setSigner",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[],name:"signer",outputs:[{internalType:"address",name:"",type:"address"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"address",name:"newOwner",type:"address"}],name:"transferOwnership",outputs:[],stateMutability:"nonpayable",type:"function"}],J.nodeWithdrawToken_ABI=[{inputs:[],stateMutability:"nonpayable",type:"constructor"},{inputs:[],name:"InvalidShortString",type:"error"},{inputs:[{internalType:"string",name:"str",type:"string"}],name:"StringTooLong",type:"error"},{anonymous:!1,inputs:[],name:"EIP712DomainChanged",type:"event"},{anonymous:!1,inputs:[{indexed:!1,internalType:"address",name:"sender",type:"address"},{indexed:!1,internalType:"address",name:"token",type:"address"},{indexed:!1,internalType:"uint256",name:"amount",type:"uint256"},{indexed:!1,internalType:"uint256",name:"pid",type:"uint256"},{indexed:!1,internalType:"uint256",name:"orderId",type:"uint256"},{indexed:!1,internalType:"uint256",name:"deadline",type:"uint256"},{indexed:!1,internalType:"bytes",name:"signature",type:"bytes"}],name:"FeePoolWithdraw",type:"event"},{anonymous:!1,inputs:[{indexed:!0,internalType:"bytes32",name:"role",type:"bytes32"},{indexed:!0,internalType:"bytes32",name:"previousAdminRole",type:"bytes32"},{indexed:!0,internalType:"bytes32",name:"newAdminRole",type:"bytes32"}],name:"RoleAdminChanged",type:"event"},{anonymous:!1,inputs:[{indexed:!0,internalType:"bytes32",name:"role",type:"bytes32"},{indexed:!0,internalType:"address",name:"account",type:"address"},{indexed:!0,internalType:"address",name:"sender",type:"address"}],name:"RoleGranted",type:"event"},{anonymous:!1,inputs:[{indexed:!0,internalType:"bytes32",name:"role",type:"bytes32"},{indexed:!0,internalType:"address",name:"account",type:"address"},{indexed:!0,internalType:"address",name:"sender",type:"address"}],name:"RoleRevoked",type:"event"},{inputs:[],name:"DEFAULT_ADMIN_ROLE",outputs:[{internalType:"bytes32",name:"",type:"bytes32"}],stateMutability:"view",type:"function"},{inputs:[],name:"MANAGER_ROLE",outputs:[{internalType:"bytes32",name:"",type:"bytes32"}],stateMutability:"view",type:"function"},{inputs:[],name:"eip712Domain",outputs:[{internalType:"bytes1",name:"fields",type:"bytes1"},{internalType:"string",name:"name",type:"string"},{internalType:"string",name:"version",type:"string"},{internalType:"uint256",name:"chainId",type:"uint256"},{internalType:"address",name:"verifyingContract",type:"address"},{internalType:"bytes32",name:"salt",type:"bytes32"},{internalType:"uint256[]",name:"extensions",type:"uint256[]"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"address",name:"token",type:"address"}],name:"getBalance",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"bytes32",name:"role",type:"bytes32"}],name:"getRoleAdmin",outputs:[{internalType:"bytes32",name:"",type:"bytes32"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"bytes32",name:"role",type:"bytes32"},{internalType:"address",name:"account",type:"address"}],name:"grantRole",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"bytes32",name:"role",type:"bytes32"},{internalType:"address",name:"account",type:"address"}],name:"hasRole",outputs:[{internalType:"bool",name:"",type:"bool"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"uint256",name:"",type:"uint256"}],name:"hasUsed",outputs:[{internalType:"bool",name:"",type:"bool"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"bytes",name:"",type:"bytes"}],name:"hashList",outputs:[{internalType:"bool",name:"",type:"bool"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"address",name:"sender",type:"address"},{internalType:"address",name:"token",type:"address"},{internalType:"uint256",name:"amount",type:"uint256"},{internalType:"uint256",name:"pid",type:"uint256"},{internalType:"uint256",name:"orderId",type:"uint256"},{internalType:"uint256",name:"deadline",type:"uint256"},{internalType:"bytes",name:"signature",type:"bytes"}],name:"isSigner",outputs:[{internalType:"bool",name:"",type:"bool"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"bytes32",name:"role",type:"bytes32"},{internalType:"address",name:"account",type:"address"}],name:"renounceRole",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"bytes32",name:"role",type:"bytes32"},{internalType:"address",name:"account",type:"address"}],name:"revokeRole",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address",name:"_signer",type:"address"}],name:"setSigner",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[],name:"signer",outputs:[{internalType:"address",name:"",type:"address"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"bytes4",name:"interfaceId",type:"bytes4"}],name:"supportsInterface",outputs:[{internalType:"bool",name:"",type:"bool"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"address",name:"token",type:"address"},{internalType:"address",name:"to",type:"address"},{internalType:"uint256",name:"amount",type:"uint256"}],name:"withdraw",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address",name:"sender",type:"address"},{internalType:"address",name:"token",type:"address"},{internalType:"uint256",name:"amount",type:"uint256"},{internalType:"uint256",name:"pid",type:"uint256"},{internalType:"uint256",name:"orderId",type:"uint256"},{internalType:"uint256",name:"deadline",type:"uint256"},{internalType:"bytes",name:"signature",type:"bytes"}],name:"withdrawToken",outputs:[],stateMutability:"nonpayable",type:"function"},{stateMutability:"payable",type:"receive"}],J.IGO_ADDRESS_TEST="0x81bCa019f388207FDb0C14459f46960FF4E75C17",J.IGO_ADDRESS="0x3ea5fde901b691d6175fd559e8f11dfdb7effb9a",J.IGO_ABI=[{inputs:[],stateMutability:"nonpayable",type:"constructor"},{inputs:[],name:"InvalidShortString",type:"error"},{inputs:[{internalType:"string",name:"str",type:"string"}],name:"StringTooLong",type:"error"},{anonymous:!1,inputs:[],name:"EIP712DomainChanged",type:"event"},{anonymous:!1,inputs:[{indexed:!1,internalType:"address",name:"sender",type:"address"},{indexed:!1,internalType:"uint256",name:"amount",type:"uint256"},{indexed:!1,internalType:"uint256",name:"timestamp",type:"uint256"}],name:"Recharge",type:"event"},{inputs:[],name:"USD",outputs:[{internalType:"address",name:"",type:"address"}],stateMutability:"view",type:"function"},{inputs:[],name:"deadline",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[],name:"eip712Domain",outputs:[{internalType:"bytes1",name:"fields",type:"bytes1"},{internalType:"string",name:"name",type:"string"},{internalType:"string",name:"version",type:"string"},{internalType:"uint256",name:"chainId",type:"uint256"},{internalType:"address",name:"verifyingContract",type:"address"},{internalType:"bytes32",name:"salt",type:"bytes32"},{internalType:"uint256[]",name:"extensions",type:"uint256[]"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"address",name:"account",type:"address"}],name:"getAmounts",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"address",name:"account",type:"address"}],name:"getParentAccount",outputs:[{internalType:"address",name:"",type:"address"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"address",name:"account",type:"address"}],name:"getRecords",outputs:[{components:[{internalType:"uint256",name:"amount",type:"uint256"},{internalType:"uint256",name:"timestamp",type:"uint256"}],internalType:"struct FodcIGO.Record[]",name:"",type:"tuple[]"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"bytes",name:"",type:"bytes"}],name:"hashList",outputs:[{internalType:"bool",name:"",type:"bool"}],stateMutability:"view",type:"function"},{inputs:[],name:"inviterAddress",outputs:[{internalType:"address",name:"",type:"address"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"address",name:"sender",type:"address"},{internalType:"uint256",name:"amount",type:"uint256"},{internalType:"address",name:"inviter",type:"address"},{internalType:"uint256",name:"_deadline",type:"uint256"},{internalType:"bytes",name:"signature",type:"bytes"}],name:"isSigner",outputs:[{internalType:"bool",name:"",type:"bool"}],stateMutability:"view",type:"function"},{inputs:[],name:"minAmount",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"address",name:"sender",type:"address"},{internalType:"uint256",name:"amount",type:"uint256"},{internalType:"address",name:"inviter",type:"address"},{internalType:"uint256",name:"_deadline",type:"uint256"},{internalType:"bytes",name:"signature",type:"bytes"}],name:"recharge",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[],name:"signer",outputs:[{internalType:"address",name:"",type:"address"}],stateMutability:"view",type:"function"},{inputs:[],name:"totalQuota",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"}],J.SAT_ADDRESS="0x424CaA5beA9bDfeF9F49796D7C7005632fAbE2E8",J.SAT_ABI=[{inputs:[{internalType:"address",name:"account",type:"address"}],name:"getAuthStatus",outputs:[{internalType:"bool",name:"",type:"bool"}],type:"function"}];var Yu=class{constructor(){this.coins={};this.needTip=!0}};var zr=class n{constructor(){this.create_contract=null;this.edit_account=null;this.account_contract=null;this.tokenId=0}static get instance(){return n._instance||(n._instance=new n),n._instance}init(){typeof window.ethereum>"u"}async getAccountVoFromServer(){let t=await v.requestPost("cybertron-sys-api/api/v1/account/find",{address:F.instance.walletAddress},!1,!1);if(t){let e=new Yu;return Object.assign(e,t),console.log("info========"+JSON.stringify(e)),e}return t}async updateProfile(t,e,i){var a=b.instance.playerDto.sex,r=b.instance.playerDto;let s=await v.requestPost("wxgame/player/changeInfo",{name:t,sex:a,icon:e,country:i});return s?(r.icon=s.icon,r.country=s.country,r.name=s.name,r.sex=s.sex,r):null}async getTokenId(){return this.tokenId?this.tokenId:(this.tokenId=await this.account_contract.methods.tokenOfOwnerByIndex(F.instance.walletAddress,0).call(),this.tokenId=parseInt(this.tokenId+""),this.tokenId)}};function Ie(n,t,e){let i=n[t.name];if(typeof i=="function")return i;let a=n[e];return typeof a=="function"?a:r=>t(n,r)}Zt();$e();var Im=class extends K{constructor(t){super(`Filter type "${t}" is not supported.`,{name:"FilterTypeNotSupportedError"})}};ei();Ri();Uo();wn();rr();ts();var vT="/docs/contract/encodeEventTopics";function va(n){let{abi:t,eventName:e,args:i}=n,a=t[0];if(e){let l=_a({abi:t,name:e});if(!l)throw new Bo(e,{docsPath:vT});a=l}if(a.type!=="event")throw new Bo(void 0,{docsPath:vT});let r=fi(a),s=En(r),o=[];if(i&&"inputs"in a){let l=a.inputs?.filter(u=>"indexed"in u&&u.indexed),c=Array.isArray(i)?i:Object.values(i).length>0?l?.map(u=>i[u.name])??[]:[];c.length>0&&(o=l?.map((u,p)=>Array.isArray(c[p])?c[p].map((d,L)=>xT({param:u,value:c[p][L]})):c[p]?xT({param:u,value:c[p]}):null)??[])}return[s,...o]}function xT({param:n,value:t}){if(n.type==="string"||n.type==="bytes")return ht(Mi(t));if(n.type==="tuple"||n.type.match(/^(.*)\[(\d+)?\]$/))throw new Im(n.type);return Di([n],[t])}Fe();function Tn(n,{method:t}){let e={};return n.transport.type==="fallback"&&n.transport.onResponse?.(({method:i,response:a,status:r,transport:s})=>{r==="success"&&t===i&&(e[a]=s.request)}),i=>e[i]||n.request}async function Gm(n,t){let{address:e,abi:i,args:a,eventName:r,fromBlock:s,strict:o,toBlock:l}=t,c=Tn(n,{method:"eth_newFilter"}),u=r?va({abi:i,args:a,eventName:r}):void 0,p=await n.request({method:"eth_newFilter",params:[{address:e,fromBlock:typeof s=="bigint"?Ce(s):s,toBlock:typeof l=="bigint"?Ce(l):l,topics:u}]});return{abi:i,args:a,eventName:r,id:p,request:c(p),strict:!!o,type:"event"}}xi();xa();Zt();$e();Cn();zo();var AA=3;function ra(n,{abi:t,address:e,args:i,docsPath:a,functionName:r,sender:s}){let{code:o,data:l,message:c,shortMessage:u}=n instanceof Qa?n:n instanceof K?n.walk(d=>"data"in d)||n.walk():{},p=(()=>n instanceof ya?new qo({functionName:r}):[AA,Ja.code].includes(o)&&(l||c||u)?new vt({abi:t,data:typeof l=="object"?l.data:l,functionName:r,message:u??c}):n)();return new Ko(p,{abi:t,args:i,contractAddress:e,docsPath:a,functionName:r,sender:s})}xi();$e();lr();Ri();function HT(n){let t=ht(`0x${n.substring(4)}`).substring(26);return $a(`0x${t}`)}Qi();oi();Fe();async function LC({hash:n,signature:t}){let e=Rt(n)?n:De(n),{secp256k1:i}=await Promise.resolve().then(()=>(xp(),bC));return`0x${(()=>{if(typeof t=="object"&&"r"in t&&"s"in t){let{r:c,s:u,v:p,yParity:d}=t,L=Number(d??p),x=gC(L);return new i.Signature(Ut(c),Ut(u)).addRecoveryBit(x)}let s=Rt(t)?t:De(t),o=Vt(`0x${s.slice(130)}`),l=gC(o);return i.Signature.fromCompact(s.substring(2,130)).addRecoveryBit(l)})().recoverPublicKey(e.substring(2)).toHex(!1)}`}function gC(n){if(n===0||n===1)return n;if(n===27)return 0;if(n===28)return 1;throw new Error("Invalid yParityOrV value")}async function Ip({hash:n,signature:t}){return HT(await LC({hash:n,signature:t}))}Pi();ei();Fe();$e();Ym();ei();Fe();function la(n,t="hex"){let e=_C(n),i=as(new Uint8Array(e.length));return e.encode(i),t==="hex"?at(i.bytes):i.bytes}function _C(n){return Array.isArray(n)?bk(n.map(t=>_C(t))):gk(n)}function bk(n){let t=n.reduce((a,r)=>a+r.length,0),e=vC(t);return{length:(()=>t<=55?1+t:1+e+t)(),encode(a){t<=55?a.pushByte(192+t):(a.pushByte(192+55+e),e===1?a.pushUint8(t):e===2?a.pushUint16(t):e===3?a.pushUint24(t):a.pushUint32(t));for(let{encode:r}of n)r(a)}}}function gk(n){let t=typeof n=="string"?qt(n):n,e=vC(t.length);return{length:(()=>t.length===1&&t[0]<128?1:t.length<=55?1+t.length:1+e+t.length)(),encode(a){t.length===1&&t[0]<128?a.pushBytes(t):t.length<=55?(a.pushByte(128+t.length),a.pushBytes(t)):(a.pushByte(128+55+e),e===1?a.pushUint8(t.length):e===2?a.pushUint16(t.length):e===3?a.pushUint24(t.length):a.pushUint32(t.length),a.pushBytes(t))}}}function vC(n){if(n<2**8)return 1;if(n<2**16)return 2;if(n<2**24)return 3;if(n<2**32)return 4;throw new K("Length is too large.")}Ri();function xC(n){let{chainId:t,contractAddress:e,nonce:i,to:a}=n,r=ht(li(["0x05",la([t?Ce(t):"0x",e,i?Ce(i):"0x"])]));return a==="bytes"?qt(r):r}async function Ep(n){let{authorization:t,signature:e}=n;return Ip({hash:xC(t),signature:e??t})}Fe();Jm();ss();$e();na();var wp=class extends K{constructor(t,{account:e,docsPath:i,chain:a,data:r,gas:s,gasPrice:o,maxFeePerGas:l,maxPriorityFeePerGas:c,nonce:u,to:p,value:d}){let L=mr({from:e?.address,to:p,value:typeof d<"u"&&`${rs(d)} ${a?.nativeCurrency?.symbol||"ETH"}`,data:r,gas:s,gasPrice:typeof o<"u"&&`${Yt(o)} gwei`,maxFeePerGas:typeof l<"u"&&`${Yt(l)} gwei`,maxPriorityFeePerGas:typeof c<"u"&&`${Yt(c)} gwei`,nonce:u});super(t.shortMessage,{cause:t,docsPath:i,metaMessages:[...t.metaMessages?[...t.metaMessages," "]:[],"Estimate Gas Arguments:",L].filter(Boolean),name:"EstimateGasExecutionError"}),Object.defineProperty(this,"cause",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.cause=t}};Ir();Tp();function IC(n,{docsPath:t,...e}){let i=(()=>{let a=Rs(n,e);return a instanceof Sa?n:a})();return new wp(i,{docsPath:t,...e})}Cp();tl();bI();Hs();xi();ss();$e();var Ap=class extends K{constructor(){super("`baseFeeMultiplier` must be greater than 1.",{name:"BaseFeeScalarError"})}},On=class extends K{constructor(){super("Chain does not support EIP-1559 fees.",{name:"Eip1559FeesNotSupportedError"})}},kp=class extends K{constructor({maxPriorityFeePerGas:t}){super(`\`maxFeePerGas\` cannot be less than the \`maxPriorityFeePerGas\` (${Yt(t)} gwei).`,{name:"MaxFeePerGasTooLowError"})}};oi();$e();var Us=class extends K{constructor({blockHash:t,blockNumber:e}){let i="Block";t&&(i=`Block at hash "${t}"`),e&&(i=`Block at number "${e}"`),super(`${i} could not be found.`,{name:"BlockNotFoundError"})}};Fe();Sp();oi();Sp();var LI={"0x0":"legacy","0x1":"eip2930","0x2":"eip1559","0x3":"eip4844","0x4":"eip7702"};function Er(n){let t={...n,blockHash:n.blockHash?n.blockHash:null,blockNumber:n.blockNumber?BigInt(n.blockNumber):null,chainId:n.chainId?Vt(n.chainId):void 0,gas:n.gas?BigInt(n.gas):void 0,gasPrice:n.gasPrice?BigInt(n.gasPrice):void 0,maxFeePerBlobGas:n.maxFeePerBlobGas?BigInt(n.maxFeePerBlobGas):void 0,maxFeePerGas:n.maxFeePerGas?BigInt(n.maxFeePerGas):void 0,maxPriorityFeePerGas:n.maxPriorityFeePerGas?BigInt(n.maxPriorityFeePerGas):void 0,nonce:n.nonce?Vt(n.nonce):void 0,to:n.to?n.to:null,transactionIndex:n.transactionIndex?Number(n.transactionIndex):null,type:n.type?LI[n.type]:void 0,typeHex:n.type?n.type:void 0,value:n.value?BigInt(n.value):void 0,v:n.v?BigInt(n.v):void 0};return n.authorizationList&&(t.authorizationList=xk(n.authorizationList)),t.yParity=(()=>{if(n.yParity)return Number(n.yParity);if(typeof t.v=="bigint"){if(t.v===0n||t.v===27n)return 0;if(t.v===1n||t.v===28n)return 1;if(t.v>=35n)return t.v%2n===0n?1:0}})(),t.type==="legacy"&&(delete t.accessList,delete t.maxFeePerBlobGas,delete t.maxFeePerGas,delete t.maxPriorityFeePerGas,delete t.yParity),t.type==="eip2930"&&(delete t.maxFeePerBlobGas,delete t.maxFeePerGas,delete t.maxPriorityFeePerGas),t.type==="eip1559"&&delete t.maxFeePerBlobGas,t}var wC=Ns("transaction",Er);function xk(n){return n.map(t=>({contractAddress:t.address,chainId:Number(t.chainId),nonce:Number(t.nonce),r:t.r,s:t.s,yParity:Number(t.yParity)}))}function _I(n){let t=(n.transactions??[]).map(e=>typeof e=="string"?e:Er(e));return{...n,baseFeePerGas:n.baseFeePerGas?BigInt(n.baseFeePerGas):null,blobGasUsed:n.blobGasUsed?BigInt(n.blobGasUsed):void 0,difficulty:n.difficulty?BigInt(n.difficulty):void 0,excessBlobGas:n.excessBlobGas?BigInt(n.excessBlobGas):void 0,gasLimit:n.gasLimit?BigInt(n.gasLimit):void 0,gasUsed:n.gasUsed?BigInt(n.gasUsed):void 0,hash:n.hash?n.hash:null,logsBloom:n.logsBloom?n.logsBloom:null,nonce:n.nonce?n.nonce:null,number:n.number?BigInt(n.number):null,size:n.size?BigInt(n.size):void 0,timestamp:n.timestamp?BigInt(n.timestamp):void 0,transactions:t,totalDifficulty:n.totalDifficulty?BigInt(n.totalDifficulty):null}}var TC=Ns("block",_I);async function mi(n,{blockHash:t,blockNumber:e,blockTag:i,includeTransactions:a}={}){let r=i??"latest",s=a??!1,o=e!==void 0?Ce(e):void 0,l=null;if(t?l=await n.request({method:"eth_getBlockByHash",params:[t,s]},{dedupe:!0}):l=await n.request({method:"eth_getBlockByNumber",params:[o||r,s]},{dedupe:!!o}),!l)throw new Us({blockHash:t,blockNumber:e});return(n.chain?.formatters?.block?.format||_I)(l)}async function Vs(n){let t=await n.request({method:"eth_gasPrice"});return BigInt(t)}async function CC(n,t){return vI(n,t)}async function vI(n,t){let{block:e,chain:i=n.chain,request:a}=t||{};try{let r=i?.fees?.maxPriorityFeePerGas??i?.fees?.defaultPriorityFee;if(typeof r=="function"){let o=e||await Ie(n,mi,"getBlock")({}),l=await r({block:o,client:n,request:a});if(l===null)throw new Error;return l}if(typeof r<"u")return r;let s=await n.request({method:"eth_maxPriorityFeePerGas"});return Ut(s)}catch{let[r,s]=await Promise.all([e?Promise.resolve(e):Ie(n,mi,"getBlock")({}),Ie(n,Vs,"getGasPrice")({})]);if(typeof r.baseFeePerGas!="bigint")throw new On;let o=s-r.baseFeePerGas;return o<0n?0n:o}}async function SC(n,t){return Bp(n,t)}async function Bp(n,t){let{block:e,chain:i=n.chain,request:a,type:r="eip1559"}=t||{},s=await(async()=>typeof i?.fees?.baseFeeMultiplier=="function"?i.fees.baseFeeMultiplier({block:e,client:n,request:a}):i?.fees?.baseFeeMultiplier??1.2)();if(s<1)throw new Ap;let l=10**(s.toString().split(".")[1]?.length??0),c=d=>d*BigInt(Math.ceil(s*l))/BigInt(l),u=e||await Ie(n,mi,"getBlock")({});if(typeof i?.fees?.estimateFeesPerGas=="function"){let d=await i.fees.estimateFeesPerGas({block:e,client:n,multiply:c,request:a,type:r});if(d!==null)return d}if(r==="eip1559"){if(typeof u.baseFeePerGas!="bigint")throw new On;let d=typeof a?.maxPriorityFeePerGas=="bigint"?a.maxPriorityFeePerGas:await vI(n,{block:u,chain:i,request:a}),L=c(u.baseFeePerGas);return{maxFeePerGas:a?.maxFeePerGas??L+d,maxPriorityFeePerGas:d}}return{gasPrice:a?.gasPrice??c(await Ie(n,Vs,"getGasPrice")({}))}}oi();Fe();async function Mp(n,{address:t,blockTag:e="latest",blockNumber:i}){let a=await n.request({method:"eth_getTransactionCount",params:[t,i?Ce(i):e]},{dedupe:!!i});return Vt(a)}ei();Fe();function Fs(n){let{kzg:t}=n,e=n.to??(typeof n.blobs[0]=="string"?"hex":"bytes"),i=typeof n.blobs[0]=="string"?n.blobs.map(r=>qt(r)):n.blobs,a=[];for(let r of i)a.push(Uint8Array.from(t.blobToKzgCommitment(r)));return e==="bytes"?a:a.map(r=>at(r))}ei();Fe();function Gs(n){let{kzg:t}=n,e=n.to??(typeof n.blobs[0]=="string"?"hex":"bytes"),i=typeof n.blobs[0]=="string"?n.blobs.map(s=>qt(s)):n.blobs,a=typeof n.commitments[0]=="string"?n.commitments.map(s=>qt(s)):n.commitments,r=[];for(let s=0;s<i.length;s++){let o=i[s],l=a[s];r.push(Uint8Array.from(t.computeBlobKzgProof(o,l)))}return e==="bytes"?r:r.map(s=>at(s))}Fe();X0();Qi();ei();Fe();function DC(n,t){let e=t||"hex",i=yr(Rt(n,{strict:!1})?Mi(n):n);return e==="bytes"?i:De(i)}function AC(n){let{commitment:t,version:e=1}=n,i=n.to??(typeof t=="string"?"hex":"bytes"),a=DC(t,"bytes");return a.set([e],0),i==="bytes"?a:at(a)}function Rp(n){let{commitments:t,version:e}=n,i=n.to??(typeof t[0]=="string"?"hex":"bytes"),a=[];for(let r of t)a.push(AC({commitment:r,to:i,version:e}));return a}$e();var Pp=class extends K{constructor({maxSize:t,size:e}){super("Blob size is too large.",{metaMessages:[`Max: ${t} bytes`,`Given: ${e} bytes`],name:"BlobSizeTooLargeError"})}},Ks=class extends K{constructor(){super("Blob data must not be empty.",{name:"EmptyBlobError"})}},Np=class extends K{constructor({hash:t,size:e}){super(`Versioned hash "${t}" size is invalid.`,{metaMessages:["Expected: 32",`Received: ${e}`],name:"InvalidVersionedHashSizeError"})}},Op=class extends K{constructor({hash:t,version:e}){super(`Versioned hash "${t}" version is invalid.`,{metaMessages:[`Expected: ${1}`,`Received: ${e}`],name:"InvalidVersionedHashVersionError"})}};Ym();Ji();ei();Fe();function kC(n){let t=n.to??(typeof n.data=="string"?"hex":"bytes"),e=typeof n.data=="string"?qt(n.data):n.data,i=ot(e);if(!i)throw new Ks;if(i>761855)throw new Pp({maxSize:761855,size:i});let a=[],r=!0,s=0;for(;r;){let o=as(new Uint8Array(131072)),l=0;for(;l<4096;){let c=e.slice(s,s+(32-1));if(o.pushByte(0),o.pushBytes(c),c.length<31){o.pushByte(128),r=!1;break}l++,s+=31}a.push(o)}return t==="bytes"?a.map(o=>o.bytes):a.map(o=>at(o.bytes))}function Hp(n){let{data:t,kzg:e,to:i}=n,a=n.blobs??kC({data:t,to:i}),r=n.commitments??Fs({blobs:a,kzg:e,to:i}),s=n.proofs??Gs({blobs:a,commitments:r,kzg:e,to:i}),o=[];for(let l=0;l<a.length;l++)o.push({blob:a[l],commitment:r[l],proof:s[l]});return o}Hs();na();function Up(n){if(n.type)return n.type;if(typeof n.authorizationList<"u")return"eip7702";if(typeof n.blobs<"u"||typeof n.blobVersionedHashes<"u"||typeof n.maxFeePerBlobGas<"u"||typeof n.sidecars<"u")return"eip4844";if(typeof n.maxFeePerGas<"u"||typeof n.maxPriorityFeePerGas<"u")return"eip1559";if(typeof n.gasPrice<"u")return typeof n.accessList<"u"?"eip2930":"legacy";throw new ap({transaction:n})}oi();async function Aa(n){let t=await n.request({method:"eth_chainId"},{dedupe:!0});return Vt(t)}var xI=["blobVersionedHashes","chainId","fees","gas","nonce","type"];async function Hn(n,t){let{account:e=n.account,blobs:i,chain:a,gas:r,kzg:s,nonce:o,nonceManager:l,parameters:c=xI,type:u}=t,p=e&&_t(e),d={...t,...p?{from:p?.address}:{}},L;async function x(){return L||(L=await Ie(n,mi,"getBlock")({blockTag:"latest"}),L)}let w;async function I(){return w||(a?a.id:typeof t.chainId<"u"?t.chainId:(w=await Ie(n,Aa,"getChainId")({}),w))}if((c.includes("blobVersionedHashes")||c.includes("sidecars"))&&i&&s){let M=Fs({blobs:i,kzg:s});if(c.includes("blobVersionedHashes")){let H=Rp({commitments:M,to:"hex"});d.blobVersionedHashes=H}if(c.includes("sidecars")){let H=Gs({blobs:i,commitments:M,kzg:s}),V=Hp({blobs:i,commitments:M,proofs:H,to:"hex"});d.sidecars=V}}if(c.includes("chainId")&&(d.chainId=await I()),c.includes("nonce")&&typeof o>"u"&&p)if(l){let M=await I();d.nonce=await l.consume({address:p.address,chainId:M,client:n})}else d.nonce=await Ie(n,Mp,"getTransactionCount")({address:p.address,blockTag:"pending"});if((c.includes("fees")||c.includes("type"))&&typeof u>"u")try{d.type=Up(d)}catch{let M=await x();d.type=typeof M?.baseFeePerGas=="bigint"?"eip1559":"legacy"}if(c.includes("fees"))if(d.type!=="legacy"&&d.type!=="eip2930"){if(typeof d.maxFeePerGas>"u"||typeof d.maxPriorityFeePerGas>"u"){let M=await x(),{maxFeePerGas:H,maxPriorityFeePerGas:V}=await Bp(n,{block:M,chain:a,request:d});if(typeof t.maxPriorityFeePerGas>"u"&&t.maxFeePerGas&&t.maxFeePerGas<V)throw new kp({maxPriorityFeePerGas:V});d.maxPriorityFeePerGas=V,d.maxFeePerGas=H}}else{if(typeof t.maxFeePerGas<"u"||typeof t.maxPriorityFeePerGas<"u")throw new On;let M=await x(),{gasPrice:H}=await Bp(n,{block:M,chain:a,request:d,type:"legacy"});d.gasPrice=H}return c.includes("gas")&&typeof r>"u"&&(d.gas=await Ie(n,qs,"estimateGas")({...d,account:p&&{address:p.address,type:"json-rpc"}})),Da(d),delete d.parameters,d}Fe();async function Vp(n,{address:t,blockNumber:e,blockTag:i="latest"}){let a=e?Ce(e):void 0,r=await n.request({method:"eth_getBalance",params:[t,a||i]});return BigInt(r)}async function qs(n,t){let{account:e=n.account}=t,i=e?_t(e):void 0;try{let $=function(ce){let{block:ve,request:Te,rpcStateOverride:N}=ce;return n.request({method:"eth_estimateGas",params:N?[Te,ve??"latest",N]:ve?[Te,ve]:[Te]})};var a=$;let{accessList:r,authorizationList:s,blobs:o,blobVersionedHashes:l,blockNumber:c,blockTag:u,data:p,gas:d,gasPrice:L,maxFeePerBlobGas:x,maxFeePerGas:w,maxPriorityFeePerGas:I,nonce:M,value:H,stateOverride:V,...q}=await Hn(n,{...t,parameters:i?.type==="local"?void 0:["blobVersionedHashes"]}),Z=(c?Ce(c):void 0)||u,Q=Dp(V),ee=await(async()=>{if(q.to)return q.to;if(s&&s.length>0)return await Ep({authorization:s[0]}).catch(()=>{throw new K("`to` is required. Could not infer from `authorizationList`")})})();Da(t);let ae=n.chain?.formatters?.transactionRequest?.format,we=(ae||Nn)({...Ps(q,{format:ae}),from:i?.address,accessList:r,authorizationList:s,blobs:o,blobVersionedHashes:l,data:p,gas:d,gasPrice:L,maxFeePerBlobGas:x,maxFeePerGas:w,maxPriorityFeePerGas:I,nonce:M,to:ee,value:H}),Oe=BigInt(await $({block:Z,request:we,rpcStateOverride:Q}));if(s){let ce=await Vp(n,{address:we.from}),ve=await Promise.all(s.map(async Te=>{let{contractAddress:N}=Te,We=await $({block:Z,request:{authorizationList:void 0,data:p,from:i?.address,to:N,value:Ce(ce)},rpcStateOverride:Q}).catch(()=>100000n);return 2n*BigInt(We)}));Oe+=ve.reduce((Te,N)=>Te+N,0n)}return Oe}catch(r){throw IC(r,{...t,account:i,chain:n.chain})}}async function BC(n,t){let{abi:e,address:i,args:a,functionName:r,...s}=t,o=Wt({abi:e,args:a,functionName:r});try{return await Ie(n,qs,"estimateGas")({data:o,to:i,...s})}catch(l){let c=s.account?_t(s.account):void 0;throw ra(l,{abi:e,address:i,args:a,docsPath:"/docs/contract/estimateContractGas",functionName:r,sender:c?.address})}}ts();Zt();il();ei();Ri();Uo();Zt();Ji();Uo();q0();zm();rr();var MC="/docs/contract/decodeEventLog";function Ws(n){let{abi:t,data:e,strict:i,topics:a}=n,r=i??!0,[s,...o]=a;if(!s)throw new ym({docsPath:MC});let l=(()=>t.length===1?t[0]:t.find(w=>w.type==="event"&&s===En(fi(w))))();if(!(l&&"name"in l)||l.type!=="event")throw new Jr(s,{docsPath:MC});let{name:c,inputs:u}=l,p=u?.some(w=>!("name"in w&&w.name)),d=p?[]:{},L=u.filter(w=>"indexed"in w&&w.indexed);for(let w=0;w<L.length;w++){let I=L[w],M=o[w];if(!M)throw new ba({abiItem:l,param:I});d[p?w:I.name||w]=wk({param:I,value:M})}let x=u.filter(w=>!("indexed"in w&&w.indexed));if(x.length>0){if(e&&e!=="0x")try{let w=ur(x,e);if(w)if(p)d=[...d,...w];else for(let I=0;I<x.length;I++)d[x[I].name]=w[I]}catch(w){if(r)throw w instanceof Xr||w instanceof is?new Zi({abiItem:l,data:e,params:x,size:ot(e)}):w}else if(r)throw new Zi({abiItem:l,data:"0x",params:x,size:0})}return{eventName:c,args:Object.values(d).length>0?d:void 0}}function wk({param:n,value:t}){return n.type==="string"||n.type==="bytes"||n.type==="tuple"||n.type.match(/^(.*)\[(\d+)?\]$/)?t:(ur([n],t)||[])[0]}function Ys(n){let{abi:t,args:e,logs:i,strict:a=!0}=n,r=(()=>{if(n.eventName)return Array.isArray(n.eventName)?n.eventName:[n.eventName]})();return i.map(s=>{try{let o=t.find(c=>c.type==="event"&&s.topics[0]===En(c));if(!o)return null;let l=Ws({...s,abi:[o],strict:a});return r&&!r.includes(l.eventName)||!Tk({args:l.args,inputs:o.inputs,matchArgs:e})?null:{...l,...s}}catch(o){let l,c;if(o instanceof Jr)return null;if(o instanceof Zi||o instanceof ba){if(a)return null;l=o.abiItem.name,c=o.abiItem.inputs?.some(u=>!("name"in u&&u.name))}return{...s,args:c?[]:{},eventName:l}}}).filter(Boolean)}function Tk(n){let{args:t,inputs:e,matchArgs:i}=n;if(!i)return!0;if(!t)return!1;function a(r,s,o){try{return r.type==="address"?Un(s,o):r.type==="string"||r.type==="bytes"?ht(Mi(s))===o:s===o}catch{return!1}}return Array.isArray(t)&&Array.isArray(i)?i.every((r,s)=>{if(r==null)return!0;let o=e[s];return o?(Array.isArray(r)?r:[r]).some(c=>a(o,c,t[s])):!1}):typeof t=="object"&&!Array.isArray(t)&&typeof i=="object"&&!Array.isArray(i)?Object.entries(i).every(([r,s])=>{if(s==null)return!0;let o=e.find(c=>c.name===r);return o?(Array.isArray(s)?s:[s]).some(c=>a(o,c,t[r])):!1}):!1}Fe();function Ei(n,{args:t,eventName:e}={}){return{...n,blockHash:n.blockHash?n.blockHash:null,blockNumber:n.blockNumber?BigInt(n.blockNumber):null,logIndex:n.logIndex?Number(n.logIndex):null,transactionHash:n.transactionHash?n.transactionHash:null,transactionIndex:n.transactionIndex?Number(n.transactionIndex):null,...e?{args:t,eventName:e}:{}}}async function zs(n,{address:t,blockHash:e,fromBlock:i,toBlock:a,event:r,events:s,args:o,strict:l}={}){let c=l??!1,u=s??(r?[r]:void 0),p=[];u&&(p=[u.flatMap(w=>va({abi:[w],eventName:w.name,args:s?void 0:o}))],r&&(p=p[0]));let d;e?d=await n.request({method:"eth_getLogs",params:[{address:t,topics:p,blockHash:e}]}):d=await n.request({method:"eth_getLogs",params:[{address:t,topics:p,fromBlock:typeof i=="bigint"?Ce(i):i,toBlock:typeof a=="bigint"?Ce(a):a}]});let L=d.map(x=>Ei(x));return u?Ys({abi:u,args:o,logs:L,strict:c}):L}async function Fp(n,t){let{abi:e,address:i,args:a,blockHash:r,eventName:s,fromBlock:o,toBlock:l,strict:c}=t,u=s?_a({abi:e,name:s}):void 0,p=u?void 0:e.filter(d=>d.type==="event");return Ie(n,zs,"getLogs")({address:i,args:a,blockHash:r,event:u,events:p,fromBlock:o,toBlock:l,strict:c})}wr();xa();js();async function ni(n,t){let{abi:e,address:i,args:a,functionName:r,...s}=t,o=Wt({abi:e,args:a,functionName:r});try{let{data:l}=await Ie(n,ka,"call")({...s,data:o,to:i});return Ui({abi:e,args:a,functionName:r,data:l||"0x"})}catch(l){throw ra(l,{abi:e,address:i,args:a,docsPath:"/docs/contract/readContract",functionName:r})}}xi();wr();xa();js();async function jC(n,t){let{abi:e,address:i,args:a,dataSuffix:r,functionName:s,...o}=t,l=o.account?_t(o.account):n.account,c=Wt({abi:e,args:a,functionName:s});try{let{data:u}=await Ie(n,ka,"call")({batch:!1,data:`${c}${r?r.replace("0x",""):""}`,to:i,...o,account:l}),p=Ui({abi:e,args:a,functionName:s,data:u||"0x"}),d=e.filter(L=>"name"in L&&L.name===t.functionName);return{result:p,request:{abi:d,address:i,args:a,dataSuffix:r,functionName:s,...o,account:l}}}catch(u){throw ra(u,{abi:e,address:i,args:a,docsPath:"/docs/contract/simulateContract",functionName:s,sender:l?.address})}}Zt();zo();var BI=new Map,$C=new Map,Rk=0;function wi(n,t,e){let i=++Rk,a=()=>BI.get(n)||[],r=()=>{let u=a();BI.set(n,u.filter(p=>p.id!==i))},s=()=>{let u=$C.get(n);a().length===1&&u&&u(),r()},o=a();if(BI.set(n,[...o,{id:i,fns:t}]),o&&o.length>0)return s;let l={};for(let u in t)l[u]=(...p)=>{let d=a();if(d.length!==0)for(let L of d)L.fns[u]?.(...p)};let c=e(l);return typeof c=="function"&&$C.set(n,c),s}async function sl(n){return new Promise(t=>setTimeout(t,n))}function Ba(n,{emitOnBegin:t,initialWaitTime:e,interval:i}){let a=!0,r=()=>a=!1;return(async()=>{let o;t&&(o=await n({unpoll:r}));let l=await e?.(o)??i;await sl(l);let c=async()=>{a&&(await n({unpoll:r}),await sl(i),c())};c()})(),r}bi();var Pk=new Map,Nk=new Map;function XC(n){let t=(a,r)=>({clear:()=>r.delete(a),get:()=>r.get(a),set:s=>r.set(a,s)}),e=t(n,Pk),i=t(n,Nk);return{clear:()=>{e.clear(),i.clear()},promise:e,response:i}}async function QC(n,{cacheKey:t,cacheTime:e=Number.POSITIVE_INFINITY}){let i=XC(t),a=i.response.get();if(a&&e>0&&new Date().getTime()-a.created.getTime()<e)return a.data;let r=i.promise.get();r||(r=n(),i.promise.set(r));try{let s=await r;return i.response.set({created:new Date,data:s}),s}finally{i.promise.clear()}}var Ok=n=>`blockNumber.${n}`;async function Ma(n,{cacheTime:t=n.cacheTime}={}){let e=await QC(()=>n.request({method:"eth_blockNumber"}),{cacheKey:Ok(n.uid),cacheTime:t});return BigInt(e)}async function Vn(n,{filter:t}){let e="strict"in t&&t.strict,i=await t.request({method:"eth_getFilterChanges",params:[t.id]});if(typeof i[0]=="string")return i;let a=i.map(r=>Ei(r));return!("abi"in t)||!t.abi?a:Ys({abi:t.abi,logs:a,strict:e})}async function Fn(n,{filter:t}){return t.request({method:"eth_uninstallFilter",params:[t.id]})}function JC(n,t){let{abi:e,address:i,args:a,batch:r=!0,eventName:s,fromBlock:o,onError:l,onLogs:c,poll:u,pollingInterval:p=n.pollingInterval,strict:d}=t;return(()=>typeof u<"u"?u:typeof o=="bigint"?!0:!(n.transport.type==="webSocket"||n.transport.type==="fallback"&&n.transport.transports[0].config.type==="webSocket"))()?(()=>{let I=d??!1,M=nt(["watchContractEvent",i,a,r,n.uid,s,p,I,o]);return wi(M,{onLogs:c,onError:l},H=>{let V;o!==void 0&&(V=o-1n);let q,X=!1,Z=Ba(async()=>{if(!X){try{q=await Ie(n,Gm,"createContractEventFilter")({abi:e,address:i,args:a,eventName:s,strict:I,fromBlock:o})}catch{}X=!0;return}try{let Q;if(q)Q=await Ie(n,Vn,"getFilterChanges")({filter:q});else{let ee=await Ie(n,Ma,"getBlockNumber")({});V&&V<ee?Q=await Ie(n,Fp,"getContractEvents")({abi:e,address:i,args:a,eventName:s,fromBlock:V+1n,toBlock:ee,strict:I}):Q=[],V=ee}if(Q.length===0)return;if(r)H.onLogs(Q);else for(let ee of Q)H.onLogs([ee])}catch(Q){q&&Q instanceof Ea&&(X=!1),H.onError?.(Q)}},{emitOnBegin:!0,interval:p});return async()=>{q&&await Ie(n,Fn,"uninstallFilter")({filter:q}),Z()}})})():(()=>{let I=d??!1,M=nt(["watchContractEvent",i,a,r,n.uid,s,p,I]),H=!0,V=()=>H=!1;return wi(M,{onLogs:c,onError:l},q=>((async()=>{try{let X=(()=>{if(n.transport.type==="fallback"){let ee=n.transport.transports.find(ae=>ae.config.type==="webSocket");return ee?ee.value:n.transport}return n.transport})(),Z=s?va({abi:e,eventName:s,args:a}):[],{unsubscribe:Q}=await X.subscribe({params:["logs",{address:i,topics:Z}],onData(ee){if(!H)return;let ae=ee.result;try{let{eventName:Be,args:we}=Ws({abi:e,data:ae.data,topics:ae.topics,strict:d}),$=Ei(ae,{args:we,eventName:Be});q.onLogs([$])}catch(Be){let we,$;if(Be instanceof Zi||Be instanceof ba){if(d)return;we=Be.abiItem.name,$=Be.abiItem.inputs?.some(ce=>!("name"in ce&&ce.name))}let Oe=Ei(ae,{args:$?[]:{},eventName:we});q.onLogs([Oe])}},onError(ee){q.onError?.(ee)}});V=Q,H||V()}catch(X){l?.(X)}})(),()=>V()))})()}xi();$e();var Fi=class extends K{constructor({docsPath:t}={}){super(["Could not find an Account to execute with this Action.","Please provide an Account with the `account` argument on the Action, or by supplying an `account` to the Client."].join(`
`),{docsPath:t,docsSlug:"account",name:"AccountNotFoundError"})}},$s=class extends K{constructor({docsPath:t,metaMessages:e,type:i}){super(`Account type "${i}" is not supported.`,{docsPath:t,metaMessages:e,name:"AccountTypeNotSupportedError"})}};xa();xi();$e();rl();function Qp({chain:n,currentChainId:t}){if(!n)throw new qp;if(t!==n.id)throw new Kp({chain:n,currentChainId:t})}Ir();na();Tp();function ZC(n,{docsPath:t,...e}){let i=(()=>{let a=Rs(n,e);return a instanceof Sa?n:a})();return new rp(i,{docsPath:t,...e})}Cp();tl();Vo();Hs();async function Xs(n,{serializedTransaction:t}){return n.request({method:"eth_sendRawTransaction",params:[t]},{retryCount:0})}var MI=new La(128);async function Qs(n,t){let{account:e=n.account,chain:i=n.chain,accessList:a,authorizationList:r,blobs:s,data:o,gas:l,gasPrice:c,maxFeePerBlobGas:u,maxFeePerGas:p,maxPriorityFeePerGas:d,nonce:L,value:x,...w}=t;if(typeof e>"u")throw new Fi({docsPath:"/docs/actions/wallet/sendTransaction"});let I=e?_t(e):null;try{Da(t);let M=await(async()=>{if(t.to)return t.to;if(r&&r.length>0)return await Ep({authorization:r[0]}).catch(()=>{throw new K("`to` is required. Could not infer from `authorizationList`.")})})();if(I?.type==="json-rpc"||I===null){let H;i!==null&&(H=await Ie(n,Aa,"getChainId")({}),Qp({currentChainId:H,chain:i}));let V=n.chain?.formatters?.transactionRequest?.format,X=(V||Nn)({...Ps(w,{format:V}),accessList:a,authorizationList:r,blobs:s,chainId:H,data:o,from:I?.address,gas:l,gasPrice:c,maxFeePerBlobGas:u,maxFeePerGas:p,maxPriorityFeePerGas:d,nonce:L,to:M,value:x}),Z=MI.get(n.uid),Q=Z?"wallet_sendTransaction":"eth_sendTransaction";try{return await n.request({method:Q,params:[X]},{retryCount:0})}catch(ee){if(Z===!1)throw ee;let ae=ee;if(ae.name==="InvalidInputRpcError"||ae.name==="InvalidParamsRpcError"||ae.name==="MethodNotFoundRpcError"||ae.name==="MethodNotSupportedRpcError")return await n.request({method:"wallet_sendTransaction",params:[X]},{retryCount:0}).then(Be=>(MI.set(n.uid,!0),Be)).catch(Be=>{let we=Be;throw we.name==="MethodNotFoundRpcError"||we.name==="MethodNotSupportedRpcError"?(MI.set(n.uid,!1),ae):we});throw ae}}if(I?.type==="local"){let H=await Ie(n,Hn,"prepareTransactionRequest")({account:I,accessList:a,authorizationList:r,blobs:s,chain:i,data:o,gas:l,gasPrice:c,maxFeePerBlobGas:u,maxFeePerGas:p,maxPriorityFeePerGas:d,nonce:L,nonceManager:I.nonceManager,parameters:[...xI,"sidecars"],value:x,...w,to:M}),V=i?.serializers?.transaction,q=await I.signTransaction(H,{serializer:V});return await Ie(n,Xs,"sendRawTransaction")({serializedTransaction:q})}throw I?.type==="smart"?new $s({metaMessages:["Consider using the `sendUserOperation` Action instead."],docsPath:"/docs/actions/bundler/sendUserOperation",type:"smart"}):new $s({docsPath:"/docs/actions/wallet/sendTransaction",type:I?.type})}catch(M){throw M instanceof $s?M:ZC(M,{...t,account:I,chain:t.chain||void 0})}}async function e1(n,t){let{abi:e,account:i=n.account,address:a,args:r,dataSuffix:s,functionName:o,...l}=t;if(typeof i>"u")throw new Fi({docsPath:"/docs/contract/writeContract"});let c=i?_t(i):null,u=Wt({abi:e,args:r,functionName:o});try{return await Ie(n,Qs,"sendTransaction")({data:`${u}${s?s.replace("0x",""):""}`,to:a,account:c,...l})}catch(p){throw ra(p,{abi:e,address:a,args:r,docsPath:"/docs/contract/writeContract",functionName:o,sender:c?.address})}}$e();var Jp=class extends K{constructor({address:t}){super(`No EIP-712 domain found on contract "${t}".`,{metaMessages:["Ensure that:",`- The contract is deployed at the address "${t}".`,"- `eip712Domain()` function exists on the contract.","- `eip712Domain()` function matches signature to ERC-5267 specification."],name:"Eip712DomainNotFoundError"})}};async function t1(n,t){let{address:e,factory:i,factoryData:a}=t;try{let[r,s,o,l,c,u,p]=await Ie(n,ni,"readContract")({abi:Hk,address:e,functionName:"eip712Domain",factory:i,factoryData:a});return{domain:{name:s,version:o,chainId:Number(l),verifyingContract:c,salt:u},extensions:p,fields:r}}catch(r){let s=r;throw s.name==="ContractFunctionExecutionError"&&s.cause.name==="ContractFunctionZeroDataError"?new Jp({address:e}):s}}var Hk=[{inputs:[],name:"eip712Domain",outputs:[{name:"fields",type:"bytes1"},{name:"name",type:"string"},{name:"version",type:"string"},{name:"chainId",type:"uint256"},{name:"verifyingContract",type:"address"},{name:"salt",type:"bytes32"},{name:"extensions",type:"uint256[]"}],stateMutability:"view",type:"function"}];Fe();async function i1(n,{chain:t}){let{id:e,name:i,nativeCurrency:a,rpcUrls:r,blockExplorers:s}=t;await n.request({method:"wallet_addEthereumChain",params:[{chainId:Ce(e),chainName:i,nativeCurrency:a,rpcUrls:r.default.http,blockExplorerUrls:s?Object.values(s).map(({url:o})=>o):void 0}]},{dedupe:!0,retryCount:0})}xi();var Zp=256,eh;function th(n=11){if(!eh||Zp+n>256*2){eh="",Zp=0;for(let t=0;t<256;t++)eh+=(256+Math.random()*256|0).toString(16).substring(1)}return eh.substring(Zp,Zp+++n)}function ih(n){let{batch:t,cacheTime:e=n.pollingInterval??4e3,ccipRead:i,key:a="base",name:r="Base Client",pollingInterval:s=4e3,type:o="base"}=n,l=n.chain,c=n.account?_t(n.account):void 0,{config:u,request:p,value:d}=n.transport({chain:l,pollingInterval:s}),L={...u,...d},x={account:c,batch:t,cacheTime:e,ccipRead:i,chain:l,key:a,name:r,pollingInterval:s,request:p,transport:L,type:o,uid:th()};function w(I){return M=>{let H=M(I);for(let q in x)delete H[q];let V={...I,...H};return Object.assign(V,{extend:w(V)})}}return Object.assign(x,{extend:w(x)})}$e();us();zo();Fe();Ri();Vo();var ah=new La(8192);function a1(n,{enabled:t=!0,id:e}){if(!t||!e)return n();if(ah.get(e))return ah.get(e);let i=n().finally(()=>ah.delete(e));return ah.set(e,i),i}function ol(n,{delay:t=100,retryCount:e=2,shouldRetry:i=()=>!0}={}){return new Promise((a,r)=>{let s=async({count:o=0}={})=>{let l=async({error:c})=>{let u=typeof t=="function"?t({count:o,error:c}):t;u&&await sl(u),s({count:o+1})};try{let c=await n();a(c)}catch(c){if(o<e&&await i({count:o,error:c}))return l({error:c});r(c)}};s()})}bi();function n1(n,t={}){return async(e,i={})=>{let{dedupe:a=!1,retryDelay:r=150,retryCount:s=3,uid:o}={...t,...i},l=a?ht(ea(`${o}.${nt(e)}`)):void 0;return a1(()=>ol(async()=>{try{return await n(e)}catch(c){let u=c;switch(u.code){case ms.code:throw new ms(u);case ps.code:throw new ps(u);case hs.code:throw new hs(u,{method:e.method});case ds.code:throw new ds(u);case Ja.code:throw new Ja(u);case Ea.code:throw new Ea(u);case fs.code:throw new fs(u);case ys.code:throw new ys(u);case bs.code:throw new bs(u);case gs.code:throw new gs(u,{method:e.method});case dr.code:throw new dr(u);case Ls.code:throw new Ls(u);case fr.code:throw new fr(u);case _s.code:throw new _s(u);case vs.code:throw new vs(u);case xs.code:throw new xs(u);case Is.code:throw new Is(u);case Es.code:throw new Es(u);case 5e3:throw new fr(u);default:throw c instanceof K?c:new lp(u)}}},{delay:({count:c,error:u})=>{if(u&&u instanceof Ni){let p=u?.headers?.get("Retry-After");if(p?.match(/\d/))return Number.parseInt(p)*1e3}return~~(1<<c)*r},retryCount:s,shouldRetry:({error:c})=>Uk(c)}),{enabled:a,id:l})}}function Uk(n){return"code"in n&&typeof n.code=="number"?n.code===-1||n.code===dr.code||n.code===Ja.code:n instanceof Ni&&n.status?n.status===403||n.status===408||n.status===413||n.status===429||n.status===500||n.status===502||n.status===503||n.status===504:!0}function nh({key:n,name:t,request:e,retryCount:i=3,retryDelay:a=150,timeout:r,type:s},o){let l=th();return{config:{key:n,name:t,request:e,retryCount:i,retryDelay:a,timeout:r,type:s},request:n1(e,{retryCount:i,retryDelay:a,uid:l}),value:o}}function Js(n,t={}){let{key:e="custom",name:i="Custom Provider",retryDelay:a}=t;return({retryCount:r})=>nh({key:e,name:i,request:n.request.bind(n),retryCount:t.retryCount??r,retryDelay:a,type:"custom"})}us();$e();var rh=class extends K{constructor(){super("No URL was provided to the Transport. Please provide a valid RPC URL to the Transport.",{docsPath:"/docs/clients/intro",name:"UrlRequiredError"})}};kI();us();function r1(n,{errorInstance:t=new Error("timed out"),timeout:e,signal:i}){return new Promise((a,r)=>{(async()=>{let s;try{let o=new AbortController;e>0&&(s=setTimeout(()=>{i?o.abort():r(t)},e)),a(await n({signal:o?.signal||null}))}catch(o){o?.name==="AbortError"&&r(t),r(o)}finally{clearTimeout(s)}})()})}bi();function Vk(){return{current:0,take(){return this.current++},reset(){this.current=0}}}var RI=Vk();function s1(n,t={}){return{async request(e){let{body:i,onRequest:a=t.onRequest,onResponse:r=t.onResponse,timeout:s=t.timeout??1e4}=e,o={...t.fetchOptions??{},...e.fetchOptions??{}},{headers:l,method:c,signal:u}=o;try{let p=await r1(async({signal:L})=>{let x={...o,body:Array.isArray(i)?nt(i.map(H=>({jsonrpc:"2.0",id:H.id??RI.take(),...H}))):nt({jsonrpc:"2.0",id:i.id??RI.take(),...i}),headers:{"Content-Type":"application/json",...l},method:c||"POST",signal:u||(s>0?L:null)},w=new Request(n,x),I=await a?.(w,x)??{...x,url:n};return await fetch(I.url??n,I)},{errorInstance:new Yo({body:i,url:n}),timeout:s,signal:!0});r&&await r(p);let d;if(p.headers.get("Content-Type")?.startsWith("application/json"))d=await p.json();else{d=await p.text();try{d=JSON.parse(d||"{}")}catch(L){if(p.ok)throw L;d={error:d}}}if(!p.ok)throw new Ni({body:i,details:nt(d.error)||p.statusText,headers:p.headers,status:p.status,url:n});return d}catch(p){throw p instanceof Ni||p instanceof Yo?p:new Ni({body:i,cause:p,url:n})}}}}function ll(n,t={}){let{batch:e,fetchOptions:i,key:a="http",name:r="HTTP JSON-RPC",onFetchRequest:s,onFetchResponse:o,retryDelay:l}=t;return({chain:c,retryCount:u,timeout:p})=>{let{batchSize:d=1e3,wait:L=0}=typeof e=="object"?e:{},x=t.retryCount??u,w=p??t.timeout??1e4,I=n||c?.rpcUrls.default.http[0];if(!I)throw new rh;let M=s1(I,{fetchOptions:i,onRequest:s,onResponse:o,timeout:w});return nh({key:a,name:r,async request({method:H,params:V}){let q={method:H,params:V},{schedule:X}=zp({id:I,wait:L,shouldSplitBatch(ae){return ae.length>d},fn:ae=>M.request({body:ae}),sort:(ae,Be)=>ae.id-Be.id}),Z=async ae=>e?X(ae):[await M.request({body:ae})],[{error:Q,result:ee}]=await Z(q);if(Q)throw new cs({body:q,error:Q,url:I});return ee},retryCount:x,retryDelay:l,timeout:w,type:"http"},{fetchOptions:i,url:I})}}Tr();wr();xa();Ar();Zr();Fe();qm();$e();Cn();function Zs(n,t){if(!(n instanceof K))return!1;let e=n.walk(i=>i instanceof vt);return e instanceof vt?!!(e.data?.errorName==="ResolverNotFound"||e.data?.errorName==="ResolverWildcardNotSupported"||e.data?.errorName==="ResolverNotContract"||e.data?.errorName==="ResolverError"||e.data?.errorName==="HttpError"||e.reason?.includes("Wildcard on non-extended resolvers is not supported")||t==="reverse"&&e.reason===Km[50]):!1}Pi();ei();Fe();Ri();Qi();function sh(n){if(n.length!==66||n.indexOf("[")!==0||n.indexOf("]")!==65)return null;let t=`0x${n.slice(1,65)}`;return Rt(t)?t:null}function eo(n){let t=new Uint8Array(32).fill(0);if(!n)return at(t);let e=n.split(".");for(let i=e.length-1;i>=0;i-=1){let a=sh(e[i]),r=a?Mi(a):ht(ta(e[i]),"bytes");t=ht(yi([t,r]),"bytes")}return at(t)}ei();function o1(n){return`[${n.slice(2)}]`}ei();Fe();Ri();function l1(n){let t=new Uint8Array(32).fill(0);return n?sh(n)||ht(ta(n)):at(t)}function Gn(n){let t=n.replace(/^\.|\.$/gm,"");if(t.length===0)return new Uint8Array(1);let e=new Uint8Array(ta(t).byteLength+2),i=0,a=t.split(".");for(let r=0;r<a.length;r++){let s=ta(a[r]);s.byteLength>255&&(s=ta(o1(l1(a[r])))),e[i]=s.length,e.set(s,i+1),i+=s.length+1}return e.byteLength!==i+1?e.slice(0,i+1):e}async function c1(n,{blockNumber:t,blockTag:e,coinType:i,name:a,gatewayUrls:r,strict:s,universalResolverAddress:o}){let l=o;if(!l){if(!n.chain)throw new Error("client chain not configured. universalResolverAddress is required.");l=Vi({blockNumber:t,chain:n.chain,contract:"ensUniversalResolver"})}try{let c=Wt({abi:wI,functionName:"addr",...i!=null?{args:[eo(a),BigInt(i)]}:{args:[eo(a)]}}),u={address:l,abi:Gp,functionName:"resolve",args:[De(Gn(a)),c],blockNumber:t,blockTag:e},p=Ie(n,ni,"readContract"),d=r?await p({...u,args:[...u.args,r]}):await p(u);if(d[0]==="0x")return null;let L=Ui({abi:wI,args:i!=null?[eo(a),BigInt(i)]:void 0,functionName:"addr",data:d[0]});return L==="0x"||si(L)==="0x00"?null:L}catch(c){if(s)throw c;if(Zs(c,"resolve"))return null;throw c}}$e();var oh=class extends K{constructor({data:t}){super("Unable to extract image from metadata. The metadata may be malformed or invalid.",{metaMessages:["- Metadata must be a JSON object with at least an `image`, `image_url` or `image_data` property.","",`Provided data: ${JSON.stringify(t)}`],name:"EnsAvatarInvalidMetadataError"})}},Kn=class extends K{constructor({reason:t}){super(`ENS NFT avatar URI is invalid. ${t}`,{name:"EnsAvatarInvalidNftUriError"})}},to=class extends K{constructor({uri:t}){super(`Unable to resolve ENS avatar URI "${t}". The URI may be malformed, invalid, or does not respond with a valid image.`,{name:"EnsAvatarUriResolutionError"})}},lh=class extends K{constructor({namespace:t}){super(`ENS NFT avatar namespace "${t}" is not supported. Must be "erc721" or "erc1155".`,{name:"EnsAvatarUnsupportedNamespaceError"})}};var Fk=/(?<protocol>https?:\/\/[^\/]*|ipfs:\/|ipns:\/|ar:\/)?(?<root>\/)?(?<subpath>ipfs\/|ipns\/)?(?<target>[\w\-.]+)(?<subtarget>\/.*)?/,Gk=/^(Qm[1-9A-HJ-NP-Za-km-z]{44,}|b[A-Za-z2-7]{58,}|B[A-Z2-7]{58,}|z[1-9A-HJ-NP-Za-km-z]{48,}|F[0-9A-F]{50,})(\/(?<target>[\w\-.]+))?(?<subtarget>\/.*)?$/,Kk=/^data:([a-zA-Z\-/+]*);base64,([^"].*)/,qk=/^data:([a-zA-Z\-/+]*)?(;[a-zA-Z0-9].*?)?(,)/;async function Wk(n){try{let t=await fetch(n,{method:"HEAD"});return t.status===200?t.headers.get("content-type")?.startsWith("image/"):!1}catch(t){return typeof t=="object"&&typeof t.response<"u"||!globalThis.hasOwnProperty("Image")?!1:new Promise(e=>{let i=new Image;i.onload=()=>{e(!0)},i.onerror=()=>{e(!1)},i.src=n})}}function u1(n,t){return n?n.endsWith("/")?n.slice(0,-1):n:t}function PI({uri:n,gatewayUrls:t}){let e=Kk.test(n);if(e)return{uri:n,isOnChain:!0,isEncoded:e};let i=u1(t?.ipfs,"https://ipfs.io"),a=u1(t?.arweave,"https://arweave.net"),r=n.match(Fk),{protocol:s,subpath:o,target:l,subtarget:c=""}=r?.groups||{},u=s==="ipns:/"||o==="ipns/",p=s==="ipfs:/"||o==="ipfs/"||Gk.test(n);if(n.startsWith("http")&&!u&&!p){let L=n;return t?.arweave&&(L=n.replace(/https:\/\/arweave.net/g,t?.arweave)),{uri:L,isOnChain:!1,isEncoded:!1}}if((u||p)&&l)return{uri:`${i}/${u?"ipns":"ipfs"}/${l}${c}`,isOnChain:!1,isEncoded:!1};if(s==="ar:/"&&l)return{uri:`${a}/${l}${c||""}`,isOnChain:!1,isEncoded:!1};let d=n.replace(qk,"");if(d.startsWith("<svg")&&(d=`data:image/svg+xml;base64,${btoa(d)}`),d.startsWith("data:")||d.startsWith("{"))return{uri:d,isOnChain:!0,isEncoded:!1};throw new to({uri:n})}function NI(n){if(typeof n!="object"||!("image"in n)&&!("image_url"in n)&&!("image_data"in n))throw new oh({data:n});return n.image||n.image_url||n.image_data}async function m1({gatewayUrls:n,uri:t}){try{let e=await fetch(t).then(a=>a.json());return await ch({gatewayUrls:n,uri:NI(e)})}catch{throw new to({uri:t})}}async function ch({gatewayUrls:n,uri:t}){let{uri:e,isOnChain:i}=PI({uri:t,gatewayUrls:n});if(i||await Wk(e))return e;throw new to({uri:t})}function p1(n){let t=n;t.startsWith("did:nft:")&&(t=t.replace("did:nft:","").replace(/_/g,"/"));let[e,i,a]=t.split("/"),[r,s]=e.split(":"),[o,l]=i.split(":");if(!r||r.toLowerCase()!=="eip155")throw new Kn({reason:"Only EIP-155 supported"});if(!s)throw new Kn({reason:"Chain ID not found"});if(!l)throw new Kn({reason:"Contract address not found"});if(!a)throw new Kn({reason:"Token ID not found"});if(!o)throw new Kn({reason:"ERC namespace not found"});return{chainID:Number.parseInt(s),namespace:o.toLowerCase(),contractAddress:l,tokenID:a}}async function h1(n,{nft:t}){if(t.namespace==="erc721")return ni(n,{address:t.contractAddress,abi:[{name:"tokenURI",type:"function",stateMutability:"view",inputs:[{name:"tokenId",type:"uint256"}],outputs:[{name:"",type:"string"}]}],functionName:"tokenURI",args:[BigInt(t.tokenID)]});if(t.namespace==="erc1155")return ni(n,{address:t.contractAddress,abi:[{name:"uri",type:"function",stateMutability:"view",inputs:[{name:"_id",type:"uint256"}],outputs:[{name:"",type:"string"}]}],functionName:"uri",args:[BigInt(t.tokenID)]});throw new lh({namespace:t.namespace})}async function d1(n,{gatewayUrls:t,record:e}){return/eip155:/i.test(e)?Yk(n,{gatewayUrls:t,record:e}):ch({uri:e,gatewayUrls:t})}async function Yk(n,{gatewayUrls:t,record:e}){let i=p1(e),a=await h1(n,{nft:i}),{uri:r,isOnChain:s,isEncoded:o}=PI({uri:a,gatewayUrls:t});if(s&&(r.includes("data:application/json;base64,")||r.startsWith("{"))){let c=o?atob(r.replace("data:application/json;base64,","")):r,u=JSON.parse(c);return ch({uri:NI(u),gatewayUrls:t})}let l=i.tokenID;return i.namespace==="erc1155"&&(l=l.replace("0x","").padStart(64,"0")),m1({gatewayUrls:t,uri:r.replace(/(?:0x)?{id}/,l)})}Tr();wr();xa();Ar();Fe();async function uh(n,{blockNumber:t,blockTag:e,name:i,key:a,gatewayUrls:r,strict:s,universalResolverAddress:o}){let l=o;if(!l){if(!n.chain)throw new Error("client chain not configured. universalResolverAddress is required.");l=Vi({blockNumber:t,chain:n.chain,contract:"ensUniversalResolver"})}try{let c={address:l,abi:Gp,functionName:"resolve",args:[De(Gn(i)),Wt({abi:EI,functionName:"text",args:[eo(i),a]})],blockNumber:t,blockTag:e},u=Ie(n,ni,"readContract"),p=r?await u({...c,args:[...c.args,r]}):await u(c);if(p[0]==="0x")return null;let d=Ui({abi:EI,functionName:"text",data:p[0]});return d===""?null:d}catch(c){if(s)throw c;if(Zs(c,"resolve"))return null;throw c}}async function f1(n,{blockNumber:t,blockTag:e,assetGatewayUrls:i,name:a,gatewayUrls:r,strict:s,universalResolverAddress:o}){let l=await Ie(n,uh,"getEnsText")({blockNumber:t,blockTag:e,key:"avatar",name:a,universalResolverAddress:o,gatewayUrls:r,strict:s});if(!l)return null;try{return await d1(n,{record:l,gatewayUrls:i})}catch{return null}}Tr();Ar();Fe();async function y1(n,{address:t,blockNumber:e,blockTag:i,gatewayUrls:a,strict:r,universalResolverAddress:s}){let o=s;if(!o){if(!n.chain)throw new Error("client chain not configured. universalResolverAddress is required.");o=Vi({blockNumber:e,chain:n.chain,contract:"ensUniversalResolver"})}let l=`${t.toLowerCase().substring(2)}.addr.reverse`;try{let c={address:o,abi:PC,functionName:"reverse",args:[De(Gn(l))],blockNumber:e,blockTag:i},u=Ie(n,ni,"readContract"),[p,d]=a?await u({...c,args:[...c.args,a]}):await u(c);return t.toLowerCase()!==d.toLowerCase()?null:p}catch(c){if(r)throw c;if(Zs(c,"reverse"))return null;throw c}}Ar();Fe();async function b1(n,{blockNumber:t,blockTag:e,name:i,universalResolverAddress:a}){let r=a;if(!r){if(!n.chain)throw new Error("client chain not configured. universalResolverAddress is required.");r=Vi({blockNumber:t,chain:n.chain,contract:"ensUniversalResolver"})}let[s]=await Ie(n,ni,"readContract")({address:r,abi:[{inputs:[{type:"bytes"}],name:"findResolver",outputs:[{type:"address"},{type:"bytes32"}],stateMutability:"view",type:"function"}],functionName:"findResolver",args:[De(Gn(i))],blockNumber:t,blockTag:e});return s}js();async function g1(n){let t=Tn(n,{method:"eth_newBlockFilter"}),e=await n.request({method:"eth_newBlockFilter"});return{id:e,request:t(e),type:"block"}}Fe();async function mh(n,{address:t,args:e,event:i,events:a,fromBlock:r,strict:s,toBlock:o}={}){let l=a??(i?[i]:void 0),c=Tn(n,{method:"eth_newFilter"}),u=[];l&&(u=[l.flatMap(L=>va({abi:[L],eventName:L.name,args:e}))],i&&(u=u[0]));let p=await n.request({method:"eth_newFilter",params:[{address:t,fromBlock:typeof r=="bigint"?Ce(r):r,toBlock:typeof o=="bigint"?Ce(o):o,...u.length?{topics:u}:{}}]});return{abi:l,args:e,eventName:i?i.name:void 0,fromBlock:r,id:p,request:c(p),strict:!!s,toBlock:o,type:"event"}}async function ph(n){let t=Tn(n,{method:"eth_newPendingTransactionFilter"}),e=await n.request({method:"eth_newPendingTransactionFilter"});return{id:e,request:t(e),type:"transaction"}}async function L1(n){let t=await n.request({method:"eth_blobBaseFee"});return BigInt(t)}oi();Fe();async function _1(n,{blockHash:t,blockNumber:e,blockTag:i="latest"}={}){let a=e!==void 0?Ce(e):void 0,r;return t?r=await n.request({method:"eth_getBlockTransactionCountByHash",params:[t]},{dedupe:!0}):r=await n.request({method:"eth_getBlockTransactionCountByNumber",params:[a||i]},{dedupe:!!a}),Vt(r)}Fe();async function OI(n,{address:t,blockNumber:e,blockTag:i="latest"}){let a=e!==void 0?Ce(e):void 0,r=await n.request({method:"eth_getCode",params:[t,a||i]},{dedupe:!!a});if(r!=="0x")return r}Fe();function v1(n){return{baseFeePerGas:n.baseFeePerGas.map(t=>BigInt(t)),gasUsedRatio:n.gasUsedRatio,oldestBlock:BigInt(n.oldestBlock),reward:n.reward?.map(t=>t.map(e=>BigInt(e)))}}async function x1(n,{blockCount:t,blockNumber:e,blockTag:i="latest",rewardPercentiles:a}){let r=e?Ce(e):void 0,s=await n.request({method:"eth_feeHistory",params:[Ce(t),r||i,a]},{dedupe:!!r});return v1(s)}async function I1(n,{filter:t}){let e=t.strict??!1,a=(await t.request({method:"eth_getFilterLogs",params:[t.id]})).map(r=>Ei(r));return t.abi?Ys({abi:t.abi,logs:a,strict:e}):a}Fe();function kt(n){return{formatters:void 0,fees:void 0,serializers:void 0,...n}}var E1=/^bytes([1-9]|1[0-9]|2[0-9]|3[0-2])?$/,w1=/^(u?int)(8|16|24|32|40|48|56|64|72|80|88|96|104|112|120|128|136|144|152|160|168|176|184|192|200|208|216|224|232|240|248|256)?$/;Zt();ga();bi();$e();var hh=class extends K{constructor({domain:t}){super(`Invalid domain "${nt(t)}".`,{metaMessages:["Must be a valid EIP-712 domain."]})}},dh=class extends K{constructor({primaryType:t,types:e}){super(`Invalid primary type \`${t}\` must be one of \`${JSON.stringify(Object.keys(e))}\`.`,{docsPath:"/api/glossary/Errors#typeddatainvalidprimarytypeerror",metaMessages:["Check that the primary type is a key in `types`."]})}},fh=class extends K{constructor({type:t}){super(`Struct type "${t}" is invalid.`,{metaMessages:["Struct type must not be a Solidity type."],name:"InvalidStructTypeError"})}};aa();Ji();Fe();wn();Pi();Fe();Ri();function T1(n){let{domain:t={},message:e,primaryType:i}=n,a={EIP712Domain:bh({domain:t}),...n.types};yh({domain:t,message:e,primaryType:i,types:a});let r=["0x1901"];return t&&r.push(zk({domain:t,types:a})),i!=="EIP712Domain"&&r.push(C1({data:e,primaryType:i,types:a})),ht(yi(r))}function zk({domain:n,types:t}){return C1({data:n,primaryType:"EIP712Domain",types:t})}function C1({data:n,primaryType:t,types:e}){let i=S1({data:n,primaryType:t,types:e});return ht(i)}function S1({data:n,primaryType:t,types:e}){let i=[{type:"bytes32"}],a=[jk({primaryType:t,types:e})];for(let r of e[t]){let[s,o]=A1({types:e,name:r.name,type:r.type,value:n[r.name]});i.push(s),a.push(o)}return Di(i,a)}function jk({primaryType:n,types:t}){let e=De($k({primaryType:n,types:t}));return ht(e)}function $k({primaryType:n,types:t}){let e="",i=D1({primaryType:n,types:t});i.delete(n);let a=[n,...Array.from(i).sort()];for(let r of a)e+=`${r}(${t[r].map(({name:s,type:o})=>`${o} ${s}`).join(",")})`;return e}function D1({primaryType:n,types:t},e=new Set){let a=n.match(/^\w*/u)?.[0];if(e.has(a)||t[a]===void 0)return e;e.add(a);for(let r of t[a])D1({primaryType:r.type,types:t},e);return e}function A1({types:n,name:t,type:e,value:i}){if(n[e]!==void 0)return[{type:"bytes32"},ht(S1({data:i,primaryType:e,types:n}))];if(e==="bytes")return i=`0x${(i.length%2?"0":"")+i.slice(2)}`,[{type:"bytes32"},ht(i)];if(e==="string")return[{type:"bytes32"},ht(De(i))];if(e.lastIndexOf("]")===e.length-1){let a=e.slice(0,e.lastIndexOf("[")),r=i.map(s=>A1({name:t,type:a,types:n,value:s}));return[{type:"bytes32"},ht(Di(r.map(([s])=>s),r.map(([,s])=>s)))]}return[{type:e},i]}bi();function k1(n){let{domain:t,message:e,primaryType:i,types:a}=n,r=(l,c)=>{let u={...c};for(let p of l){let{name:d,type:L}=p;L==="address"&&(u[d]=u[d].toLowerCase())}return u},s=(()=>a.EIP712Domain?t?r(a.EIP712Domain,t):{}:{})(),o=(()=>{if(i!=="EIP712Domain")return r(a[i],e)})();return nt({domain:s,message:o,primaryType:i,types:a})}function yh(n){let{domain:t,message:e,primaryType:i,types:a}=n,r=(s,o)=>{for(let l of s){let{name:c,type:u}=l,p=o[c],d=u.match(w1);if(d&&(typeof p=="number"||typeof p=="bigint")){let[w,I,M]=d;Ce(p,{signed:I==="int",size:Number.parseInt(M)/8})}if(u==="address"&&typeof p=="string"&&!ft(p))throw new Lt({address:p});let L=u.match(E1);if(L){let[w,I]=L;if(I&&ot(p)!==Number.parseInt(I))throw new Lm({expectedSize:Number.parseInt(I),givenSize:ot(p)})}let x=a[u];x&&(Xk(u),r(x,p))}};if(a.EIP712Domain&&t){if(typeof t!="object")throw new hh({domain:t});r(a.EIP712Domain,t)}if(i!=="EIP712Domain")if(a[i])r(a[i],e);else throw new dh({primaryType:i,types:a})}function bh({domain:n}){return[typeof n?.name=="string"&&{name:"name",type:"string"},n?.version&&{name:"version",type:"string"},typeof n?.chainId=="number"&&{name:"chainId",type:"uint256"},n?.verifyingContract&&{name:"verifyingContract",type:"address"},n?.salt&&{name:"salt",type:"bytes32"}].filter(Boolean)}function Xk(n){if(n==="address"||n==="bool"||n==="string"||n.startsWith("bytes")||n.startsWith("uint")||n.startsWith("int"))throw new fh({type:n})}xa();oi();Sp();var Qk={"0x0":"reverted","0x1":"success"};function HI(n){let t={...n,blockNumber:n.blockNumber?BigInt(n.blockNumber):null,contractAddress:n.contractAddress?n.contractAddress:null,cumulativeGasUsed:n.cumulativeGasUsed?BigInt(n.cumulativeGasUsed):null,effectiveGasPrice:n.effectiveGasPrice?BigInt(n.effectiveGasPrice):null,gasUsed:n.gasUsed?BigInt(n.gasUsed):null,logs:n.logs?n.logs.map(e=>Ei(e)):null,to:n.to?n.to:null,transactionIndex:n.transactionIndex?Vt(n.transactionIndex):null,status:n.status?Qk[n.status]:null,type:n.type?LI[n.type]||n.type:null};return n.blobGasPrice&&(t.blobGasPrice=BigInt(n.blobGasPrice)),n.blobGasUsed&&(t.blobGasUsed=BigInt(n.blobGasUsed)),t}var B1=Ns("transactionReceipt",HI);oi();Ri();var M1=`Ethereum Signed Message:
`;Pi();Ji();Fe();function R1(n){let t=(()=>typeof n=="string"?ea(n):typeof n.raw=="string"?n.raw:at(n.raw))(),e=ea(`${M1}${ot(t)}`);return yi([e,t])}function gh(n,t){return ht(R1(n),t)}var Lh="0x6492649264926492649264926492649264926492649264926492649264926492";cr();function P1(n){return V0(n,-32)===Lh}wn();Pi();ei();function N1(n){let{address:t,data:e,signature:i,to:a="hex"}=n,r=li([Di([{type:"address"},{type:"bytes"},{type:"bytes"}],[t,e,i]),Lh]);return a==="hex"?r:qt(r)}gI();ga();$e();rl();Ir();aa();Ji();cr();oi();function O1(n){let{authorizationList:t}=n;if(t)for(let e of t){let{contractAddress:i,chainId:a}=e;if(!ft(i))throw new Lt({address:i});if(a<0)throw new Sr({chainId:a})}_h(n)}function H1(n){let{blobVersionedHashes:t}=n;if(t){if(t.length===0)throw new Ks;for(let e of t){let i=ot(e),a=Vt(Xa(e,0,1));if(i!==32)throw new Np({hash:e,size:i});if(a!==1)throw new Op({hash:e,version:a})}}_h(n)}function _h(n){let{chainId:t,maxPriorityFeePerGas:e,maxFeePerGas:i,to:a}=n;if(t<=0)throw new Sr({chainId:t});if(a&&!ft(a))throw new Lt({address:a});if(i&&i>Os)throw new Hi({maxFeePerGas:i});if(e&&i&&e>i)throw new Ca({maxFeePerGas:i,maxPriorityFeePerGas:e})}function U1(n){let{chainId:t,maxPriorityFeePerGas:e,gasPrice:i,maxFeePerGas:a,to:r}=n;if(t<=0)throw new Sr({chainId:t});if(r&&!ft(r))throw new Lt({address:r});if(e||a)throw new K("`maxFeePerGas`/`maxPriorityFeePerGas` is not a valid EIP-2930 Transaction attribute.");if(i&&i>Os)throw new Hi({maxFeePerGas:i})}function V1(n){let{chainId:t,maxPriorityFeePerGas:e,gasPrice:i,maxFeePerGas:a,to:r}=n;if(r&&!ft(r))throw new Lt({address:r});if(typeof t<"u"&&t<=0)throw new Sr({chainId:t});if(e||a)throw new K("`maxFeePerGas`/`maxPriorityFeePerGas` is not a valid Legacy Transaction attribute.");if(i&&i>Os)throw new Hi({maxFeePerGas:i})}na();Pi();Zr();Fe();Fe();function F1(n){if(!n||n.length===0)return[];let t=[];for(let e of n){let{contractAddress:i,chainId:a,nonce:r,...s}=e;t.push([a?De(a):"0x",i,r?De(r):"0x",...io({},s)])}return t}ga();na();aa();function cl(n){if(!n||n.length===0)return[];let t=[];for(let e=0;e<n.length;e++){let{address:i,storageKeys:a}=n[e];for(let r=0;r<a.length;r++)if(a[r].length-2!==64)throw new np({storageKey:a[r]});if(!ft(i,{strict:!1}))throw new Lt({address:i});t.push([i,a])}return t}function G1(n,t){let e=Up(n);return e==="eip1559"?e2(n,t):e==="eip2930"?t2(n,t):e==="eip4844"?Zk(n,t):e==="eip7702"?Jk(n,t):i2(n,t)}function Jk(n,t){let{authorizationList:e,chainId:i,gas:a,nonce:r,to:s,value:o,maxFeePerGas:l,maxPriorityFeePerGas:c,accessList:u,data:p}=n;O1(n);let d=cl(u),L=F1(e);return li(["0x04",la([De(i),r?De(r):"0x",c?De(c):"0x",l?De(l):"0x",a?De(a):"0x",s??"0x",o?De(o):"0x",p??"0x",d,L,...io(n,t)])])}function Zk(n,t){let{chainId:e,gas:i,nonce:a,to:r,value:s,maxFeePerBlobGas:o,maxFeePerGas:l,maxPriorityFeePerGas:c,accessList:u,data:p}=n;H1(n);let d=n.blobVersionedHashes,L=n.sidecars;if(n.blobs&&(typeof d>"u"||typeof L>"u")){let V=typeof n.blobs[0]=="string"?n.blobs:n.blobs.map(Z=>at(Z)),q=n.kzg,X=Fs({blobs:V,kzg:q});if(typeof d>"u"&&(d=Rp({commitments:X})),typeof L>"u"){let Z=Gs({blobs:V,commitments:X,kzg:q});L=Hp({blobs:V,commitments:X,proofs:Z})}}let x=cl(u),w=[De(e),a?De(a):"0x",c?De(c):"0x",l?De(l):"0x",i?De(i):"0x",r??"0x",s?De(s):"0x",p??"0x",x,o?De(o):"0x",d??[],...io(n,t)],I=[],M=[],H=[];if(L)for(let V=0;V<L.length;V++){let{blob:q,commitment:X,proof:Z}=L[V];I.push(q),M.push(X),H.push(Z)}return li(["0x03",L?la([w,I,M,H]):la(w)])}function e2(n,t){let{chainId:e,gas:i,nonce:a,to:r,value:s,maxFeePerGas:o,maxPriorityFeePerGas:l,accessList:c,data:u}=n;_h(n);let p=cl(c),d=[De(e),a?De(a):"0x",l?De(l):"0x",o?De(o):"0x",i?De(i):"0x",r??"0x",s?De(s):"0x",u??"0x",p,...io(n,t)];return li(["0x02",la(d)])}function t2(n,t){let{chainId:e,gas:i,data:a,nonce:r,to:s,value:o,accessList:l,gasPrice:c}=n;U1(n);let u=cl(l),p=[De(e),r?De(r):"0x",c?De(c):"0x",i?De(i):"0x",s??"0x",o?De(o):"0x",a??"0x",u,...io(n,t)];return li(["0x01",la(p)])}function i2(n,t){let{chainId:e=0,gas:i,data:a,nonce:r,to:s,value:o,gasPrice:l}=n;V1(n);let c=[r?De(r):"0x",l?De(l):"0x",i?De(i):"0x",s??"0x",o?De(o):"0x",a??"0x"];if(t){let u=(()=>{if(t.v>=35n)return(t.v-35n)/2n>0?t.v:27n+(t.v===35n?0n:1n);if(e>0)return BigInt(e*2)+BigInt(35n+t.v-27n);let L=27n+(t.v===27n?0n:1n);if(t.v!==L)throw new ip({v:t.v});return L})(),p=si(t.r),d=si(t.s);c=[...c,De(u),p==="0x00"?"0x":p,d==="0x00"?"0x":d]}else e>0&&(c=[...c,De(e),"0x","0x"]);return la(c)}function io(n,t){let e=t??n,{v:i,yParity:a}=e;if(typeof e.r>"u")return[];if(typeof e.s>"u")return[];if(typeof i>"u"&&typeof a>"u")return[];let r=si(e.r),s=si(e.s);return[(()=>typeof a=="number"?a?De(1):"0x":i===0n?"0x":i===1n?De(1):i===27n?"0x":De(1))(),r==="0x00"?"0x":r,s==="0x00"?"0x":s]}$e();var vh=class extends K{constructor({value:t}){super(`Number \`${t}\` is not a valid decimal number.`,{name:"InvalidDecimalNumberError"})}};function pi(n,t){if(!/^(-?)([0-9]*)\.?([0-9]*)$/.test(n))throw new vh({value:n});let[e,i="0"]=n.split("."),a=e.startsWith("-");if(a&&(e=e.slice(1)),i=i.replace(/(0+)$/,""),t===0)Math.round(+`.${i}`)===1&&(e=`${BigInt(e)+1n}`),i="";else if(i.length>t){let[r,s,o]=[i.slice(0,t-1),i.slice(t-1,t),i.slice(t)],l=Math.round(+`${s}.${o}`);l>9?i=`${BigInt(r)+BigInt(1)}0`.padStart(r.length+1,"0"):i=`${r}${l}`,i.length>t&&(i=i.slice(1),e=`${BigInt(e)+1n}`),i=i.slice(0,t)}else i=i.padEnd(t,"0");return BigInt(`${a?"-":""}${e}${i}`)}Xm();function ao(n,t="wei"){return pi(n,$m[t])}function a2(n){return n.map(t=>({...t,value:BigInt(t.value)}))}function K1(n){return{...n,balance:n.balance?BigInt(n.balance):void 0,nonce:n.nonce?Vt(n.nonce):void 0,storageProof:n.storageProof?a2(n.storageProof):void 0}}async function q1(n,{address:t,blockNumber:e,blockTag:i,storageKeys:a}){let r=i??"latest",s=e!==void 0?Ce(e):void 0,o=await n.request({method:"eth_getProof",params:[t,a,s||r]});return K1(o)}Fe();async function W1(n,{address:t,blockNumber:e,blockTag:i="latest",slot:a}){let r=e!==void 0?Ce(e):void 0;return await n.request({method:"eth_getStorageAt",params:[t,a,r||i]})}na();Fe();async function no(n,{blockHash:t,blockNumber:e,blockTag:i,hash:a,index:r}){let s=i||"latest",o=e!==void 0?Ce(e):void 0,l=null;if(a?l=await n.request({method:"eth_getTransactionByHash",params:[a]},{dedupe:!0}):t?l=await n.request({method:"eth_getTransactionByBlockHashAndIndex",params:[t,Ce(r)]},{dedupe:!0}):(o||s)&&(l=await n.request({method:"eth_getTransactionByBlockNumberAndIndex",params:[o||s,Ce(r)]},{dedupe:!!o})),!l)throw new os({blockHash:t,blockNumber:e,blockTag:s,hash:a,index:r});return(n.chain?.formatters?.transaction?.format||Er)(l)}async function Y1(n,{hash:t,transactionReceipt:e}){let[i,a]=await Promise.all([Ie(n,Ma,"getBlockNumber")({}),t?Ie(n,no,"getTransaction")({hash:t}):void 0]),r=e?.blockNumber||a?.blockNumber;return r?i-r+1n:0n}na();async function ul(n,{hash:t}){let e=await n.request({method:"eth_getTransactionReceipt",params:[t]},{dedupe:!0});if(!e)throw new ls({hash:t});return(n.chain?.formatters?.transactionReceipt?.format||HI)(e)}Tr();Zt();$e();Cn();wr();xa();Ar();async function z1(n,t){let{allowFailure:e=!0,batchSize:i,blockNumber:a,blockTag:r,multicallAddress:s,stateOverride:o}=t,l=t.contracts,c=i??(typeof n.batch?.multicall=="object"&&n.batch.multicall.batchSize||1024),u=s;if(!u){if(!n.chain)throw new Error("client chain not configured. multicallAddress is required.");u=Vi({blockNumber:a,chain:n.chain,contract:"multicall3"})}let p=[[]],d=0,L=0;for(let I=0;I<l.length;I++){let{abi:M,address:H,args:V,functionName:q}=l[I];try{let X=Wt({abi:M,args:V,functionName:q});L+=(X.length-2)/2,c>0&&L>c&&p[d].length>0&&(d++,L=(X.length-2)/2,p[d]=[]),p[d]=[...p[d],{allowFailure:!0,callData:X,target:H}]}catch(X){let Z=ra(X,{abi:M,address:H,args:V,docsPath:"/docs/contract/multicall",functionName:q});if(!e)throw Z;p[d]=[...p[d],{allowFailure:!0,callData:"0x",target:H}]}}let x=await Promise.allSettled(p.map(I=>Ie(n,ni,"readContract")({abi:al,address:u,args:[I],blockNumber:a,blockTag:r,functionName:"aggregate3",stateOverride:o}))),w=[];for(let I=0;I<x.length;I++){let M=x[I];if(M.status==="rejected"){if(!e)throw M.reason;for(let V=0;V<p[I].length;V++)w.push({status:"failure",error:M.reason,result:void 0});continue}let H=M.value;for(let V=0;V<H.length;V++){let{returnData:q,success:X}=H[V],{callData:Z}=p[I][V],{abi:Q,address:ee,functionName:ae,args:Be}=l[w.length];try{if(Z==="0x")throw new ya;if(!X)throw new Qa({data:q});let we=Ui({abi:Q,args:Be,data:q,functionName:ae});w.push(e?{result:we,status:"success"}:we)}catch(we){let $=ra(we,{abi:Q,address:ee,args:Be,docsPath:"/docs/contract/multicall",functionName:ae});if(!e)throw $;w.push({error:$,result:void 0,status:"failure"})}}}if(w.length!==l.length)throw new K("multicall results mismatch");return w}Tr();CI();Cn();Wp();lr();il();Qi();Fe();xp();oi();ei();function j1({r:n,s:t,to:e="hex",v:i,yParity:a}){let r=(()=>{if(a===0||a===1)return a;if(i&&(i===27n||i===28n||i>=35n))return i%2n===0n?1:0;throw new Error("Invalid `v` or `yParity` value")})(),s=`0x${new tn.Signature(Ut(n),Ut(t)).toCompactHex()}${r===0?"1b":"1c"}`;return e==="hex"?s:qt(s)}js();async function ro(n,t){let{address:e,factory:i,factoryData:a,hash:r,signature:s,universalSignatureVerifierAddress:o=n.chain?.contracts?.universalSignatureVerifier?.address,...l}=t,c=(()=>Rt(s)?s:typeof s=="object"&&"r"in s&&"s"in s?j1(s):at(s))(),u=await(async()=>!i&&!a||P1(c)?c:N1({address:i,data:a,signature:c}))();try{let p=o?{to:o,data:Wt({abi:TI,functionName:"isValidSig",args:[e,r,u]}),...l}:{data:Dr({abi:TI,args:[e,r,u],bytecode:VC}),...l},{data:d}=await Ie(n,ka,"call")(p);return M0(d??"0x0")}catch(p){try{if(Un(Um(e),await Ip({hash:r,signature:s})))return!0}catch{}if(p instanceof hr)return!1;throw p}}async function $1(n,{address:t,message:e,factory:i,factoryData:a,signature:r,...s}){let o=gh(e);return ro(n,{address:t,factory:i,factoryData:a,hash:o,signature:r,...s})}async function X1(n,t){let{address:e,factory:i,factoryData:a,signature:r,message:s,primaryType:o,types:l,domain:c,...u}=t,p=T1({message:s,primaryType:o,types:l,domain:c});return ro(n,{address:e,factory:i,factoryData:a,hash:p,signature:r,...u})}na();DI();bi();oi();bi();function xh(n,{emitOnBegin:t=!1,emitMissed:e=!1,onBlockNumber:i,onError:a,poll:r,pollingInterval:s=n.pollingInterval}){let o=(()=>typeof r<"u"?r:!(n.transport.type==="webSocket"||n.transport.type==="fallback"&&n.transport.transports[0].config.type==="webSocket"))(),l;return o?(()=>{let p=nt(["watchBlockNumber",n.uid,t,e,s]);return wi(p,{onBlockNumber:i,onError:a},d=>Ba(async()=>{try{let L=await Ie(n,Ma,"getBlockNumber")({cacheTime:0});if(l){if(L===l)return;if(L-l>1&&e)for(let x=l+1n;x<L;x++)d.onBlockNumber(x,l),l=x}(!l||L>l)&&(d.onBlockNumber(L,l),l=L)}catch(L){d.onError?.(L)}},{emitOnBegin:t,interval:s}))})():(()=>{let p=nt(["watchBlockNumber",n.uid,t,e]);return wi(p,{onBlockNumber:i,onError:a},d=>{let L=!0,x=()=>L=!1;return(async()=>{try{let w=(()=>{if(n.transport.type==="fallback"){let M=n.transport.transports.find(H=>H.config.type==="webSocket");return M?M.value:n.transport}return n.transport})(),{unsubscribe:I}=await w.subscribe({params:["newHeads"],onData(M){if(!L)return;let H=Ut(M.result?.number);d.onBlockNumber(H,l),l=H},onError(M){d.onError?.(M)}});x=I,L||x()}catch(w){a?.(w)}})(),()=>x()})})()}async function Q1(n,{confirmations:t=1,hash:e,onReplaced:i,pollingInterval:a=n.pollingInterval,retryCount:r=6,retryDelay:s=({count:l})=>~~(1<<l)*200,timeout:o=18e4}){let l=nt(["waitForTransactionReceipt",n.uid,e]),c,u,p,d=!1,{promise:L,resolve:x,reject:w}=Yp(),I=o?setTimeout(()=>w(new sp({hash:e})),o):void 0,M=wi(l,{onReplaced:i,resolve:x,reject:w},H=>{let V=Ie(n,xh,"watchBlockNumber")({emitMissed:!0,emitOnBegin:!0,poll:!0,pollingInterval:a,async onBlockNumber(q){let X=Q=>{clearTimeout(I),V(),Q(),M()},Z=q;if(!d)try{if(p){if(t>1&&(!p.blockNumber||Z-p.blockNumber+1n<t))return;X(()=>H.resolve(p));return}if(c||(d=!0,await ol(async()=>{c=await Ie(n,no,"getTransaction")({hash:e}),c.blockNumber&&(Z=c.blockNumber)},{delay:s,retryCount:r}),d=!1),p=await Ie(n,ul,"getTransactionReceipt")({hash:e}),t>1&&(!p.blockNumber||Z-p.blockNumber+1n<t))return;X(()=>H.resolve(p))}catch(Q){if(Q instanceof os||Q instanceof ls){if(!c){d=!1;return}try{u=c,d=!0;let ee=await ol(()=>Ie(n,mi,"getBlock")({blockNumber:Z,includeTransactions:!0}),{delay:s,retryCount:r,shouldRetry:({error:we})=>we instanceof Us});d=!1;let ae=ee.transactions.find(({from:we,nonce:$})=>we===u.from&&$===u.nonce);if(!ae||(p=await Ie(n,ul,"getTransactionReceipt")({hash:ae.hash}),t>1&&(!p.blockNumber||Z-p.blockNumber+1n<t)))return;let Be="replaced";ae.to===u.to&&ae.value===u.value?Be="repriced":ae.from===ae.to&&ae.value===0n&&(Be="cancelled"),X(()=>{H.onReplaced?.({reason:Be,replacedTransaction:u,transaction:ae,transactionReceipt:p}),H.resolve(p)})}catch(ee){X(()=>H.reject(ee))}}else X(()=>H.reject(Q))}}})});return L}bi();function J1(n,{blockTag:t="latest",emitMissed:e=!1,emitOnBegin:i=!1,onBlock:a,onError:r,includeTransactions:s,poll:o,pollingInterval:l=n.pollingInterval}){let c=(()=>typeof o<"u"?o:!(n.transport.type==="webSocket"||n.transport.type==="fallback"&&n.transport.transports[0].config.type==="webSocket"))(),u=s??!1,p;return c?(()=>{let x=nt(["watchBlocks",n.uid,t,e,i,u,l]);return wi(x,{onBlock:a,onError:r},w=>Ba(async()=>{try{let I=await Ie(n,mi,"getBlock")({blockTag:t,includeTransactions:u});if(I.number&&p?.number){if(I.number===p.number)return;if(I.number-p.number>1&&e)for(let M=p?.number+1n;M<I.number;M++){let H=await Ie(n,mi,"getBlock")({blockNumber:M,includeTransactions:u});w.onBlock(H,p),p=H}}(!p?.number||t==="pending"&&!I?.number||I.number&&I.number>p.number)&&(w.onBlock(I,p),p=I)}catch(I){w.onError?.(I)}},{emitOnBegin:i,interval:l}))})():(()=>{let x=!0,w=!0,I=()=>x=!1;return(async()=>{try{i&&Ie(n,mi,"getBlock")({blockTag:t,includeTransactions:u}).then(V=>{x&&w&&(a(V,void 0),w=!1)});let M=(()=>{if(n.transport.type==="fallback"){let V=n.transport.transports.find(q=>q.config.type==="webSocket");return V?V.value:n.transport}return n.transport})(),{unsubscribe:H}=await M.subscribe({params:["newHeads"],async onData(V){if(!x)return;let q=await Ie(n,mi,"getBlock")({blockNumber:V.blockNumber,includeTransactions:u}).catch(()=>{});x&&(a(q,p),w=!1,p=q)},onError(V){r?.(V)}});I=H,x||I()}catch(M){r?.(M)}})(),()=>I()})()}bi();Zt();zo();function Z1(n,{address:t,args:e,batch:i=!0,event:a,events:r,fromBlock:s,onError:o,onLogs:l,poll:c,pollingInterval:u=n.pollingInterval,strict:p}){let d=(()=>typeof c<"u"?c:typeof s=="bigint"?!0:!(n.transport.type==="webSocket"||n.transport.type==="fallback"&&n.transport.transports[0].config.type==="webSocket"))(),L=p??!1;return d?(()=>{let I=nt(["watchEvent",t,e,i,n.uid,a,u,s]);return wi(I,{onLogs:l,onError:o},M=>{let H;s!==void 0&&(H=s-1n);let V,q=!1,X=Ba(async()=>{if(!q){try{V=await Ie(n,mh,"createEventFilter")({address:t,args:e,event:a,events:r,strict:L,fromBlock:s})}catch{}q=!0;return}try{let Z;if(V)Z=await Ie(n,Vn,"getFilterChanges")({filter:V});else{let Q=await Ie(n,Ma,"getBlockNumber")({});H&&H!==Q?Z=await Ie(n,zs,"getLogs")({address:t,args:e,event:a,events:r,fromBlock:H+1n,toBlock:Q}):Z=[],H=Q}if(Z.length===0)return;if(i)M.onLogs(Z);else for(let Q of Z)M.onLogs([Q])}catch(Z){V&&Z instanceof Ea&&(q=!1),M.onError?.(Z)}},{emitOnBegin:!0,interval:u});return async()=>{V&&await Ie(n,Fn,"uninstallFilter")({filter:V}),X()}})})():(()=>{let I=!0,M=()=>I=!1;return(async()=>{try{let H=(()=>{if(n.transport.type==="fallback"){let Z=n.transport.transports.find(Q=>Q.config.type==="webSocket");return Z?Z.value:n.transport}return n.transport})(),V=r??(a?[a]:void 0),q=[];V&&(q=[V.flatMap(Q=>va({abi:[Q],eventName:Q.name,args:e}))],a&&(q=q[0]));let{unsubscribe:X}=await H.subscribe({params:["logs",{address:t,topics:q}],onData(Z){if(!I)return;let Q=Z.result;try{let{eventName:ee,args:ae}=Ws({abi:V??[],data:Q.data,topics:Q.topics,strict:L}),Be=Ei(Q,{args:ae,eventName:ee});l([Be])}catch(ee){let ae,Be;if(ee instanceof Zi||ee instanceof ba){if(p)return;ae=ee.abiItem.name,Be=ee.abiItem.inputs?.some($=>!("name"in $&&$.name))}let we=Ei(Q,{args:Be?[]:{},eventName:ae});l([we])}},onError(Z){o?.(Z)}});M=X,I||M()}catch(H){o?.(H)}})(),()=>M()})()}bi();function eS(n,{batch:t=!0,onError:e,onTransactions:i,poll:a,pollingInterval:r=n.pollingInterval}){return(typeof a<"u"?a:n.transport.type!=="webSocket")?(()=>{let c=nt(["watchPendingTransactions",n.uid,t,r]);return wi(c,{onTransactions:i,onError:e},u=>{let p,d=Ba(async()=>{try{if(!p)try{p=await Ie(n,ph,"createPendingTransactionFilter")({});return}catch(x){throw d(),x}let L=await Ie(n,Vn,"getFilterChanges")({filter:p});if(L.length===0)return;if(t)u.onTransactions(L);else for(let x of L)u.onTransactions([x])}catch(L){u.onError?.(L)}},{emitOnBegin:!0,interval:r});return async()=>{p&&await Ie(n,Fn,"uninstallFilter")({filter:p}),d()}})})():(()=>{let c=!0,u=()=>c=!1;return(async()=>{try{let{unsubscribe:p}=await n.transport.subscribe({params:["newPendingTransactions"],onData(d){if(!c)return;let L=d.result;i([L])},onError(d){e?.(d)}});u=p,c||u()}catch(p){e?.(p)}})(),()=>u()})()}function tS(n){let{scheme:t,statement:e,...i}=n.match(n2)?.groups??{},{chainId:a,expirationTime:r,issuedAt:s,notBefore:o,requestId:l,...c}=n.match(r2)?.groups??{},u=n.split("Resources:")[1]?.split(`
- `).slice(1);return{...i,...c,...a?{chainId:Number(a)}:{},...r?{expirationTime:new Date(r)}:{},...s?{issuedAt:new Date(s)}:{},...o?{notBefore:new Date(o)}:{},...l?{requestId:l}:{},...u?{resources:u}:{},...t?{scheme:t}:{},...e?{statement:e}:{}}}var n2=/^(?:(?<scheme>[a-zA-Z][a-zA-Z0-9+-.]*):\/\/)?(?<domain>[a-zA-Z0-9+-.]*(?::[0-9]{1,5})?) (?:wants you to sign in with your Ethereum account:\n)(?<address>0x[a-fA-F0-9]{40})\n\n(?:(?<statement>.*)\n\n)?/,r2=/(?:URI: (?<uri>.+))\n(?:Version: (?<version>.+))\n(?:Chain ID: (?<chainId>\d+))\n(?:Nonce: (?<nonce>[a-zA-Z0-9]+))\n(?:Issued At: (?<issuedAt>.+))(?:\nExpiration Time: (?<expirationTime>.+))?(?:\nNot Before: (?<notBefore>.+))?(?:\nRequest ID: (?<requestId>.+))?/;il();function iS(n){let{address:t,domain:e,message:i,nonce:a,scheme:r,time:s=new Date}=n;if(e&&i.domain!==e||a&&i.nonce!==a||r&&i.scheme!==r||i.expirationTime&&s>=i.expirationTime||i.notBefore&&s<i.notBefore)return!1;try{if(!i.address||t&&!Un(i.address,t))return!1}catch{return!1}return!0}async function aS(n,t){let{address:e,domain:i,message:a,nonce:r,scheme:s,signature:o,time:l=new Date,...c}=t,u=tS(a);if(!u.address||!iS({address:e,domain:i,message:u,nonce:r,scheme:s,time:l}))return!1;let d=gh(a);return ro(n,{address:u.address,hash:d,signature:o,...c})}function nS(n){return{call:t=>ka(n,t),createBlockFilter:()=>g1(n),createContractEventFilter:t=>Gm(n,t),createEventFilter:t=>mh(n,t),createPendingTransactionFilter:()=>ph(n),estimateContractGas:t=>BC(n,t),estimateGas:t=>qs(n,t),getBalance:t=>Vp(n,t),getBlobBaseFee:()=>L1(n),getBlock:t=>mi(n,t),getBlockNumber:t=>Ma(n,t),getBlockTransactionCount:t=>_1(n,t),getBytecode:t=>OI(n,t),getChainId:()=>Aa(n),getCode:t=>OI(n,t),getContractEvents:t=>Fp(n,t),getEip712Domain:t=>t1(n,t),getEnsAddress:t=>c1(n,t),getEnsAvatar:t=>f1(n,t),getEnsName:t=>y1(n,t),getEnsResolver:t=>b1(n,t),getEnsText:t=>uh(n,t),getFeeHistory:t=>x1(n,t),estimateFeesPerGas:t=>SC(n,t),getFilterChanges:t=>Vn(n,t),getFilterLogs:t=>I1(n,t),getGasPrice:()=>Vs(n),getLogs:t=>zs(n,t),getProof:t=>q1(n,t),estimateMaxPriorityFeePerGas:t=>CC(n,t),getStorageAt:t=>W1(n,t),getTransaction:t=>no(n,t),getTransactionConfirmations:t=>Y1(n,t),getTransactionCount:t=>Mp(n,t),getTransactionReceipt:t=>ul(n,t),multicall:t=>z1(n,t),prepareTransactionRequest:t=>Hn(n,t),readContract:t=>ni(n,t),sendRawTransaction:t=>Xs(n,t),simulateContract:t=>jC(n,t),verifyMessage:t=>$1(n,t),verifySiweMessage:t=>aS(n,t),verifyTypedData:t=>X1(n,t),uninstallFilter:t=>Fn(n,t),waitForTransactionReceipt:t=>Q1(n,t),watchBlocks:t=>J1(n,t),watchBlockNumber:t=>xh(n,t),watchContractEvent:t=>JC(n,t),watchEvent:t=>Z1(n,t),watchPendingTransactions:t=>eS(n,t)}}function ml(n){let{key:t="public",name:e="Public Client"}=n;return ih({...n,key:t,name:e,type:"publicClient"}).extend(nS)}Wp();function rS(n,t){let{abi:e,args:i,bytecode:a,...r}=t,s=Dr({abi:e,args:i,bytecode:a});return Qs(n,{...r,data:s})}lr();async function sS(n){return n.account?.type==="local"?[n.account.address]:(await n.request({method:"eth_accounts"},{dedupe:!0})).map(e=>$a(e))}async function oS(n){return await n.request({method:"wallet_getPermissions"},{dedupe:!0})}lr();async function lS(n){return(await n.request({method:"eth_requestAccounts"},{dedupe:!0,retryCount:0})).map(e=>Um(e))}async function cS(n,t){return n.request({method:"wallet_requestPermissions",params:[t]},{retryCount:0})}xi();Fe();async function uS(n,{account:t=n.account,message:e}){if(!t)throw new Fi({docsPath:"/docs/actions/wallet/signMessage"});let i=_t(t);if(i.signMessage)return i.signMessage({message:e});let a=(()=>typeof e=="string"?ea(e):e.raw instanceof Uint8Array?De(e.raw):e.raw)();return n.request({method:"personal_sign",params:[a,i.address]},{retryCount:0})}xi();Fe();tl();Hs();async function mS(n,t){let{account:e=n.account,chain:i=n.chain,...a}=t;if(!e)throw new Fi({docsPath:"/docs/actions/wallet/signTransaction"});let r=_t(e);Da({account:r,...t});let s=await Ie(n,Aa,"getChainId")({});i!==null&&Qp({currentChainId:s,chain:i});let l=(i?.formatters||n.chain?.formatters)?.transactionRequest?.format||Nn;return r.signTransaction?r.signTransaction({...a,chainId:s},{serializer:n.chain?.serializers?.transaction}):await n.request({method:"eth_signTransaction",params:[{...l(a),chainId:Ce(s),from:r.address}]},{retryCount:0})}xi();async function pS(n,t){let{account:e=n.account,domain:i,message:a,primaryType:r}=t;if(!e)throw new Fi({docsPath:"/docs/actions/wallet/signTypedData"});let s=_t(e),o={EIP712Domain:bh({domain:i}),...t.types};if(yh({domain:i,message:a,primaryType:r,types:o}),s.signTypedData)return s.signTypedData({domain:i,message:a,primaryType:r,types:o});let l=k1({domain:i,message:a,primaryType:r,types:o});return n.request({method:"eth_signTypedData_v4",params:[s.address,l]},{retryCount:0})}Fe();async function hS(n,{id:t}){await n.request({method:"wallet_switchEthereumChain",params:[{chainId:Ce(t)}]},{retryCount:0})}async function dS(n,t){return await n.request({method:"wallet_watchAsset",params:t},{retryCount:0})}function fS(n){return{addChain:t=>i1(n,t),deployContract:t=>rS(n,t),getAddresses:()=>sS(n),getChainId:()=>Aa(n),getPermissions:()=>oS(n),prepareTransactionRequest:t=>Hn(n,t),requestAddresses:()=>lS(n),requestPermissions:t=>cS(n,t),sendRawTransaction:t=>Xs(n,t),sendTransaction:t=>Qs(n,t),signMessage:t=>uS(n,t),signTransaction:t=>mS(n,t),signTypedData:t=>pS(n,t),switchChain:t=>hS(n,t),watchAsset:t=>dS(n,t),writeContract:t=>e1(n,t)}}function so(n){let{key:t="wallet",name:e="Wallet Client",transport:i}=n;return ih({...n,key:t,name:e,transport:i,type:"walletClient"}).extend(fS)}$e();Cn();Fe();Qm();var ti=class{constructor(){}};ti.UPDATE_LOCAL_WALLET_LIST_EVENT="WalletEvent:UPDATE_LOCAL_WALLET_LIST_EVENT",ti.TRANSFER_LOCAL_WALLET_EVENT="WalletEvent:TRANSFER_LOCAL_WALLET_EVENT";var Ih=class{};var xt=class{constructor(){this.extra={}}};var oo=class{constructor(){this.connectAddr="ws://175.27.154.72:10001";this.groupApplyList=[];this.groupData=[];this.watch=[]}};var Eh=class{};var Ae=class n{constructor(){this.inMinWaiting=!1;this.needGetRoomInfo=!1}openMinView(){this.enterRoomSpr||(this.enterRoomSpr=this.enterRoomPrefab.create()),this.enterRoomSpr.x=Laya.stage.width>>1,this.enterRoomSpr.y=0,this.enterRoomSpr.zOrder=1e3,Laya.stage.addChild(this.enterRoomSpr),this.inMinWaiting=!0}closeMinView(){this.enterRoomSpr&&this.enterRoomSpr.removeSelf(),this.inMinWaiting=!1}openMaxView(){this.closeMinView();var t=!0;A.intance.openModule(y.EnterRoomView,t)}openEnterView(){if(this.inMinWaiting==!0){this.closeMinView();var t=!0;A.intance.openModule(y.EnterRoomView,t)}else A.intance.openModule(y.EnterRoomView)}static get instance(){return n._instance==null&&(n._instance=new n),n._instance}init(){this.closeMinView(),this.initRoomData(),this.needGetRoomInfo=!0,Laya.timer.loop(1500,this,this.onRefreshRoom)}onRefreshRoomImditely(){Laya.timer.clear(this,this.onRefreshRoom),this.needGetRoomInfo=!0,this.onRefreshRoom(),Laya.timer.loop(1500,this,this.onRefreshRoom)}updateBattleCD(){B.instance.coolDownTime=Math.round(B.instance.roomDto.joinCd/1e3),g.intance.event(f.EVENT_UPDATE_MATCH_ROOM),B.instance.coolDownTime>0?(this.onSetCoolTime(),Laya.timer.loop(1e3,this,this.onSetCoolTime)):this.onGoMatch()}onSetCoolTime(){B.instance.coolDownTime>=0?B.instance.coolDownTime--:this.onGoMatch()}async onGoMatch(){Laya.timer.clear(this,this.onSetCoolTime),Laya.timer.clear(this,this.onRefreshRoom);let t=await v.requestPost("wxgame/room/info",{roomId:B.instance.roomDto.roomId});if(!this.needGetRoomInfo){console.log("界面已经关掉了，不能再继续了。。。");return}var e=t.roomDto;e.joinCd==0?t.roomDto.enterGame==1?(Laya.timer.clearAll(this),lt.instance.initSocket(),this.closeMinView()):(this.close(),g.intance.event(f.EVENT_ENTER_MATCH_ROOM,!0),Le.commTipWithYes(Ee.instance.get(25))):(B.instance.roomDto=e,this.updateBattleCD())}initRoomData(){var t=B.instance.roomDto.members.length,e=B.instance.roomDto.maxCount;if(B.instance.roomDto.state==W.STATE_START&&t>=e){this.onGoMatch();return}this.updateBattleCD()}async onRefreshRoom(){console.log("onRefreshRoom");let t=await v.requestPost("wxgame/room/info",{roomId:B.instance.roomDto.roomId});if(!this.needGetRoomInfo){console.log("界面已经关掉了，不能再继续了!");return}B.instance.roomDto=t.roomDto,this.initRoomData(),B.instance.setMatchRes()}close(){this.needGetRoomInfo=!1,Laya.timer.clearAll(this),g.intance.event(f.EVENT_CLOSE_MODULE,y.EnterRoomView),this.closeMinView()}async onCreateAndJoinWithPwd(t,e,i){var a=e.isBookingMust;if(t!=W.ACTION_SIGNUP&&t!=W.ACTION_CREATE_BOOKING){var r=_.intance.m_dicNodes.get(e.nodeId);if(r&&r.dT>800&&z.Debug<2){E.instance.notice(m.instance.getLanguage(1306));return}}var s=!1;if(t==W.ACTION_WATCH||t==W.ACTION_JOIN&&a?s=!1:s=!0,s){let Be=!1;var o=_.intance.m_dicArenaDic.get(e.arenaId),l=o.item[0];let we=b.instance.playerDto;if(o.type==3){if(!we.newFightHeroPk){Le.heroNotEnought(1353);return}}else if(we.fightHeroPk){let $=b.instance.m_heroData.heroVoDic.get(we.fightHeroPk);if($){if(Be=$.state==2,t!=W.ACTION_SIGNUP&&$.state==1){pe.instance().AlertByType(P.BASEALERTVIEW,m.instance.getLanguage(1176),P.YES,null);return}}else if(t!=W.ACTION_SIGNUP){Le.heroNotEnought();return}}else if(t!=W.ACTION_SIGNUP){Le.heroNotEnought();return}if(o.item&&o.item.length>1){var l=o.item[0],c=o.item[1];t==W.ACTION_SIGNUP&&!e.preContract&&(c=c*2);var u=b.instance.m_packageData.getCountById(l);let Oe=_.intance.getArenaTypesInSubByType(o.type).heroType;var p=k.instance.arenaType;if(Be){var d=await v.requestPost("wxgame/lease/heroInfo",{heroPk:we.fightHeroPk});if(d.info.leaseType==1){if(d.info.remainTicketCount<=0&&p==1){pe.instance().AlertByType(P.BASEALERTVIEW,m.instance.getLanguage(1175),P.YES,null);return}if(Oe.indexOf(d.info.leaseType)<0){pe.instance().AlertByType(P.BASEALERTVIEW,Ee.instance.get(127),P.YES,null);return}if(l!==d.info.ticketId){console.log("票不一样不能进: ","需要的门票类型："+l,"代打英雄随身带的门票类型："+d.info.ticketId),pe.instance().AlertByType(P.BASEALERTVIEW,m.instance.getLanguage(1178),P.YES,null);return}}else if(d.info.leaseType==2&&Oe.indexOf(d.info.leaseType)<0){pe.instance().AlertByType(P.BASEALERTVIEW,m.instance.getLanguage(1299),P.YES,null);return}}if(console.log("currNum: "+u,"needNum: "+c,"itemId: "+l),t!=W.ACTION_SIGNUP&&u<c&&(!Be||d.info.leaseType==2)){Le.titickNotEnought(l);return}}}let L=!1,x;if(t==W.ACTION_CREATE)x=await v.requestPost("wxgame/room/create",{numIndex:e.numIndex,nodeId:e.nodeId,password:i,arenaId:e.arenaId,roomName:e.roomName,customName:e.customName,anonymous:e.anonymous,closeLive:e.closeLive});else if(t==W.ACTION_JOIN)x=await v.requestPost("wxgame/room/join",{roomId:e.roomId,pass:i});else if(t==W.ACTION_CREATE_BOOKING)e.groupId&&(L=!0),x=await v.requestPost("wxgame/roomPreContract/create",{numIndex:e.numIndex,groupId:e.groupId,nodeId:e.nodeId,password:i,arenaId:e.arenaId,roomName:e.roomName,customName:e.customName,startTime:e.startTime,anonymous:e.anonymous,closeLive:e.closeLive});else if(t==W.ACTION_JOIN_BOOKING){var w=0;e.teamDto&&(w=e.teamDto.teamId),e.groupId&&w==0&&(L=!0),x=await v.requestPost("wxgame/roomPreContract/apply",{teamId:w,roomId:e.roomId,password:i})}else if(t==W.ACTION_WATCH)x=await v.requestPost("wxgame/room/joinWatch",{roomId:e.roomId});else if(t==W.ACTION_SIGNUP&&(x=await v.requestPost("wxgame/room/joinGroup",{roomId:e.roomId}),x)){E.instance.notice(m.instance.getLanguage(1373)),this.onRefreshRoomImditely();return}if(x.roomDto&&(B.instance.roomDto=x.roomDto),x.roomDto||x.dto){if(g.intance.event(f.EVENT_Close_CreateRoom),t==W.ACTION_CREATE_BOOKING||t==W.ACTION_JOIN_BOOKING)if(L){var I=x.dto,M=I.roomId,w=I.teamDto.teamId,H=I.teamDto.leaderPlayer.name;A.intance.openModule(y.TeamCreateShareDialog,[M,w,H])}else E.instance.notice(m.instance.getLanguage(2e3));else t==W.ACTION_WATCH&&x.roomDto&&x.roomDto.state==10?lt.instance.initSocket():n.instance.openEnterView();if(t==W.ACTION_CREATE||t==W.ACTION_CREATE_BOOKING){var V=o.type,q="";V==1?q="Professional Arena":V==2?q="Airdrop Arena":V==3&&(q="Training Arena");var X=o.lv,Z="";X==1?Z="Novice":X==2?Z="Elite":X==3&&(Z="Master");var Q=o.coinType,ee=_.intance.m_dicItems.get(Q),ae=m.instance.getEnglishLanguage(ee.name);gtag("event","new_arena",{event_category:q,arena_type:q,coin_type:ae,arena_lv:Z})}}else E.instance.notice(m.instance.getLanguage(135))}async goBookingCreateRoomDialog(t,e=0){var i=await v.requestPost("wxgame/roomPreContract/info",{roomId:t,teamId:e});i.dto&&(g.intance.event(f.EVENT_CLOSE_MODULE,y.CreateRoomDialog),A.intance.openModule(y.CreateRoomDialog,[W.ACTION_JOIN_BOOKING,!1,!0,[i.dto,i.inApply]]))}async goMatchCreateRoomDialog(t){var e=await v.requestPost("wxgame/room/info2",{roomId:t});e.roomDto&&(g.intance.event(f.EVENT_CLOSE_MODULE,y.CreateRoomDialog),A.intance.openModule(y.CreateRoomDialog,[W.ACTION_JOIN,!1,!1,e.roomDto,!0]))}goBookingInviteConfimDialog(t){pe.instance().AlertByType(P.InviteConfimDialog,t,P.CANCEL,Laya.Handler.create(this,this.onAcceptInvite,[t]))}onAcceptInvite(t){console.log("onAcceptInvitation");var e=new oo;e.roomId=t.roomId,e.arenaId=t.arenaId;var i=new Eh;i.teamId=t.teamId,e.teamDto=i,n.instance.onCreateAndJoinWithPwd(W.ACTION_JOIN_BOOKING,e,"")}goBookingApplyConfimDialog(t){pe.instance().AlertByType(P.ApplyConfimDialog,t,P.CANCEL,Laya.Handler.create(this,this.onAcceptApply,[t,1]),Laya.Handler.create(this,this.onAcceptApply,[t,2]))}async onAcceptApply(t,e){console.log("onAcceptInvitation");var i=t.roomId,a=t.teamId,r=t.applicant.id,s=await v.requestPost("wxgame/roomPreContract/groupJoinApply",{roomId:i,teamId:a,targetPid:r,type:e});E.instance.notice(m.instance.getLanguage(2e3))}onGetBookingId(t){var e,i;let a=/\[([^\]]+)\]/g,r,s=[];for(;(r=a.exec(t))!==null&&(s.push(r[1]),s.length!==2););if(s.length>0)e=s[0],s.length>1&&(i=s[1]),console.log("中括号内容:",e,i);else{console.log("未找到中括号内容，检查链接中的 bookingId...");let l=/https?:\/\/[^\s]+/g.exec(t);if(l){let c=new URL(l[0]),u=c.searchParams.get("bookingId");if(u){e=u,console.log("链接中的 bookingId:",u);let p=c.searchParams.get("teamId");p&&(i=p,console.log("链接中的 teamId:",p))}else console.log("链接中未包含 bookingId 参数")}else console.log("文本中未找到链接")}return[e,i]}onGetNewUrl(t,e){let i=new URL(window.location.href),a=i.searchParams;a.get("bookingId")&&a.delete("bookingId"),a.has("debug")&&a.delete("debug"),a.has("address")&&a.delete("address");let s=t;return a.append("bookingId",s+""),e&&a.append("teamId",e+""),i.search=a.toString(),i.toString()}goPveMatch(){var t={arenaId:4001,coinType:0,roomId:4563,members:[{id:1000000026,x:1706,y:1350,dire:0,speed:320,heroId:15000020003,heroColor:1e3,name:"1000000026",icon:"10015",leader:0,kill:0,hp:899,maxHp:899,atk:0,score:1e4,skillCd:{},commonCd:0,area:0,country:0,nodeId:0,lease:0,equips:{},cardCd:{},buffDtoList:[],no:0,npc:!0,startTime:1727683479461},{id:1000000027,x:952,y:1735,dire:0,speed:320,heroId:15000030003,heroColor:1e3,name:"1000000027",icon:"10015",leader:0,kill:0,hp:919,maxHp:919,atk:0,score:1e4,skillCd:{},commonCd:0,area:0,country:0,nodeId:0,lease:0,equips:{},cardCd:{},buffDtoList:[],no:0,npc:!0,startTime:1727683479461},{id:1000000007,x:952,y:965,dire:0,speed:320,heroId:12000010003,heroColor:1e3,name:"1000000007",icon:"10015",leader:0,kill:0,hp:1018,maxHp:1018,atk:0,score:1e4,skillCd:{},commonCd:0,area:0,country:0,nodeId:0,lease:0,equips:{},cardCd:{},buffDtoList:[],no:0,npc:!0,startTime:1727683479461},{id:1003,x:2083,y:2120,dire:0,speed:0,heroId:15000010006,heroColor:434,name:"h1",icon:"10005",leader:1,kill:0,hp:1828,maxHp:1828,atk:0,score:1e4,skillCd:{},commonCd:0,area:0,country:1017,nodeId:1,lease:0,equips:{},cardCd:{},buffDtoList:[],no:0,npc:!1,startTime:1727683479461}],remainderCd:604799998,startTime:1727683478029,nowTime:1727683479462,arenaType:4,watch:[],anonymous:0},e=t.members.length,i=t.members[e-1];i&&(i.id=b.instance.playerDto.pid),B.instance.matchDto=t,oe.intance.setCurrentScene(Y.M_SCENE_MATCH)}};var nn=class nn{constructor(t,e){this._lineIndex=0;this._isShow=!1;this._alpha=.6;this.isInit=!1;this._isRelease=!0;this._count=0;this.maxCount=1e3;this.prevX=0;this.prevY=0;this._stage=t,this._isRelease=e,this._actionLineList=[],this._time=new Date().getTime();let i,a,r,s,o=function(u){i=u.stageX,a=u.stageY,r=i,s=a},l=function(u){r=u.stageX,s=u.stageY},c=function(u){let p=Laya.stage.width-(r-i)<160,d=Laya.stage.height-(s-a)<160;p&&d&&$t.debugger&&(Laya.Browser.window.console.log=$t.addConsoleLog,$t.debugger.showOrHide())};Laya.stage.on(Laya.Event.MOUSE_DOWN,this,o),Laya.stage.on(Laya.Event.MOUSE_MOVE,this,l),Laya.stage.on(Laya.Event.MOUSE_UP,this,c)}initDebugView(){if(!this.isInit){this.totalW=Laya.stage.width,this.totalH=Laya.stage.height/2,this.bigContainer=new Laya.Sprite,this.bigContainer.zOrder=2e3,this.bigContainer.name="bigContainerDebug",this.bgContainer=new Laya.Sprite,this._bgSp=new Laya.Sprite,this._bgSp.alpha=this._alpha,this._bgSp.graphics.drawRect(0,0,this.totalW,this.totalH,"#000000"),this._bgSp.mouseEnabled=!1,this._debugInfoTf=new Laya.Text,this._debugInfoTf.color="#ffffff",this._debugInfoTf.width=this.totalW-10,this._debugInfoTf.height=this.totalH-10,this._debugInfoTf.overflow="scroll",this._debugInfoTf.wordWrap=!0;let t="[LOADINFO - DEBUGGER]";this.appendText("加载调试信息 "+t,0,!1),this._closeTf=new Laya.Label,this._closeTf.color="#ff0000",this._closeTf.valign="middle",this._closeTf.width=55,this._closeTf.height=55,this._closeTf.borderColor=nn.DEFAULT_COLOR,this._closeTf.text="关闭",this._autoScrollTf=new Laya.Label,this._autoScrollTf.color="#ff0000",this._autoScrollTf.valign="middle",this._autoScrollTf.width=55,this._autoScrollTf.height=55,this._autoScrollTf.borderColor=nn.DEFAULT_COLOR,this._autoScrollTf.text="自动卷屏",this._bgAlpha0=new Laya.Label,this._bgAlpha0.color="#ff0000",this._bgAlpha0.valign="middle",this._bgAlpha0.width=55,this._bgAlpha0.height=55,this._bgAlpha0.borderColor=nn.DEFAULT_COLOR,this._bgAlpha0.text="背景-",this._bgAlpha1=new Laya.Label,this._bgAlpha1.color="#ff0000",this._bgAlpha1.valign="middle",this._bgAlpha1.width=55,this._bgAlpha1.height=55,this._bgAlpha1.borderColor=nn.DEFAULT_COLOR,this._bgAlpha1.text="背景+",this._clearTf=new Laya.Label,this._clearTf.color="#ff0000",this._clearTf.valign="middle",this._clearTf.width=55,this._clearTf.height=55,this._clearTf.borderColor=nn.DEFAULT_COLOR,this._clearTf.text="清理",this._testTf=new Laya.Label,this._testTf.color="#ff0000",this._testTf.width=55,this._testTf.height=55,this._testTf.borderColor=nn.DEFAULT_COLOR,this._testTf.text="点穿",this.bgContainer.x=5,this.bgContainer.y=5,this._debugInfoTf.x=5,this._debugInfoTf.y=5,this.bgContainer.addChild(this._bgSp),this.bgContainer.addChild(this._debugInfoTf),this._closeTf.x=this.totalW-60,this._closeTf.y=5,this.bgContainer.addChild(this._closeTf),this._autoScrollTf.x=this.totalW-60,this._autoScrollTf.y=105,this.bgContainer.addChild(this._autoScrollTf),this._bgAlpha0.x=this.totalW-60,this._bgAlpha0.y=205,this.bgContainer.addChild(this._bgAlpha0),this._bgAlpha1.x=this.totalW-60,this._bgAlpha1.y=305,this.bgContainer.addChild(this._bgAlpha1),this._clearTf.x=this.totalW-60,this._clearTf.y=405,this.bgContainer.addChild(this._clearTf),this._testTf.x=this.totalW-60,this._testTf.y=505,this.bigContainer.addChild(this.bgContainer),this.bigContainer.addChild(this._testTf),this._autoScroll=!0,this._hide=!0,this._debugInfoTf.on(Laya.Event.MOUSE_DOWN,this,this.startScrollText),this._closeTf.on(Laya.Event.CLICK,this,this.onCloseTfClick),this._autoScrollTf.on(Laya.Event.CLICK,this,this.onAutoScrollTfClick),this._bgAlpha0.on(Laya.Event.CLICK,this,this.onBgAlpha0),this._bgAlpha1.on(Laya.Event.CLICK,this,this.onBgAlpha1),this._clearTf.on(Laya.Event.CLICK,this,this.onClearTfClick),this._testTf.on(Laya.Event.CLICK,this,this.onTestTfClick),this.isInit=!0}}show(){this.initDebugView(),this._stage.addChild(this.bigContainer),this._isShow=!0,this.updateView()}hide(){this.initDebugView(),this.bigContainer.parent&&this.bigContainer.parent.removeChild(this.bigContainer),this._isShow=!1,this.updateView()}showOrHide(){this._isShow=!this._isShow,this._isShow?this.show():this.hide()}appendText(t,e=0,i=!0){if(i){let a=new Date().getTime()-this._time;t+="  ["+(a/1e3).toFixed(3)+"]"}this._actionLineList.push([t+`
`,e]),this._lineIndex>=200&&(this._actionLineList.splice(0,20),this._lineIndex-=20),this._count++,this._count>this.maxCount&&(this._count=0,this._debugInfoTf&&(this._debugInfoTf.text="")),this._isShow&&(this._currentLine=this._actionLineList[this._lineIndex++],this._debugInfoTf&&(this._debugInfoTf.text+=this._currentLine[0]),this._autoScroll&&this._debugInfoTf&&(this._debugInfoTf.scrollY=this._debugInfoTf.maxScrollY))}updateView(){if(this._isShow){this._count=0,this._debugInfoTf.text="";let t=this._actionLineList.length;for(this._lineIndex=0;this._lineIndex<t;++this._lineIndex)this._currentLine=this._actionLineList[this._lineIndex],this._debugInfoTf.text+=this._currentLine[0],this._count++,this._count>this.maxCount&&(this._count=0,this._debugInfoTf.text="");this._autoScroll&&(this._debugInfoTf.scrollY=this._debugInfoTf.maxScrollY)}else this._debugInfoTf.text=""}onCloseTfClick(t){this.hide()}onAutoScrollTfClick(t){this._autoScroll=!this._autoScroll,this._autoScroll?this._autoScrollTf.text="自动卷屏":this._autoScrollTf.text="手动卷屏"}onBgAlpha0(t){this._alpha-=.1,this._alpha<=0&&(this._alpha=0),this._bgSp.alpha=this._alpha}onBgAlpha1(t){this._alpha+=.1,this._alpha>=1&&(this._alpha=1),this._bgSp.alpha=this._alpha}onClearTfClick(t){this._debugInfoTf.text="",this._actionLineList.length=0,this._lineIndex=0}onTestTfClick(t){this.bgContainer.mouseEnabled=!this.bgContainer.mouseEnabled}set testFun(t){this._testFun=t}get bgSp(){return this._bgSp}startScrollText(t){this.prevX=this._debugInfoTf.mouseX,this.prevY=this._debugInfoTf.mouseY,Laya.stage.on(Laya.Event.MOUSE_MOVE,this,this.scrollText),Laya.stage.on(Laya.Event.MOUSE_UP,this,this.finishScrollText)}finishScrollText(t){Laya.stage.off(Laya.Event.MOUSE_MOVE,this,this.scrollText),Laya.stage.off(Laya.Event.MOUSE_UP,this,this.finishScrollText)}scrollText(t){let e=this._debugInfoTf.mouseX,i=this._debugInfoTf.mouseY;this._debugInfoTf.scrollX+=this.prevX-e,this._debugInfoTf.scrollY+=this.prevY-i,this.prevX=e,this.prevY=i}};nn.DEFAULT_COLOR="#ffffff";var wh=nn;var $t=class n{static Initialize(t,e){n.isRelease=e,this.debugger==null&&(this.debugger=new wh(t,e))}static log(t,e=0,i=0){var a=Le.GetLogTime+" "+t;e&&n.addLog(a,e,i)}static addLog(t,e=0,i=0){this.debugger&&this.debugger.appendText(t,i),console.log(t)}static addConsoleLog(...t){n.debugger&&n.debugger.appendText(t,0)}};var pl=class pl{constructor(){this.module=0;this.errorCode=0;this.errorMessage=""}protocolId(){return pl.PROTOCOL_ID}static write(t,e){t.writePacketFlag(e)||e==null||(t.writeInt(e.errorCode),t.writeString(e.errorMessage),t.writeInt(e.module))}static read(t){if(!t.readBoolean())return null;let e=new pl,i=t.readInt();e.errorCode=i;let a=t.readString();e.errorMessage=a;let r=t.readInt();return e.module=r,e}};pl.PROTOCOL_ID=101;var UI=pl,hl=UI;var dl=class dl{protocolId(){return dl.PROTOCOL_ID}static write(t,e){t.writePacketFlag(e)||e==null}static read(t){return t.readBoolean()?new dl:null}};dl.PROTOCOL_ID=103;var VI=dl,Th=VI;var fl=class fl{constructor(){this.time=0}protocolId(){return fl.PROTOCOL_ID}static write(t,e){t.writePacketFlag(e)||e==null||t.writeLong(e.time)}static read(t){if(!t.readBoolean())return null;let e=new fl,i=t.readLong();return e.time=i,e}};fl.PROTOCOL_ID=104;var FI=fl,yS=FI;var yl=class yl{constructor(){this.pid=0;this.roomId=0;this.loginToken="";this.watch=0}protocolId(){return yl.PROTOCOL_ID}static write(t,e){t.writePacketFlag(e)||e==null||(t.writeString(e.loginToken),t.writeLong(e.pid),t.writeLong(e.roomId),t.writeInt(e.watch))}static read(t){if(!t.readBoolean())return null;let e=new yl,i=t.readString();e.loginToken=i;let a=t.readLong();e.pid=a;let r=t.readLong();if(e.roomId=r,!t.isReadable())return e;let s=t.readInt();return e.watch=s,e}};yl.PROTOCOL_ID=1001;var GI=yl,Ch=GI;var bl=class bl{constructor(){this.errorCode=0;this.pid=0;this.matchDto=null;this.socketToken=""}protocolId(){return bl.PROTOCOL_ID}static write(t,e){t.writePacketFlag(e)||e==null||(t.writeInt(e.errorCode),t.writePacket(e.matchDto,25010),t.writeLong(e.pid),t.writeString(e.socketToken))}static read(t){if(!t.readBoolean())return null;let e=new bl,i=t.readInt();e.errorCode=i;let a=t.readPacket(25010);e.matchDto=a;let r=t.readLong();e.pid=r;let s=t.readString();return e.socketToken=s,e}};bl.PROTOCOL_ID=1002;var KI=bl,Sh=KI;var gl=class gl{protocolId(){return gl.PROTOCOL_ID}static write(t,e){t.writePacketFlag(e)||e==null}static read(t){return t.readBoolean()?new gl:null}};gl.PROTOCOL_ID=1004;var qI=gl,Dh=qI;var Ll=class Ll{constructor(){this.sequence=0;this.param=""}protocolId(){return Ll.PROTOCOL_ID}static write(t,e){t.writePacketFlag(e)||e==null||(t.writeInt(e.sequence),t.writeString(e.param))}static read(t){if(!t.readBoolean())return null;let e=new Ll;if(!t.isReadable())return e;let i=t.readInt();if(e.sequence=i,!t.isReadable())return e;let a=t.readString();return e.param=a,e}};Ll.PROTOCOL_ID=1005;var WI=Ll,bS=WI;var _l=class _l{constructor(){this.sequence=0;this.code=0}protocolId(){return _l.PROTOCOL_ID}static write(t,e){t.writePacketFlag(e)||e==null||(t.writeInt(e.sequence),t.writeInt(e.code))}static read(t){if(!t.readBoolean())return null;let e=new _l;if(!t.isReadable())return e;let i=t.readInt();if(e.sequence=i,!t.isReadable())return e;let a=t.readInt();return e.code=a,e}};_l.PROTOCOL_ID=1006;var YI=_l,gS=YI;var vl=class vl{constructor(){this.token=""}protocolId(){return vl.PROTOCOL_ID}static write(t,e){t.writePacketFlag(e)||e==null||t.writeString(e.token)}static read(t){if(!t.readBoolean())return null;let e=new vl,i=t.readString();return e.token=i,e}};vl.PROTOCOL_ID=1007;var zI=vl,Ah=zI;var xl=class xl{constructor(){this.errorCode=0}protocolId(){return xl.PROTOCOL_ID}static write(t,e){t.writePacketFlag(e)||e==null||t.writeInt(e.errorCode)}static read(t){if(!t.readBoolean())return null;let e=new xl,i=t.readInt();return e.errorCode=i,e}};xl.PROTOCOL_ID=1008;var jI=xl,kh=jI;var Il=class Il{protocolId(){return Il.PROTOCOL_ID}static write(t,e){t.writePacketFlag(e)||e==null}static read(t){return t.readBoolean()?new Il:null}};Il.PROTOCOL_ID=1010;var $I=Il,LS=$I;var El=class El{constructor(){this.type=0;this.id=0;this.count=0}protocolId(){return El.PROTOCOL_ID}static write(t,e){t.writePacketFlag(e)||e==null||(t.writeInt(e.type),t.writeInt(e.id),t.writeLong(e.count))}static read(t){if(!t.readBoolean())return null;let e=new El;if(!t.isReadable())return e;let i=t.readInt();if(e.type=i,!t.isReadable())return e;let a=t.readInt();if(e.id=a,!t.isReadable())return e;let r=t.readLong();return e.count=r,e}};El.PROTOCOL_ID=1012;var XI=El,_S=XI;var wl=class wl{constructor(){this.x=0;this.y=0;this.speed=0;this.dire=0;this.time=0;this.area=0}protocolId(){return wl.PROTOCOL_ID}static write(t,e){t.writePacketFlag(e)||e==null||(t.writeInt(e.area),t.writeInt(e.dire),t.writeInt(e.speed),t.writeLong(e.time),t.writeInt(e.x),t.writeInt(e.y))}static read(t){if(!t.readBoolean())return null;let e=new wl,i=t.readInt();e.area=i;let a=t.readInt();e.dire=a;let r=t.readInt();e.speed=r;let s=t.readLong();e.time=s;let o=t.readInt();e.x=o;let l=t.readInt();return e.y=l,e}};wl.PROTOCOL_ID=1013;var QI=wl,Bh=QI;var Tl=class Tl{constructor(){this.x=0;this.y=0;this.speed=0;this.dire=0;this.errorCode=0;this.time=0}protocolId(){return Tl.PROTOCOL_ID}static write(t,e){t.writePacketFlag(e)||e==null||(t.writeInt(e.dire),t.writeInt(e.errorCode),t.writeInt(e.speed),t.writeLong(e.time),t.writeInt(e.x),t.writeInt(e.y))}static read(t){if(!t.readBoolean())return null;let e=new Tl,i=t.readInt();e.dire=i;let a=t.readInt();e.errorCode=a;let r=t.readInt();e.speed=r;let s=t.readLong();e.time=s;let o=t.readInt();e.x=o;let l=t.readInt();return e.y=l,e}};Tl.PROTOCOL_ID=1014;var JI=Tl,vS=JI;var Cl=class Cl{constructor(){this.type=0;this.member=null}protocolId(){return Cl.PROTOCOL_ID}static write(t,e){t.writePacketFlag(e)||e==null||(t.writePacket(e.member,25011),t.writeInt(e.type))}static read(t){if(!t.readBoolean())return null;let e=new Cl,i=t.readPacket(25011);e.member=i;let a=t.readInt();return e.type=a,e}};Cl.PROTOCOL_ID=1016;var ZI=Cl,Mh=ZI;var Sl=class Sl{constructor(){this.pid=0;this.x=0;this.y=0;this.speed=0;this.dire=0;this.time=0;this.area=0;this.npc=!1}protocolId(){return Sl.PROTOCOL_ID}static write(t,e){t.writePacketFlag(e)||e==null||(t.writeInt(e.area),t.writeInt(e.dire),t.writeBoolean(e.npc),t.writeLong(e.pid),t.writeInt(e.speed),t.writeLong(e.time),t.writeInt(e.x),t.writeInt(e.y))}static read(t){if(!t.readBoolean())return null;let e=new Sl,i=t.readInt();e.area=i;let a=t.readInt();e.dire=a;let r=t.readBoolean();e.npc=r;let s=t.readLong();e.pid=s;let o=t.readInt();e.speed=o;let l=t.readLong();e.time=l;let c=t.readInt();e.x=c;let u=t.readInt();return e.y=u,e}};Sl.PROTOCOL_ID=1018;var eE=Sl,Rh=eE;var Dl=class Dl{constructor(){this.roomId=0;this.rankList=[];this.reward=[];this.arenaType=0;this.groupData=[];this.teamData=[];this.groupFightScore=new Map;this.groupId=0;this.battleTime=0;this.personalRank=0;this.totalRank=0;this.loserTid=""}protocolId(){return Dl.PROTOCOL_ID}static write(t,e){t.writePacketFlag(e)||e==null||(t.writeInt(e.arenaType),t.writeLong(e.battleTime),e.groupData===null?t.writeInt(0):(t.writeInt(e.groupData.length),e.groupData.forEach(i=>{t.writePacketList(i,25013)})),t.writeStringLongMap(e.groupFightScore),t.writeInt(e.groupId),t.writeString(e.loserTid),t.writeLong(e.personalRank),t.writePacketList(e.rankList,25012),t.writePacketList(e.reward,25008),t.writeLong(e.roomId),t.writePacketList(e.teamData,25017),t.writeLong(e.totalRank))}static read(t){if(!t.readBoolean())return null;let e=new Dl,i=t.readInt();e.arenaType=i;let a=t.readLong();e.battleTime=a;let r=new Array,s=t.readInt();if(s>0)for(let I=0;I<s;I++){let M=t.readPacketList(25013);r.push(M)}e.groupData=r;let o=t.readStringLongMap();e.groupFightScore=o;let l=t.readInt();e.groupId=l;let c=t.readString();e.loserTid=c;let u=t.readLong();e.personalRank=u;let p=t.readPacketList(25012);e.rankList=p;let d=t.readPacketList(25008);e.reward=d;let L=t.readLong();e.roomId=L;let x=t.readPacketList(25017);e.teamData=x;let w=t.readLong();return e.totalRank=w,e}};Dl.PROTOCOL_ID=1020;var tE=Dl,Ph=tE;var Al=class Al{constructor(){this.targetId=0;this.attackType=0;this.skillId=0}protocolId(){return Al.PROTOCOL_ID}static write(t,e){t.writePacketFlag(e)||e==null||(t.writeInt(e.attackType),t.writeInt(e.skillId),t.writeLong(e.targetId))}static read(t){if(!t.readBoolean())return null;let e=new Al,i=t.readInt();e.attackType=i;let a=t.readInt();e.skillId=a;let r=t.readLong();return e.targetId=r,e}};Al.PROTOCOL_ID=1021;var iE=Al,Nh=iE;var kl=class kl{constructor(){this.errorCode=0;this.cd=0;this.attackType=0;this.skillId=0;this.commonCd=0}protocolId(){return kl.PROTOCOL_ID}static write(t,e){t.writePacketFlag(e)||e==null||(t.writeInt(e.attackType),t.writeLong(e.cd),t.writeLong(e.commonCd),t.writeInt(e.errorCode),t.writeInt(e.skillId))}static read(t){if(!t.readBoolean())return null;let e=new kl,i=t.readInt();e.attackType=i;let a=t.readLong();e.cd=a;let r=t.readLong();e.commonCd=r;let s=t.readInt();e.errorCode=s;let o=t.readInt();return e.skillId=o,e}};kl.PROTOCOL_ID=1022;var aE=kl,xS=aE;var Bl=class Bl{constructor(){this.attPid=0;this.defPid=0;this.attackValue=[];this.allAtkValue=0;this.bj=!1;this.sb=!1;this.skill=0;this.defHp=0;this.attScore=0;this.defScore=0;this.buffEffects=[];this.attHp=0;this.npc=!1}protocolId(){return Bl.PROTOCOL_ID}static write(t,e){t.writePacketFlag(e)||e==null||(t.writeLong(e.allAtkValue),t.writeLong(e.attHp),t.writeLong(e.attPid),t.writeLong(e.attScore),t.writeLongList(e.attackValue),t.writeBoolean(e.bj),t.writePacketList(e.buffEffects,25016),t.writeLong(e.defHp),t.writeLong(e.defPid),t.writeLong(e.defScore),t.writeBoolean(e.npc),t.writeBoolean(e.sb),t.writeInt(e.skill))}static read(t){if(!t.readBoolean())return null;let e=new Bl,i=t.readLong();e.allAtkValue=i;let a=t.readLong();e.attHp=a;let r=t.readLong();e.attPid=r;let s=t.readLong();e.attScore=s;let o=t.readLongList();e.attackValue=o;let l=t.readBoolean();e.bj=l;let c=t.readPacketList(25016);e.buffEffects=c;let u=t.readLong();e.defHp=u;let p=t.readLong();e.defPid=p;let d=t.readLong();e.defScore=d;let L=t.readBoolean();e.npc=L;let x=t.readBoolean();e.sb=x;let w=t.readInt();return e.skill=w,e}};Bl.PROTOCOL_ID=1024;var nE=Bl,Oh=nE;var Ml=class Ml{constructor(){this.roomId=0}protocolId(){return Ml.PROTOCOL_ID}static write(t,e){t.writePacketFlag(e)||e==null||t.writeLong(e.roomId)}static read(t){if(!t.readBoolean())return null;let e=new Ml,i=t.readLong();return e.roomId=i,e}};Ml.PROTOCOL_ID=1025;var rE=Ml,Hh=rE;var Rl=class Rl{constructor(){this.errorCode=0;this.matchDto=null}protocolId(){return Rl.PROTOCOL_ID}static write(t,e){t.writePacketFlag(e)||e==null||(t.writeInt(e.errorCode),t.writePacket(e.matchDto,25010))}static read(t){if(!t.readBoolean())return null;let e=new Rl,i=t.readInt();e.errorCode=i;let a=t.readPacket(25010);return e.matchDto=a,e}};Rl.PROTOCOL_ID=1026;var sE=Rl,Uh=sE;var Pl=class Pl{constructor(){this.pid=0}protocolId(){return Pl.PROTOCOL_ID}static write(t,e){t.writePacketFlag(e)||e==null||t.writeLong(e.pid)}static read(t){if(!t.readBoolean())return null;let e=new Pl,i=t.readLong();return e.pid=i,e}};Pl.PROTOCOL_ID=1028;var oE=Pl,Vh=oE;var Nl=class Nl{constructor(){this.pid=0;this.kill=0}protocolId(){return Nl.PROTOCOL_ID}static write(t,e){t.writePacketFlag(e)||e==null||(t.writeInt(e.kill),t.writeLong(e.pid))}static read(t){if(!t.readBoolean())return null;let e=new Nl,i=t.readInt();e.kill=i;let a=t.readLong();return e.pid=a,e}};Nl.PROTOCOL_ID=1030;var lE=Nl,Fh=lE;var Ol=class Ol{constructor(){this.targetId=0;this.type=0;this.skillId=0;this.param=new Map;this.monsterId=0}protocolId(){return Ol.PROTOCOL_ID}static write(t,e){t.writePacketFlag(e)||e==null||(t.writeLong(e.monsterId),t.writeStringStringMap(e.param),t.writeInt(e.skillId),t.writeLong(e.targetId),t.writeInt(e.type))}static read(t){if(!t.readBoolean())return null;let e=new Ol,i=t.readLong();e.monsterId=i;let a=t.readStringStringMap();e.param=a;let r=t.readInt();e.skillId=r;let s=t.readLong();e.targetId=s;let o=t.readInt();return e.type=o,e}};Ol.PROTOCOL_ID=1031;var cE=Ol,Hl=cE;var Ul=class Ul{constructor(){this.errorCode=0}protocolId(){return Ul.PROTOCOL_ID}static write(t,e){t.writePacketFlag(e)||e==null||t.writeInt(e.errorCode)}static read(t){if(!t.readBoolean())return null;let e=new Ul,i=t.readInt();return e.errorCode=i,e}};Ul.PROTOCOL_ID=1032;var uE=Ul,IS=uE;var Vl=class Vl{constructor(){this.attId=0;this.defId=0;this.type=0;this.skillId=0;this.param=new Map}protocolId(){return Vl.PROTOCOL_ID}static write(t,e){t.writePacketFlag(e)||e==null||(t.writeLong(e.attId),t.writeLong(e.defId),t.writeStringStringMap(e.param),t.writeInt(e.skillId),t.writeInt(e.type))}static read(t){if(!t.readBoolean())return null;let e=new Vl,i=t.readLong();e.attId=i;let a=t.readLong();e.defId=a;let r=t.readStringStringMap();e.param=r;let s=t.readInt();e.skillId=s;let o=t.readInt();return e.type=o,e}};Vl.PROTOCOL_ID=1034;var mE=Vl,Gh=mE;var Fl=class Fl{constructor(){this.targetId=0;this.targetX=0;this.targetY=0;this.skillId=0;this.sourceId=0;this.time=0}protocolId(){return Fl.PROTOCOL_ID}static write(t,e){t.writePacketFlag(e)||e==null||(t.writeInt(e.skillId),t.writeLong(e.sourceId),t.writeLong(e.targetId),t.writeInt(e.targetX),t.writeInt(e.targetY),t.writeLong(e.time))}static read(t){if(!t.readBoolean())return null;let e=new Fl,i=t.readInt();e.skillId=i;let a=t.readLong();e.sourceId=a;let r=t.readLong();e.targetId=r;let s=t.readInt();e.targetX=s;let o=t.readInt();e.targetY=o;let l=t.readLong();return e.time=l,e}};Fl.PROTOCOL_ID=1035;var pE=Fl,Kh=pE;var Gl=class Gl{constructor(){this.errorCode=0;this.time=0}protocolId(){return Gl.PROTOCOL_ID}static write(t,e){t.writePacketFlag(e)||e==null||(t.writeInt(e.errorCode),t.writeLong(e.time))}static read(t){if(!t.readBoolean())return null;let e=new Gl,i=t.readInt();e.errorCode=i;let a=t.readLong();return e.time=a,e}};Gl.PROTOCOL_ID=1036;var hE=Gl,ES=hE;var Kl=class Kl{constructor(){this.targetId=0;this.targetX=0;this.targetY=0;this.sourceId=0;this.skillId=0;this.time=0}protocolId(){return Kl.PROTOCOL_ID}static write(t,e){t.writePacketFlag(e)||e==null||(t.writeInt(e.skillId),t.writeLong(e.sourceId),t.writeLong(e.targetId),t.writeInt(e.targetX),t.writeInt(e.targetY),t.writeLong(e.time))}static read(t){if(!t.readBoolean())return null;let e=new Kl,i=t.readInt();e.skillId=i;let a=t.readLong();e.sourceId=a;let r=t.readLong();e.targetId=r;let s=t.readInt();e.targetX=s;let o=t.readInt();e.targetY=o;let l=t.readLong();return e.time=l,e}};Kl.PROTOCOL_ID=1038;var dE=Kl,qh=dE;var ql=class ql{constructor(){this.time=0}protocolId(){return ql.PROTOCOL_ID}static write(t,e){t.writePacketFlag(e)||e==null||t.writeLong(e.time)}static read(t){if(!t.readBoolean())return null;let e=new ql,i=t.readLong();return e.time=i,e}};ql.PROTOCOL_ID=1040;var fE=ql,Wh=fE;var Wl=class Wl{constructor(){this.moveList=[]}protocolId(){return Wl.PROTOCOL_ID}static write(t,e){t.writePacketFlag(e)||e==null||t.writePacketList(e.moveList,1018)}static read(t){if(!t.readBoolean())return null;let e=new Wl,i=t.readPacketList(1018);return e.moveList=i,e}};Wl.PROTOCOL_ID=1042;var yE=Wl,Yh=yE;var Yl=class Yl{constructor(){this.pos=0}protocolId(){return Yl.PROTOCOL_ID}static write(t,e){t.writePacketFlag(e)||e==null||t.writeInt(e.pos)}static read(t){if(!t.readBoolean())return null;let e=new Yl,i=t.readInt();return e.pos=i,e}};Yl.PROTOCOL_ID=1043;var bE=Yl,zh=bE;var zl=class zl{constructor(){this.errorCode=0;this.skillId=0;this.pos=0;this.remainCount=0}protocolId(){return zl.PROTOCOL_ID}static write(t,e){t.writePacketFlag(e)||e==null||(t.writeInt(e.errorCode),t.writeInt(e.pos),t.writeInt(e.remainCount),t.writeInt(e.skillId))}static read(t){if(!t.readBoolean())return null;let e=new zl,i=t.readInt();e.errorCode=i;let a=t.readInt();e.pos=a;let r=t.readInt();e.remainCount=r;let s=t.readInt();return e.skillId=s,e}};zl.PROTOCOL_ID=1044;var gE=zl,jh=gE;var jl=class jl{constructor(){this.buffList=[];this.buffEffects=[]}protocolId(){return jl.PROTOCOL_ID}static write(t,e){t.writePacketFlag(e)||e==null||(t.writePacketList(e.buffEffects,25016),t.writePacketList(e.buffList,25015))}static read(t){if(!t.readBoolean())return null;let e=new jl,i=t.readPacketList(25016);e.buffEffects=i;let a=t.readPacketList(25015);return e.buffList=a,e}};jl.PROTOCOL_ID=1046;var LE=jl,$h=LE;var $l=class $l{constructor(){this.pos=0;this.targetList=[]}protocolId(){return $l.PROTOCOL_ID}static write(t,e){t.writePacketFlag(e)||e==null||(t.writeInt(e.pos),t.writeLongList(e.targetList))}static read(t){if(!t.readBoolean())return null;let e=new $l,i=t.readInt();e.pos=i;let a=t.readLongList();return e.targetList=a,e}};$l.PROTOCOL_ID=1047;var _E=$l,Xh=_E;var Xl=class Xl{constructor(){this.errorCode=0;this.skillId=0;this.pos=0}protocolId(){return Xl.PROTOCOL_ID}static write(t,e){t.writePacketFlag(e)||e==null||(t.writeInt(e.errorCode),t.writeInt(e.pos),t.writeInt(e.skillId))}static read(t){if(!t.readBoolean())return null;let e=new Xl,i=t.readInt();e.errorCode=i;let a=t.readInt();e.pos=a;let r=t.readInt();return e.skillId=r,e}};Xl.PROTOCOL_ID=1048;var vE=Xl,wS=vE;var Ql=class Ql{constructor(){this.pos=0;this.targetList=[]}protocolId(){return Ql.PROTOCOL_ID}static write(t,e){t.writePacketFlag(e)||e==null||(t.writeInt(e.pos),t.writeLongList(e.targetList))}static read(t){if(!t.readBoolean())return null;let e=new Ql,i=t.readInt();e.pos=i;let a=t.readLongList();return e.targetList=a,e}};Ql.PROTOCOL_ID=1049;var xE=Ql,Qh=xE;var Jl=class Jl{constructor(){this.errorCode=0;this.skillId=0;this.pos=0;this.remainCount=0}protocolId(){return Jl.PROTOCOL_ID}static write(t,e){t.writePacketFlag(e)||e==null||(t.writeInt(e.errorCode),t.writeInt(e.pos),t.writeInt(e.remainCount),t.writeInt(e.skillId))}static read(t){if(!t.readBoolean())return null;let e=new Jl,i=t.readInt();e.errorCode=i;let a=t.readInt();e.pos=a;let r=t.readInt();e.remainCount=r;let s=t.readInt();return e.skillId=s,e}};Jl.PROTOCOL_ID=1050;var IE=Jl,Jh=IE;var Zl=class Zl{constructor(){this.monsterId=0;this.hp=0;this.maxHp=0;this.x=0;this.y=0}protocolId(){return Zl.PROTOCOL_ID}static write(t,e){t.writePacketFlag(e)||e==null||(t.writeLong(e.hp),t.writeLong(e.maxHp),t.writeLong(e.monsterId),t.writeInt(e.x),t.writeInt(e.y))}static read(t){if(!t.readBoolean())return null;let e=new Zl,i=t.readLong();e.hp=i;let a=t.readLong();e.maxHp=a;let r=t.readLong();e.monsterId=r;let s=t.readInt();e.x=s;let o=t.readInt();return e.y=o,e}};Zl.PROTOCOL_ID=1052;var EE=Zl,Zh=EE;var ec=class ec{constructor(){this.x=0;this.y=0;this.speed=0;this.dire=0;this.time=0;this.area=0;this.monsterId=0}protocolId(){return ec.PROTOCOL_ID}static write(t,e){t.writePacketFlag(e)||e==null||(t.writeInt(e.area),t.writeInt(e.dire),t.writeLong(e.monsterId),t.writeInt(e.speed),t.writeLong(e.time),t.writeInt(e.x),t.writeInt(e.y))}static read(t){if(!t.readBoolean())return null;let e=new ec,i=t.readInt();e.area=i;let a=t.readInt();e.dire=a;let r=t.readLong();e.monsterId=r;let s=t.readInt();e.speed=s;let o=t.readLong();e.time=o;let l=t.readInt();e.x=l;let c=t.readInt();return e.y=c,e}};ec.PROTOCOL_ID=1053;var wE=ec,ed=wE;var tc=class tc{constructor(){this.x=0;this.y=0;this.speed=0;this.dire=0;this.errorCode=0;this.time=0;this.monsterId=0}protocolId(){return tc.PROTOCOL_ID}static write(t,e){t.writePacketFlag(e)||e==null||(t.writeInt(e.dire),t.writeInt(e.errorCode),t.writeLong(e.monsterId),t.writeInt(e.speed),t.writeLong(e.time),t.writeInt(e.x),t.writeInt(e.y))}static read(t){if(!t.readBoolean())return null;let e=new tc,i=t.readInt();e.dire=i;let a=t.readInt();e.errorCode=a;let r=t.readLong();e.monsterId=r;let s=t.readInt();e.speed=s;let o=t.readLong();e.time=o;let l=t.readInt();e.x=l;let c=t.readInt();return e.y=c,e}};tc.PROTOCOL_ID=1054;var TE=tc,TS=TE;var ic=class ic{constructor(){this.targetId=0;this.attackType=0;this.skillId=0;this.monsterId=0}protocolId(){return ic.PROTOCOL_ID}static write(t,e){t.writePacketFlag(e)||e==null||(t.writeInt(e.attackType),t.writeLong(e.monsterId),t.writeInt(e.skillId),t.writeLong(e.targetId))}static read(t){if(!t.readBoolean())return null;let e=new ic,i=t.readInt();e.attackType=i;let a=t.readLong();e.monsterId=a;let r=t.readInt();e.skillId=r;let s=t.readLong();return e.targetId=s,e}};ic.PROTOCOL_ID=1055;var CE=ic,td=CE;var ac=class ac{constructor(){this.errorCode=0;this.cd=0;this.attackType=0;this.skillId=0;this.commonCd=0;this.monsterId=0}protocolId(){return ac.PROTOCOL_ID}static write(t,e){t.writePacketFlag(e)||e==null||(t.writeInt(e.attackType),t.writeLong(e.cd),t.writeLong(e.commonCd),t.writeInt(e.errorCode),t.writeLong(e.monsterId),t.writeInt(e.skillId))}static read(t){if(!t.readBoolean())return null;let e=new ac,i=t.readInt();e.attackType=i;let a=t.readLong();e.cd=a;let r=t.readLong();e.commonCd=r;let s=t.readInt();e.errorCode=s;let o=t.readLong();e.monsterId=o;let l=t.readInt();return e.skillId=l,e}};ac.PROTOCOL_ID=1056;var SE=ac,CS=SE;var nc=class nc{constructor(){this.killPidList=[]}protocolId(){return nc.PROTOCOL_ID}static write(t,e){t.writePacketFlag(e)||e==null||t.writeLongList(e.killPidList)}static read(t){if(!t.readBoolean())return null;let e=new nc,i=t.readLongList();return e.killPidList=i,e}};nc.PROTOCOL_ID=1057;var DE=nc,SS=DE;var rc=class rc{constructor(){this.killPidList=[]}protocolId(){return rc.PROTOCOL_ID}static write(t,e){t.writePacketFlag(e)||e==null||t.writeLongList(e.killPidList)}static read(t){if(!t.readBoolean())return null;let e=new rc,i=t.readLongList();return e.killPidList=i,e}};rc.PROTOCOL_ID=1058;var AE=rc,DS=AE;var sc=class sc{constructor(){this.id=0;this.value=!1}protocolId(){return sc.PROTOCOL_ID}static write(t,e){t.writePacketFlag(e)||e==null||(t.writeInt(e.id),t.writeBoolean(e.value))}static read(t){if(!t.readBoolean())return null;let e=new sc,i=t.readInt();e.id=i;let a=t.readBoolean();return e.value=a,e}};sc.PROTOCOL_ID=25007;var kE=sc,AS=kE;var oc=class oc{constructor(){this.type=0;this.id=0;this.count=0}protocolId(){return oc.PROTOCOL_ID}static write(t,e){t.writePacketFlag(e)||e==null||(t.writeDouble(e.count),t.writeLong(e.id),t.writeInt(e.type))}static read(t){if(!t.readBoolean())return null;let e=new oc,i=t.readDouble();e.count=i;let a=t.readLong();e.id=a;let r=t.readInt();return e.type=r,e}};oc.PROTOCOL_ID=25008;var BE=oc,kS=BE;var lc=class lc{constructor(){this.id=0;this.map=0;this.maxX=0;this.maxY=0;this.players=[];this.groupId=0}protocolId(){return lc.PROTOCOL_ID}static write(t,e){t.writePacketFlag(e)||e==null||(t.writeInt(e.groupId),t.writeLong(e.id),t.writeInt(e.map),t.writeInt(e.maxX),t.writeInt(e.maxY),t.writePacketList(e.players,25011))}static read(t){if(!t.readBoolean())return null;let e=new lc,i=t.readInt();e.groupId=i;let a=t.readLong();e.id=a;let r=t.readInt();e.map=r;let s=t.readInt();e.maxX=s;let o=t.readInt();e.maxY=o;let l=t.readPacketList(25011);return e.players=l,e}};lc.PROTOCOL_ID=25009;var ME=lc,BS=ME;var cc=class cc{constructor(){this.arenaId=0;this.coinType=0;this.roomId=0;this.members=[];this.remainderCd=0;this.startTime=0;this.nowTime=0;this.arenaType=0;this.watch=[];this.anonymous=0}protocolId(){return cc.PROTOCOL_ID}static write(t,e){t.writePacketFlag(e)||e==null||(t.writeInt(e.anonymous),t.writeInt(e.arenaId),t.writeInt(e.arenaType),t.writeInt(e.coinType),t.writePacketList(e.members,25011),t.writeLong(e.nowTime),t.writeLong(e.remainderCd),t.writeLong(e.roomId),t.writeLong(e.startTime),t.writeLongList(e.watch))}static read(t){if(!t.readBoolean())return null;let e=new cc,i=t.readInt();e.anonymous=i;let a=t.readInt();e.arenaId=a;let r=t.readInt();e.arenaType=r;let s=t.readInt();e.coinType=s;let o=t.readPacketList(25011);e.members=o;let l=t.readLong();e.nowTime=l;let c=t.readLong();e.remainderCd=c;let u=t.readLong();e.roomId=u;let p=t.readLong();e.startTime=p;let d=t.readLongList();return e.watch=d,e}};cc.PROTOCOL_ID=25010;var RE=cc,MS=RE;var uc=class uc{constructor(){this.id=0;this.x=0;this.y=0;this.dire=0;this.speed=0;this.heroId=0;this.heroColor=0;this.name="";this.icon="";this.leader=0;this.kill=0;this.hp=0;this.maxHp=0;this.atk=0;this.score=0;this.skillCd=new Map;this.commonCd=0;this.area=0;this.country=0;this.nodeId=0;this.lease=0;this.equips=new Map;this.cardCd=new Map;this.buffDtoList=[];this.no=0;this.npc=!1;this.startTime=0;this.status=0;this.killStatus=0}protocolId(){return uc.PROTOCOL_ID}static write(t,e){t.writePacketFlag(e)||e==null||(t.writeInt(e.area),t.writeLong(e.atk),t.writePacketList(e.buffDtoList,25015),t.writeIntLongMap(e.cardCd),t.writeLong(e.commonCd),t.writeInt(e.country),t.writeInt(e.dire),t.writeStringPacketMap(e.equips,25014),t.writeInt(e.heroColor),t.writeLong(e.heroId),t.writeLong(e.hp),t.writeString(e.icon),t.writeLong(e.id),t.writeInt(e.kill),t.writeInt(e.killStatus),t.writeInt(e.leader),t.writeInt(e.lease),t.writeLong(e.maxHp),t.writeString(e.name),t.writeInt(e.no),t.writeInt(e.nodeId),t.writeBoolean(e.npc),t.writeLong(e.score),t.writeIntLongMap(e.skillCd),t.writeInt(e.speed),t.writeLong(e.startTime),t.writeInt(e.status),t.writeInt(e.x),t.writeInt(e.y))}static read(t){if(!t.readBoolean())return null;let e=new uc,i=t.readInt();e.area=i;let a=t.readLong();e.atk=a;let r=t.readPacketList(25015);e.buffDtoList=r;let s=t.readIntLongMap();e.cardCd=s;let o=t.readLong();e.commonCd=o;let l=t.readInt();e.country=l;let c=t.readInt();e.dire=c;let u=t.readStringPacketMap(25014);e.equips=u;let p=t.readInt();e.heroColor=p;let d=t.readLong();e.heroId=d;let L=t.readLong();e.hp=L;let x=t.readString();e.icon=x;let w=t.readLong();e.id=w;let I=t.readInt();e.kill=I;let M=t.readInt();e.killStatus=M;let H=t.readInt();e.leader=H;let V=t.readInt();e.lease=V;let q=t.readLong();e.maxHp=q;let X=t.readString();e.name=X;let Z=t.readInt();e.no=Z;let Q=t.readInt();e.nodeId=Q;let ee=t.readBoolean();e.npc=ee;let ae=t.readLong();e.score=ae;let Be=t.readIntLongMap();e.skillCd=Be;let we=t.readInt();e.speed=we;let $=t.readLong();e.startTime=$;let Oe=t.readInt();e.status=Oe;let ce=t.readInt();e.x=ce;let ve=t.readInt();return e.y=ve,e}};uc.PROTOCOL_ID=25011;var PE=uc,RS=PE;var mc=class mc{constructor(){this.id=0;this.heroId=0;this.heroColor=0;this.name="";this.icon="";this.leader=0;this.rankNum=0;this.kill=0;this.atk=0;this.score=0;this.die=!1;this.country=0;this.heroPk="";this.nodeId=0;this.lease=0;this.no=0;this.startTime=0}protocolId(){return mc.PROTOCOL_ID}static write(t,e){t.writePacketFlag(e)||e==null||(t.writeLong(e.atk),t.writeInt(e.country),t.writeBoolean(e.die),t.writeInt(e.heroColor),t.writeLong(e.heroId),t.writeString(e.heroPk),t.writeString(e.icon),t.writeLong(e.id),t.writeInt(e.kill),t.writeInt(e.leader),t.writeInt(e.lease),t.writeString(e.name),t.writeInt(e.no),t.writeInt(e.nodeId),t.writeInt(e.rankNum),t.writeLong(e.score),t.writeLong(e.startTime))}static read(t){if(!t.readBoolean())return null;let e=new mc,i=t.readLong();e.atk=i;let a=t.readInt();e.country=a;let r=t.readBoolean();e.die=r;let s=t.readInt();e.heroColor=s;let o=t.readLong();e.heroId=o;let l=t.readString();e.heroPk=l;let c=t.readString();e.icon=c;let u=t.readLong();e.id=u;let p=t.readInt();e.kill=p;let d=t.readInt();e.leader=d;let L=t.readInt();e.lease=L;let x=t.readString();e.name=x;let w=t.readInt();e.no=w;let I=t.readInt();e.nodeId=I;let M=t.readInt();e.rankNum=M;let H=t.readLong();e.score=H;let V=t.readLong();return e.startTime=V,e}};mc.PROTOCOL_ID=25012;var NE=mc,PS=NE;var pc=class pc{constructor(){this.pid=0;this.rank=0;this.reward=[]}protocolId(){return pc.PROTOCOL_ID}static write(t,e){t.writePacketFlag(e)||e==null||(t.writeLong(e.pid),t.writeInt(e.rank),t.writePacketList(e.reward,25008))}static read(t){if(!t.readBoolean())return null;let e=new pc,i=t.readLong();e.pid=i;let a=t.readInt();e.rank=a;let r=t.readPacketList(25008);return e.reward=r,e}};pc.PROTOCOL_ID=25013;var OE=pc,NS=OE;var hc=class hc{constructor(){this.pk="";this.type=0;this.id=0;this.count=0}protocolId(){return hc.PROTOCOL_ID}static write(t,e){t.writePacketFlag(e)||e==null||(t.writeDouble(e.count),t.writeLong(e.id),t.writeString(e.pk),t.writeInt(e.type))}static read(t){if(!t.readBoolean())return null;let e=new hc,i=t.readDouble();e.count=i;let a=t.readLong();e.id=a;let r=t.readString();e.pk=r;let s=t.readInt();return e.type=s,e}};hc.PROTOCOL_ID=25014;var HE=hc,OS=HE;var dc=class dc{constructor(){this.buffId=0;this.expireTime=0;this.skillId=0;this.pid=0}protocolId(){return dc.PROTOCOL_ID}static write(t,e){t.writePacketFlag(e)||e==null||(t.writeInt(e.buffId),t.writeLong(e.expireTime),t.writeLong(e.pid),t.writeInt(e.skillId))}static read(t){if(!t.readBoolean())return null;let e=new dc,i=t.readInt();e.buffId=i;let a=t.readLong();e.expireTime=a;let r=t.readLong();e.pid=r;let s=t.readInt();return e.skillId=s,e}};dc.PROTOCOL_ID=25015;var UE=dc,HS=UE;var fc=class fc{constructor(){this.atk=0;this.buffId=0;this.effectType=0;this.targetPid=0}protocolId(){return fc.PROTOCOL_ID}static write(t,e){t.writePacketFlag(e)||e==null||(t.writeLong(e.atk),t.writeLong(e.buffId),t.writeInt(e.effectType),t.writeLong(e.targetPid))}static read(t){if(!t.readBoolean())return null;let e=new fc,i=t.readLong();e.atk=i;let a=t.readLong();e.buffId=a;let r=t.readInt();e.effectType=r;let s=t.readLong();return e.targetPid=s,e}};fc.PROTOCOL_ID=25016;var VE=fc,US=VE;var yc=class yc{constructor(){this.rank=0;this.no=0;this.score=0;this.members=[]}protocolId(){return yc.PROTOCOL_ID}static write(t,e){t.writePacketFlag(e)||e==null||(t.writeLongList(e.members),t.writeInt(e.no),t.writeInt(e.rank),t.writeLong(e.score))}static read(t){if(!t.readBoolean())return null;let e=new yc,i=t.readLongList();e.members=i;let a=t.readInt();e.no=a;let r=t.readInt();e.rank=r;let s=t.readLong();return e.score=s,e}};yc.PROTOCOL_ID=25017;var FE=yc,VS=FE;var Re=new Map;Re.set(101,hl);Re.set(103,Th);Re.set(104,yS);Re.set(1001,Ch);Re.set(1002,Sh);Re.set(1004,Dh);Re.set(1005,bS);Re.set(1006,gS);Re.set(1007,Ah);Re.set(1008,kh);Re.set(1010,LS);Re.set(1012,_S);Re.set(1013,Bh);Re.set(1014,vS);Re.set(1016,Mh);Re.set(1018,Rh);Re.set(1020,Ph);Re.set(1021,Nh);Re.set(1022,xS);Re.set(1024,Oh);Re.set(1025,Hh);Re.set(1026,Uh);Re.set(1028,Vh);Re.set(1030,Fh);Re.set(1031,Hl);Re.set(1032,IS);Re.set(1034,Gh);Re.set(1035,Kh);Re.set(1036,ES);Re.set(1038,qh);Re.set(1040,Wh);Re.set(1042,Yh);Re.set(1043,zh);Re.set(1044,jh);Re.set(1046,$h);Re.set(1047,Xh);Re.set(1048,wS);Re.set(1049,Qh);Re.set(1050,Jh);Re.set(1052,Zh);Re.set(1053,ed);Re.set(1054,TS);Re.set(1055,td);Re.set(1056,CS);Re.set(1057,SS);Re.set(1058,DS);Re.set(25007,AS);Re.set(25008,kS);Re.set(25009,BS);Re.set(25010,MS);Re.set(25011,RS);Re.set(25012,PS);Re.set(25013,NS);Re.set(25014,OS);Re.set(25015,HS);Re.set(25016,US);Re.set(25017,VS);var GE=class n{static getProtocol(t){let e=Re.get(t);if(e===null)throw"[protocolId:"+t+"]协议不存在";return e}static write(t,e){let i=e.protocolId();t.writeInt(i),n.getProtocol(i).write(t,e)}static read(t){let e=t.readInt();return n.getProtocol(e).read(t)}},gi=GE;var FS={},GS={},Gi;try{Gi=new WebAssembly.Instance(new WebAssembly.Module(new Uint8Array([0,97,115,109,1,0,0,0,1,13,2,96,0,1,127,96,4,127,127,127,127,1,127,3,7,6,0,1,1,1,1,1,6,6,1,127,1,65,0,11,7,50,6,3,109,117,108,0,1,5,100,105,118,95,115,0,2,5,100,105,118,95,117,0,3,5,114,101,109,95,115,0,4,5,114,101,109,95,117,0,5,8,103,101,116,95,104,105,103,104,0,0,10,191,1,6,4,0,35,0,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,126,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,127,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,128,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,129,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,130,34,4,66,32,135,167,36,0,32,4,167,11])),{}).exports}catch{}var j=class j{constructor(t,e,i=!1){this.low=t|0,this.high=e|0,this.unsigned=i}toInt(){return this.unsigned?this.low>>>0:this.low}toNumber(){return this.unsigned?(this.high>>>0)*lo+(this.low>>>0):this.high*lo+(this.low>>>0)}toString(t=10){if(t<2||36<t)throw RangeError("radix");if(this.isZero())return"0";if(this.isNegative())if(this.equals(j.MIN_VALUE)){let r=j.fromNumber(t),s=this.divide(r),o=s.multiply(r).subtract(this);return s.toString(t)+o.toInt().toString(t)}else return"-"+this.negate().toString(t);let e=j.fromNumber(Math.pow(t,6),this.unsigned),i="",a=this;for(;;){let r=a.divide(e),o=(a.subtract(r.multiply(e)).toInt()>>>0).toString(t);if(a=r,a.isZero())return o+i;for(;o.length<6;)o="0"+o;i=""+o+i}}getHighBits(){return this.high}getHighBitsUnsigned(){return this.high>>>0}getLowBits(){return this.low}getLowBitsUnsigned(){return this.low>>>0}getNumBitsAbs(){if(this.isNegative())return this.equals(j.MIN_VALUE)?64:this.negate().getNumBitsAbs();let t=this.high!=0?this.high:this.low,e;for(e=31;e>0&&!(t&1<<e);e--);return this.high!=0?e+33:e+1}isZero(){return this.high===0&&this.low===0}isNegative(){return!this.unsigned&&this.high<0}isPositive(){return this.unsigned||this.high>=0}isOdd(){return(this.low&1)===1}isEven(){return(this.low&1)===0}equals(t){return t instanceof j||(t=j.fromValue(t)),this.unsigned!==t.unsigned&&this.high>>>31===1&&t.high>>>31===1?!1:this.high===t.high&&this.low===t.low}notEquals(t){return!this.equals(t)}lessThan(t){return this.compare(t)<0}lessThanOrEqual(t){return this.compare(t)<=0}greaterThan(t){return this.compare(t)>0}greaterThanOrEqual(t){return this.compare(t)>=0}compare(t){if(t instanceof j||(t=j.fromValue(t)),this.equals(t))return 0;let e=this.isNegative(),i=t.isNegative();return e&&!i?-1:!e&&i?1:this.unsigned?t.high>>>0>this.high>>>0||t.high===this.high&&t.low>>>0>this.low>>>0?-1:1:this.subtract(t).isNegative()?-1:1}negate(){return!this.unsigned&&this.equals(j.MIN_VALUE)?j.MIN_VALUE:this.not().add(j.ONE)}add(t){t instanceof j||(t=j.fromValue(t));let e=this.high>>>16,i=this.high&65535,a=this.low>>>16,r=this.low&65535,s=t.high>>>16,o=t.high&65535,l=t.low>>>16,c=t.low&65535,u=0,p=0,d=0,L=0;return L+=r+c,d+=L>>>16,L&=65535,d+=a+l,p+=d>>>16,d&=65535,p+=i+o,u+=p>>>16,p&=65535,u+=e+s,u&=65535,j.fromBits(d<<16|L,u<<16|p,this.unsigned)}subtract(t){return t instanceof j||(t=j.fromValue(t)),this.add(t.negate())}multiply(t){if(this.isZero())return j.ZERO;if(t instanceof j||(t=j.fromValue(t)),Gi){let x=Gi.mul(this.low,this.high,t.low,t.high);return j.fromBits(x,Gi.get_high(),this.unsigned)}if(t.isZero())return j.ZERO;if(this.equals(j.MIN_VALUE))return t.isOdd()?j.MIN_VALUE:j.ZERO;if(t.equals(j.MIN_VALUE))return this.isOdd()?j.MIN_VALUE:j.ZERO;if(this.isNegative())return t.isNegative()?this.negate().multiply(t.negate()):this.negate().multiply(t).negate();if(t.isNegative())return this.multiply(t.negate()).negate();if(this.lessThan(WS)&&t.lessThan(WS))return j.fromNumber(this.toNumber()*t.toNumber(),this.unsigned);let e=this.high>>>16,i=this.high&65535,a=this.low>>>16,r=this.low&65535,s=t.high>>>16,o=t.high&65535,l=t.low>>>16,c=t.low&65535,u=0,p=0,d=0,L=0;return L+=r*c,d+=L>>>16,L&=65535,d+=a*c,p+=d>>>16,d&=65535,d+=r*l,p+=d>>>16,d&=65535,p+=i*c,u+=p>>>16,p&=65535,p+=a*l,u+=p>>>16,p&=65535,p+=r*o,u+=p>>>16,p&=65535,u+=e*c+i*l+a*o+r*s,u&=65535,j.fromBits(d<<16|L,u<<16|p,this.unsigned)}divide(t){if(t instanceof j||(t=j.fromValue(t)),t.isZero())throw Error("division by zero");if(Gi){if(!this.unsigned&&this.high===-2147483648&&t.low===-1&&t.high===-1)return this;let r=(this.unsigned?Gi.div_u:Gi.div_s)(this.low,this.high,t.low,t.high);return j.fromBits(r,Gi.get_high(),this.unsigned)}if(this.isZero())return this.unsigned?j.UZERO:j.ZERO;let e,i,a;if(this.unsigned){if(t.unsigned||(t=t.toUnsigned()),t.greaterThan(this))return j.UZERO;if(t.greaterThan(this.shiftRightUnsigned(1)))return j.UONE;a=j.UZERO}else{if(this.equals(j.MIN_VALUE))return t.equals(j.ONE)||t.equals(j.NEG_ONE)?j.MIN_VALUE:t.equals(j.MIN_VALUE)?j.ONE:(e=this.shiftRight(1).divide(t).shiftLeft(1),e.equals(j.ZERO)?t.isNegative()?j.ONE:j.NEG_ONE:(i=this.subtract(t.multiply(e)),a=e.add(i.divide(t)),a));if(t.equals(j.MIN_VALUE))return this.unsigned?j.UZERO:j.ZERO;if(this.isNegative())return t.isNegative()?this.negate().divide(t.negate()):this.negate().divide(t).negate();if(t.isNegative())return this.divide(t.negate()).negate();a=j.ZERO}for(i=this;i.greaterThanOrEqual(t);){e=Math.max(1,Math.floor(i.toNumber()/t.toNumber()));let r=Math.ceil(Math.log(e)/Math.LN2),s=r<=48?1:Math.pow(2,r-48),o=j.fromNumber(e),l=o.multiply(t);for(;l.isNegative()||l.greaterThan(i);)e-=s,o=j.fromNumber(e,this.unsigned),l=o.multiply(t);o.isZero()&&(o=j.ONE),a=a.add(o),i=i.subtract(l)}return a}modulo(t){if(t instanceof j||(t=j.fromValue(t)),Gi){let e=(this.unsigned?Gi.rem_u:Gi.rem_s)(this.low,this.high,t.low,t.high);return j.fromBits(e,Gi.get_high(),this.unsigned)}return this.subtract(this.divide(t).multiply(t))}not(){return j.fromBits(~this.low,~this.high,this.unsigned)}and(t){return t instanceof j||(t=j.fromValue(t)),j.fromBits(this.low&t.low,this.high&t.high,this.unsigned)}or(t){return t instanceof j||(t=j.fromValue(t)),j.fromBits(this.low|t.low,this.high|t.high,this.unsigned)}xor(t){return t instanceof j||(t=j.fromValue(t)),j.fromBits(this.low^t.low,this.high^t.high,this.unsigned)}shiftLeft(t){if(t instanceof j&&(t=t.toInt()),(t&=63)===0)return this;if(t<32){let e=this.low<<t;return j.fromBits(e,this.high<<t|this.low>>>32-t,this.unsigned)}else return j.fromBits(0,this.low<<t-32,this.unsigned)}shiftRight(t){return t instanceof j&&(t=t.toInt()),(t&=63)===0?this:t<32?j.fromBits(this.low>>>t|this.high<<32-t,this.high>>t,this.unsigned):j.fromBits(this.high>>t-32,this.high>=0?0:-1,this.unsigned)}shiftRightUnsigned(t){return t instanceof j&&(t=t.toInt()),(t&=63)===0?this:t<32?j.fromBits(this.low>>>t|this.high<<32-t,this.high>>>t,this.unsigned):t===32?j.fromBits(this.high,0,this.unsigned):j.fromBits(this.high>>>t-32,0,this.unsigned)}rotateLeft(t){let e;return t instanceof j&&(t=t.toInt()),(t&=63)===0?this:t===32?j.fromBits(this.high,this.low,this.unsigned):t<32?(e=32-t,j.fromBits(this.low<<t|this.high>>>e,this.high<<t|this.low>>>e,this.unsigned)):(t-=32,e=32-t,j.fromBits(this.high<<t|this.low>>>e,this.low<<t|this.high>>>e,this.unsigned))}rotateRight(t){let e;return t instanceof j&&(t=t.toInt()),(t&=63)===0?this:t===32?j.fromBits(this.high,this.low,this.unsigned):t<32?(e=32-t,j.fromBits(this.high<<e|this.low>>>t,this.low<<e|this.high>>>t,this.unsigned)):(t-=32,e=32-t,j.fromBits(this.low<<e|this.high>>>t,this.high<<e|this.low>>>t,this.unsigned))}toSigned(){return this.unsigned?j.fromBits(this.low,this.high,!1):this}toUnsigned(){return this.unsigned?this:j.fromBits(this.low,this.high,!0)}toBytes(t){return t?this.toBytesLE():this.toBytesBE()}toBytesLE(){let t=this.high,e=this.low;return[e&255,e>>>8&255,e>>>16&255,e>>>24,t&255,t>>>8&255,t>>>16&255,t>>>24]}toBytesBE(){let t=this.high,e=this.low;return[t>>>24,t>>>16&255,t>>>8&255,t&255,e>>>24,e>>>16&255,e>>>8&255,e&255]}static fromBytes(t,e,i){return i?j.fromBytesLE(t,e):j.fromBytesBE(t,e)}static fromBytesLE(t,e){return new j(t[0]|t[1]<<8|t[2]<<16|t[3]<<24,t[4]|t[5]<<8|t[6]<<16|t[7]<<24,e)}static fromBytesBE(t,e){return new j(t[4]<<24|t[5]<<16|t[6]<<8|t[7],t[0]<<24|t[1]<<16|t[2]<<8|t[3],e)}static fromInt(t,e){let i;if(e){if(t>>>=0,i=0<=t&&t<256){let r=GS[t];if(r)return r}let a=j.fromBits(t,(t|0)<0?-1:0,!0);return i&&(GS[t]=a),a}else{if(t|=0,i=-128<=t&&t<128){let r=FS[t];if(r)return r}let a=j.fromBits(t,t<0?-1:0,!1);return i&&(FS[t]=a),a}}static fromNumber(t,e){if(isNaN(t))return e?j.UZERO:j.ZERO;if(e){if(t<0)return j.UZERO;if(t>=YS)return j.MAX_UNSIGNED_VALUE}else{if(t<=-qS)return j.MIN_VALUE;if(t+1>=qS)return j.MAX_VALUE}return t<0?j.fromNumber(-t,e).negate():j.fromBits(t%lo|0,t/lo|0,e)}static fromBits(t,e,i){return new j(t,e,i)}static fromString(t,e,i){if(t.length===0)throw Error("empty string");if(t==="NaN"||t==="Infinity"||t==="+Infinity"||t==="-Infinity")return j.ZERO;if(typeof e=="number"?(i=e,e=!1):e=!!e,i=i||10,i<2||36<i)throw RangeError("radix");let a;if((a=t.indexOf("-"))>0)throw Error("interior hyphen");if(a===0)return j.fromString(t.substring(1),e,i).negate();let r=j.fromNumber(Math.pow(i,8)),s=j.ZERO;for(let o=0;o<t.length;o+=8){let l=Math.min(8,t.length-o),c=parseInt(t.substring(o,o+l),i);if(l<8){let u=j.fromNumber(Math.pow(i,l));s=s.multiply(u).add(j.fromNumber(c))}else s=s.multiply(r),s=s.add(j.fromNumber(c))}return s.unsigned=e,s}static fromValue(t,e){return typeof t=="number"?j.fromNumber(t,e):typeof t=="string"?j.fromString(t,e):j.fromBits(t.low,t.high,typeof e=="boolean"?e:t.unsigned)}};j.ZERO=j.fromInt(0),j.UZERO=j.fromInt(0,!0),j.ONE=j.fromInt(1),j.UONE=j.fromInt(1,!0),j.NEG_ONE=j.fromInt(-1),j.MAX_VALUE=j.fromBits(-1,2147483647,!1),j.MAX_UNSIGNED_VALUE=j.fromBits(-1,-1,!0),j.MIN_VALUE=j.fromBits(0,-2147483648,!1);var co=j,KS=65536,s2=1<<24,lo=KS*KS,YS=lo*lo,qS=YS/2,WS=co.fromInt(s2);var bc=class n{constructor(t,e){this.lo=t>>>0,this.hi=e>>>0}zzEncode(){let t=this.hi>>31;return this.hi=((this.hi<<1|this.lo>>>31)^t)>>>0,this.lo=(this.lo<<1^t)>>>0,this}zzDecode(){let t=-(this.lo&1);return this.lo=((this.lo>>>1|this.hi<<31)^t)>>>0,this.hi=(this.hi>>>1^t)>>>0,this}toLong(t){return new co(this.lo|0,this.hi|0,!!t)}static from(t){return typeof t=="number"?n.fromNumber(t):((typeof t=="string"||t instanceof String)&&(t=co.fromString(t)),t.low||t.high?new n(t.low>>>0,t.high>>>0):zS)}static fromNumber(t){if(t===0)return zS;let e=t<0;e&&(t=-t);let i=t>>>0,a=(t-i)/4294967296>>>0;return e&&(a=~a>>>0,i=~i>>>0,++i>4294967295&&(i=0,++a>4294967295&&(a=0))),new n(i,a)}},zS=new bc(0,0);function o2(n,t){let e=0;for(;t.hi;)n.writeByte(t.lo&127|128),t.lo=(t.lo>>>7|t.hi<<25)>>>0,t.hi>>>=7,e=e+7;for(;t.lo>127;){if(e>=56){n.writeByte(t.lo);return}n.writeByte(t.lo&127|128),t.lo=t.lo>>>7,e=e+7}n.writeByte(t.lo)}function l2(n){let t=new bc(0,0),e=0,i=n.length,a=0;if(i-a>4){for(;e<4;++e)if(t.lo=(t.lo|(n[a]&127)<<e*7)>>>0,n[a++]<128)return t;if(t.lo=(t.lo|(n[a]&127)<<28)>>>0,t.hi=(t.hi|(n[a]&127)>>4)>>>0,n[a++]<128)return t;e=0}else{for(;e<3;++e)if(t.lo=(t.lo|(n[a]&127)<<e*7)>>>0,n[a++]<128)return t;return t.lo=(t.lo|(n[a++]&127)<<e*7)>>>0,t}for(;e<4;++e){if(a===8)return t.hi=(t.hi|n[a]<<e*7+3)>>>0,t;if(t.hi=(t.hi|(n[a]&127)<<e*7+3)>>>0,n[a++]<128)return t}return t}function jS(n,t){let e=bc.from(t).zzEncode();o2(n,e)}function $S(n){return l2(n).zzDecode().toLong(!1)}var XS="",c2=128,u2=655537,m2=32767,p2=-32768,QS=2147483647,JS=-2147483648,h2=new TextEncoder,d2=new TextDecoder;function f2(n,t){if(n.byteLength>t)throw new Error("newLength is too small");let e=new ArrayBuffer(t);return new Uint8Array(e).set(new Uint8Array(n)),e}function y2(n){return n<<1^n>>31}function b2(n){return n>>>1^-(n&1)}var KE=class{constructor(){this.writeOffset=0,this.readOffset=0,this.buffer=new ArrayBuffer(c2),this.bufferView=new DataView(this.buffer,0,this.buffer.byteLength)}setWriteOffset(t){if(t>this.buffer.byteLength)throw new Error("index out of bounds exception:readerIndex:"+this.readOffset+", writerIndex:"+this.writeOffset+"(expected:0 <= readerIndex <= writerIndex <= capacity:"+this.buffer.byteLength);this.writeOffset=t}setReadOffset(t){if(t>this.writeOffset)throw new Error("index out of bounds exception:readerIndex:"+this.readOffset+", writerIndex:"+this.writeOffset+"(expected:0 <= readerIndex <= writerIndex <= capacity:"+this.buffer.byteLength);this.readOffset=t}getCapacity(){return this.buffer.byteLength-this.writeOffset}ensureCapacity(t){for(;t-this.getCapacity()>0;){let e=this.buffer.byteLength*2;if(e>u2)throw new Error("out of memory error");this.buffer=f2(this.buffer,e),this.bufferView=new DataView(this.buffer,0,this.buffer.byteLength)}}isReadable(){return this.writeOffset>this.readOffset}writeBytes(t){let e=t.byteLength;this.ensureCapacity(e),new Uint8Array(this.buffer).set(new Uint8Array(t),this.writeOffset),this.writeOffset+=e}toBytes(){let t=new ArrayBuffer(this.writeOffset);return new Uint8Array(t).set(new Uint8Array(this.buffer.slice(0,this.writeOffset))),t}writeBoolean(t){if(!(t===!0||t===!1))throw new Error("value must be true of false");this.ensureCapacity(1),t===!0?this.bufferView.setInt8(this.writeOffset,1):this.bufferView.setInt8(this.writeOffset,0),this.writeOffset++}readBoolean(){let t=this.bufferView.getInt8(this.readOffset);return this.readOffset++,t===1}writeByte(t){this.ensureCapacity(1),this.bufferView.setInt8(this.writeOffset,t),this.writeOffset++}readByte(){let t=this.bufferView.getInt8(this.readOffset);return this.readOffset++,t}writeShort(t){if(!(p2<=t&&t<=m2))throw new Error("value must range between minShort:-32768 and maxShort:32767");this.ensureCapacity(2),this.bufferView.setInt16(this.writeOffset,t),this.writeOffset+=2}readShort(){let t=this.bufferView.getInt16(this.readOffset);return this.readOffset+=2,t}writeRawInt(t){if(!(JS<=t&&t<=QS))throw new Error("value must range between minInt:-2147483648 and maxInt:2147483647");this.ensureCapacity(4),this.bufferView.setInt32(this.writeOffset,t),this.writeOffset+=4}readRawInt(){let t=this.bufferView.getInt32(this.readOffset);return this.readOffset+=4,t}writeInt(t){if(!(JS<=t&&t<=QS))throw new Error("value must range between minInt:-2147483648 and maxInt:2147483647");if(this.ensureCapacity(5),t=y2(t),!(t>>>7)){this.writeByte(t);return}if(!(t>>>14)){this.writeByte(t&127|128),this.writeByte(t>>>7);return}if(!(t>>>21)){this.writeByte(t&127|128),this.writeByte(t>>>7|128),this.writeByte(t>>>14);return}if(!(t>>>28)){this.writeByte(t&127|128),this.writeByte(t>>>7|128),this.writeByte(t>>>14|128),this.writeByte(t>>>21);return}this.writeByte(t&127|128),this.writeByte(t>>>7|128),this.writeByte(t>>>14|128),this.writeByte(t>>>21|128),this.writeByte(t>>>28)}readInt(){let t=this.readByte(),e=t&127;return t&128&&(t=this.readByte(),e|=(t&127)<<7,t&128&&(t=this.readByte(),e|=(t&127)<<14,t&128&&(t=this.readByte(),e|=(t&127)<<21,t&128&&(t=this.readByte(),e|=(t&127)<<28)))),b2(e)}writeLong(t){if(t==null)throw new Error("value must not be null");this.ensureCapacity(9),jS(this,t)}readLong(){let t=new ArrayBuffer(9),e=new DataView(t,0,t.byteLength),i=0,a=this.readByte();return e.setUint8(i++,a),a&128&&(a=this.readByte(),e.setUint8(i++,a),a&128&&(a=this.readByte(),e.setUint8(i++,a),a&128&&(a=this.readByte(),e.setUint8(i++,a),a&128&&(a=this.readByte(),e.setUint8(i++,a),a&128&&(a=this.readByte(),e.setUint8(i++,a),a&128&&(a=this.readByte(),e.setUint8(i++,a),a&128&&(a=this.readByte(),e.setUint8(i++,a),a&128&&(a=this.readByte(),e.setUint8(i++,a))))))))),$S(new Uint8Array(t.slice(0,i))).toNumber()}writeFloat(t){if(t==null)throw new Error("value must not be null");this.ensureCapacity(4),this.bufferView.setFloat32(this.writeOffset,t),this.writeOffset+=4}readFloat(){let t=this.bufferView.getFloat32(this.readOffset);return this.readOffset+=4,t}writeDouble(t){if(t==null)throw new Error("value must not be null");this.ensureCapacity(8),this.bufferView.setFloat64(this.writeOffset,t),this.writeOffset+=8}readDouble(){let t=this.bufferView.getFloat64(this.readOffset);return this.readOffset+=8,t}writeChar(t){if(t==null||t.length===0){this.writeString(XS);return}this.writeString(t.charAt(0))}readChar(){return this.readString()}writeString(t){if(t==null||t.trim().length===0){this.writeInt(0);return}let e=h2.encode(t);this.ensureCapacity(5+e.length),this.writeInt(e.length),e.forEach(i=>this.writeByte(i))}readString(){let t=this.readInt();if(t<=0)return XS;let e=new Uint8Array(this.buffer.slice(this.readOffset,this.readOffset+t)),i=d2.decode(e);return this.readOffset+=t,i}writePacketFlag(t){let e=t==null;return this.writeBoolean(!e),e}writePacket(t,e){gi.getProtocol(e).write(this,t)}readPacket(t){return gi.getProtocol(t).read(this)}writeBooleanArray(t){t===null?this.writeInt(0):(this.writeInt(t.length),t.forEach(e=>{this.writeBoolean(e)}))}readBooleanArray(){let t=[],e=this.readInt();if(e>0)for(let i=0;i<e;i++)t.push(this.readBoolean());return t}writeByteArray(t){t===null?this.writeInt(0):(this.writeInt(t.length),t.forEach(e=>{this.writeByte(e)}))}readByteArray(){let t=[],e=this.readInt();if(e>0)for(let i=0;i<e;i++)t.push(this.readByte());return t}writeShortArray(t){t===null?this.writeInt(0):(this.writeInt(t.length),t.forEach(e=>{this.writeShort(e)}))}readShortArray(){let t=[],e=this.readInt();if(e>0)for(let i=0;i<e;i++)t.push(this.readShort());return t}writeIntArray(t){t===null?this.writeInt(0):(this.writeInt(t.length),t.forEach(e=>{this.writeInt(e)}))}readIntArray(){let t=[],e=this.readInt();if(e>0)for(let i=0;i<e;i++)t.push(this.readInt());return t}writeLongArray(t){t===null?this.writeInt(0):(this.writeInt(t.length),t.forEach(e=>{this.writeLong(e)}))}readLongArray(){let t=[],e=this.readInt();if(e>0)for(let i=0;i<e;i++)t.push(this.readLong());return t}writeFloatArray(t){t===null?this.writeInt(0):(this.writeInt(t.length),t.forEach(e=>{this.writeFloat(e)}))}readFloatArray(){let t=[],e=this.readInt();if(e>0)for(let i=0;i<e;i++)t.push(this.readFloat());return t}writeDoubleArray(t){t===null?this.writeInt(0):(this.writeInt(t.length),t.forEach(e=>{this.writeDouble(e)}))}readDoubleArray(){let t=[],e=this.readInt();if(e>0)for(let i=0;i<e;i++)t.push(this.readDouble());return t}writeStringArray(t){t===null?this.writeInt(0):(this.writeInt(t.length),t.forEach(e=>{this.writeString(e)}))}readStringArray(){let t=[],e=this.readInt();if(e>0)for(let i=0;i<e;i++)t.push(this.readString());return t}writeCharArray(t){t===null?this.writeInt(0):(this.writeInt(t.length),t.forEach(e=>{this.writeChar(e)}))}readCharArray(){let t=[],e=this.readInt();if(e>0)for(let i=0;i<e;i++)t.push(this.readChar());return t}writePacketArray(t,e){if(t===null)this.writeInt(0);else{let i=gi.getProtocol(e);this.writeInt(t.length),t.forEach(a=>{i.write(this,a)})}}readPacketArray(t){let e=[],i=this.readInt();if(i>0){let a=gi.getProtocol(t);for(let r=0;r<i;r++)e.push(a.read(this))}return e}writeBooleanList(t){this.writeBooleanArray(t)}readBooleanList(){return this.readBooleanArray()}writeByteList(t){this.writeByteArray(t)}readByteList(){return this.readByteArray()}writeShortList(t){this.writeShortArray(t)}readShortList(){return this.readShortArray()}writeIntList(t){this.writeIntArray(t)}readIntList(){return this.readIntArray()}writeLongList(t){this.writeLongArray(t)}readLongList(){return this.readLongArray()}writeFloatList(t){this.writeFloatArray(t)}readFloatList(){return this.readFloatArray()}writeDoubleList(t){this.writeDoubleArray(t)}readDoubleList(){return this.readDoubleArray()}writeStringList(t){this.writeStringArray(t)}readStringList(){return this.readStringArray()}writeCharList(t){this.writeCharArray(t)}readCharList(){return this.readCharArray()}writePacketList(t,e){this.writePacketArray(t,e)}readPacketList(t){return this.readPacketArray(t)}writeBooleanSet(t){t===null?this.writeInt(0):(this.writeInt(t.size),t.forEach(e=>{this.writeBoolean(e)}))}readBooleanSet(){return new Set(this.readBooleanArray())}writeByteSet(t){t===null?this.writeInt(0):(this.writeInt(t.size),t.forEach(e=>{this.writeByte(e)}))}readByteSet(){return new Set(this.readByteArray())}writeShortSet(t){t===null?this.writeInt(0):(this.writeInt(t.size),t.forEach(e=>{this.writeShort(e)}))}readShortSet(){return new Set(this.readShortArray())}writeIntSet(t){t===null?this.writeInt(0):(this.writeInt(t.size),t.forEach(e=>{this.writeInt(e)}))}readIntSet(){return new Set(this.readIntArray())}writeLongSet(t){t===null?this.writeInt(0):(this.writeInt(t.size),t.forEach(e=>{this.writeLong(e)}))}readLongSet(){return new Set(this.readLongArray())}writeFloatSet(t){t===null?this.writeInt(0):(this.writeInt(t.size),t.forEach(e=>{this.writeFloat(e)}))}readFloatSet(){return new Set(this.readFloatArray())}writeDoubleSet(t){t===null?this.writeInt(0):(this.writeInt(t.size),t.forEach(e=>{this.writeDouble(e)}))}readDoubleSet(){return new Set(this.readDoubleArray())}writeStringSet(t){t===null?this.writeInt(0):(this.writeInt(t.size),t.forEach(e=>{this.writeString(e)}))}readStringSet(){return new Set(this.readStringArray())}writeCharSet(t){t===null?this.writeInt(0):(this.writeInt(t.size),t.forEach(e=>{this.writeChar(e)}))}readCharSet(){return new Set(this.readCharArray())}writePacketSet(t,e){if(t===null)this.writeInt(0);else{let i=gi.getProtocol(e);this.writeInt(t.size),t.forEach(a=>{i.write(this,a)})}}readPacketSet(t){return new Set(this.readPacketArray(t))}writeIntIntMap(t){t===null?this.writeInt(0):(this.writeInt(t.size),t.forEach((e,i)=>{this.writeInt(i),this.writeInt(e)}))}readIntIntMap(){let t=new Map,e=this.readInt();if(e>0)for(let i=0;i<e;i++){let a=this.readInt(),r=this.readInt();t.set(a,r)}return t}writeIntLongMap(t){t===null?this.writeInt(0):(this.writeInt(t.size),t.forEach((e,i)=>{this.writeInt(i),this.writeLong(e)}))}readIntLongMap(){let t=new Map,e=this.readInt();if(e>0)for(let i=0;i<e;i++){let a=this.readInt(),r=this.readLong();t.set(a,r)}return t}writeIntStringMap(t){t===null?this.writeInt(0):(this.writeInt(t.size),t.forEach((e,i)=>{this.writeInt(i),this.writeString(e)}))}readIntStringMap(){let t=new Map,e=this.readInt();if(e>0)for(let i=0;i<e;i++){let a=this.readInt(),r=this.readString();t.set(a,r)}return t}writeIntPacketMap(t,e){if(t===null)this.writeInt(0);else{let i=gi.getProtocol(e);this.writeInt(t.size),t.forEach((a,r)=>{this.writeInt(r),i.write(this,a)})}}readIntPacketMap(t){let e=new Map,i=this.readInt();if(i>0){let a=gi.getProtocol(t);for(let r=0;r<i;r++){let s=this.readInt(),o=a.read(this);e.set(s,o)}}return e}writeLongIntMap(t){t===null?this.writeInt(0):(this.writeInt(t.size),t.forEach((e,i)=>{this.writeLong(i),this.writeInt(e)}))}readLongIntMap(){let t=new Map,e=this.readInt();if(e>0)for(let i=0;i<e;i++){let a=this.readLong(),r=this.readInt();t.set(a,r)}return t}writeLongLongMap(t){t===null?this.writeInt(0):(this.writeInt(t.size),t.forEach((e,i)=>{this.writeLong(i),this.writeLong(e)}))}readLongLongMap(){let t=new Map,e=this.readInt();if(e>0)for(let i=0;i<e;i++){let a=this.readLong(),r=this.readLong();t.set(a,r)}return t}writeLongStringMap(t){t===null?this.writeInt(0):(this.writeInt(t.size),t.forEach((e,i)=>{this.writeLong(i),this.writeString(e)}))}readLongStringMap(){let t=new Map,e=this.readInt();if(e>0)for(let i=0;i<e;i++){let a=this.readLong(),r=this.readString();t.set(a,r)}return t}writeLongPacketMap(t,e){if(t===null)this.writeInt(0);else{let i=gi.getProtocol(e);this.writeInt(t.size),t.forEach((a,r)=>{this.writeLong(r),i.write(this,a)})}}readLongPacketMap(t){let e=new Map,i=this.readInt();if(i>0){let a=gi.getProtocol(t);for(let r=0;r<i;r++){let s=this.readLong(),o=a.read(this);e.set(s,o)}}return e}writeStringIntMap(t){t===null?this.writeInt(0):(this.writeInt(t.size),t.forEach((e,i)=>{this.writeString(i),this.writeInt(e)}))}readStringIntMap(){let t=new Map,e=this.readInt();if(e>0)for(let i=0;i<e;i++){let a=this.readString(),r=this.readInt();t.set(a,r)}return t}writeStringLongMap(t){t===null?this.writeInt(0):(this.writeInt(t.size),t.forEach((e,i)=>{this.writeString(i),this.writeLong(e)}))}readStringLongMap(){let t=new Map,e=this.readInt();if(e>0)for(let i=0;i<e;i++){let a=this.readString(),r=this.readLong();t.set(a,r)}return t}writeStringStringMap(t){t===null?this.writeInt(0):(this.writeInt(t.size),t.forEach((e,i)=>{this.writeString(i),this.writeString(e)}))}readStringStringMap(){let t=new Map,e=this.readInt();if(e>0)for(let i=0;i<e;i++){let a=this.readString(),r=this.readString();t.set(a,r)}return t}writeStringPacketMap(t,e){if(t===null)this.writeInt(0);else{let i=gi.getProtocol(e);this.writeInt(t.size),t.forEach((a,r)=>{this.writeString(r),i.write(this,a)})}}readStringPacketMap(t){let e=new Map,i=this.readInt();if(i>0){let a=gi.getProtocol(t);for(let r=0;r<i;r++){let s=this.readString(),o=a.read(this);e.set(s,o)}}return e}},qE=KE;var hi=class hi{constructor(){this.m_iConnectTimes=0;this.m_iMaxTimes=10;this.m_iHeartTime=6e4;this.moveIndex=0;this._isMatching=!1;this.isFirst=!0;this.m_socket=new Laya.Socket,this.m_socket.on(Laya.Event.OPEN,this,this.onSocketOpen),this.m_socket.on(Laya.Event.CLOSE,this,this.onSocketClose),this.m_socket.on(Laya.Event.MESSAGE,this,this.onMessageReveived),this.m_socket.on(Laya.Event.ERROR,this,this.onConnectError)}static get instance(){return hi._instance==null&&(hi._instance=new hi),hi._instance}get isMatching(){return this._isMatching}set isMatching(t){this._isMatching=t,t||(this.m_socket.close(),this.isConnect=!1)}initSocket(){this.isMatching=!0,this.isFirst=!0;var t=B.instance.roomDto.connectAddr;hi.m_strHttpHost=t,this.connect()}onSocketOpen(){this.isConnect=!0,this.m_iConnectTimes=0,$t.log("websocket----websocket connected",1),this.onLogin()}onLogin(){if(this.isFirst){let e=new Ch;e.roomId=B.instance.roomDto.roomId,e.loginToken=localStorage.getItem("TOX-COOKIE"+F.instance.walletAddress),e.pid=b.instance.playerDto.pid;var t=B.instance.roomWatcher;e.watch=t?1:0,this.sendData(e)}else{let e=new Ah;e.token=this.socketToken,this.sendData(e)}}onSocketClose(t){$t.log("websocket----closed",1),this.isMatching&&(this.isOtherLogin||(this.isConnect=!1,console.log("websocket----closed m_iConnectTimes:"+this.m_iConnectTimes+", m_iMaxTimes: "+this.m_iMaxTimes),this.m_iConnectTimes<=this.m_iMaxTimes?Laya.timer.once(1500,this,this.onReconnect):de.instance.hideLoading()))}onReconnect(){hi.instance.reconnect(),hi.instance.m_iConnectTimes++}onConnectError(t){$t.log("websocket----onConnectError e:"+t,1),this.isMatching&&(this.isOtherLogin||(this.isConnect=!1,this.m_iConnectTimes<=this.m_iMaxTimes?Laya.timer.once(1500,this,this.onReconnect):de.instance.hideLoading()))}connect(){$t.log("websocket----connect: "+hi.m_strHttpHost,1),this.isMatching&&(this.isConnect||(Laya.timer.once(1e4,this,this.showTip),this.m_socket.connectByUrl(hi.m_strHttpHost),$t.log("websocket----connect websocket",1)))}clearShowTip(){Laya.timer.clear(this,this.showTip)}showTip(){Le.netError()}reconnect(){$t.log("websocket----reconnect: "+hi.m_strHttpHost,1),this.isMatching&&(this.isConnect||(this.m_socket.connectByUrl(hi.m_strHttpHost),$t.log("websocket----reconnect websocket",1)))}onSendMessage(){}sendData(t){if(this.isMatching)if(this.isConnect){let e=new qE;e.setWriteOffset(4),gi.write(e,t),e.writeBoolean(!1);let i=e.writeOffset;e.setWriteOffset(0),e.writeRawInt(i-4),e.setWriteOffset(i),this.m_socket.send(e.buffer),console.log(Le.GetLogTime+" websocket ------>>>>>>>> send message PROTOCOL_ID:"+t.protocolId()+"，内容："+JSON.stringify(t))}else $t.log("socket send error： "+JSON.stringify(t))}async onMessageReveived(t){let e=t,i=new qE;i.writeBytes(e),i.setReadOffset(4);let a=gi.read(i),r=a.protocolId();console.log(Le.GetLogTime+" websocket ------<<<<<<<< recv PROTOCOL_ID: "+r+"，内容："+JSON.stringify(a));let s=a.errorCode;if(s&&s>0){console.warn("errorCode "+s+", errorMessage： "+Ee.instance.get(s)),s==24||s==25?(this.isMatching=!1,Ae.instance.close(),hi.instance.clearShowTip(),oe.intance.currSceneName!=Y.M_SCENE_MATCH&&(oe.intance.setCurrentScene(Y.M_SCENE_MAIN),Le.commTipWithYes(Ee.instance.get(s)))):s==69&&Ee.instance.showErrorWord(s);return}switch(g.intance.event("msg_"+r,[e]),r){case Sh.PROTOCOL_ID:console.log("收到了登录返回"),this.isFirst=!1;let l=a;v.needHeart=!1,B.instance.matchDto=l.matchDto,this.socketToken=l.socketToken,oe.intance.setCurrentScene(Y.M_SCENE_MATCH),this.clearShowTip();break;case kh.PROTOCOL_ID:console.log("断线重连 返回");break;case Wh.PROTOCOL_ID:console.log("收到比赛开始数据");let c=a;A.intance.disposeView(y.MatchReadyView),B.instance.stopAll=!1;break;case Rh.PROTOCOL_ID:console.log("收到移动数据");let u=a;this.moveIndex++,k.instance.onRevMovePush(u,this.moveIndex);break;case Yh.PROTOCOL_ID:var o=a.moveList.reverse();this.moveIndex++,o.forEach(ae=>{k.instance.onRevMovePush(ae,this.moveIndex)});break;case qh.PROTOCOL_ID:let d=a;k.instance.onRevTargetMovePush(d);break;case Oh.PROTOCOL_ID:console.log("收到伤害数据");let L=a;k.instance.onRevAttackPush(L);break;case Gh.PROTOCOL_ID:console.log("收到动画数据");let x=a;k.instance.onRevAnimationPush(x);break;case jh.PROTOCOL_ID:console.log("收到卡牌数据");let w=a;k.instance.onRevCardResponse(w);break;case Jh.PROTOCOL_ID:console.log("收到大招卡牌检测数据");let I=a;k.instance.onRevCardResponse(I);break;case $h.PROTOCOL_ID:console.log("收到buff数据");let M=a;k.instance.onRevUsePush(M);break;case Mh.PROTOCOL_ID:console.log("收到玩家加入或离开数据");let H=a;k.instance.addPlayer(H);break;case Vh.PROTOCOL_ID:console.log("收到第一滴血数据");let V=a;g.intance.event(f.EVENT_FirstBlood,[V]);break;case Fh.PROTOCOL_ID:console.log("收到多杀数据");let q=a;g.intance.event(f.EVENT_MutiKill,[q]);break;case Ph.PROTOCOL_ID:console.log("收到比赛结束");let X=a;B.instance.matchDto&&B.instance.onGoMatchEndRank(X);break;case Zh.PROTOCOL_ID:console.log("收到了怪物刷新数据返回");let Z=a;k.instance.onRevReLifePush(Z);break;case Uh.PROTOCOL_ID:console.log("收到了恢复数据返回");let Q=a;k.instance.onRevRestorePush(Q.matchDto);break;case hl.PROTOCOL_ID:console.log("收到了错误信息返回");let ee=new hl;Object.assign(ee,a),console.log("errorMessage： "+ee.errorMessage),Ee.instance.showErrByString(ee.errorMessage);break;case Dh.PROTOCOL_ID:this.isOtherLogin=!0,Laya.timer.clearAll(this),Le.otherLogin(),console.log("websocket----------------------------otherLogin");break;default:break}}sendHeart(){this.m_socket.connected&&this.sendData(new Th)}};hi.m_strHttpHost=getWSServer(),hi.CMD_99999=99999;var lt=hi;var qe=class qe{static get IsSetRelease(){return qe._IsSetRelease}static get IsSetGuid(){return qe._IsSetGuid}static initParms(){if(Laya.Browser.window.location){let e=Laya.Browser.window.location.href,i=this.getURLParameters(e);if(qe.m_obj=i,console.log("1initgame-->urldata:",qe.m_obj),qe.m_obj.server&&qe.m_obj.server!=""&&(v.httpRoot=qe.m_obj.server),qe.m_obj.socket&&qe.m_obj.socket!=""){var t=qe.m_obj.socket;lt.m_strHttpHost=t+"/websocket"}if(qe.m_obj.address&&qe.m_obj.address!=""&&(F.instance.walletAddress=qe.m_obj.address),qe.m_obj.from&&qe.m_obj.from=="into"&&(z.isInto=!0),qe.m_obj.isFull&&qe.m_obj.isFull=="1"&&(z.isFull=!0),qe.m_obj.justFull&&qe.m_obj.justFull=="1"&&(z.justFull=!0),qe.m_obj.white&&qe.m_obj.white=="1"&&(z.isWhite=!0),qe.m_obj.debug&&qe.m_obj.debug!="0"&&(z.Debug=parseInt(qe.m_obj.debug)),qe.m_obj.res&&qe.m_obj.res!="0"&&(z.Res=parseInt(qe.m_obj.res)),qe.m_obj.bookingId&&qe.m_obj.bookingId!="0"&&(z.bookingId=parseInt(qe.m_obj.bookingId),qe.m_obj.teamId&&qe.m_obj.teamId!="0"&&(z.teamId=parseInt(qe.m_obj.teamId))),qe.m_obj.lang&&qe.m_obj.lang!=""){let a=parseInt(qe.m_obj.lang);a<1&&(a=1),z.ignoreLang=!0,b.instance.m_strLanguage=a}}}static getURLParameters(t){let e={};return t.replace(/[?&]+([^=&]+)=([^&]*)/gi,(i,a,r)=>e[a]=decodeURIComponent(r)),e}static cheakStr(t){let e=new RegExp("[A-Za-z0-9_-\\s]","g"),i=t.match(e);return!!(i&&i.length==t.length)}static isNumber(t){return/^(?!0\d)\d*\.?\d*$/.test(t)}static roundToTwoDecimals(t){return t%1===0?t.toString():Number(t.toFixed(2)).toString()}static filterObjectsByState(t,e,i=void 0){return i?t.filter(a=>a.state===e&&i.indexOf(a.pk)<0&&a.newFightFlag!==1):t.filter(a=>a.state===e&&a.newFightFlag!==1)}static filterPVEExpHerosByState(t,e,i=void 0){return i?t.filter(a=>a.state===e&&i.indexOf(a.pk)<0&&a.newFightFlag==1):t.filter(a=>a.state===e&&a.newFightFlag==1)}static filterObjectsByNewFightFlag(t){return t.filter(e=>e.newFightFlag!==1)}static getArenaByTicketId(t){let e=_.intance.m_dicArenaDic.values;for(let i of e)if(Array.isArray(i.item)&&i.item.length>0&&i.item[0]===t)return i.name}static processItemsArray(t,e=!0){let i=_.intance.getGeneralValueById(20),a={},r={};var s=[];t.forEach(c=>{i.indexOf(c.id)>-1?r[c.id]?r[c.id].count+=c.count:r[c.id]=c:(a[c.id]=c,s.push(c))}),e&&i.forEach(c=>{r[c]||(r[c]={type:1,id:c,count:0})});let o=Object.values(r),l=Object.values(a);return o=o.sort((c,u)=>i.indexOf(c.id)-i.indexOf(u.id)),[o,l,s]}static sumItemCount(t){let e=new Map;return t.forEach(a=>{a.reward.forEach(r=>{let{type:s,id:o,count:l}=r;e.has(o)?e.set(o,{type:s,id:o,count:e.get(o).count+l}):e.set(o,{type:s,id:o,count:l})})}),Array.from(e.values())}static addIndexToObjects(t){return t.forEach((e,i)=>{e.index=i}),t}static findFirstTypeAndNotGold(t){for(let e=0;e<t.length;e++)if(t[e].id>=3001&&t[e].id<=3021&&t[e].id!==3005)return t[e]}static getTitleByGoodsId(t,e){for(let i of t)if(i.goods===e)return i.title;return null}static getShopByGoodsId(t,e){for(let i of t)if(i.goods===e)return i;return null}static getCurrencyIdByName(t){let e=ge.TYPE_TOX;switch(t){case"TOX":e=ge.TYPE_TOX;break;case"ETH":e=ge.TYPE_ETH;break;case"BTC":e=ge.TYPE_BTC;break;case"USDT":e=ge.TYPE_USDT;break;case"BTOX":e=ge.TYPE_BTOX;break;case"GALA":e=ge.TYPE_GALA;break;case"BNRY":e=ge.TYPE_BNRY;break;case"KLAY":e=ge.TYPE_KLAY;break;case"BNB":e=ge.TYPE_BNB;break;case"GGG":e=ge.TYPE_GGG;break}return e}static formatNumber(t,e=7){let i=t.toString(),a=i.indexOf(".");return a!==-1&&i.length-a>e?(i=i.slice(0,a+e),parseFloat(i)):t}static truncateToTwoDecimalPlaces(t){let e=t.toString(),i=e.indexOf(".");if(i===-1)return t;let a=e.substring(0,i+5);return parseFloat(a)}static getKeyByValue(t,e){return Object.keys(t).find(i=>t[i]===e)}static powerOf10(t,e){return t*Math.pow(10,e)}static isLeapYear(t){return t%4==0&&t%100!=0||t%400==0}static getDaysInMonth(t,e){return e===2?this.isLeapYear(t)?29:28:[4,6,9,11].includes(e)?30:31}static shortenString(t,e,i){return t.length<=e+i?t:t.substr(0,e)+"..."+t.substr(-i)}static multiplyBigDecimals(t,e){let a=Math.pow(10,1e4),r=parseFloat(String(t))*parseFloat(String(e));return Math.round(r*a)/a}static arraysEqual(t,e){return t.length===e.length&&t.every((i,a)=>i===e[a])}static categorizeArrays(t,e){let i=[];for(let a of e){let r=a[0],s=a[1],o=t.find(c=>c[0]===r),l=o?o[1]:0;i.push([r,l,s])}return i}static setMap(t,e){if(t.has(e[0])){let i=t.get(e[0]);i+=e[1],t.set(e[0],i)}else t.set(e[0],e[1]);return console.log(t),t}static getfrom(){return qe.m_obj.from}};qe._IsSetRelease=!1,qe._IsSetGuid=!1;var te=qe;var ZS={gasPriceOracle:{address:"0x420000000000000000000000000000000000000F"},l1Block:{address:"0x4200000000000000000000000000000000000015"},l2CrossDomainMessenger:{address:"0x4200000000000000000000000000000000000007"},l2Erc721Bridge:{address:"0x4200000000000000000000000000000000000014"},l2StandardBridge:{address:"0x4200000000000000000000000000000000000010"},l2ToL1MessagePasser:{address:"0x4200000000000000000000000000000000000016"}};oi();var eD={block:TC({format(n){return{transactions:n.transactions?.map(e=>{if(typeof e=="string")return e;let i=Er(e);return i.typeHex==="0x7e"&&(i.isSystemTx=e.isSystemTx,i.mint=e.mint?Ut(e.mint):void 0,i.sourceHash=e.sourceHash,i.type="deposit"),i}),stateRoot:n.stateRoot}}}),transaction:wC({format(n){let t={};return n.type==="0x7e"&&(t.isSystemTx=n.isSystemTx,t.mint=n.mint?Ut(n.mint):void 0,t.sourceHash=n.sourceHash,t.type="deposit"),t}}),transactionReceipt:B1({format(n){return{l1GasPrice:n.l1GasPrice?Ut(n.l1GasPrice):null,l1GasUsed:n.l1GasUsed?Ut(n.l1GasUsed):null,l1Fee:n.l1Fee?Ut(n.l1Fee):null,l1FeeScalar:n.l1FeeScalar?Number(n.l1FeeScalar):null}}})};ga();aa();Pi();Fe();function g2(n,t){return _2(n)?L2(n):G1(n,t)}var tD={transaction:g2};function L2(n){v2(n);let{sourceHash:t,data:e,from:i,gas:a,isSystemTx:r,mint:s,to:o,value:l}=n,c=[t,i,o??"0x",s?De(s):"0x",l?De(l):"0x",a?De(a):"0x",r?"0x1":"0x",e??"0x"];return li(["0x7e",la(c)])}function _2(n){return n.type==="deposit"||typeof n.sourceHash<"u"}function v2(n){let{from:t,to:e}=n;if(t&&!ft(t))throw new Lt({address:t});if(e&&!ft(e))throw new Lt({address:e})}var kr={contracts:ZS,formatters:eD,serializers:tD};var Ki=kt({id:56,name:"BNB Smart Chain",nativeCurrency:{decimals:18,name:"BNB",symbol:"BNB"},rpcUrls:{default:{http:["https://rpc.ankr.com/bsc"]}},blockExplorers:{default:{name:"BscScan",url:"https://bscscan.com",apiUrl:"https://api.bscscan.com/api"}},contracts:{multicall3:{address:"0xca11bde05977b3631167028862be2a173976ca11",blockCreated:15921452}}});var Ra=kt({id:97,name:"Binance Smart Chain Testnet",nativeCurrency:{decimals:18,name:"BNB",symbol:"tBNB"},rpcUrls:{default:{http:["https://data-seed-prebsc-1-s1.bnbchain.org:8545"]}},blockExplorers:{default:{name:"BscScan",url:"https://testnet.bscscan.com",apiUrl:"https://api-testnet.bscscan.com/api"}},contracts:{multicall3:{address:"0xca11bde05977b3631167028862be2a173976ca11",blockCreated:17422483}},testnet:!0});var id=kt({id:8217,name:"Klaytn",nativeCurrency:{decimals:18,name:"Klaytn",symbol:"KLAY"},rpcUrls:{default:{http:["https://public-en-cypress.klaytn.net"]}},blockExplorers:{default:{name:"KlaytnScope",url:"https://scope.klaytn.com"}},contracts:{multicall3:{address:"0xcA11bde05977b3631167028862bE2a173976CA11",blockCreated:96002415}}});var ad=kt({id:1890,name:"LightLink Phoenix Mainnet",network:"lightlink-phoenix",nativeCurrency:{decimals:18,name:"Ether",symbol:"ETH"},rpcUrls:{default:{http:["https://replicator.phoenix.lightlink.io/rpc/v1"]}},blockExplorers:{default:{name:"LightLink Phoenix Explorer",url:"https://phoenix.lightlink.io"}},testnet:!1});var qn=kt({id:1,name:"Ethereum",nativeCurrency:{name:"Ether",symbol:"ETH",decimals:18},rpcUrls:{default:{http:["https://cloudflare-eth.com"]}},blockExplorers:{default:{name:"Etherscan",url:"https://etherscan.io",apiUrl:"https://api.etherscan.io/api"}},contracts:{ensRegistry:{address:"0x00000000000C2E074eC69A0dFb2997BA6C7d2e1e"},ensUniversalResolver:{address:"0xce01f8eee7E479C928F8919abD53E553a36CeF67",blockCreated:19258213},multicall3:{address:"0xca11bde05977b3631167028862be2a173976ca11",blockCreated:14353601}}});var Wn=kt({id:5e3,name:"Mantle",nativeCurrency:{decimals:18,name:"MNT",symbol:"MNT"},rpcUrls:{default:{http:["https://rpc.mantle.xyz"]}},blockExplorers:{default:{name:"Mantle Explorer",url:"https://mantlescan.xyz/",apiUrl:"https://api.mantlescan.xyz/api"}},contracts:{multicall3:{address:"0xcA11bde05977b3631167028862bE2a173976CA11",blockCreated:304717}}});var rn=kt({id:5003,name:"Mantle Sepolia Testnet",nativeCurrency:{decimals:18,name:"MNT",symbol:"MNT"},rpcUrls:{default:{http:["https://rpc.sepolia.mantle.xyz"]}},blockExplorers:{default:{name:"Mantle Testnet Explorer",url:"https://explorer.sepolia.mantle.xyz/",apiUrl:"https://explorer.sepolia.mantle.xyz/api"}},contracts:{multicall3:{address:"0xcA11bde05977b3631167028862bE2a173976CA11",blockCreated:4584012}},testnet:!0});var nd=56,qi=kt({id:204,name:"opBNB",nativeCurrency:{name:"BNB",symbol:"BNB",decimals:18},rpcUrls:{default:{http:["https://opbnb-mainnet-rpc.bnbchain.org"]}},blockExplorers:{default:{name:"opBNB (BSCScan)",url:"https://opbnb.bscscan.com",apiUrl:"https://api-opbnb.bscscan.com/api"}},contracts:{...kr.contracts,multicall3:{address:"0xcA11bde05977b3631167028862bE2a173976CA11",blockCreated:512881},l2OutputOracle:{[nd]:{address:"0x153CAB79f4767E2ff862C94aa49573294B13D169"}},portal:{[nd]:{address:"0x1876EA7702C0ad0C6A2ae6036DE7733edfBca519"}},l1StandardBridge:{[nd]:{address:"0xF05F0e4362859c3331Cb9395CBC201E3Fa6757Ea"}}},sourceId:nd});var rd=97,Wi=kt({id:5611,name:"opBNB Testnet",nativeCurrency:{decimals:18,name:"tBNB",symbol:"tBNB"},rpcUrls:{default:{http:["https://opbnb-testnet-rpc.bnbchain.org"]}},blockExplorers:{default:{name:"opbnbscan",url:"https://testnet.opbnbscan.com"}},contracts:{...kr.contracts,multicall3:{address:"0xcA11bde05977b3631167028862bE2a173976CA11",blockCreated:3705108},l2OutputOracle:{[rd]:{address:"0xFf2394Bb843012562f4349C6632a0EcB92fC8810"}},portal:{[rd]:{address:"0x4386C8ABf2009aC0c263462Da568DD9d46e52a31"}},l1StandardBridge:{[rd]:{address:"0x677311Fd2cCc511Bbc0f581E8d9a07B033D5E840"}}},testnet:!0,sourceId:rd});var gc=1,sd=kt({...kr,id:10,name:"OP Mainnet",nativeCurrency:{name:"Ether",symbol:"ETH",decimals:18},rpcUrls:{default:{http:["https://mainnet.optimism.io"]}},blockExplorers:{default:{name:"Optimism Explorer",url:"https://optimistic.etherscan.io",apiUrl:"https://api-optimistic.etherscan.io/api"}},contracts:{...kr.contracts,disputeGameFactory:{[gc]:{address:"0xe5965Ab5962eDc7477C8520243A95517CD252fA9"}},l2OutputOracle:{[gc]:{address:"0xdfe97868233d1aa22e815a266982f2cf17685a27"}},multicall3:{address:"0xca11bde05977b3631167028862be2a173976ca11",blockCreated:4286263},portal:{[gc]:{address:"0xbEb5Fc579115071764c7423A4f12eDde41f106Ed"}},l1StandardBridge:{[gc]:{address:"0x99C9fc46f92E8a1c0deC1b1747d010903E884bE1"}}},sourceId:gc});var uo=kt({id:11155111,name:"Sepolia",nativeCurrency:{name:"Sepolia Ether",symbol:"ETH",decimals:18},rpcUrls:{default:{http:["https://sepolia.drpc.org"]}},blockExplorers:{default:{name:"Etherscan",url:"https://sepolia.etherscan.io",apiUrl:"https://api-sepolia.etherscan.io/api"}},contracts:{multicall3:{address:"0xca11bde05977b3631167028862be2a173976ca11",blockCreated:751532},ensRegistry:{address:"0x00000000000C2E074eC69A0dFb2997BA6C7d2e1e"},ensUniversalResolver:{address:"0xc8Af999e38273D658BE1b921b88A9Ddf005769cC",blockCreated:5317080}},testnet:!0});var Yn=class n{constructor(){this.assets_contract=null;this.startRecharge=!1}static get instance(){return n._instance||(n._instance=new n),n._instance}async init(){typeof window.ethereum>"u"||(g.intance.on(f.EVENT_RECHARGE_GET,this,this.rechargeEnd),this.assets_contract=new window.web3.eth.Contract(J.WITHDRAW_AND_RECHARGE_ABI,J.WITHDRAW_AND_RECHARGE_ADDRESS))}async depositWallet(t,e){if(de.instance.showLoading(!0),!await F.instance.allowanceAddressByTokenAddress(J.WITHDRAW_AND_RECHARGE_ADDRESS,t)){de.instance.hideLoading(),E.instance.notice(m.instance.getLanguage(15));return}return e=window.web3.utils.toWei(e+""),await this.assets_contract.methods.recharge(t.toLowerCase(),e).send({from:F.instance.walletAddress},(a,r)=>{if(a)return de.instance.hideLoading(),!1}),!0}async withdrawToken(t){return de.instance.showLoading(!0),await this.assets_contract.methods.withdrawToken(t.tokenAddress,t.to,t.amount,t.timestamp,t.hash,t.r,t.s,t.v).send({from:F.instance.walletAddress},(e,i)=>{if(e)return de.instance.hideLoading(),!1}),!0}async updateAssetsBalance(){qa.instance.walletDic==null&&(qa.instance.walletDic=new le),g.intance.event(ti.UPDATE_LOCAL_WALLET_LIST_EVENT)}updateCwt(t){let e=qa.instance.walletDic.get(_i.ASSETS_TOX);e||(e=new Ih,e.itemId=_i.ASSETS_TOX,qa.instance.walletDic.set(_i.ASSETS_TOX,e)),e.ethValue=t}async rechargeToken(t,e=null,i){try{if(e.token&&e.token!==J.ADDRESS0&&!await F.instance.newAllowanceAddress(i,e.token))return de.instance.hideLoading(),E.instance.notice(m.instance.getLanguage(15)),!1;let a=pi(t+"",e.tokenDecimals),r=J.RECHANGE_ABI_NEW,s="depositToken",o;!e.token||e.token==J.ADDRESS0?o=await F.instance.walletClient.writeContract({account:F.instance.walletAddress,address:i,abi:r,functionName:"depositETH",value:a,args:[]}):o=await F.instance.walletClient.writeContract({account:F.instance.walletAddress,address:i,abi:r,functionName:s,args:[e.token,a]}),this.startRecharge=!0,Laya.timer.once(6e4,this,this.clearRecharge);let l,c=!1;if(l=await F.instance.publicClient.waitForTransactionReceipt({hash:o,pollingInterval:1e3}),l&&l.status=="success"||c){if(!this.startRecharge)return;Laya.timer.clear(this,this.clearRecharge),console.log(`Tx successful with hash: ${o}`);let u=await F.instance.walletClient.getChainId(),p=[u,o];return this.getReward(u,o),Laya.timer.loop(2e3,this,this.getReward,p),Laya.timer.once(6e4,this,this.clearRecharge),o}else{de.instance.hideLoading(),Le.TransactionErrorTip();return}}catch(a){de.instance.hideLoading(),console.log(a),a instanceof Error?a.message.includes("does not match the target chain for the transaction")?g.intance.event(f.CHANGE_ASSET_CHAIN):console.log("Error message does not contain the specified character."):console.log("An error occurred, but it is not an instance of Error.")}}async getReward(t,e){let i=await v.requestPost("wxgame/sys/payCallPack",{chainId:t,hashId:e});if(i&&i.coin){Laya.timer.clear(this,this.clearRecharge);let r=i.coin[0];if(!r)return;g.intance.event(ti.UPDATE_LOCAL_WALLET_LIST_EVENT);var a=new xt;a.id=r[0],a.count=r[1],de.instance.hideLoading(),A.intance.openModule(y.RewardGetDialog,[a]),this.rechargeEnd()}}rechargeEnd(){b.instance.rechargeEnd=!1,Laya.timer.clear(this,this.getReward)}clearRecharge(){this.startRecharge=!1,de.instance.hideLoading(),E.instance.notice(m.instance.getLanguage(1350)),this.rechargeEnd()}parseGwei(t){return t*1e9}async getAmountsOut(t,e,i,a=void 0){try{let r=18,s=18;a&&(r=a.usdtDecimals,s=a.tokenDecimals);let o=te.powerOf10(i,r),l;if(t=="BNB"||t=="GALA"?l=await F.instance.publicClient.readContract({address:e,abi:J.PUZZLE_ABI,functionName:"getAmountsOut",args:[o]}):l=await F.instance.publicClient.readContract({address:e,abi:J.PUZZLE_ABI,functionName:"getTokenAmountsOut",args:[o,a.token]}),l){let c=Number(l)/Math.pow(10,s);return console.log(c),c}}catch(r){if(r instanceof Error){let s=r.message;return 0}}return 0}async withdrawAirToken(t,e=null,i,a,r,s,o,l){try{let u;l==qn.id||l==uo.id?u=J.PUZZLE_ABI_ETH:u=J.PUZZLE_ABI;var c=await F.instance.walletClient.writeContract({account:F.instance.walletAddress,address:t,abi:u,functionName:"withdrawToken",args:[e,i,a,r,s,o]});return c}catch(u){de.instance.hideLoading(),console.log(u)}}};var ld=AD(iD());var Pa=class{static getInviteUrl(){return window.location.origin+"?invite="+this.encode(F.instance.walletAddress)}static encode(t){for(var e="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ",i=e.length,a=e.split(""),r="",s,o,l,c,u=0;u<t.length;u++)s=t.charCodeAt(u),o=s%i,s=(s-o)/i,l=s%i,s=(s-l)/i,c=s%i,r+=a[c]+a[l]+a[o];return window.btoa(r)}static decode(t){t=window.atob(t);var e="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ",i=e.length,a,r,s,o,l=0,c;c=new Array(Math.floor(t.length/3)),a=c.length;for(var u=0;u<a;u++)r=e.indexOf(t.charAt(l)),l++,s=e.indexOf(t.charAt(l)),l++,o=e.indexOf(t.charAt(l)),l++,c[u]=r*i*i+s*i+o;return a=decodeCharCode(c.join(",")),a}static getQueryString(t){var e=new RegExp("(^|&)"+t+"=([^&]*)(&|$)"),i=window.location.search.substr(1).match(e);return i!=null?i[2]:""}static getInviteWalletAddress(){let t=this.getQueryString("invite");return t&&(t=this.decode(t)),t}static toWei(t,e){let i=t*10**parseInt(e);return window.web3.utils.toBN("0x"+i.toString(16)).toString()}static fromWei(t,e,i=0){if(!t)return 0;let a=t.length-e+i;if(a<=0)return 0;let r=t.toString().slice(0,a);if(i){let s=r.length-i;if(s<=0){let o="0.";for(let l=0;l<Math.abs(s);l++)o+="0";r=o+r}else r=r.slice(0,r.length-i)+"."+r.slice(r.length-i)}return r}static deepClone(t){let e=new le;for(let i in t)typeof t[i]=="function"?e[i]=t[i]:e[i]=JSON.parse(JSON.stringify(t[i]));return e}};xp();Fe();function Lc(){return De(tn.utils.randomPrivateKey())}var od=($=>($[$.MAINNET=1]="MAINNET",$[$.TESTNET_RINKEBY=4]="TESTNET_RINKEBY",$[$.ARBITRUM=42161]="ARBITRUM",$[$.ARBITRUM_TESTNET=421611]="ARBITRUM_TESTNET",$[$.AVALANCHE=43114]="AVALANCHE",$[$.AVALANCHE_TESTNET=43113]="AVALANCHE_TESTNET",$[$.POLYGON=137]="POLYGON",$[$.POLYGON_TESTNET=80001]="POLYGON_TESTNET",$[$.FANTOM=250]="FANTOM",$[$.FANTOM_TESTNET=4002]="FANTOM_TESTNET",$[$.OPTIMISM=10]="OPTIMISM",$[$.OPTIMISM_TESTNET=69]="OPTIMISM_TESTNET",$[$.BOBA=288]="BOBA",$[$.BOBA_TESTNET=28]="BOBA_TESTNET",$[$.ESC=20]="ESC",$[$.HECO=128]="HECO",$[$.BSC=56]="BSC",$[$.BSC_TESTNET=97]="BSC_TESTNET",$[$.MATCH=9001]="MATCH",$[$.MATCH_TESTNET=9e3]="MATCH_TESTNET",$[$.CC=1331]="CC",$[$.SEPOLIA=11155111]="SEPOLIA",$[$.Klaytn=8217]="Klaytn",$[$.Lightlink=1890]="Lightlink",$[$.OpBNB=qi.id]="OpBNB",$[$.opBNBTestnet=5611]="opBNBTestnet",$[$.Mantle=Wn.id]="Mantle",$[$.MantleSepoliaTestnet=rn.id]="MantleSepoliaTestnet",$))(od||{}),zn={id:9001,name:"MATCH",network:"MATCH",iconUrl:"",iconBackground:"#fff",nativeCurrency:{decimals:18,name:"MATCH",symbol:"MATCH"},rpcUrls:{default:{http:["https://rpc-match.phantomarena.co/"]},public:{http:["https://rpc-match.phantomarena.co/"]}},blockExplorers:{default:{name:"matchscan",url:"https://lisbon.matchscan.io"},etherscan:{name:"matchscan",url:"https://lisbon.matchscan.io"}},testnet:!1};var F=class n{constructor(){this.tokenContract=null;this.hero_contract=null}static get instance(){return n._instance||(n._instance=new n),n._instance}async init(){if(typeof window.ethereum>"u"||z.Debug==2){E.instance.notice(m.instance.getLanguage(130));return}He.instance.sendCustumEvent(10),this.walletClient=so({transport:Js(window.ethereum)});var t;if(z.Debug<2){console.log("开始获得链id ===============》");var e=await n.instance.walletClient.getChainId();t=this.getChain(e)}t||(t=Ki),this.publicClient=ml({chain:t,transport:ll()}),this.walletClient=so({chain:t,transport:Js(window.ethereum)});let i=await n.instance.walletClient.getChainId();console.log("链id===============》",i),await v0(),He.instance.sendCustumEvent(12),this.registerProxy(),He.instance.sendCustumEvent(17)}async registerProxy(){zr.instance.init()}async getWalletAddress(){if(this.walletAddress)return this.walletAddress;let[t]=await this.walletClient.requestAddresses();return console.log("钱包地址===============》",t),t;if(await v0(),Gt.type==Gt.TYPE_TRUST)try{console.log("initWeb3 -3");let e=await Gt.trustProvider.request({method:"eth_requestAccounts"});return console.log("initWeb3 -4"),console.log(e),e[0]}catch(e){console.log("initWeb3 -5"+e),e.code===4001&&console.error("User denied connection.")}else if(Gt.type==Gt.TYPE_WEB3)return(await window.ethereum.request({method:"eth_requestAccounts"}))[0];return null}async dappLogin(){console.log("dappLogin this.walletAddress: "+this.walletAddress),He.instance.sendCustumEvent(13),this.walletAddress=await this.getWalletAddress(),He.instance.sendCustumEvent(14),console.log("login to server",1),await this.signAndLogin(),console.log("login success",1)}getChainId(){let t="";return typeof window.ethereum>"u"&&(t="0x38"),(window.ethereum.chainId+"").indexOf("0x")==-1?t="0x"+window.ethereum.chainId.toString(16):t=window.ethereum.chainId,t!=="0x38"&&t!=="0x61"&&E.instance.notice(m.instance.getLanguage(18)),t}async signAndLogin(t=!1){console.log("signAndLogin mustSign: "+t);var e=!0;let i=new Date().getTime(),a="",r="",s="",o="";if(z.Debug!=0)e=!1;else if(!t&&localStorage.getItem("TOX-COOKIE"+this.walletAddress)&&z.Debug==0){let d=localStorage.getItem("TOX-COOKIE"+n.instance.walletAddress),L=localStorage.getItem("TOX-COOKIE-CODE"+n.instance.walletAddress);L=Pa.decode(L);let x=L.split("&");i=parseFloat(x[0]),a=x[1],r=x[2],s=x[3],o=x[4],d&&i&&a&&r&&s&&o&&(e=!1),console.log("needSign: "+e)}if(e){console.log("111");var l=Lc().substring(0,32);a=De(l,{size:32}),console.log("222"),i=new Date().getTime();let L=this.walletAddress+a+i,x=new ld.default("SHA-256","TEXT",{encoding:"UTF8"});x.update(L);let w=x.getHash("HEX");console.log("进入签名",1);let I=await this.walletClient.signMessage({account:this.walletAddress,message:w});console.log("签名结束",1);let M=I.substring(2);r="0x"+M.substring(0,64),s="0x"+M.substring(64,128),o="0x"+M.substring(128,130)}let c={debug:z.Debug,address:this.walletAddress,time:i,randomHex:a,r,s,v:o};He.instance.sendCustumEvent(15);let u=await v.requestPost("wxgame/player/login",c,!1,!1);if(u){if(console.log("服务器登录成功"),u.status==1){Le.alertNoAll(Ee.instance.get(2));return}He.instance.sendCustumEvent(16),localStorage.setItem("TOX-COOKIE"+n.instance.walletAddress,u.loginToken);var p=Pa.encode(i+"&"+a+"&"+r+"&"+s+"&"+o);localStorage.setItem("TOX-COOKIE-CODE"+n.instance.walletAddress,p)}else A.intance.openModule(y.NoServerView);g.intance.event(f.EVENT_LOGIN_GAME_END,u)}async main(){let t=ml({chain:qn,transport:ll()}),e=so({chain:qn,transport:Js(window.ethereum)}),i=await t.getBalance({address:"0x55d398326f99059fF775485246999027B3197955"});console.log("balance:"+i);let[a]=await e.requestAddresses();console.log("address:"+a);let r=await e.signMessage({account:a,message:"Hello world!"});console.log("address: "+a),console.log("message: Hello world!"),console.log("signature: "+r);let s=await t.verifyMessage({address:a,message:"Hello world!",signature:r});console.log("valid: "+s);let l=await(await fetch("http://localhost:3000/api/login",{method:"POST",body:JSON.stringify({address:e.account.address,signature:r})})).json();console.log("data: "+l)}async refreshToken(){let t,e=localStorage.getItem("TOX-COOKIE-CODE"+n.instance.walletAddress);e=Pa.decode(e);let i=e.split("&"),a=parseFloat(i[0]),r=i[1],s=i[2],o=i[3],l=i[4];if(a&&r&&s&&o&&l){let c={debug:z.Debug,address:this.walletAddress,time:a,randomHex:r,r:s,s:o,v:l};t=await v.requestPost("wxgame/player/getJwt",c,!1,!1).catch(u=>{}),t&&localStorage.setItem("TOX-COOKIE"+n.instance.walletAddress,t.loginToken)}return t}async checkNickName(t){console.log("checkNickName");let e={name:t,address:this.walletAddress};return await v.requestPost("wxgame/player/nameCheck",e,!1,!1).catch(a=>{de.instance.hideLoading(),console.log("checkResult 失败")})}waitGetAccount(){Laya.timer.loop(2e3,this,this.getAcccount)}async getAcccount(){console.log("getAcccount");var t=!0;let e=new Date().getTime(),i="",a="",r="",s="";if(z.Debug!=0)t=!1;else{let u=localStorage.getItem("TOX-COOKIE-CODE"+n.instance.walletAddress);u=Pa.decode(u);let p=u.split("&");e=parseFloat(p[0]),i=p[1],a=p[2],r=p[3],s=p[4],e&&i&&a&&r&&s&&(t=!1),console.log("needSign: "+t)}if(t){var o=Lc().substring(0,32);i=De(o,{size:32}),e=new Date().getTime();let p=this.walletAddress+i+e,d=new ld.default("SHA-256","TEXT",{encoding:"UTF8"});d.update(p);let L=d.getHash("HEX");console.log("进入签名",1);let x=await this.walletClient.signMessage({account:this.walletAddress,message:L});console.log("签名结束",1);let w=x.substring(2);a="0x"+w.substring(0,64),r="0x"+w.substring(64,128),s="0x"+w.substring(128,130)}let l,c={address:this.walletAddress,time:e,randomHex:i,r:a,s:r,v:s};if(l=await v.requestPost("wxgame/player/getAccount",c,!1,!1).catch(u=>{}),l){Laya.timer.clear(this,this.getAcccount);let u=l.playerDto;localStorage.setItem("TOX-COOKIE"+n.instance.walletAddress,l.loginToken),g.intance.event(f.EVENT_WAIT_PLAYERINFO,u)}}async createAcccount(t,e,i,a,r){console.log("createAcccount");var s=!0;let o=new Date().getTime(),l="",c="",u="",p="";if(z.Debug!=0)s=!1;else{let w=localStorage.getItem("TOX-COOKIE-CODE"+n.instance.walletAddress);w=Pa.decode(w);let I=w.split("&");o=parseFloat(I[0]),l=I[1],c=I[2],u=I[3],p=I[4],o&&l&&c&&u&&p&&(s=!1),console.log("needSign: "+s)}if(s){var d=Lc().substring(0,32);l=De(d,{size:32}),o=new Date().getTime();let I=this.walletAddress+l+o,M=new ld.default("SHA-256","TEXT",{encoding:"UTF8"});M.update(I);let H=M.getHash("HEX");console.log("进入签名",1);let V=await this.walletClient.signMessage({account:this.walletAddress,message:H});console.log("签名结束",1);let q=V.substring(2);c="0x"+q.substring(0,64),u="0x"+q.substring(64,128),p="0x"+q.substring(128,130)}let L,x={name:t,sex:e,icon:i,country:a,referral:r,debug:z.Debug,address:this.walletAddress,time:o,randomHex:l,r:c,s:u,v:p};if(L=await v.requestPost("wxgame/player/create",x,!1,!1).catch(w=>{}),L){let w=L.playerDto;return localStorage.setItem("TOX-COOKIE"+n.instance.walletAddress,L.loginToken),w}return null}async getBalance(){return 0}async allowanceAddress(t){}async newAllowanceAddress(t,e){let i=n.instance.walletAddress,a=t;try{if(console.log("查看是否已经授权, owner:"+i+", spender:"+a+", publicClient.chain.id:"+this.publicClient.chain.id),e==0)return!0;let r=await n.instance.publicClient.readContract({address:e,abi:J.TOKEN_ERC20ABI,functionName:"allowance",args:[i,a]});if(r=="0"){console.log("未授权，进行授权, owner:"+i+", allowance:"+r+", walletClient.chain.id:"+this.walletClient.chain.id);let s=await n.instance.walletClient.writeContract({address:e,abi:J.TOKEN_ERC20ABI,functionName:"approve",args:[a,"100000000000000000000000000000000000000000000000"],account:i});console.log("授权hash============"+s);let o=await n.instance.publicClient.waitForTransactionReceipt({hash:s});return console.log(`Tx with hash: ${s}`,o),o&&o.status=="success"?(console.log(`Tx successful with hash: ${s}`),!0):!1}else return console.log("已授权, owner:"+i+", allowance:"+r),!0}catch(r){if(console.log("授权错误====》",r),r instanceof Error){let s=r.message;console.log("授权错误====》",s)}}}async allowanceAddressByTokenAddress(t,e){let i=new window.web3.eth.Contract(J.TOKEN_ERC20ABI,e);return await i.methods.allowance(this.walletAddress,t).call()=="0"&&(console.log("ERC20 allowance!"),await i.methods.approve(t,"100000000000000000000000000000000000000000000000").send({from:this.walletAddress},(r,s)=>{if(r)return de.instance.hideLoading(),!1})),!0}async getERC20TokenBalance(t){return window.ethereum,await new window.web3.eth.Contract(J.TOKEN_ERC20ABI,t).methods.balanceOf(this.walletAddress).call()}async getBalance2(t,e=void 0){let i=this.walletAddress;e&&(i=e);let a;return!t||t==J.ADDRESS0?a=await n.instance.publicClient.getBalance({address:i}):a=await this.publicClient.readContract({address:t,abi:J.TOKEN_ERC20ABI,functionName:"balanceOf",args:[i]}),console.log("getBalance2 publicClient.chain.id:"+this.publicClient.chain.id,"代币地址",t,"余额：",a),a}async getIgoUSD(){let t=z.vType==2?J.IGO_ADDRESS:J.IGO_ADDRESS_TEST;return await this.publicClient.readContract({address:t,abi:J.IGO_ABI,functionName:"USD"})}async getIgoLimitTime(){let t=z.vType==2?J.IGO_ADDRESS:J.IGO_ADDRESS_TEST;return await this.publicClient.readContract({address:t,abi:J.IGO_ABI,functionName:"deadline"})}async getIgoRecord(){let t=z.vType==2?J.IGO_ADDRESS:J.IGO_ADDRESS_TEST,e=this.walletAddress;return await this.publicClient.readContract({address:t,abi:J.IGO_ABI,functionName:"getRecords",args:[e]})}async rechargeIgoUSD(t,e,i){let a=z.vType==2?J.IGO_ADDRESS:J.IGO_ADDRESS_TEST,r=this.walletAddress,s=Number(pi(t+"",18)),o=await v.requestPost("wxgame/fodc/getSignature",{amount:s,chainId:e,contract:a});if(o&&o.signInfo){let l=o.signInfo;try{if(de.instance.showLoading(),!await n.instance.newAllowanceAddress(a,i))return de.instance.hideLoading(),E.instance.notice(m.instance.getLanguage(15)),!1;let u=await n.instance.walletClient.writeContract({address:l.contract,abi:J.IGO_ABI,functionName:"recharge",args:[l.address,l.amount,l.inviteAddress,l.deadline,l.signature],account:r}),p;if(p=await n.instance.publicClient.waitForTransactionReceipt({hash:u,pollingInterval:1e3}),p&&p.status=="success")return console.log(`Tx successful with hash: ${u}`),de.instance.hideLoading(),u;de.instance.hideLoading(),Le.TransactionErrorTip();return}catch(c){de.instance.hideLoading(),Le.TransactionErrorTip(),console.log(c)}}}async getRechargedIgoUSD(){let t=z.vType==2?J.IGO_ADDRESS:J.IGO_ADDRESS_TEST,e=n.instance.walletAddress;return await this.publicClient.readContract({address:t,abi:J.IGO_ABI,functionName:"getAmounts",args:[e]})}async getAllRechargedMoney(){let t=z.vType==2?J.IGO_ADDRESS:J.IGO_ADDRESS_TEST,e=n.instance.walletAddress;return await this.publicClient.readContract({address:t,abi:J.IGO_ABI,functionName:"totalQuota"})}async getMyAllRechargedMoney(){let t=z.vType==2?J.IGO_ADDRESS:J.IGO_ADDRESS_TEST,e=n.instance.walletAddress;return await this.publicClient.readContract({address:t,abi:J.IGO_ABI,functionName:"getAmounts",args:[e]})}async getBankBalance(t,e,i){if(i=="WBNB"){let a=await n.instance.publicClient.getBalance({address:e});if(a)return a}else{let a=this.getBalance2(t,e);if(a)return a}}async getHeroStatus(t){return await this.hero_contract.methods.getStatus(parseInt(t)).call()}async checkHeroIsBuzy(t){let e=await this.getHeroStatus(t);return parseInt(e)?(E.instance.notice(m.instance.getLanguage(19)),!0):!1}async switchChain(t){var e=this.getChainName(t);let i=await n.instance.walletClient.getChainId();if(z.isInto&&Laya.Browser.onIOS&&i!==t)return E.instance.notice(m.instance.getLanguage(1172,e)),!1;try{console.log("switchChain id:"+t),await this.walletClient.switchChain({id:t})}catch(a){if(console.log(a),a instanceof Error){let r=a.message;console.log("切换错误====》",r)}return E.instance.notice(m.instance.getLanguage(1172,e)),!1}return await this.resetPublicAndWallet(t),!0}async addChain(t){console.log(t);var e=this.getChain(t);let i=await this.walletClient.addChain({chain:e});console.log(i)}getChain(t){var e=null;switch(t){case Ki.id:e=Ki;break;case Ra.id:e=Ra;break;case zn.id:e=zn;break;case qn.id:e=qn;break;case sd.id:e=sd;break;case uo.id:e=uo;break;case id.id:e=id;break;case ad.id:e=ad;break;case qi.id:e=qi;break;case Wi.id:e=Wi;break;case Wn.id:e=Wn;break;case rn.id:e=rn;break}return e}getChainName(t){var e="",i=this.getChain(t);return i&&(e=i.name),e}async resetPublicAndWallet(t){console.log("resetPublicAndWallet chain:"+t);var e=this.getChain(t);await n.instance.reInitPublicClient(e),await n.instance.reInitWalletClient(e)}reInitPublicClient(t){console.log("reInitPublicClient chain:"+t),this.publicClient=ml({chain:t,transport:ll()})}reInitWalletClient(t){console.log("reInitWalletClient chain:"+t),this.walletClient=so({chain:t,transport:Js(window.ethereum)})}async getAuthStatus(){let t=n.instance.walletAddress;try{return await n.instance.publicClient.readContract({address:J.SAT_ADDRESS,abi:J.SAT_ABI,functionName:"getAuthStatus",args:[t]})}catch(e){if(console.log("授权错误====》",e),e instanceof Error){let i=e.message;console.log("授权错误====》",i)}}}};var aD=Laya.HttpRequest,Xt=class Xt{static requestGet(t,e,i=!1,a=!0,r=!1){return new Promise((s,o)=>{var l=Laya.Pool.getItem("HttpRequest");l||(l=new aD),l.http.timeout=2e3,l.on(Laya.Event.COMPLETE,null,L),l.on(Laya.Event.ERROR,null,x),l.http.onreadystatechange=()=>{if(l.http.readyState===XMLHttpRequest.DONE){var I=l.http.status;I>=200&&I<400||(o(),w())}};let c=localStorage.getItem("TOX-COOKIE"+F.instance.walletAddress),u=["Content-Type","application/json"];c&&(u=[...u,"Authorization",c]);let p;t.startsWith("http")?p=t+d(e):p=Xt.httpRoot+"/"+t+d(e),Xt.httpRoot!="https://api.phantomarena.co"&&$t.log("REQUEST_GET "+p,1),l.send(p,null,"get","json",u);function d(I){if(typeof I=="string")return I;let M="";for(let H in I)M+="&"+H+"="+I[H];return M}function L(I){I.code==="0"?s(I.data):(Ee.instance.showErrorWord(parseInt(I.code)),o(I.code)),w()}function x(I,M){debugger;o(I),w()}function w(){l.off(Laya.Event.COMPLETE,null,L),l.off(Laya.Event.ERROR,null,x),Laya.Pool.recover("HttpRequest",l)}})}static startHeart(){Laya.stage.on(Laya.Event.BLUR,this,()=>{this.stopHeartInStage=!0,console.log("失去焦点, 停止心跳")}),Laya.stage.on(Laya.Event.FOCUS,this,()=>{this.stopHeartInStage=!1,console.log("获取焦点, 开始心跳")}),Laya.timer.loop(3e3,this,this.onHeart)}static async onHeart(){if(z.showHeartLog){if(!Xt.needHeart||this.stopHeartInRoom)return}else if(!Xt.needHeart||this.stopHeartInStage||this.stopHeartInRoom)return;let t=new Date().getTime();var e=await this.requestPost("wxgame/sys/ping",{},!0,!0);if(e.status==1){Le.alertNoAll(Ee.instance.get(2)),Laya.timer.clear(this,this.onHeart);return}var a=new Date().getTime()-t;g.intance.event(f.EVENT_Game_Delay,a);var r=e.time;b.instance.m_serverTime=r;var s=e.resChange;b.instance.playerDto.fightHeroPk=e.fightHeroPk;var o=e.itemChange,l=!1;s&&s.length>0&&(l=!0,b.instance.moneyInfoHander(s,!0,!1),g.intance.event(ti.UPDATE_LOCAL_WALLET_LIST_EVENT),g.intance.event(f.REFRESH_ALL_WITHDRAW_DATA)),o&&o.length>0&&(l=!0,b.instance.itemsDataUpdataHandler(o,!0,!1)),e.redPoint&&!te.arraysEqual(b.instance.redDotData,e.redPoint)&&(b.instance.redDotData=e.redPoint,b.instance.refreshRedDotShow()),e.teamInviteDtoList&&e.teamInviteDtoList.length&&e.teamInviteDtoList.forEach(c=>{console.log("onHeart == teamInviteDto: ",c),Ae.instance.goBookingInviteConfimDialog(c)}),e.teamApplyDtoList&&e.teamApplyDtoList.length&&e.teamApplyDtoList.forEach(c=>{console.log("onHeart == teamApplyDto: ",c),Ae.instance.goBookingApplyConfimDialog(c)}),e.preContractReadyRoomId&&this.lastPrecontractReadyRoomId!=e.preContractReadyRoomId&&(this.lastPrecontractReadyRoomId=e.preContractReadyRoomId,console.log("onHeart == data.preContractReadyRoomId: ",e.preContractReadyRoomId),Ae.instance.goBookingCreateRoomDialog(e.preContractReadyRoomId)),e.preContractStartRoomId&&this.lastPreContractstartRoomId!=e.preContractStartRoomId&&(this.lastPreContractstartRoomId=e.preContractStartRoomId,console.log("onHeart == data.preContractStartRoomId: ",e.preContractStartRoomId),Ae.instance.goMatchCreateRoomDialog(e.preContractStartRoomId)),l&&console.log("onHeart: data =============> ",e)}static requestPost(t,e,i=!1,a=!0,r=!1){let s=localStorage.getItem("TOX-COOKIE"+F.instance.walletAddress);return i&&!s?[]:new Promise((o,l)=>{var c=Laya.Pool.getItem("HttpRequest");c||(c=new aD),c.http.timeout=1e4,c.once(Laya.Event.COMPLETE,null,d),c.once(Laya.Event.ERROR,null,L);let u=[];s&&a&&(u=[...u,"Authorization",s]);var p=Xt.seq+1;Xt.seq=p,t=="wxgame/sys/ping"?z.showHeartLog&&console.log(Le.GetLogTime+" "+p+" >>> HTTP_POST "+Xt.httpRoot+"/"+t+" "+JSON.stringify(e),s):console.log(Le.GetLogTime+" "+p+" >>> HTTP_POST "+Xt.httpRoot+"/"+t+" "+JSON.stringify(e),s),t.startsWith("http")?c.send(t,e,"post","json",u):c.send(Xt.httpRoot+"/"+t,e,"post","json",u);async function d(w){if(t=="wxgame/sys/ping"?z.showHeartLog&&console.log(Le.GetLogTime+" "+p+" <<< hTTP_RCV data: "+JSON.stringify(w),1):console.log(Le.GetLogTime+" "+p+" <<< hTTP_RCV data: "+JSON.stringify(w),1),w.errorCode==0||w.errorCode==="0")o(w);else{if(w.errorCode===10)Le.heroNotEnought();else if(w.errorCode===18)Le.titickNotEnought();else if(w.errorCode===26)Le.RemError();else if(w.errorCode!==29)if(w.errorCode===30)Le.NoHeroError(Ee.instance.get(w.errorCode));else if(w.errorCode===32)Le.NoHeroError(Ee.instance.get(w.errorCode));else if(w.errorCode===2||w.errorCode===21)Le.alertNoAll(Ee.instance.get(w.errorCode));else if(w.errorCode===5)if(z.Debug==0){localStorage.setItem("TOX-COOKIE"+F.instance.walletAddress,"");var I=await F.instance.refreshToken();I&&Xt.requestPost(t,e,i,a)}else localStorage.setItem("TOX-COOKIE"+F.instance.walletAddress,""),Ee.instance.showErrorWord(parseInt(w.errorCode));else w.errorCode===17?z.Debug==0?(localStorage.setItem("TOX-COOKIE"+F.instance.walletAddress,""),F.instance.signAndLogin(),Ee.instance.showErrorWord(parseInt(w.errorCode))):(localStorage.setItem("TOX-COOKIE"+F.instance.walletAddress,""),Ee.instance.showErrorWord(parseInt(w.errorCode))):w.errorCode===9?(Ae.instance.close(),Le.commTipWithYes(Ee.instance.get(w.errorCode))):w.errorCode===51?Le.commTipWithYes(Ee.instance.get(w.errorCode)):r||Ee.instance.showErrorWord(parseInt(w.errorCode),w.errorParams);l(w.errorCode)}x()}function L(w,I){console.log("errorHandler data: "+w,1),r||Ee.instance.showErrorWord(500),l(w),x()}function x(){c.off(Laya.Event.COMPLETE,null,d),c.off(Laya.Event.ERROR,null,L),Laya.Pool.recover("HttpRequest",c)}})}};Xt.httpRoot=getServer(),Xt.needHeart=!0,Xt.stopHeartInRoom=!1,Xt.stopHeartInStage=!1,Xt.lastPreContractstartRoomId=-1,Xt.lastPrecontractReadyRoomId=-1,Xt.seq=0;var v=Xt;var ca=class ca{constructor(){}static trim(t,e=null){e||(e=[" ","\r",`
`,"	",String.fromCharCode(65279)]);var i,a,r;for(i=t,r=e.length,a=0;a<r;a++)i=ca.getReplace(i,e[a],"");return i}static getReplace(t,e,i){if(!t)return"";var a;return a=t.replace(new RegExp(e,"g"),i),a}static isEmpty(t){return t.length<1?!0:ca.emptyStrDic.hasOwnProperty(t)}static trimLeft(t){var e;e=0;var i;for(i=t.length;ca.isEmpty(t.charAt(e))&&e<i;)e++;return e<i?t.substr(e):""}static trimRight(t){var e;for(e=t.length-1;ca.isEmpty(t.charAt(e))&&e>=0;)e--;var i;return i=t.substring(0,e),e>=0?t.substring(0,e+1):""}static trimSide(t){var e;return e=ca.trimLeft(t),e=ca.trimRight(e),e}static shortStr(t,e){return t.length>e?t.substr(0,e)+"...":t}static shortHeroStr(t,e=10){return ca.abbreviateString(t,e)}static abbreviateString(t,e=11){if(t.length<=e)return t;{let i=Math.floor((e-3)/2);return t.slice(0,i)+"..."+t.slice(-i)}}static caseInsensitiveSearchWithRegex(t,e){return new RegExp(e,"i").test(t)}static formatWalletAddress(t){let a="...";return t.length<=12+10?t:`${t.substring(0,12)}${a}${t.substring(t.length-10)}`}};ca.ANONYMOUS_NAME="***",ca.emptyStrDic={" ":!0,"\r":!0,"\n":!0,"	":!0};var Me=ca;var B=class n{constructor(){this._inited=!1;this.stopAll=!1;this.roomWatcher=!1;this.matchWatcher=!1;this.heroReadyDic=new le;this.init()}static get instance(){return n._instance||(n._instance=new n),n._instance}init(){this._inited||(this._inited=!0)}get roomDto(){return this._roomDto}set roomDto(t){if(console.log("roomDto: ",t),this._roomDto=t,t){var e=b.instance.playerDto.pid;if(t.watch){let i=t.watch.some(a=>a===e);this.roomWatcher=i}}}setRoomAnonymousLabel(t,e=-1){return e==-1&&(e=n.instance.roomDto.anonymous),e==1?Me.ANONYMOUS_NAME:t}setMatchAnonymousLabel(t,e=-1){return e==-1&&(e=n.instance.matchDto.anonymous),!this.matchWatcher&&e==1?Me.ANONYMOUS_NAME:t}setMatchAnonymousImg(t,e=-1){return e==-1&&(e=n.instance.matchDto.anonymous),!this.matchWatcher&&e==1?null:t}get matchDto(){return this._matchDto}set matchDto(t){if(console.log("matchDto: ",t),this._matchDto=t,t){var e=b.instance.playerDto.pid;if(t.watch){let i=t.watch.some(a=>a===e);this.matchWatcher=i}t.startTime-t.nowTime>0?this.stopAll=!0:this.stopAll=!1}else this.stopAll=!1}setMatchRes(){this.heroReadyDic=new le;var t=this.roomDto.members.length,e=[],i=this.currArenaItem.mapid;if(this.heroReadyDic.get("map_"+i)==null){var i=n.instance.currArenaItem.mapid,a=S.instance.getMapImg(i);e.push(a);var r=S.instance.getMapPrefab(i);e.push(r),this.heroReadyDic.set("map_"+i,!0)}for(var s=0;s<t;s++){var o=this.roomDto.members[s];if(this.heroReadyDic.get(o.heroId+"_"+o.heroColor)==null){var l=_.intance.m_dicHeros.get(o.heroId),c=S.instance.getHeroSkRes(l.serialId,o.heroColor);e.push({url:c,type:Laya.Loader.SPINE}),this.heroReadyDic.set(o.heroId+"_"+o.heroColor,!0)}}e.length>0&&Laya.loader.load(e,null,Laya.Handler.create(this,this.onPreAssetPress1,null,!1)).then(()=>{})}onPreAssetPress1(t){}async checkMatchRankData(){if(this.reward==null){let t=await v.requestPost("wxgame/room/balanceInfo",{roomId:n.instance.matchDto.roomId});this.onGoMatchEndRank(t)}}onGoMatchEndRank(t){if(this.roomGameOverPush=t,lt.instance.isMatching=!1,t.arenaType==W.ARENA_TYPE_PVE){var e=k.instance.myPlayer;e&&console.log("我的英雄血量剩余： "+e.hp),n.instance.stopAll=!0,A.intance.openModule(y.MatchEndView,[null,null,null,t])}else{var i=t.rankList,a=t.reward,r=t.groupId,s=t.groupData;if(this.reward==null)if(n.instance.reward=a,r){var o=t.teamData;A.intance.openModule(y.MatchEndTeamRankView,[i,s,o,r])}else A.intance.openModule(y.MatchEndRankView,[i,s]);else console.warn("onGoMatchEndRank this.rewrad: ",this.reward)}}clearData(){console.log("clearData ",this.reward),this.roomDto=null,this.matchDto=null,this.reward=null,this.playerJoinDic=null,this.roomGameOverPush=null,this.playerEndDic=null,this.heroReadyDic=null,this.currArenaItem=null,this.roomWatcher=!1,this.matchWatcher=!1,k.instance.clearData(),v.needHeart=!0,Xe.instance.playMusicByName(Xe.soundName_bg,".mp3"),ut.instance.needPop=!0,Li.instance.startShow()}};var gt=class n{constructor(){}static judgePosition(t,e){let i=Math.atan2(e,t)*180/Math.PI;return i<0&&(i+=360),Math.floor(i)}static distancePoint(t,e,i,a){return Math.sqrt((t-i)*(t-i)+(e-a)*(e-a))}get2D_Distance(t,e){return Math.sqrt(Math.pow(Math.abs(t),2)+Math.pow(Math.abs(e),2))}static rollCharacterByDir(t,e,i,a){let r=i;return n.rollCharacter(t,e,r,a)}static rollCharacter(t,e,i,a){let r=i*(Math.PI/180);var s=t+a*Math.cos(r),o=e+a*Math.sin(r),l=B.instance.currArenaItem.mapid,c=_.intance.m_dicMaps.get(l),u=c.offset;return s<u?s=u:s>c.width-u&&(s=c.width-u),o<u?o=u:o>c.height-u&&(o=c.height-u),console.log(`新的坐标：X=${s}, Y=${o}`),[s,o]}static createDirectPath(t,e,i,a=40,r=25){for(var s=[],o=i*Math.PI/180,l=1;l<a;++l){var c=t,u=e+r*l,p=-(u-e)*Math.sin(o)+t,d=(u-e)*Math.cos(o)+e;s.push(p,d)}return s}static pointsBack(t,e){if(e<=0||!t||t.length<4)return t;for(var i=0,a=-1,r=-1,s=0;s<t.length;s+=2){var o=t[s],l=t[s+1];a>0&&r>0&&(i+=this.distancePoint(a,r,o,l)),a=o,r=l}if(i<e)return null;for(var c=t.concat(),u=0,p=0;c&&c.length>=4&&u<e;){var d=c.pop(),L=c.pop(),x=c[c.length-1],w=c[c.length-2];if(u+=this.distancePoint(w,x,L,d),p=u-e,p>0){var I=Math.atan2(x-d,w-L),M=I*180/Math.PI+90;I=M*Math.PI/180;var H=x+p,V=-(H-x)*Math.sin(I)+w,q=(H-x)*Math.cos(I)+x;c.push(V,q)}}return c}static createLinePath(t,e,i,a,r=25,s=0){var o=[],l=Math.atan2(a-e,i-t);l=(l*180/Math.PI-90)*Math.PI/180;for(var c=this.distancePoint(t,e,i,a)-s,u=0,p=0;c>u;){var d=t,L=e+r*p,x=-(L-e)*Math.sin(l)+t,w=(L-e)*Math.cos(l)+e;u=this.distancePoint(t,e,x,w),c>u&&o.push(x,w),p++}return s==0&&o.push(i,a),o}static rolePosTransform(t,e,i){var a=new Laya.Matrix;return a.rotate(Math.PI/180*(t.modelAngle-90)),a.translate(e.x,e.y),a.transformPoint(i)}static pointtInPolygon(t,e){for(var i=0,a=0;a<e.length;a++){var r=e[a],s=e[(a+1)%e.length];if(r.y!=s.y&&!(t.y<Math.min(r.y,s.y))&&!(t.y>=Math.max(r.y,s.y))){var o=(t.y-r.y)*(s.x-r.x)/(s.y-r.y)+r.x;o>t.x&&i++}}return i%2==1}static pointInPie(t,e,i,a,r,s){var o=Math.atan2(s.y-e,s.x-t)*180/Math.PI,l=this.distancePoint(t,e,s.x,s.y);return o>=i&&o<=a&&l<=r}static getRandInRound(t,e){return Math.floor(Math.random()*(e-t+1))+t}static getUnitVector(t){let i=t*(Math.PI/180),a=1*Math.cos(i),r=1*Math.sin(i);return new Laya.Point(a,r)}static subtract(t,e){let i=new Laya.Point;return i.x=t.x-e.x,i.y=t.y-e.y,i}static getDistance(t,e){let i=t.x-e.x,a=t.y-e.y;return Math.sqrt(i*i+a*a)}static calculateDistance(t,e){let i=t.x-e.x,a=t.y-e.y;return Math.sqrt(i*i+a*a)}};var jn=class jn{constructor(){this.activeMonsters=[];this.maxActiveMonsters=2;this.maxActiveMonsters=_.intance.getGeneralValueById(30)}update(){this.updateActiveMonsters(),this.manageActiveMonsters()}updateActiveMonsters(){for(let t of this.activeMonsters)t._isDead&&this.removeActiveMonster(t)}manageActiveMonsters(){var t=B.instance.matchCoolDownTime,e=this.maxActiveMonsters;for(t<30?e=1:t<60&&(e=2);this.activeMonsters.length<e;){let i=k.instance.matchHeroSprs.filter(s=>s!=k.instance.myHeroSpr&&!this.activeMonsters.includes(s)&&!s._isDead);if(i.length===0)break;let a=Math.floor(Math.random()*i.length),r=i[a];this.activeMonsters.push(r),r.isFocusedOnPlayer=!0}}removeActiveMonster(t){let e=this.activeMonsters.indexOf(t);e!==-1&&(t.isFocusedOnPlayer=!1,this.activeMonsters.splice(e,1))}clearData(){this.activeMonsters=[]}static get instance(){return jn._instance==null&&(jn._instance=new jn),jn._instance}};jn._instance=null;var Br=jn;var Nt=class Nt{constructor(){this.arenaType=1;this.validEnemyList=[];this.gameWindowX=0;this.gameWindowY=0;this.isControl=!1;this.tIndex=0;this.mapDir=-4;this.moveP=new Laya.Point}get gameMap(){return this._gameMap}set gameMap(t){this._gameMap=t}clearData(){Br.instance.clearData(),this.gameMap=null,this.box_players=null,this.box_behind=null,this.box_front=null,this.myHeroSpr=null,this.otherHeroSpr=null,this.matchHeroSmallDic=null,this.matchHeroSprDic=null,this.matchHeroSprs=null,this.matchHeroDic=null,this.myPlayer=null,this.allOrders=null}static get instance(){return Nt._instance==null&&(Nt._instance=new Nt),Nt._instance}init(){this.validEnemyList=[]}insertValidList(t){this.isFInd(t,this.validEnemyList)||this.validEnemyList.push(t)}isFInd(t,e){var i=!1;(!t||!e||e.length<=0)&&(i=!1);for(let a=0;a<e.length;a++)if(e[a]==t)return!0;return i}isFIndIndex(t,e){var i=-1;(!t||!e||e.length<=0)&&(i=-1);for(let a=0;a<e.length;a++)e[a]==t&&(i=a);return i}removeValidListByValue(t){if(!(!t||!this.validEnemyList||this.validEnemyList.length<=0)){var e=this.isFIndIndex(t,this.validEnemyList);e!=-1&&this.validEnemyList.splice(e,1)}}createWallMap(){Laya.loader.load("resources/tiledMap/map1_32.json").then(()=>{let e=Laya.loader.getRes("resources/tiledMap/map1_32.json").data.layers[2],i=e.data,a=e.width,r=e.height,s;s=new Array,this.gridXNum=a,this.gridYNum=r;for(var o=0;o<this.gridYNum;o++){s[o]=new Array;for(var l=0;l<this.gridXNum;l++)i[o*this.gridXNum+l]==0?s[o][l]=1:s[o][l]=0}this.graph=new window.Graph(s),this.opts=[],this.opts.closest=!0,this.opts.heuristic=window.astar.heuristics.diagonal})}getEveryPath(t,e){var i,a=this.graph.grid[Math.ceil(t.y/32)-1][Math.ceil(t.x/32)-1],r=this.graph.grid[Math.ceil(e.y/32)-1][Math.ceil(e.x/32)-1];a.weight==0&&(console.log(a,"不能通过"),a=this.getNeighborCanGo(a)),r.weight==0&&(console.log(r,"不能通过"),r=this.getNeighborCanGo(r));var s=new Date().getTime();i=window.astar.search(this.graph,a,r,{closest:this.opts.closest});var o=new Date().getTime();return this.tIndex++,i}getNodeAt(t,e){var i=this.graph.grid[Math.ceil(e/32)-1][Math.ceil(t/32)-1];return i}isInBounds(t,e){return t>=0&&t<this.gridYNum&&e>=0&&e<this.gridXNum}isWalkableAt(t,e){return this.isInBounds(t,e)?this.graph.grid[t][e].weight==1:!1}getNeighborCanGo(t,e=1){let i=t.x,a=t.y,r=[{dx:0,dy:-e},{dx:e,dy:0},{dx:0,dy:e},{dx:-e,dy:0}],s=[{dx:-e,dy:-e},{dx:e,dy:-e},{dx:e,dy:e},{dx:-e,dy:e}];for(let o of r){let l=i+o.dx,c=a+o.dy;if(this.isWalkableAt(l,c))return this.graph.grid[l][c]}for(let o of s){let l=i+o.dx,c=a+o.dy;if(this.isWalkableAt(l,c))return this.graph.grid[l][c]}return this.getNeighborCanGo(t,++e)}getNeighbors(t){let e=[],i=t.x,a=t.y,r=[{dx:0,dy:-10},{dx:10,dy:0},{dx:0,dy:10},{dx:-10,dy:0}],s=[{dx:-10,dy:-10},{dx:10,dy:-10},{dx:10,dy:10},{dx:-10,dy:10}];return r.forEach(o=>{let l=i+o.dx,c=a+o.dy;this.isWalkableAt(l,c)&&e.push(this.graph.grid[l][c])}),s.forEach(o=>{let l=i+o.dx,c=a+o.dy;this.isWalkableAt(l,c)&&e.push(this.graph.grid[l][c])}),e}getRunways(t){let e=[],i=t.x,a=t.y,r=[{dx:0,dy:-2},{dx:2,dy:0},{dx:0,dy:2},{dx:-2,dy:0}],s=[{dx:-2,dy:-2},{dx:2,dy:-2},{dx:2,dy:2},{dx:-2,dy:2}];return r.forEach(o=>{let l=i+o.dx,c=a+o.dy;this.isWalkableAt(l,c)&&e.push(this.graph.grid[l][c])}),s.forEach(o=>{let l=i+o.dx,c=a+o.dy;this.isWalkableAt(l,c)&&e.push(this.graph.grid[l][c])}),e}initMatch(t,e){this.createWallMap(),Laya.loader.load("scenes/match/MatchHeroSpr.lh").then(i=>{this.roleAniPrefab=i,this.createPlayers(t),e&&e(t)})}updateMatch(t,e){this.updatePlayers(),e&&e(t)}createPlayers(t){this.matchHeroDic=new le,this.matchHeroSprDic=new le,this.matchHeroSmallDic=new le,this.matchHeroSprs=[],this.allOrders||(this.allOrders=[]);let e=B.instance.matchDto.members.length;for(var i,a=B.instance.matchWatcher,r=0;r<e;r++){var s=B.instance.matchDto.members[r];b.instance.playerDto.pid==s.id&&(this.myPlayer=s)}for(var o=0;o<e;o++){var s=B.instance.matchDto.members[o],l=new Laya.Image;l.anchorX=0,l.anchorY=0,s.no?this.myPlayer&&this.myPlayer.no==s.no?l.skin="res/match1/img_point_2.png":l.skin="res/match1/img_point_1.png":b.instance.playerDto.pid==s.id?l.skin="res/match1/img_point_2.png":l.skin="res/match1/img_point_1.png",t.img_smallMap.addChild(l),this.matchHeroSmallDic.set(s.id,l);let u=this.roleAniPrefab.create();try{u.smallHeroImg=l,u.dataSource=s,a?s.leader==1&&(this.setOtherHero(u),i=!0):b.instance.playerDto.pid==s.id&&this.setCurrentHero(u),this.matchHeroDic.set(s.id,s),this.box_players.addChild(u),this.matchHeroSprs.push(u),this.allOrders.push(u),this.matchHeroSprDic.set(s.id,u)}catch(p){console.warn(p)}}!i&&a&&this.setOtherHero(this.matchHeroSprs[0])}drawPath(t){if(this.box_players.graphics.clear(),t.length>1){this.box_players.graphics.drawLine(this.transformPos(t[0].y),this.transformPos(t[0].x),this.transformPos(t[1].y),this.transformPos(t[1].x),"#FF0000");for(let e=0;e<t.length;e++)this.box_players.graphics.drawCircle(this.transformPos(t[e].y),this.transformPos(t[e].x),5,"#00FF00"),e<t.length-1&&this.box_players.graphics.drawLine(this.transformPos(t[e].y),this.transformPos(t[e].x),this.transformPos(t[e+1].y),this.transformPos(t[e+1].x),"#FF0000")}}transformPos(t){return t*32+16}updatePlayers(){this.matchHeroSprs=[];let t=B.instance.matchDto.members.length;for(var e=0;e<t;e++){var i=B.instance.matchDto.members[e];let r=this.matchHeroSprDic.get(i.id);if(r){r.dataSource=i;var a=B.instance.matchWatcher;a||b.instance.playerDto.pid==i.id&&(this.myPlayer=i,this.setCurrentHero(r)),this.matchHeroDic.set(i.id,i),this.matchHeroSprs.push(r)}}}addPlayer(t){if(t.type==1){if(this.matchHeroSprs){if(b.instance.playerDto.pid==t.member.id){console.log("自己不处理 :"+t.member.id);return}let e=this.getRoleById(t.member.id);if(e)e.dataSource=t.member,e.alpha=1;else{let i=this.roleAniPrefab.create();i.dataSource=t.member,this.box_players.addChild(i),this.matchHeroSprs.push(i)}}}else this.removeRoleById(t.member.id)}onSendMove(t,e,i,a,r,s,o){if(b.instance.playerDto.pid==e){let l=new Bh;l.time=t,l.speed=i,l.dire=a,l.x=r,l.y=s,l.area=o,lt.instance.sendData(l)}}onNpcSendMove(t,e,i,a,r,s,o){let l=new ed;l.monsterId=e,l.time=t,l.speed=i,l.dire=a,l.x=r,l.y=s,l.area=o,lt.instance.sendData(l)}onSendTargetMove(t,e,i,a,r,s=0){if(b.instance.playerDto.pid==e){let o=new Kh;o.time=t,o.targetId=i,o.targetX=a,o.targetY=r,o.skillId=s,o.sourceId=e,lt.instance.sendData(o)}}onSendUse(t,e){if(t){let i=new Qh;i.pos=e,lt.instance.sendData(i)}else{let i=new zh;i.pos=e,lt.instance.sendData(i)}}onRevCardResponse(t){console.log("onRevCardResponse");var e=t.skillId,i=t.pos;if(e){g.intance.event(f.EVENT_UPDATE_ITEM_SKILL_COOL,[[e,t.remainCount]]);var a=_.intance.m_dicSkills.get(e);(a.type==6||a.type==7)&&Nt.instance.myHeroSpr.attack(i,a.id)}}onRevUsePush(t){console.log("onRevUsePush");var e=t.buffList;e&&e.forEach(a=>{var r=_.intance.m_dicBuffs.get(a.buffId);if(r.triggerTiming==1){var s=Nt.instance.getRoleById(a.pid);r.cycle!=1&&s.parseBuffDto(a,!0)}});var i=t.buffEffects;console.log("onRevAttackPush buffEffects: ",i),i&&i.forEach(a=>{var r=a.buffId,s=_.intance.m_dicBuffs.get(r),o=Nt.instance.getRoleById(a.targetPid);o.parseBuffEffect(a)})}onSendAnimation(t,e,i,a=-1,r=-1,s=-1){if(b.instance.playerDto.pid==t){let o=new Hl;o.skillId=e,o.type=i,o.targetId=a,o.param.set("newX",`${r}`),o.param.set("newY",`${s}`),lt.instance.sendData(o)}else{let o=new Hl;o.monsterId=t,o.skillId=e,o.type=i,o.targetId=a,o.param.set("newX",`${r}`),o.param.set("newY",`${s}`),lt.instance.sendData(o)}}onRevAnimationPush(t){var e=Nt.instance.getRoleById(t.attId);t.attId!=b.instance.playerDto.pid&&(t.defId&&t.param.set("defId",t.defId),e.attack(0,t.skillId,!1,t.param))}onSendAttack(t,e,i,a){if(b.instance.playerDto.pid==t){let r=new Nh;r.targetId=e,r.attackType=i,r.skillId=a,lt.instance.sendData(r)}else{let r=new td;r.monsterId=t,r.targetId=e,r.attackType=i,r.skillId=a,lt.instance.sendData(r)}}onSendAttackBig(t,e){let i=new Xh;i.pos=t,i.targetList=e,lt.instance.sendData(i)}onRevMovePush(t,e){if(!(t==null||t.pid==b.instance.playerDto.pid)){var i=Nt.instance.getRoleById(t.pid);i?i.onPushMoveData(t,e):console.log(t.pid+" sprite is null")}}onRevTargetMovePush(t){if(t.sourceId!=b.instance.playerDto.pid){var e=Nt.instance.getRoleById(t.targetId);e?e.onPushTargetMoveData(t.time,t.targetX,t.targetY):console.log(t.targetId+" sprite is null")}}onRevAttackPush(t){var e=Nt.instance.getRoleById(t.attPid);if(t.attPid!=b.instance.playerDto.pid){var i=_.intance.m_dicSkills.get(t.skill);i.type!=5&&e.attack(0,t.skill,!1)}var a=Nt.instance.getRoleById(t.defPid);a.takeDamage(t,e);var r=t.buffEffects;console.log("onRevAttackPush buffEffects: ",r),r&&r.forEach(l=>{var c=Nt.instance.getRoleById(l.targetPid);c.parseBuffEffect(l)});var s=this.matchHeroDic.get(t.attPid),o=this.matchHeroDic.get(t.defPid);if(s.score=t.attScore,o.score=t.defScore,t.defHp<=0){var s=this.matchHeroDic.get(t.attPid);s.kill++}g.intance.event(f.UPDATE_KILL_NUM)}sendRestoreData(){if(B.instance.reward==null){let t=new Hh;t.roomId=B.instance.matchDto.roomId,lt.instance.sendData(t)}}onRevRestorePush(t){B.instance.matchDto=t,g.intance.event(f.EVENT_RESTORE_DATA),t&&t.startTime-t.nowTime<=0&&A.intance.disposeView(y.MatchReadyView)}onRevReLifePush(t){var e=t.monsterId;if(console.log("复活："+e),e){var i=this.matchHeroDic.get(e);i.hp=t.hp,i.maxHp=t.maxHp,i.x=t.x,i.y=t.y;let a=this.getRoleById(e);a&&(a.dataSource=i)}}getRoleById(t){let e;return this.matchHeroSprs&&this.matchHeroSprs.forEach(i=>{if(i.roomPlayerDto.id==t){e=i;return}}),e}removeRoleById(t){var e;this.matchHeroSprs&&this.matchHeroSprs.forEach(i=>{if(i.roomPlayerDto.id==t){e=i,i.speed=0,i.alpha=.3;return}})}getValidList(){return this.validEnemyList}playMusic(){Xe.instance.playMusicByURL("mp3/battle.mp3"),ut.instance.needPop=!1}playSound(t){var e="";t==1?e="resources/music/pugong":t==2?e="resources/music/enemyHit":t==3&&(e="resources/music/dazhao"),Xe.instance.playSound(e+".wav",1)}setCurrentHero(t){var e=B.instance.matchWatcher;if(!e){t.isMe=!0;var i=this.myHeroSpr==null;this.myHeroSpr=t,this.moveType=W.CAMERA_FOLLOW_ME,Nt.instance.moveGameWindow(!0),this.myHeroSpr.initBirth(i)}}setOtherHero(t){if(this.otherHeroSpr&&this.otherHeroSpr==t){this.setCameraIdle();return}this.removeOtherHero(),t.setFollowIcon(!0),this.otherHeroSpr=t,this.moveType=W.CAMERA_FOLLOW_OTHER,Nt.instance.moveGameWindow(!0)}setCameraIdle(){this.removeOtherHero(),this.moveType=W.CAMERA_IDLE,Nt.instance.moveGameWindow(!0)}removeOtherHero(){this.otherHeroSpr&&this.otherHeroSpr.setFollowIcon(!1),this.otherHeroSpr=null}getAttackTarget(t,e){console.log("getAttackTarget");var i=e.distance,a=e.targetsType;if(a==1){let o=new Laya.Point(t.x,t.y),l=gt.getUnitVector(t.roleDirection);var r=[];return this.matchHeroSprs&&this.matchHeroSprs.forEach(c=>{if(!c._isDead&&!this.isOneTeam(t,c)&&t.roomPlayerDto.id!=c.roomPlayerDto.id){var u=this.getEnemyDistance(t,c);if(u<=i){let p=new Laya.Point(c.x,c.y),d=gt.subtract(p,o);d.x*l.x+d.y*l.y>0&&r.push(c)}}}),r}else if(a==2){let o,l=1e4;if(this.matchHeroSprs&&this.matchHeroSprs.forEach(c=>{if(!c._isDead&&!this.isOneTeam(t,c)&&t.roomPlayerDto.id!=c.roomPlayerDto.id){var u=this.getEnemyDistance(t,c);u<=i&&u<l&&this.canAttack(t,c)&&(o=c,l=u)}}),o)return[o]}else if(a==3){let o=[];this.matchHeroSprs&&this.matchHeroSprs.forEach(u=>{if(!u._isDead&&!this.isOneTeam(t,u)&&t.roomPlayerDto.id!=u.roomPlayerDto.id){var p=this.getEnemyDistance(t,u);p<=i&&o.push(u)}});let l=[];var s=e.targetsNum;let c=this.shuffleArray(o);for(let u=0;u<Math.min(s,c.length);u++)l.push(c[u]);return l}return[]}shuffleArray(t){for(let e=t.length-1;e>0;e--){let i=Math.floor(Math.random()*(e+1));[t[e],t[i]]=[t[i],t[e]]}return t}isOneTeam(t,e){return t.roomPlayerDto&&t.roomPlayerDto.no?t.roomPlayerDto.no==e.roomPlayerDto.no:t.roomPlayerDto.id==e.roomPlayerDto.id}getEnemyDistance(t,e){return Math.sqrt(Math.pow(e.x-t.x,2)+Math.pow(e.y-t.y,2))}canAttack(t,e){let i=new Laya.Vector2;i.x=e.x-t.x,i.y=e.y-t.y;let a=gt.getUnitVector(t.roleDirection),r=Math.atan2(i.y,i.x)-Math.atan2(a.y,a.x);r<0&&(r+=2*Math.PI),r=r*180/Math.PI;let s=90;return t.roomPlayerDto.npc&&(s=120),r<s||r>360-s}canTui(t,e){let i=new Laya.Vector2;i.x=e.x-t.x,i.y=e.y-t.y;let a=gt.getUnitVector(t.roleDirection),r=Math.atan2(i.y,i.x)-Math.atan2(a.y,a.x);r<0&&(r+=2*Math.PI),r=r*180/Math.PI;let s=45;return r<s||r>360-s}setMyHeroDirection(t){var e=B.instance.matchWatcher;if(e){if(!this.moveP){console.log("setMyHeroDirection: "+this.moveP);return}this.moveType!=W.CAMERA_DIRECT_OPERATE&&(this.removeOtherHero(),this.moveType=W.CAMERA_DIRECT_OPERATE,this.setMapPos()),this.mapDir=t}else{if(!this.myHeroSpr)return;t!=-4?(this.myHeroSpr.myRoleDirection=t,this.myHeroSpr.speed=this.myHeroSpr.moveSpeed*this.myHeroSpr.speedRate,this.myHeroSpr.inControl=!0,this.isControl=!0):(this.myHeroSpr.speed=0,this.myHeroSpr.inControl=!1,this.isControl=!1)}}updateMyRoleSpeed(){this.myHeroSpr&&this.myHeroSpr.inControl&&(this.myHeroSpr.speed=this.myHeroSpr.moveSpeed*this.myHeroSpr.speedRate)}fromBigToSmall(t,e){var i=B.instance.currArenaItem.mapid;i==1002&&(t-=160,e-=160);var a=t*216/3040,r=e*216/3040;return[a,r]}fromSmallToBig(t,e){var i=B.instance.currArenaItem.mapid,a=t/(216/3040),r=e/(216/3040);return i==1002&&(a+=160,r+=160),[a,r]}clickSmallMapToMove(t){this.removeOtherHero();var e=Nt.instance.fromSmallToBig(t.x,t.y);this.moveP.setTo(e[0],e[1]),this.moveType=W.CAMERA_MAP_CLICK,this.moveGameWindow(!0)}moveGameWindow(t=!1){if(this.moveType!=W.CAMERA_IDLE){if(this.moveType==W.CAMERA_FOLLOW_ME){if(!this.myHeroSpr)return;this.moveP.setTo(this.myHeroSpr.x,this.myHeroSpr.y)}else if(this.moveType==W.CAMERA_FOLLOW_OTHER){if(!this.otherHeroSpr)return;this.otherHeroSpr._isDead?this.setCameraIdle():this.moveP.setTo(this.otherHeroSpr.x,this.otherHeroSpr.y)}else if(this.moveType==W.CAMERA_MAP_CLICK){if(!this.moveP)return}else if(this.moveType==W.CAMERA_DIRECT_OPERATE){if(!this.moveP)return;if(this.mapDir!=-4){let c=1*9.799999999999999,u=this.mapDir*(Math.PI/180),p=c*Math.cos(u),d=c*Math.sin(u);var e=Math.round(this.moveP.x+p),i=Math.round(this.moveP.y+d);this.gameWindowX=e-Laya.stage.width/2,this.gameWindowY=i-Laya.stage.height/2;var a=-this.gameWindowX,r=-this.gameWindowY,s=Laya.stage.width-this.gameMap.width,o=Laya.stage.height-this.gameMap.height;console.log("moveGameWindow: gameMap ",this.moveType,t,a,r,Laya.stage.width,Laya.stage.height,this.gameMap.x,this.gameMap.y),a>0?e=this.moveP.x:a<s&&(e=this.moveP.x),r>0?i=this.moveP.y:r<o&&(i=this.moveP.y),this.moveP.setTo(e,i),t=!0}else return}if(this.moveP){this.gameWindowX=this.moveP.x-Laya.stage.width/2,this.gameWindowY=this.moveP.y-Laya.stage.height/2;var a=-this.gameWindowX,r=-this.gameWindowY,s=Laya.stage.width-this.gameMap.width,o=Laya.stage.height-this.gameMap.height;a>0?a=0:a<s?a=s:a=a,r>0?r=0:r<o?r=o:r=r,t?(Laya.Tween.clearAll(this.gameMap),this.gameMap.pos(a,r,!0)):Laya.Tween.to(this.gameMap,{x:a,y:r},500)}}}setMapPos(){var t=Laya.stage.width/2-this.gameMap.x,e=Laya.stage.height/2-this.gameMap.y;this.moveP.setTo(t,e)}};Nt._instance=null;var k=Nt;var wt=class wt{constructor(){this.resArr=["gameIcon/map/1001/img_map.jpg","gameIcon/map/1002/img_map.jpg",{url:"gameIcon/map/map_1001.lh",type:Laya.Loader.HIERARCHY},{url:"gameIcon/map/map_1002.lh",type:Laya.Loader.HIERARCHY},"res/common/comm_bg/img_com_bg.jpg","res/common/comm/img_bg_large.png","res/common/comm/img_bg_medium.png","res/common/comm/img_bg_small.png","res/igoPage/img_com_anniu3.png","res/igoPage/img_com_anniu4.png",{url:"res/common.atlas",type:Laya.Loader.ATLAS},{url:"gameIcon/effect/match/beiji/spine.sk"},{url:"gameIcon/effect/match/dunpai/spine.sk"},{url:"gameIcon/effect/ruchang/effect1.skel",type:Laya.Loader.SPINE},{url:"gameIcon/effect/ruchang/effect2.skel",type:Laya.Loader.SPINE},{url:"gameIcon/effect/ruchang/effect3.skel",type:Laya.Loader.SPINE},{url:"gameIcon/effect/hua/effect.skel",type:Laya.Loader.SPINE},{url:"gameIcon/effect/diquan/img_3.skel",type:Laya.Loader.SPINE},{url:"gameIcon/effect/diquan/img_4.skel",type:Laya.Loader.SPINE},{url:"gameIcon/effect/diquan/img_5.skel",type:Laya.Loader.SPINE},{url:"gameIcon/effect/diquan/img_6.skel",type:Laya.Loader.SPINE},{url:"gameIcon/effect/match/zhuangbei/img_equip_1.skel",type:Laya.Loader.SPINE},{url:"gameIcon/effect/match/zhuangbei/img_equip_2.skel",type:Laya.Loader.SPINE},{url:"gameIcon/effect/match/zhuangbei/img_equip_3.skel",type:Laya.Loader.SPINE},{url:"gameIcon/effect/match/zhuangbei/img_equip_4.skel",type:Laya.Loader.SPINE},{url:"gameIcon/effect/match/tx/img_wudi.skel",type:Laya.Loader.SPINE},{url:"gameIcon/effect/baoqi/img_4.skel",type:Laya.Loader.SPINE},{url:"gameIcon/effect/baoqi/img_5.skel",type:Laya.Loader.SPINE},{url:"gameIcon/effect/baoqi/img_6.skel",type:Laya.Loader.SPINE},{url:"gameIcon/effect/match/tx/img_gongji_1009.skel",type:Laya.Loader.SPINE},{url:"gameIcon/effect/match/tx/img_gongji_1010.skel",type:Laya.Loader.SPINE},{url:"gameIcon/effect/match/tx/img_gongji_1011.skel",type:Laya.Loader.SPINE},{url:"gameIcon/effect/match/tx/img_gongji_1012.skel",type:Laya.Loader.SPINE},{url:"gameIcon/effect/match/tx/img_gongji_1013.skel",type:Laya.Loader.SPINE},{url:"gameIcon/effect/match/tx/img_gongji_1014.skel",type:Laya.Loader.SPINE},{url:"scenes/mainView/MainScene.ls",type:Laya.Loader.HIERARCHY},{url:"scenes/shop/ShopScene.ls",type:Laya.Loader.HIERARCHY},{url:"scenes/hero/MyHeroScene.ls",type:Laya.Loader.HIERARCHY},{url:"scenes/match/Match.ls",type:Laya.Loader.HIERARCHY},{url:"scenes/hero/AniSk.lh",type:Laya.Loader.HIERARCHY},{url:"scenes/match/MatchHeroSpr.lh",type:Laya.Loader.HIERARCHY},{url:"scenes/match/DamageNumber.lh",type:Laya.Loader.HIERARCHY},{url:"scenes/match/RocketSpr.lh",type:Laya.Loader.HIERARCHY},{url:"scenes/mainView/EnterRoomSpr.lh",type:Laya.Loader.HIERARCHY},{url:"scenes/notice/TxtLoadingView.lh",type:Laya.Loader.HIERARCHY},{url:"scenes/notice/TxtNoticeView.lh",type:Laya.Loader.HIERARCHY},{url:"scenes/mainView/BarrageSpr.lh",type:Laya.Loader.HIERARCHY},{url:"scenes/mainView/SpecialBarrageSpr.lh",type:Laya.Loader.HIERARCHY},{url:"scenes/mainView/CreateRoomDialog.lh",type:Laya.Loader.HIERARCHY},{url:"scenes/mainView/EnterRoomView.lh",type:Laya.Loader.HIERARCHY},{url:"scenes/match/MatchEndRankView.lh",type:Laya.Loader.HIERARCHY},{url:"scenes/match/MatchEndTeamRankView.lh",type:Laya.Loader.HIERARCHY},{url:"scenes/match/MatchReadyView.lh",type:Laya.Loader.HIERARCHY},{url:"scenes/match/MatchEndView.lh",type:Laya.Loader.HIERARCHY},{url:"prefab/closeBtn.lh",type:Laya.Loader.HIERARCHY},{url:"prefab/defaultButton.lh",type:Laya.Loader.HIERARCHY},{url:"prefab/DropBox.lh",type:Laya.Loader.HIERARCHY},{url:"resources/sound/destroy.wav",type:Laya.Loader.BUFFER},{url:"resources/sound/hit.wav",type:Laya.Loader.BUFFER}];this.m_arrPreResource=["config/spot.json","config/scene.json"];this.m_arrInitResource=["resources/tiledMap/map1_32.json","config/general.json","config/head.json","config/iconBadge.json","config/country.json","config/expression.json","config/fontColor.json","config/variable.json","config/equip.json","config/shop.json","config/likeIt.json","config/union.json","config/winNumbers.json","config/hero.json","config/monster.json","config/pveLuckyDraw.json","config/skill.json","config/buff.json","config/effect.json","config/item.json","config/arena.json","config/arenaType.json","config/characterStar.json","config/node.json","config/groupWar.json","config/teamName.json","config/heroRent.json","config/map.json","config/level.json","config/welfarebag.json","config/mailmessage.json","config/currencyAddress.json","config/aCoin.json","config/coinAddress.json","config/buyHeroes.json","config/puzzleExchange.json","config/DropCashAddress.json","config/otcTelegram.json","config/attributes.json","config/equipSuit.json","config/turntable.json","config/wheel.json","config/heroStar.json","config/wheel1.json","config/wheelPC.json"];this.m_objModuleReource={FindScene:["res/atlas/find.atlas"],MainScene:[],ShopScene:[],RankScene:[],GetMatScene:[],OpenGameScene:[],ScholarshipScene:[],FriendScene:[],CommentDialog:["res/atlas/comment.atlas"],GuideView:["res/atlas/guide.atlas","res/atlas/ShopView.atlas","config/newplayer.json"],ShareView:["res/atlas/share.atlas"],SelectHeadDialog:[],UnionApplyDialog:["config/alliance_constant.json","config/guild_building_main.json","config/alliance_pos.json","config/guild_level.json"],GuildScene:["res/atlas/union.atlas","config/alliance_constant.json","config/guild_building_main.json","config/alliance_pos.json","config/guild_level.json","config/guild_apply.json","config/guild_contrubute.json"],UnionWarScene:["res/atlas/unionWar.atlas","config/resource_node.json"],HeroScene:["res/atlas/hero.atlas","config/hero_lv.json","config/hero_attup.json","res/atlas/equip.atlas"],AFKBattleScene:["res/atlas/battle.atlas"],ArenaScene:["res/atlas/Arena.atlas"],MailScene:[],KnapsackScene:["res/atlas/mainUI1.atlas"],UnionScene:["res/union1.atlas"],IgoPageScene:[],PveScene:[]};this.m_objModuleViews={NoServerView:"scenes/createRole/NoServer.lh",CreateLoginView:"scenes/createRole/CreateLoginView.lh",ChangeHeadDialog:"scenes/createRole/ChangeHeadDialog.lh",HeroGetDialog:"scenes/shop/HeroGetDialog.lh",BuyTicketDialog:"scenes/shop/BuyTicketDialog.lh",ItemGetDialog:"scenes/item/ItemGetDialog.lh",EquipStarUpDialog:"scenes/item/EquipStarUpDialog.lh",RewardGetDialog:"scenes/item/RewardGetDialog.lh",KnapsackTipDialog:"scenes/item/KnapsackTipDialog.lh",SelectHeadDialog:"scenes/createRole/SelectHeadDialog.lh",TxtNoticeView:"scenes/notice/TxtNoticeView.lh",NoticeDialog:"scenes/notice/NoticeDialog.lh",HelpDialog:"scenes/notice/HelpDialog.lh",ImgDialog:"scenes/notice/ImgDialog.lh",ChampDetailDialog:"scenes/asset/ChampDetailDialog.lh",ChampRecordDialog:"scenes/asset/ChampRecordDialog.lh",RoleInfoDialog:"scenes/createRole/RoleInfoDialog.lh",RemGetDialog:"scenes/createRole/RemGetDialog.lh",CreateRoomDialog:"scenes/mainView/CreateRoomDialog.lh",CreateRentalDialog:"scenes/shop/CreateRentalDialog.lh",MyLeasedDialog:"scenes/shop/MyLeasedDialog.lh",MyRentedDialog:"scenes/shop/MyRentedDialog.lh",MyRentalBuyDialog:"scenes/shop/MyRentalBuyDialog.lh",EnterRoomView:"scenes/mainView/EnterRoomView.lh",InputPwdDialog:"scenes/mainView/InputPwdDialog.lh",RoomInfoDialog:"scenes/mainView/RoomInfoDialog.lh",HeroDetailDialog:"scenes/hero/HeroDetailDialog.lh",MatchEndRankView:"scenes/match/MatchEndRankView.lh",MatchEndTeamRankView:"scenes/match/MatchEndTeamRankView.lh",MyBookingView:"scenes/airdrop/MyBookingView.lh",UnionMemberView:"scenes/union/UnionMemberView.lh",UnionListView:"scenes/union/UnionListView.lh",CreateSubUnionView:"scenes/union/CreateSubUnionView.lh",ChangeUnionIconDialog:"scenes/union/ChangeUnionIconDialog.lh",MySubUnionView:"scenes/union/MySubUnionView.lh",UnionMemberApplyView:"scenes/union/UnionMemberApplyView.lh",UnionReferralView:"scenes/union/UnionReferralView.lh",UnionTransferView:"scenes/union/UnionTransferView.lh",TicketTransferView:"scenes/union/TicketTransferView.lh",HeroTransferView:"scenes/hero/HeroTransferView.lh",BanAccountView:"scenes/match/BanAccountView.lh",MatchReadyView:"scenes/match/MatchReadyView.lh",MatchEndView:"scenes/match/MatchEndView.lh",GameSettingLanguageDialog:"scenes/gameSetting/GameSettingLanguageDialog.lh",SkillTipDialog:"scenes/hero/SkillTipDialog.lh",TransferRecordDialog:"scenes/hero/TransferRecordDialog.lh",TeamCreateShareDialog:"scenes/airdrop/TeamCreateShareDialog.lh",TeamShareDialog:"scenes/airdrop/TeamShareDialog.lh",TeamJoinUsingDialog:"scenes/airdrop/TeamJoinUsingDialog.lh",TeamInfoDialog:"scenes/airdrop/TeamInfoDialog.lh",MyTeamDialog:"scenes/airdrop/MyTeamDialog.lh",MyFriendDialog:"scenes/airdrop/MyFriendDialog.lh",BaseAlertDialog:"scenes/baseAlert/BaseAlertDialog.lh",MatchConfimDialog:"scenes/baseAlert/MatchConfimDialog.lh",InviteConfimDialog:"scenes/airdrop/InviteConfimDialog.lh",ApplyConfimDialog:"scenes/airdrop/ApplyConfimDialog.lh",CreateSubWalletDialog:"scenes/scholarship/CreateSubWalletDialog.lh",WalletChooseHeroDialog:"scenes/scholarship/WalletChooseHeroDialog.lh",WalletChoosePropsDialog:"scenes/scholarship/WalletChoosePropsDialog.lh",EmployInfoDialog:"scenes/scholarship/EmployInfoDialog.lh",HireDetailDialog:"scenes/asset/HireDetailDialog.lh",ProxyDetailDialog:"scenes/asset/ProxyDetailDialog.lh",WithDrawRecordDialog:"scenes/asset/WithDrawRecordDialog.lh",NodeRevenueRecordDialog:"scenes/asset/NodeRevenueRecordDialog.lh",CardPayView:"scenes/asset/CardPayView.lh",RentalRecordDialog:"scenes/scholarship/RentalRecordDialog.lh",PrivateChatDialog:"scenes/friend/PrivateChatDialog.lh",AirdropRecordDialog:"scenes/asset/AirdropRecordDialog.lh",ActivityInfoDialog:"scenes/createRole/ActivityInfoDialog.lh",CharacterStarDialog:"scenes/createRole/CharacterStarDialog.lh",LastDrawDialog:"scenes/lcPool/LastDrawDialog.lh",IgoPageScene:"scenes/igoPage/IgoPageScene.lh",IgoJoinDialog:"scenes/igoPage/IgoJoinDialog.lh",IgoRecordDialog:"scenes/igoPage/IgoRecordDialog.lh",DailyTaskPropsDialog:"scenes/dailyTasks/DailyTaskPropsDialog.lh",DailyTaskNoPropsDialog:"scenes/dailyTasks/DailyTaskNoPropsDialog.lh",PveScene:"scenes/pve/PveScene.lh",PveRecordView:"scenes/pve/PveRecordView.lh",PveSponsorView:"scenes/pve/PveSponsorView.lh",PveChoosePropsDialog:"scenes/pve/PveChoosePropsDialog.lh",ReferralDialog:"scenes/createRole/ReferralDialog.lh",ReferralL2Dialog:"scenes/createRole/ReferralL2Dialog.lh",TotalBattlesDialog:"scenes/createRole/TotalBattlesDialog.lh"};this.m_objConfigReource={};this.m_commonResource=new le;this.loadingView=Laya.Browser.window.loadingView;this.ii=100;this.baseUrl="https://cdn.phantomarena.ai/hero/";if(wt._instance)throw new Error("LayerManager是单例,不可new.");wt._instance=this}static get instance(){return wt._instance==null&&(wt._instance=new wt),wt._instance}init(){Laya.loader.on(Laya.Event.ERROR,this,this.onError),this.initGameLanguage()}initGameLanguage(){wt.GameLanguage_URL="config/language.json",Laya.loader.load(wt.GameLanguage_URL,Laya.Handler.create(this,this.initGameResource))}initGameResource(t){if(t==null)return;let e=wt.instance.getResBySetURL(wt.GameLanguage_URL);m.instance.initLanTypes(e.data),Laya.loader.clearRes(wt.GameLanguage_URL),this.onConfigLoaded()}onError(t){}onConfigLoaded(){let t=new Ka;t.ID=4,t.Event="加载语言包信息",He.instance.sendCustumEvent(4,null,t),z.ignoreLang||(b.instance.m_strLanguage=m.instance.getLanIdByType(z.User_Lan)),this.m_UILang="config/lang_english"+b.instance.m_strLanguage+".json",this.m_NomalLang="config/english"+b.instance.m_strLanguage+".json",this.m_NomalLang1="config/english1.json",this.m_ErrorLang="config/error"+b.instance.m_strLanguage+".json",this.m_arrPreResource.push(this.m_UILang),this.m_arrPreResource.push(this.m_NomalLang),this.m_arrPreResource.push(this.m_NomalLang1),this.m_arrPreResource.push(this.m_ErrorLang),this.initResourceURL(this.m_arrPreResource,!0),this.initResourceURL(this.m_arrInitResource,!0),this.addFont1()}addFont1(){Laya.loader.load("res/font/CookieRun Regular.otf",Laya.Loader.TTF).then(()=>{this.loadDemoResource()})}loadDemoResource(){Laya.loader.load(this.resArr,null,Laya.Handler.create(this,this.onPreAssetPress1,null,!1)).then(()=>{de.instance.init(),k.instance.damageNumPrefab=Laya.loader.getRes("scenes/match/DamageNumber.lh"),k.instance.rocketSprPrefab=Laya.loader.getRes("scenes/match/RocketSpr.lh"),k.instance.aniSkPrefab=Laya.loader.getRes("scenes/hero/AniSk.lh"),Ae.instance.enterRoomPrefab=Laya.loader.getRes("scenes/mainView/EnterRoomSpr.lh"),Ae.instance.barrageSprPrefab=Laya.loader.getRes("scenes/mainView/BarrageSpr.lh"),Ae.instance.specialBarrageSprPrefab=Laya.loader.getRes("scenes/mainView/SpecialBarrageSpr.lh"),k.instance.roleAniPrefab=Laya.loader.getRes("scenes/match/MatchHeroSpr.lh"),k.instance.ruchangEffects=[Laya.loader.getRes("gameIcon/effect/ruchang/effect1.skel"),Laya.loader.getRes("gameIcon/effect/ruchang/effect2.skel"),Laya.loader.getRes("gameIcon/effect/ruchang/effect3.skel")],k.instance.huaEffect=Laya.loader.getRes("gameIcon/effect/hua/effect.skel"),k.instance.beijiTemplet=Laya.loader.getRes("gameIcon/effect/match/beiji/spine.sk"),k.instance.dunpaiTemplet=Laya.loader.getRes("gameIcon/effect/match/dunpai/spine.sk"),k.instance.diquanEffect3=Laya.loader.getRes("gameIcon/effect/diquan/img_3.skel"),k.instance.diquanEffect4=Laya.loader.getRes("gameIcon/effect/diquan/img_4.skel"),k.instance.diquanEffect5=Laya.loader.getRes("gameIcon/effect/diquan/img_5.skel"),k.instance.diquanEffect6=Laya.loader.getRes("gameIcon/effect/diquan/img_6.skel"),k.instance.equipPos1=Laya.loader.getRes("gameIcon/effect/match/zhuangbei/img_equip_1.skel"),k.instance.equipPos2=Laya.loader.getRes("gameIcon/effect/match/zhuangbei/img_equip_2.skel"),k.instance.equipPos3=Laya.loader.getRes("gameIcon/effect/match/zhuangbei/img_equip_3.skel"),k.instance.equipPos4=Laya.loader.getRes("gameIcon/effect/match/zhuangbei/img_equip_4.skel"),k.instance.img_wudi=Laya.loader.getRes("gameIcon/effect/match/tx/img_wudi.skel"),k.instance.baoqiEffect4=Laya.loader.getRes("gameIcon/effect/baoqi/img_4.skel"),k.instance.baoqiEffect5=Laya.loader.getRes("gameIcon/effect/baoqi/img_5.skel"),k.instance.baoqiEffect6=Laya.loader.getRes("gameIcon/effect/baoqi/img_6.skel"),k.instance.img_gongji_1009=Laya.loader.getRes("gameIcon/effect/match/tx/img_gongji_1009.skel"),k.instance.img_gongji_1010=Laya.loader.getRes("gameIcon/effect/match/tx/img_gongji_1010.skel"),k.instance.img_gongji_1011=Laya.loader.getRes("gameIcon/effect/match/tx/img_gongji_1011.skel"),k.instance.img_gongji_1012=Laya.loader.getRes("gameIcon/effect/match/tx/img_gongji_1012.skel"),k.instance.img_gongji_1013=Laya.loader.getRes("gameIcon/effect/match/tx/img_gongji_1013.skel"),k.instance.img_gongji_1014=Laya.loader.getRes("gameIcon/effect/match/tx/img_gongji_1014.skel");var t=k.instance.roleAniPrefab.create();console.log(" ================ roleAniPrefab: "+t),this.onLoadThreeDimen()})}onLoadThreeDimen(){Laya.loader.load(this.m_arrPreResource,Laya.Handler.create(this,this.onPreAssetLoaded),Laya.Handler.create(this,this.onPreAssetPress2,null,!1))}onPreAssetPress1(t){this.va=(t*100*.5).toFixed(0),this.loadingView&&this.va<100&&this.va>this.m_iPrecess&&this.loadingView.loading(this.va)}onPreAssetPress2(t){this.va=(t*100*.5+.5).toFixed(0),this.loadingView&&this.va<100&&this.va>this.m_iPrecess&&this.loadingView.loading(this.va)}onPreAssetLoaded(t){if(!t)return;let e=Laya.Browser.now();qr.instance.initSpotCfgData(),this.initResourceURL(this.m_objModuleReource),this.initResourceURL(this.m_objConfigReource),He.instance.sendCustumEvent(5),_.intance.preInit(),this.setGlobalLanguage(),He.instance.sendCustumEvent(6),g.intance.event(f.EVENT_BACK_TO_LOGIN),oe.intance.initPreload(),this.loadingView&&this.loadingView.loading(100),console.log("-----------------------preload-time:"+(Laya.Browser.now()-e))}setGlobalLanguage(){let t=wt.instance.getResByURL(this.m_NomalLang);m.instance.initConfigLan(t.data);let e=wt.instance.getResByURL(this.m_NomalLang1);m.instance.initConfigLan1(e.data);let i=wt.instance.getResByURL(this.m_UILang);m.instance.initUILan(i.data);let a=wt.instance.getResByURL(this.m_ErrorLang);Ee.instance.initErrData(a.data),this.clearResUrlByRoot(this.m_UILang,!0),this.clearResUrlByRoot(this.m_NomalLang,!0),this.clearResUrlByRoot(this.m_NomalLang1,!0),this.clearResUrlByRoot(this.m_ErrorLang,!0)}initResourceURL(t,e=!1){if(t instanceof Array)this.setResURLArr(t,e);else if(t instanceof Object)for(let i in t)this.setResURLArr(t[i],e)}setResURLArr(t,e){let i,a;for(let r=0;r<t.length;r++)e?(this.m_commonResource.set(t[r],!0),a=this.setResURL(t[r]),i=this.getTypeFromUrl(a),t[r]={url:a,type:i,size:1,priority:1}):this.m_commonResource.get(t[r])?(t.splice(r,1),r--):(a=this.setResURL(t[r]),i=this.getTypeFromUrl(a),t[r]={url:a,type:i,size:1,priority:1})}getTypeFromUrl(t){let{ext:e,typeId:i,main:a,loaderType:r}=Laya.Loader.getURLInfo(t);wt._extReg.lastIndex=t.lastIndexOf(".");let s=wt._extReg.exec(t);return s&&s.length>1?s[1].toLowerCase():"text"}setResURL(t){return t}clearResUrlByRoot(t,e=!1){let i=t;Laya.loader.clearRes(i)}hasFormatEffectUrl(t){return t.indexOf("effect/")>=0}setItemResURL(t){return t&&t.hasOwnProperty("item_img")?this.setResURL("icon/"+t.item_img+".png"):""}setThreeDimenUrl(t){return t?this.setResURL("threeDimen/"+t):""}getThreeDimenUrl(t){let e=this.setResURL("threeDimen/"+t);return Laya.Loader.getRes(e)}getResByURL(t){let e=wt.instance.setResURL(t);return Laya.Loader.getRes(e)}getResBySetURL(t){return Laya.Loader.getRes(t)}loadModuleUrl(t,e=null,i=null,a=1,r=!0){console.log("loadModuleUrl m_strName: "+t),this.ii++;let s=wt.instance.m_objModuleReource[t];if(s==null||s.length<1){e.run();return}Laya.loader.load(s,Laya.Handler.create(this,this.loadItemComplete,[e,s]),Laya.Handler.create(this,this.onLoadProgress,[t],!1),i,a,r,this.ii.toString())}loadItemComplete(t,e){this.usedUrlDic||(this.usedUrlDic=new le);for(let i in e){let a=e[i].url,r=this.usedUrlDic.get(a);r?this.usedUrlDic.set(a,++r):this.usedUrlDic.set(a,1)}t.run()}clearModuleUrl(t){console.log("clearModuleUrl m_strName: "+t);let e=wt.instance.m_objModuleReource[t];for(let i in e){let a=e[i].url;if(this.usedUrlDic){let r=this.usedUrlDic.get(a);r-=1,r<1?(this.usedUrlDic.remove(a),Laya.loader.clearRes(a)):this.usedUrlDic.set(a,r)}}}onLoadProgress(t,e){}loadResource(t,e=null,i=null,a=null,r=1,s=!0){Laya.loader.load(t,e,i,a,r,s)}getNodeIcon(t){return this.setResURL("gameIcon/node/img_"+t+".png")}getCountryIcon(t){return this.setResURL("gameIcon/country/img_"+t+".png")}getTeamFlag(t){return this.setResURL("gameIcon/hero/teamFlag/img_"+t+".png")}getChestIcon(t){return this.setResURL("gameIcon/items/chest/img_"+t+".png")}getChestBigIcon(t){return this.setResURL("gameIcon/items/chestBig/img_"+t+".png")}getHeroEggIcon(t){return this.setResURL("gameIcon/hero/heroEgg/img_"+t+".png")}getHeroEggBigIcon(t){return this.setResURL("gameIcon/hero/heroEggBig/img_"+t+".png")}getHeroHeadIcon(t){return this.setResURL("gameIcon/hero/heroHead/img_"+t+".png")}getHeroQuality(t){return this.setResURL("gameIcon/hero/heroQuality/img_"+t+".png")}getHeroBackIcon(t){return this.setResURL("gameIcon/hero/heroDetail/img_hero_di_"+t+".png")}getHeroFrontIcon(t){return this.setResURL("gameIcon/hero/heroDetail/img_hero_"+t+".png")}getItemIcon(t){return this.setResURL("gameIcon/items/item/img_"+t+".png")}getItemBgIcon(t){return this.setResURL("gameIcon/items/itemBg/img_"+t+".png")}getItemBigIcon(t){return this.setResURL("gameIcon/items/itemBig/img_"+t+".png")}getItemBigBigIcon(t){return this.setResURL("gameIcon/items/itemBigBig/img_"+t+".jpg")}getItemQualityIcon(t){return this.setResURL("gameIcon/items/itemQuality/img_"+t+".png")}getMoneyIcon(t){return this.setResURL("gameIcon/items/money/img_"+t+".png")}getAttrIcon(t){return this.setResURL("gameIcon/attr/img_attr_"+t+".png")}getSkillIcon(t,e=!1){let i;return e?i=this.setResURL("gameIcon/skill/skills/img_big_"+t+".png"):i=this.setResURL("gameIcon/skill/skills/img_"+t+".png"),i}getMatchSkillIcon(t){return this.setResURL("gameIcon/skill/matchSkills/img_"+t+".png")}getPlayerIcon(t){return parseInt(t)>0?this.setResURL("gameIcon/head/headCircle/img_"+t+".png"):t}getUnionIcon(t){return parseInt(t)>0?this.setResURL("gameIcon/union/badge/img_trade_"+t+".png"):t}getUnionLvIcon(t){return this.setResURL("gameIcon/union/lvIcon/img_trade_"+(t>3?4:t)+".png")}getUnionLvDiIcon(t){return this.setResURL("gameIcon/union/lvIcon/img_trade_di_"+(t>3?4:t)+".png")}getEmoji(t,e){return this.setResURL("gameIcon/emoji/tab"+t+"/img_"+e+".png")}getFontColor(t){return this.setResURL("gameIcon/emoji/img_color_"+t+".png")}getSceneBgUrl(t){return"scene/"+t+".jpg"}clearSKinUrl(t){for(let e in t)t[e]instanceof String&&t[e].indexOf("skincolor")==-1&&Laya.loader.clearRes(t[e]);t=[]}getFunctionIcon(t){return this.setResURL("icon/functionIcon/"+t+".png")}getNewFunIcon(t){return this.setResURL("icon/newFunIcon/"+t+".png")}getSoundURL(t,e=".ogg"){let i;return i=this.setResURL("mp3/"+t+e),i}getSoundURLogg(t){let e;return e=this.setResURL("mp3/"+t),e}getSceneUrl(t){return"scene/sceneBg/"+t+".jpg"}getMianSysIcon(t){return this.setResURL("icon/mainSysIcon/btn_"+t+".png")}getEffectUrl(t){return this.setResURL("effect/"+t+".json")}getLoadingUrl(t){return this.setResURL("effect/"+t)}getGuangImg(t){return this.setResURL("swf/"+t+".png")}getGuildProofBg(t){return this.setResURL("scene/guild/proof/"+t+"/1.png")}getGuildProofHots(t){return this.setResURL("scene/guild/proof/"+t+"/"+t+"/"+t+".json")}getShareImgUrl(t,e=!1,i=!1){let a;return i?t:(t=t+".jpg",e?a="https://mutantbox.8686c.com/16/qa/common/share/"+t:a="https://cdn.test.com/16/qa/common/share/"+t,a)}getHeadUrl(t){return"common/common_icon/"+t+".png"}getMapImg(t){return"gameIcon/map/"+t+"/img_map.jpg"}getMapPrefab(t){return"gameIcon/map/map_"+t+".lh"}clearCache(){}getHeroHeadRes(t,e){return z.Res==0?"gameIcon/hero/heroHead/img_"+t+".png":this.baseUrl+`${t}/${e}.png`}getHeroSkRes(t,e){return z.Res==0?`gameIcon/hero/heroSk/${t}/img_hero.skel`:this.baseUrl+`${t}/${e}/img_hero.skel`}};wt._extReg=/\.(\w+)\??/g;var S=wt;var $n=class $n{constructor(){this._list=[];this._isNoticing=!1;this._isListener=!1}static get instance(){return $n._instance||($n._instance=new $n),$n._instance}notice(t){this._isNoticing?this._isListener||(this._isListener=!0,this._list.push(t),Laya.timer.loop($n.Tip_Interval,this,this.onInterVal)):(this._list.push(t),this.noticeOne())}noticeOne(){var t=S.instance.m_objModuleViews.TxtNoticeView;let e;Laya.loader.load(t).then(i=>{if(!i){console.log("noticeOne : "+t+"  res is null");return}e=Laya.Pool.getItemByCreateFun("txtNotice",i.create,i);let a=this._list.shift();e.notice(a),Laya.stage.addChild(e),e.x=C.instence.stageWidth*.5-e.width*.5,e.y=C.instence.stageHeight*.5-e.height*.5,Laya.Tween.to(e,{y:e.y-250,alpha:.5},1e3,null,Laya.Handler.create(this,this.onFinish,[e]),1e3)})}onFinish(t){t&&(t.visible=!1,t.removeSelf())}onInterVal(){this._list.length>=1?this.noticeOne():(this._isNoticing=!1,this._isListener=!1,Laya.timer.clear(this,this.onInterVal))}};$n.Tip_Interval=1e3;var E=$n;var Ee=class n{constructor(){this._curErrTxt=""}static get instance(){return n._instance||(n._instance=new n),n._instance}initErrData(t){this.errData=t}get(t){return this.errData[t]?this.errData[t].words:(console.warn("服务端错误码语言包未配表 错误码："+t),t)}showErrorWord(t,...e){var i=this.getLanguage2(t,e);E.instance.notice(i)}getLanguage2(t,e){if(this.errData&&this.errData[t]){let i=this.errData[t].words;if(i&&i!="")return this._curErrTxt=m.instance.replacePlaceholder(i,e),this._curErrTxt}return this._curErrTxt=m.instance.replacePlaceholder(t+"",e),this._curErrTxt}showErrByString(t,e="#ff0000"){this._curErrTxt=t;let i=new Laya.Label(this._curErrTxt);i.width=500,i.align="center",i.height=40,i.fontSize=26,i.color=e,i.mouseEnabled=!1,i.strokeColor="#000000",i.stroke=.5,Laya.stage.addChild(i),i.x=(Laya.stage.width-i.width)/2,i.y=(Laya.stage.height-i.height)/2,Laya.Tween.to(i,{y:i.y-100,alpha:0},500,null,Laya.Handler.create(this,this.completeHandler,[i]),1e3)}completeHandler(t){t&&t.parent&&t.parent.removeChild(t)}dispose(){this.errData=null}};var mt=class{};mt.FUNID_MALL="1004",mt.FUN_ID_TAGGARDEN="2005",mt.FunID_WORK="1006",mt.FUN_ID_BARGAIN_SHOP="1007",mt.TRAVEL_HARD="1012",mt.TRAVEL_REWARD="3006",mt.FUNID_TUJIAN="2105",mt.FUN_ID_PARTY="7003",mt.FUN_ID_FB="9010",mt.FUN_ID_PET="9004",mt.FUN_ID_TURNTABLE="9001",mt.FUN_ID_GASHPOEN="9012",mt.FUN_ID_SHOPEXCHANGE="2104",mt.FUN_ID_TIME_STAGE="9014",mt.FUN_ID_DRAWCARD_PVP="1008613",mt.FUN_ID_PHONE="2004",mt.FUN_ID_DS="9017",mt.FUN_ID_BUY_PS="9030",mt.FUN_ID_DESTINY="3020",mt.FUN_ID_ACTIVITY_SHOP="9026",mt.FUN_ID_WORKSHOP_RECYCLE="3002",mt.FUN_ID_WORKSHOP_COLOR="3004",mt.FUN_ID_WORKSHOP_UPGRADE="3003",mt.FUN_ID_GUILD="1010",mt.FUN_ID_VIP="9022",mt.FUN_ID_MONTHCARD="9100";var cd=class{constructor(){this.bafflesInfo=[[330,740,9],[294,113.95,1],[712.95-80,343.45,3],[1251.35,125.95,7]];this.redHotStateMap=new le;this.openSystem=new le;this.m_dicSystemInfoCfg=new le,this._openTypeList=new le,this.parseJson()}hasRedState(t){let e=this.redHotStateMap.get(t+"");return e&&e.redState>0?e.redState:0}initSystemOpen(t){this.openSystem=new le;for(let e=0;e<t.length;e++)this.openSystem.set(t[e],!0),t[e]+""==mt.FUN_ID_PHONE.toString()}parseJson(){let t=S.instance.getResByURL("config/system_open.json"),e;for(let i in t)if(e=t[i],e){this.m_dicSystemInfoCfg.set(e.functionID,e);let a=this._openTypeList.get(e.open_type);a||(a=[],this._openTypeList.set(e.open_type,a)),a.push(e)}}getSystemsByType(t){let e=[];for(let i=0;i<this.m_dicSystemInfoCfg.values.length;i++){let a=this.m_dicSystemInfoCfg.values[i];a.positionID==t&&e.push(a)}return e}getLockFun(t,e){let i=this._openTypeList.get(t);for(let a of i)if(a.parameter1+""==e+"")return a;return null}getBuildSystem(){}isOpen(t){return z.buildClickState?!0:(t instanceof String&&(t=parseInt(t+"")),this.openSystem.get(t)!=null)}};var ud=class{constructor(){this._vipLv=0}isReceive(t){for(let e of this.isRewards)if(e+""==t.toString())return!0;return!1}addIsReceive(t){this.isReceive(t)||this.isRewards.push(t)}get vipLv(){return this._vipLv}set vipLv(t){this._vipLv!=t&&(this._vipLv=t)}};var md=class{constructor(){this.m_dicItemList=new le,this.m_dicTypeList=new le,this.m_dicSubTypeList=new le,this.m_dicBackList=new le}initData(t){this.m_dicItemList=new le,this.m_dicTypeList=new le,this.m_dicSubTypeList=new le,this.m_dicBackList=new le;let e;for(let a=0;a<t.length;a++){e=new Ne;var i=t[a];e.m_iId=i.id,i.pk&&(e.m_iPk=i.pk),e.m_iId=i.id,e.m_iNum=i.count,e.m_iNum>0&&this.pushItem(e)}console.log("@@@@@@@@@@@@@@@@@@-----------------------------------------packVo: ")}getCountById(t,e=!0){return _.intance.m_dicItems.get(t)==null?0:this.getItemCountById(t,e)}pushItem(t){this.m_dicItemList.set(t.m_iId,t),this.m_dicTypeList.get(t.type)==null&&this.m_dicTypeList.set(t.type,new le),this.m_dicSubTypeList.get(t.subType)==null&&this.m_dicSubTypeList.set(t.subType,new le),this.m_dicBackList.get(t.backType)==null&&this.m_dicBackList.set(t.backType,new le),this.m_dicTypeList.get(t.type).set(t.m_iId,t),this.m_dicSubTypeList.get(t.subType).set(t.m_iId,t),this.m_dicBackList.get(t.backType).set(t.m_iId,t)}removeItem(t){this.m_dicItemList.remove(t.m_iId),this.m_dicTypeList.get(t.type).remove(t.m_iId),this.m_dicSubTypeList.get(t.subType).remove(t.m_iId),this.m_dicBackList.get(t.backType).remove(t.m_iId)}updateData(t,e=!1,i=!0){console.log("updateData: ",t,e,i);let a=[],r=!1,s;for(let o=0;o<t.length;o++){t[o]instanceof Array?(s=new xt,s.id=t[o][0],s.count=t[o][1]):s=t[o];let l=this.m_dicItemList.get(s.id);l==null&&(l=new Ne(s.id),this.pushItem(l),l.m_bNew=!0),e?l.m_iNum=s.count:(l.newAddCnt=s.count,l.m_iNum=l.m_iNum+s.count),a.push(l.m_iId),l.m_iNum<=0&&this.removeItem(l),l.newAddCnt>0&&ut.instance.needPop&&i&&(ut.instance.addItem(l),r=!0)}r&&ut.instance.needPop&&ut.instance.autoPop&&Li.instance.startShow(),a.length>0&&g.intance.event(f.PACKAGE_UPDATE_ITEM,[a])}getItemById(t){return this.m_dicItemList.get(t)}getItemsBySubType(t){let e=this.m_dicSubTypeList.get(t);return e==null&&(e=[]),e}getListByType(t){let e=[];return this.m_dicTypeList.get(t)&&(e=this.m_dicTypeList.get(t).values.slice()),e.sort(this.sortOnQa),e}getBackByType(t){let e=[];return this.m_dicBackList.get(t)&&(e=this.m_dicBackList.get(t).values.slice()),e.sort(this.sortOnQa),e}async getQuan(t){let e=[];var a=(await v.requestPost("wxgame/hero/loserTicketBagList",{type:t},!0,!0)).data;let r;for(let l=0;l<a.length;l++){r=new Ne;var s=a[l];r.m_iId=s.id,s.pk&&(r.m_iPk=s.pk),r.m_iId=s.id,r.m_iNum=s.count,s.extra&&s.extra.prize&&(r.prizeStatus=2),s.extra&&s.extra.expTime?r.expTime=parseFloat(s.extra.expTime):r.expTime=0;var o=b.instance.m_serverTime;o>r.expTime?t==3&&e.push(r):s.extra&&s.extra.onChain?(r.chainStatus=1,t==1&&e.push(r)):t==2&&e.push(r)}return e.sort(this.sortOnExpTime),e}getListBySubType(t){let e=[];return this.m_dicSubTypeList.get(t)&&(e=this.m_dicSubTypeList.get(t).values.slice()),e.sort(this.sortOnQa),e}sortOnQa(t,e){let i=t.itemItem.sort,a=e.itemItem.sort;return i<a?-1:i>a?1:0}sortOnExpTime(t,e){let i=t.expTime,a=e.expTime;return i<a?1:i>a?-1:0}getItemCountById(t,e=!0){let i=this.getItemById(t);return i?i.m_iNum:0}};var pd=class n{constructor(t){this._addNewFList=[];this.delayShowNewFun=!1}static get instance(){return n._instace==null&&(n._instace=new n(new zE)),n._instace}addNewOpenFun(t){this._addNewFList=this._addNewFList.concat(t),this.delayShowNewFun||this.showNewFun()}setDelayShowFun(t){this.delayShowNewFun!=t&&(this.delayShowNewFun=t,t||this.showNewFun())}showNewFun(){if(this._addNewFList.length>0){let t=this._addNewFList.pop(),e=b.instance.systemOpenModel.m_dicSystemInfoCfg.get(t.toString());e?e.if_open.toString()=="1"||e.if_pop.toString()!="1"?this.showNewFun():this.swithToNewFun(t):this.showNewFun()}}swithToNewFun(t,e=!1){let i=b.instance.systemOpenModel.m_dicSystemInfoCfg.get(t);if(i){if(i.if_open.toString()=="1"){E.instance.notice("system_open.json-->funId:"+i.functionID+"is close");return}(i.if_pop.toString()=="1"||e)&&g.intance.event(f.EVENT_OPEN_MODULE,[y.NewFunUnLockDialog,t])}}hasUnlockFunction(t,e=!0){let i=b.instance.systemOpenModel.m_dicSystemInfoCfg.get(t+""),a=b.instance.systemOpenModel.isOpen(parseInt(t));return!a&&e&&E.instance.notice(m.instance.getLanguage(i.lock_word)),a}},zE=class{};var Xn=class{constructor(){}ReadShort(t){let e=new Uint8Array(t.buffer),i=e[t.pos]<<8,a=e[t.pos+1],r=i|a;return t.pos+=2,r}ReadInt(t){let e=new Uint8Array(t.buffer),i=e[t.pos]<<24|e[t.pos+1]<<16|e[t.pos+2]<<8|e[t.pos+3];return t.pos+=4,i}ReadByte(t){return t.getByte()}ReadString(t){let e=this.ReadShort(t);return e==0?"":t.getUTFBytes(e)}ReadBytes(t,e){let i=t.buffer.slice(t.pos,e);return new Laya.Byte(i)}dispose(){}};var hd=class{constructor(){this.writeByt=new Laya.Byte}writeByte(){}writeShort(t){this.writeByt.writeByte(t>>8),this.writeByt.writeByte(t)}writeInt(t){this.writeByt.writeByte(t>>24),this.writeByt.writeByte(t>>16),this.writeByt.writeByte(t>>8),this.writeByt.writeByte(t)}writeString(t){if(t.length==0){this.writeShort(0);return}let i=new Laya.Byte;i.writeUTFBytes(t),this.writeShort(i.length),this.writeByt.writeUTFBytes(t)}dispose(){}};var mo=class n{constructor(){this.cookie="####1.0.0#0#";this.encryptKey="FFIYD#^3LB954JB90fzj*(d)sO7";this._curSendIndex=-1}static get instance(){return n._instance||(n._instance=new n),n._instance}setLoginCookie(){this.cookie="####1.0.0#"+z.Login_UDID+"#"+z.UserAgent}parseCookie(t,e,i,a="1.0.0"){let r=this.encryptKey+e+t,s=x2(r);a=b.instance.M_S_VersionServer;let o=s+"#"+t+"#"+e+"#"+i+"#"+a+"#"+this._curSendIndex+"#1#"+z.Login_UDID+"#"+z.UserAgent;this.cookie=o}reflashCookie(){this.parseCookie(this.m_time,this.m_roleID,this.m_accout)}analyClient(t,e){let i=new hd;i.writeString(this.cookie),i.writeShort(t);let a=this.analyData[t];return a&&a.length>0&&this.writeByt(a,e,i),i.writeByt}writeByt(t,e,i){for(let a in t){let r=e[a];if(t[a].indexOf("7/")!=-1){i.writeShort(r.length);let s=this.analyData[String(t[a]).split("7/")[1]];if(s)for(let o in r)this.writeByt(s,r[o],i)}else if(t[a]=="1")i.writeInt(r);else if(t[a]=="2")i.writeShort(r);else if(t[a]=="3")i.writeString(r);else if(t[a]=="4"||t[a]=="5"||t[a]=="6"){i.writeShort(r.length);for(let s in r)t[a]=="4"?i.writeInt(r[s]):t[a]=="5"?i.writeShort(r[s]):t[a]=="6"&&i.writeString(r[s])}}}analyServer(t){let e=new Xn,i=e.ReadShort(t),a=[i],r=this.analyData[i];return r&&r.length>0&&(a=a.concat(this.readByt(r,t,e))),a}analyCookie(t=""){console.log("RECE_COOKIE: "+t,1);let e=t.split("#");this.m_time=e[0],this.m_roleID=e[1],this.m_accout=e[2];let i=e[3];this._curSendIndex=i,this._curSendIndex++,console.log("cookie:_time:"+this.m_time+"  _roleID："+this.m_roleID+"	  _accout："+this.m_accout),this.parseCookie(this.m_time,this.m_roleID,this.m_accout),b.instance.timeStamp=parseFloat(this.m_time)}readByt(t,e,i){let a=[];for(let r in t)if(t[r].indexOf("7/")!=-1){let s=i.ReadShort(e),o=this.analyData[String(t[r]).split("7/")[1]],l=[];if(o&&s>0)for(let c=0;c<s;c++)l.push(this.readByt(o,e,i));a.push(l)}else if(t[r]=="1")a.push(i.ReadInt(e));else if(t[r]=="2")a.push(i.ReadShort(e));else if(t[r]=="3")a.push(i.ReadString(e));else if(t[r]=="4"||t[r]=="5"||t[r]=="6"){let s=i.ReadShort(e),o=[];for(let l=0;l<s;l++)t[r]=="4"?o.push(i.ReadInt(e)):t[r]=="5"?o.push(i.ReadShort(e)):t[r]=="6"&&o.push(i.ReadString(e));a.push(o)}return a}dispose(){}};function x2(n){throw new Error("Function not implemented.")}var Ue=class Ue{constructor(){this._isSending=!1;this._stopSending=!1;this._sendCmd=0;this._callDataArr=[],this._httpReq=new Laya.HttpRequest,this._httpReq.http.timeout=15e3,this._httpReq.http.ontimeout=this.timeoutFunction,this._httpReq.on(Laya.Event.COMPLETE,this,this.reqCompleteHandler),this._httpReq.on(Laya.Event.ERROR,this,this.reqErrorHandler),this._httpReq.on(Laya.Event.PROGRESS,this,this.reqProcessHandler),Ue.RepeatHandler=Laya.Handler.create(this,this.repeatCallHandler,null,!1)}static get instance(){return Ue._instance||(Ue._instance=new Ue),Ue._instance}repeatCallHandler(){let t=this._callDataArr[0];t&&(t.needReSend?(this._callDataArr.shift(),this._sendByByte(t.command,t.callData,t.isShowLoading,!0)):this._callDataArr.shift())}timeoutFunction(){Ue.ErrorIndex++,this._sendCmd==2,Ue.timeoutTimes<Ue.MaxSendTimes,Ue.timeoutTimes++,Ue._IS_SEND=!1,this._isSending=!1,Ue.ErrorIndex>=Ue.RepeatTimesTimeOut?(de.instance.hideLoading(),Ue.ErrorTips=m.instance.getLanguage(5076),A.intance.openModule(y.ClientErrView)):Ue.RepeatHandler.run()}reqCompleteHandler(t){let e=Laya.Browser.now()-this.m_nSendTime;if(e&&e>Ue.RequestTime?(Ue.reqTimes<Ue.MaxSendTimes,Ue.reqTimes++):(Ue.reqTimes=0,Ue.timeoutTimes=0,Ue.errorTimes=0),console.log("cmd time："+(Laya.Browser.now()-this.m_nSendTime)),this._httpReq.data==null){Ee.instance.showErrByString("_buff:null");return}this._isSending=!1,Ue.ErrorIndex=0;let i=new Laya.Byte(this._httpReq.data),a;if(i){let r=new Xn,s=r.ReadString(i);mo.instance.analyCookie(s);let o=r.ReadByte(i);for(let l=0;l<o;l++){r.ReadByte(i);let c=r.ReadShort(i),u=r.ReadBytes(i,i.pos+c);if(i.pos+=c,u.length<2)continue;u.pos=0;let p=r.ReadBytes(u,u.length);p.pos=0;let d=new Uint8Array(p.buffer),L=new Uint8Array(I2(d)),x=new Laya.Byte(L.buffer);x.pos=0;let w=mo.instance.analyServer(x);Laya.LayaEnv.isConch?console.log("REVC_CMD: cmdID:"+w[0]+" data:"+w,1):console.log(Le.GetLogTime+" REVC_CMD: cmdID:",w[0],w),w[0]==153&&console.log("......"),w[0]==27&&(w[1]==2e4||w[1]==20042)&&(a=!0),g.intance.event("msg_"+w.shift(),[w])}o==0&&console.log("REVC_DATA: NO_DATA",1)}if(this._callDataArr.length>0){let r=this._callDataArr.shift();a&&r&&r.callBackHandler!=null&&r.callBackHandler.run()}Ue._IS_SEND=!1,this._callDataArr.length>0?Ue.RepeatHandler.run():de.instance.hideLoading()}reqErrorHandler(t){console.log("[error] HttpNetService reqError: ["+t+"]",1),Ue.errorTimes<Ue.MaxSendTimes&&this._sendCmd==2,Ue.errorTimes++,de.instance.showLoadingByInfo(m.instance.getLanguage(5205)),Ue.ErrorIndex++,Ue._IS_SEND=!1,this._isSending=!1,Ue.ErrorIndex>=Ue.RepeatTimes?(de.instance.hideLoading(),Ue.ErrorTips=m.instance.getLanguage(5075),A.intance.openModule(y.ClientErrView),this._callDataArr.length=0):Laya.timer.once(1e3,this,function(){Ue.RepeatHandler.run()})}reqProcessHandler(t){}DataToService(t){Laya.LayaEnv.isConch?this._httpReq.send(z.server,t.buffer,"post","arraybuffer",["Content-Type","application/x-www-form-urlencoded","Connection","close"]):this._httpReq.send(z.server,t.buffer,"post","arraybuffer",["Content-Type","application/x-www-form-urlencoded"])}SendData(t,e,i=null,a=!0,r=!0){this._stopSending||(this.m_nSendTime=Laya.Browser.now(),Ue.ErrorIndex=0,r&&this._callDataArr.push({command:t,callData:e,callBackHandler:i,isShowLoading:a,needReSend:r}),this._sendByByte(t,e,a,!1))}_sendByByte(t,e,i=!0,a=!1){this._sendCmd=t,this._sendCmd==2,lt.instance.sendData({cmd:t,code:"",data:e})}reSendData(){this._callDataArr.length>0&&Ue.RepeatHandler.run()}sendOutHandler(){Laya.timer.clear(this,this.sendOutHandler),this._isSending&&(this._isSending=!1,Ue.ErrorIndex>=Ue.RepeatTimes?(de.instance.hideLoading(),Ue.ErrorTips="Client Error!",A.intance.openModule(y.ClientErrView),this._callDataArr.length=0):Ue.RepeatHandler.run())}EnCodeByte(t){t.pos=0;let i=new Xn().ReadBytes(t,t.length);i.pos=0;let a=new Laya.Byte,r=0,s,o=0;for(let l=0;l<i.length;l++)r>=6?r=1:r+=1,s=i.getByte(),o=s,s>>=8-r,o<<=r,o|=s,o^=3,a.writeByte(o);return a}DecryptByte(t){t.pos=0;let i=new Xn().ReadBytes(t,t.length);i.pos=0;let a=new Laya.Byte,r=0,s,o=new Uint8Array(i.buffer);for(let l=0;l<o.length;l++)r>=6?r=1:r+=1,s=o[l],s^=3,s<<=8-r,o[l]^=3,o[l]>>=r,o[l]|=s;return a=new Laya.Byte(o.buffer),a}init(){}HttpLoadProcess(t){}httpLoadComplete(t){mo.instance.analyData=t}dispose(){}set stopSending(t){this._stopSending=t}};Ue._IS_SEND=!1,Ue.ErrorIndex=0,Ue.RepeatTimes=8,Ue.RepeatTimesTimeOut=3,Ue.ErrorTips="",Ue.LoginTime=5e3,Ue.RequestTime=4e3,Ue.MaxSendTimes=5,Ue.reqTimes=0,Ue.timeoutTimes=0,Ue.errorTimes=0;var sn=Ue;function I2(n){throw new Error("Function not implemented.")}var ii=class extends Laya.Event{constructor(){super()}};ii.INIT_SUIT_EVENT="HeroEvent:INIT_SUIT_EVENT",ii.EVENT_FIND_ITEM_CLICK="HeroEvent:EVENT_FIND_ITEM_CLICK",ii.EVENT_RELEASE_ITEM_CLICK="HeroEvent:EVENT_RELEASE_ITEM_CLICK",ii.EVENT_FINISH="HeroEvent:EVENT_FINISH",ii.EVENT_START="HeroEvent:EVENT_START",ii.EVENT_AGAIN="HeroEvent:EVENT_AGAIN",ii.EVENT_ENABLE_TIJIAO="HeroEvent:EVENT_ENABLE_TIJIAO",ii.EVENT_HUMANSTAY="HeroEvent:EVENT_HUMANSTAY",ii.EVENT_STOPGAME="HeroEvent:EVENT_STOPGAME",ii.EVENT_RESTORE="HeroEvent:EVENT_RESTORE",ii.EVENT_CANCEL_RESTORE="HeroEvent:EVENT_CANCEL_RESTORE",ii.EVENT_COLLISIONENTER="HeroEvent:EVENT_COLLISIONENTER",ii.EVENT_HERO_DRAW_UPDATE_PRODUCTION="HeroEvent:EVENT_HERO_DRAW_UPDATE_PRODUCTION",ii.SELECT_UI="HeroEvent:SELECT_UI";var dd=class extends me{constructor(){super()}};var fd=class extends me{constructor(){super()}};var ze=class n{constructor(){this._inited=!1;this._initUpgrade=!1;this.heroList=[];this.init()}static get instance(){return n._instance||(n._instance=new n),n._instance}init(){this._inited||(this._inited=!0)}initUpgrade(){if(!this._initUpgrade){let t=_.intance;t.m_dicHeroLv||(t.m_dicHeroLv=t.initConfig("hero_lv",["hero_lv","hero_star","race"],fd)),t.m_dicHeroAttup||(t.m_dicHeroAttup=t.initConfig("hero_attup",["star_lv","race"],dd)),this._initUpgrade=!0}}getHead(t){let e=Math.floor(Math.random()*3)+1;return"common/common_icon/img_"+t+"_"+e+".png"}getNextHero(t){let e=b.instance.m_heroData.heroVoDic.keys.indexOf(t.pk);return b.instance.m_heroData.heroVoDic.keys.length===1?null:e<=b.instance.m_heroData.heroVoDic.keys.length-2?b.instance.m_heroData.heroVoDic.values[e+1]:null}getLastHero(t){let e=b.instance.m_heroData.heroVoDic.keys.indexOf(t.pk);return e>0?b.instance.m_heroData.heroVoDic.values[e-1]:null}setStar(t,e,i=1){let a=parseInt(e);var r=Math.floor(a/6),s=a%6,o=r+s;let l=0,c=i<2?"img_star":"img_star_";for(let L=0;L<r;L++)t[c+(L+1)].skin="gameIcon/hero/heroDetail/img_star_2.png",t[c+(L+1)].visible=!0;for(let L=r;L<s;L++)t[c+(L+1)].skin="gameIcon/hero/heroDetail/img_star_1.png",t[c+(L+1)].visible=!0;for(let L=o;L<5;L++)t[c+(L+1)].visible=!1;let p=(i<2?t.box_star:t[`box_star${i}`]).width,d=46;o==1?t[c+1].x=p/2-l:o==2?(t[c+1].x=p/2-d/2-l,t[c+2].x=p/2+d/2-l):o==3?(t[c+1].x=p/2-l,t[c+2].x=p/2-d-l,t[c+3].x=p/2+d-l):o==4?(t[c+1].x=p/2-d/2-l,t[c+2].x=p/2+d/2-l,t[c+3].x=p/2-d*(1/2+1)-l,t[c+4].x=p/2+d*(1/2+1)-l):(t[c+1].x=p/2-l,t[c+2].x=p/2-d-l,t[c+3].x=p/2+d-l,t[c+4].x=p/2-d*2-l,t[c+5].x=p/2+d*2-l)}setStar2(t,e){let i=parseInt(e);for(let a=1;a<6;a++)a<=i?t["img_star"+a].skin="gameIcon/hero/heroDetail/img_star_1.png":t["img_star"+a].skin="gameIcon/hero/heroDetail/img_star_0.png",t["img_star"+a].visible=!0}getRoundName(t){let e=m.instance.getLanguage(10014,16,8);return t==4?e=m.instance.getLanguage(10014,2,1):t==3?e=m.instance.getLanguage(10014,4,2):t==2&&(e=m.instance.getLanguage(10014,8,4)),e}setHeroVoByHeroDto(t,e){t.id=e.id,t.lv=e.lv,t.pk=e.pk,t.color=e.color,t.state=e.state,t.newFightFlag=e.newFightFlag}};var yd=class{};var bd=class{};var Et=class n{constructor(){this.mail_contract=null}static get instance(){return n._instance||(n._instance=new n),n._instance}init(){typeof window.ethereum>"u"||(this.mail_contract=new window.web3.eth.Contract(J.BLINDBOX_ABI,J.BLINDBOX_ADDRESS))}async initData(){this.mailList=new le,de.instance.showLoading(!0);let t=await this.mail_contract.methods.getPricesLength().call();for(let e=0;e<t;e++){let i=await this.mail_contract.methods.getPriceByIndex(e).call(),a=new yd;a.type=1,a.idx=e,Object.assign(a,i),this.mailList.set(a.idx,a),a.showPrice=ao(a.currentPrice+"")}de.instance.hideLoading()}async hasFree(){return await this.mail_contract.methods.getIsFreeOpen().call()?!await this.mail_contract.methods.hasFreeHero(F.instance.walletAddress).call():!1}async recruit(t){console.log("成功",66),console.log("失败",66),de.instance.showLoading(!0);let e=_.intance.m_dicShops.get(t),i=e.cost[0];try{var a;z.vType==2?a=zn.id:z.vType==1?a=zn.id:a=Ra.id;let c=_.intance.getBuyHeroAddress(a),u=await F.instance.walletClient.getChainId();if(a!==u){var r=await F.instance.switchChain(a);if(!r){this.onEndHeroBuy(),console.log("切换失败，请手动切换");return}u=await F.instance.walletClient.getChainId()}let p=_.intance.getCurrencyAddress(3001);if(!p)return this.onEndHeroBuy(),E.instance.notice(m.instance.getLanguage(1177,u)),!1;if(!c)return this.onEndHeroBuy(),E.instance.notice(m.instance.getLanguage(1174,u)),!1;let d=e.cost[1],L=await F.instance.getBalance2(p),x=ao(d+"");if(parseFloat(L)<parseFloat(x)){this.onEndHeroBuy(),Le.moneyNotEnought(i);return}if(console.log("判断授权 tokenAddress: "+p+", chainIDData:"+a),!await F.instance.newAllowanceAddress(c,p))return console.log("未授权"),this.onEndHeroBuy(),E.instance.notice(m.instance.getLanguage(15)),de.instance.hideLoading(),!1;console.log("授权成功 开始购买");var s=await F.instance.walletClient.writeContract({account:F.instance.walletAddress,address:c,abi:J.BUY_HERO_ABI,functionName:"mintByTOX",args:[]});console.log("============"+s);let I=await F.instance.publicClient.waitForTransactionReceipt({hash:s});return console.log(`Tx with hash: ${s}`,I),I&&I.status=="success"?(console.log(`Tx successful with hash: ${s}`),s):(this.onEndHeroBuy(),Le.TransactionErrorTip(),!1)}catch(c){this.onEndHeroBuy();var o=c.shortMessage;if(o&&o.indexOf("does not match")!=-1){var l=F.instance.getChainName(a);o=m.instance.getLanguage(1172,l)}if(console.log(o),c instanceof K){let u=c.walk(p=>p instanceof vt);if(u instanceof vt){let p=u.data?.errorName??"";console.log("============errorName: "+p)}}return null}}waitGetHero(){Laya.timer.loop(2e3,this,this.getHero)}async getHero(){var t=await v.requestPost("wxgame/hero/heroBuyChainCheck",{}).catch(e=>{});t&&t.heroList&&t.heroList.length>0&&(Laya.timer.clear(this,this.getHero),this.onNewAddHero(t.heroList))}onNewAddHero(t){ut.instance.autoPop=!1,b.instance.herosDataUpdataHandler(t),this.onEndHeroBuy()}onAddHero(t){ut.instance.autoPop=!1,b.instance.herosDataUpdataHandler(t.reward),t.resChange&&b.instance.moneyInfoHander(t.resChange),t.fightHeroPk&&(b.instance.playerDto.fightHeroPk=t.fightHeroPk),this.onEndHeroBuy()}onEndHeroBuy(){de.instance.hideLoading(),g.intance.event(f.EVENT_END_HEROBUY)}async recruit1(t){let e=_.intance.m_dicShops.get(t),i=e.cost[1],a=await F.instance.getBalance(),r=await v.requestPost("wxgame/hero/heroBuy",{shopId:e.id},!0,!0);r?this.onAddHero(r):this.onEndHeroBuy()}async recruitFree(){de.instance.showLoading(!0),this.isOpen=await this.mail_contract.methods.getIsOpen().call();let t=await this.hasFree();if(!this.isOpen){de.instance.hideLoading(),g.intance.event(f.EVENT_HERO_DRAW_BACK,[m.instance.getLanguage(12)]);return}if(!t){g.intance.event(f.EVENT_HERO_DRAW_BACK,[m.instance.getLanguage(17)]);return}await this.mail_contract.methods.recruitFree().send({from:F.instance.walletAddress},(e,i)=>{if(e){de.instance.hideLoading(),g.intance.event(f.EVENT_HERO_DRAW_BACK,[m.instance.getLanguage(16)]);return}})}async ownerHero(t=!1){let e=await v.requestPost("wxgame/hero/heroList",{},!0,!0);b.instance.m_heroData.initData(e.heroList,t),console.log("HERO LIST")}async ownerBag(){let t=await v.requestPost("wxgame/hero/bagList",{},!0,!0);b.instance.m_packageData.initData(t.data),console.log("BAG LIST")}async heroOutputRate(){if(ze.instance.heroOutputRateDic)return;let t=await v.requestPost("cybertron-sys-api/api/v1/heroes/heroOutputRate",{},!0);ze.instance.heroOutputRateDic=new le;for(let e of t){let i=new bd;Object.assign(i,e),ze.instance.heroOutputRateDic.set(i.mineralLevel,i)}console.log("HERO heroOutputRate"),g.intance.event(ii.EVENT_HERO_DRAW_UPDATE_PRODUCTION)}makeHeroVo(t){let e=new Ht;return Object.assign(e,t),e}};var et=class et{constructor(){}};et.DEFAULT_HERO_ID=11000010003,et.DEFAULT_HERO_COLOR=1,et.TYPE_Professional=1,et.TYPE_Training=2,et.ANI_beiji="beiji",et.ANI_daiji="daiji",et.ANI_gongji="gongji",et.ANI_ti="ti",et.ANI_hua="hua",et.ANI_dang="gedang",et.ANI_dazhao="z_dazhao",et.ANI_ruchang="ruchang",et.ANI_siwang="siwang",et.ANI_xingzou="xingzou",et.ANI_chongzhuang="z_chongzhuang",et.ANI_chongzhuang2="z_chongzhuang2",et.ANI_daodi="z_daodi",et.ANI_shanbi="z_shanbi",et.ANIS=[et.ANI_daiji,et.ANI_xingzou,et.ANI_gongji,et.ANI_ti,et.ANI_hua,et.ANI_dang,et.ANI_beiji,et.ANI_siwang],et.TYPE_GONGJI=1,et.TYPE_TI=2,et.TYPE_HUA=3,et.TYPE_DANG=4,et.TYPE_FEI=5,et.TYPE_DAZHAO=6,et.TYPE_HUOJIANDAN=7;var Je=et;var gd=class{constructor(){this.heroVoDic=new le}initData(t,e=!1){(!this.heroVoDic||e)&&(this.heroVoDic=new le);let i;for(let r=0;r<t.length;r++){i=new Ht;var a=t[r];ze.instance.setHeroVoByHeroDto(i,a),this.pushItem(i)}console.log("@@@@@@@@@@@@@@@@@@-----------------------------------------packVo: ")}updateData(t){console.dir("更新英雄："+t),this.updataItemVoByArr(t)}herosDataRemoveHandler(t){console.dir("删除英雄："+t);for(let i=0;i<t.length;i++){var e=t[i];this.removeItemPk(e)}}pushItem(t){this.heroVoDic.set(t.pk,t)}removeItem(t){this.removeItemPk(t.pk)}removeItemPk(t){this.heroVoDic.remove(t+"")}updataItemVoByArr(t,e=!1){let i=[],a=!1,r;for(let s=0;s<t.length;s++){r=t[s];let o=this.heroVoDic.get(r.pk);o==null?(o=new Ht,ze.instance.setHeroVoByHeroDto(o,r),o.m_bNew=!0,o.newAddCnt=1,o.newAddCnt>0&&this.pushItem(o)):o.newAddCnt=1,o.isLvUp=e,i.push(o.pk),o.m_iNum<=0&&this.removeItem(o),o.newAddCnt>0&&ut.instance.needPop&&(ut.instance.addHeroItem(o),a=!0)}a&&ut.instance.needPop&&ut.instance.autoPop&&Li.instance.startShow(),i.length>0&&g.intance.event(f.PACKAGE_UPDATE_ITEM,[i])}getItemById(t){return this.heroVoDic.get(t)}getCount(){return this.heroVoDic.values.length}getCanTransferHero(t){let e=this.heroVoDic.get(t+"");return e&&e.state==0&&e.pk!=b.instance.playerDto.fightHeroPk?e:null}getListByType(t){let e=[],i=t==Je.TYPE_Training?1:0;for(let a=0;a<this.heroVoDic.values.length;a++){let r=this.heroVoDic.values[a];r.newFightFlag==i&&e.push(r)}return e}};var Ld=class{constructor(){this.m_redData={system:!1,friend:!1,announce:!1};this.m_dicItemList=new le,this.m_dicTypeList=new le}initData(t){this.m_dicItemList=new le,this.m_dicTypeList=new le,this.m_redData={system:!1,friend:!1,announce:!1};let e;for(let i=0;i<t.length;i++)switch(e=t[i],this.pushItem(e),e.type){case 1:e.state==0&&(this.m_redData.system=!0);break;case 2:e.state==0&&(this.m_redData.friend=!0);break;case 3:e.state==0&&(this.m_redData.announce=!0);break}console.log("@@@@@@@@@@@@@@@@@@-----------------------------------------packVo: ")}parseItem(t){if(t.mailId>0){var e=_.intance.m_dicMail.get(t.mailId);t.title=m.instance.getLanguage(e.title),t.content=m.instance.getLanguageMulti(e.text,t.params)}}pushItem(t){this.parseItem(t),this.m_dicItemList.set(t.id,t),this.m_dicTypeList.get(t.type)==null&&this.m_dicTypeList.set(t.type,new le),this.m_dicTypeList.get(t.type).set(t.id,t)}removeItem(t){this.m_dicItemList.remove(t.id),this.m_dicTypeList.get(t.type).remove(t.id)}getItemById(t){return this.m_dicItemList.get(t)}getListByType(t){let e=[];return this.m_dicTypeList.get(t)&&(e=this.m_dicTypeList.get(t).values.slice()),e}getRedData(){return this.m_redData}};var b=class n{constructor(){this.timeZoneOff=0;this.hearIntervalSceond=10*60;this._timeStamp=0;this._m_strLanguage=1;this.isLanChanged=!1;this.pveOpen=2;this.lastTimestamp=0;this._m_serverTime=0;this.M_S_VersionServer="1.0.0";this.redDotData=[];this.friendNum=0;this.headId=10001;this.countryId=1010;this.colorId=1;this._guildIcon=2006;this.rechargeEnd=!1;this.needPopError=!0}async initData(){He.instance.sendCustumEvent(20),await Et.instance.ownerHero(),await Et.instance.ownerBag(),He.instance.sendCustumEvent(21)}get m_serverTime(){let t=Date.now();return this._m_serverTime+(t-this.lastTimestamp)}set m_serverTime(t){this._m_serverTime=t,this.lastTimestamp=Date.now()}get guildIcon(){return this._guildIcon}set guildIcon(t){console.log("guildIcon: "+t),this._guildIcon=t}get m_strLanguage(){return this._m_strLanguage}set m_strLanguage(t){this._m_strLanguage=t}static get instance(){return n._instance||(n._instance=new n),n._instance}init(){this.vipInfo=new ud,this.m_packageData=new md,this.m_mailData=new Ld,this.m_heroData=new gd,this.systemOpenModel=new cd,this.m_dicCustomerVo=new le,g.intance.on("msg_27",this,this.commonErrHandler),g.intance.on("msg_11",this,this.vipInfoHandler),g.intance.on("msg_13",this,this.onVipUpgrade),g.intance.on("msg_90",this,this.initSystemOpen),g.intance.on("msg_161",this,this.reciveTurnoverVo),g.intance.on("msg_333",this,this.onInitSceneBg),g.intance.on("msg_350",this,this.onInitStoreDiscount),g.intance.on("msg_388",this,this.onInitTitle),g.intance.on("msg_1002",this,this.onLanChange)}initSend(){}onLanChange(t){let e=parseInt(t[0]),i=parseInt(t[1]);switch(e){case 1:i==1&&He.instance.reload();break;case 2:break}}get timeStamp(){return this._timeStamp+(Laya.Browser.now()-this.recordStampTime)/1e3}set timeStamp(t){this.recordStampTime=Laya.Browser.now(),this._timeStamp=t}onReciveBuyTimes(t){n.instance.playerDto.updateRoleBuyTimes(t)}reciveTurnoverVo(t){}onInitSceneBg(t){}onInitTitle(t){}getAdRankById(t){return this.m_adRankDic&&this.m_adRankDic.get(t)?this.m_adRankDic.get(t):""}onGetPvpGrade(t){let e=t[0]}onInitStoreDiscount(t){}reciveBuyCustomerMsg(t){}onInitStyleAndTag(t){let e=t[0];for(let i=0;i<e.length;i++){let a=e[i],r=a[0],s=a[1],o=a[2]}}reciveFriendList(t){}reciveFirstRecharge(t){}hasReceiveFirst(){return this.firstRechargeState.toString()=="3"}recieveOnlineAward(t){}initFriendsGiftHandler(t){}initSystemOpen(t){this.systemOpenModel.initSystemOpen(t[0])}updateSystemOpen(t){let e=t[0];pd.instance.addNewOpenFun(e);for(let i=0;i<e.length;i++)this.systemOpenModel.openSystem.set(e[i],!0)}serverTimeUpdateHandler(){let t=this.hearIntervalSceond*1e3;Laya.timer.loop(t,this,this.onHear)}onHear(){}itemsDataUpdataHandler(t,e,i){this.m_packageData.updateData(t,e,i),g.intance.event(f.EVENT_ITEM_UPDATE)}herosDataUpdataHandler(t){this.m_heroData.updateData(t)}vipInfoHandler(t){this.vipInfo.trecharge=t[1],this.vipInfo.isRewards=t[2],this.vipInfo.daygift=t[3]}onVipUpgrade(t){}getConsumeValue(t){t=parseInt(t.toString());var e=this.playerDto.coins[t];return e>0?e:0}hasEnoughMoney(t,e,i=!0){switch(t=parseInt(t.toString()),e=parseInt(e.toString()),t){default:return this.playerDto.coins[t]<e&&i&&g.intance.event("open_buy",4),this.playerDto.coins[t]>=e}}moneyInfoHander(t,e=!0,i=!0){let a=!1,r=!1,s=0;for(let o of t)r=!1,o[0]==ge.TYPE_EXP?(s=parseInt(o[1]+"")-this.playerDto.exp,this.playerDto.exp=parseInt(o[1]+""),r=s>0):(s=parseFloat(o[1]+"")-this.playerDto.coins[o[0]],this.playerDto.coins[o[0]]=parseFloat(o[1]+""),r=s>0),r&&ut.instance.needPop&&i&&(a=!0,ut.instance.addConsumeByServer([o[0],s]));e&&g.intance.event(f.ROLE_INFO_CHANGE),a&&ut.instance.autoPop&&Li.instance.startShow()}commonErrHandler(t){if(de.instance.hideLoading(),parseInt(t[0])==2e4){this.needPopError&&(Ee.instance.showErrorWord(parseInt(t[0])),g.intance.event(f.RECIVE_SUCESS_SERVICE));return}else if(parseInt(t[0])==20008){g.intance.event("open_buy",1);return}else if(parseInt(t[0])==20007){g.intance.event("open_buy",2);return}else if(parseInt(t[0])==20015){g.intance.event("open_buy",3);return}else if(parseInt(t[0])==20016){g.intance.event("open_buy",4);return}else if(parseInt(t[0])==10021){sn.ErrorTips=Ee.instance.get(10021),A.intance.openModule(y.ClientErrView);return}else if(parseInt(t[0])==10023){sn.ErrorTips=Ee.instance.get(10023),A.intance.openModule(y.ClientErrView);return}else if(parseInt(t[0])==10019){sn.ErrorTips=Ee.instance.get(10019),A.intance.openModule(y.ClientErrView);return}else if(parseInt(t[0])!=20053){if(parseInt(t[0])==10002){sn.ErrorTips=m.instance.getLanguage(5085),A.intance.openModule(y.ClientErrView);return}}Ee.instance.showErrorWord(parseInt(t[0])),console.log("Server Error Code:"+t[0])}dispose(){}parseNumber(t){let e=[];for(let i=0;i<t.length;i++){let a=t[i];a=this.dividedNumber(a),e.push(a.toString())}return e}dividedNumber(t){return t/1e4}getRedDotById(t){return!!(this.redDotData&&this.redDotData.indexOf(t)>-1)}openWheelDialog(){let t=Laya.Handler.create(this,()=>{oe.intance.setCurrentScene(Y.M_SCENE_DAILY_TASK)});pe.instance().AlertByType(P.BASEALERTVIEW,m.instance.getLanguage(1772),P.CANCEL,t)}refreshRedDotShow(){for(let t=0;t<this.redDotData.length;t++)switch(this.redDotData[t]){case 7:case 8:case 9:g.intance.event(f.REFRESH_MAINSCENE_HEAD_RED),g.intance.event(f.REFRESH_ROLEINFO_RED),g.intance.event(f.REFRESH_ACTIVITY_RED);break;case 11:case 12:case 13:case 14:case 15:case 16:case 17:case 18:case 19:case 20:case 21:case 22:g.intance.event(f.REFRESH_ACTIVITY_RED);break;case 23:g.intance.event(f.REFRESH_MAIL_RED);break;case 26:g.intance.event(f.REFRESH_WHEEL_RED);break}}};var Yi=class{constructor(){}};Yi.Lan_en=1,Yi.Lan_zh=6,Yi.Lan_tr=7;var m=class n{constructor(){this._lanTypesById=new le,this._lanTypesByType=new le,this._configData=new le,this._configData1=new le}static get instance(){return n._instance||(n._instance=new n),n._instance}initLanTypes(t){this._lanTypesById=new le,this._lanTypesByType=new le;for(let e in t){let i=new To;if(i.init(t[e]),parseInt(i.if_open)!=1)continue;let a=i.id,r=i.type;this._lanTypesById.set(a,i),r&&r!=""&&this._lanTypesByType.set(r,i)}}getLanTypes(){return this._lanTypesById}getLanIdByType(t){if(this._lanTypesByType){let e=this._lanTypesByType.get(t);if(e)return parseInt(e.id.toString())}return 1}getLanTypeById(t){if(this._lanTypesById){let e=this._lanTypesById.get(t);if(e)return e.type}return"en"}initConfigLan(t){this._configData=t}initConfigLan1(t){this._configData1=t}initUILan(t){Laya.Text.langPacks={};let e;for(e in t){let i=t[e].value;Laya.Text.langPacks[e]=i}}changeBrToN(t){let e=/<br>/g;for(;t.indexOf("<br>")!=-1;)t=t.replace(e,`
`);return t}replacePlaceholder(t,e){if(t=="")return"";let i=/{(\d+)}/g;return e.length>0&&(t=t.replace(i,function(){return e[arguments[1]]})),this.replaceLanByBR(t)}replaceLanByBR(t){return t+""}getEnglishLanguage(t,...e){return this.getEnglishLanguageReplace(t,e)}getEnglishLanguageReplace(t,e){if(this._configData1&&this._configData1[t]){let i=this._configData1[t].value;if(i&&i!="")return this.replacePlaceholder(i,e)}return this.replacePlaceholder(t+"",e)}getLanguage(t,...e){return this.getLanguageReplace(t,e)}getLanguageReplace(t,e){if(this._configData&&this._configData[t]){let i=this._configData[t].value;if(i&&i!="")return this.replacePlaceholder(i,e)}return this.replacePlaceholder(t+"",e)}getLanguageMulti(t,e){if(console.log("getLanguageMulti",e),this._configData&&this._configData[t]){let i=this._configData[t].value;if(i&&i!="")return this.replacePlaceholderMulti(i,e)}return this.replacePlaceholder(t+"",e)}replacePlaceholderMulti(t,e){if(t=="")return"";let i=/{(\d+)}/g;return e.length>0&&(t=t.replace(i,function(){var a=e[arguments[1]];if(typeof a=="object")a=JSON.parse(a),a=n.instance.parseObj(a);else if(typeof a=="string")try{a=JSON.parse(a),typeof a=="object"&&(a=n.instance.parseObj(a))}catch{}return a})),this.replaceLanByBR(t)}parseObj(t){if(t.hasOwnProperty("tableType")){if(t.tableType==1){var e=_.intance.m_dicItems.get(t.id);e&&(t=n.instance.getLanguage(e.name))}else if(t.tableType==2){var i=_.intance.m_dicArenaDic.get(t.id);i&&(t=n.instance.getLanguage(i.name))}}else t=n.instance.getMultiLan(t);return t}getUILang(t,e=null,i=null,a=null,r=null){if(t=Laya.Text.langPacks&&Laya.Text.langPacks[t]?Laya.Text.langPacks[t]:t,arguments.length>1)for(let s=0,o=arguments.length;s<o;s++)t=t.replace("{"+s+"}",arguments[s+1]);return t}getMultiLan(t){var e=parseInt(b.instance.m_strLanguage.toString()),i;return t&&(i=t[e],i||(i=t[Yi.Lan_en])),i}FGM_GetLanguage(){let t=function(i){console.log("initGame->-----------------------------FGM_GetLanguage:=="+i),i&&(i=i.substring(0,2),z.User_Lan=i)},e=Laya.LocalStorage.getItem(z.COOKIE_CF_LAN);!e||e==""?t(this.language):t(e)}get language(){return"en"}FGM_SetLanguage(t){t&&t!=""&&Laya.LocalStorage.setItem(z.COOKIE_CF_LAN,t)}dispose(){}};var _d=class n{constructor(){this.m_sprMap=new Laya.Sprite;this.m_Image=new Laya.Image}static get instance(){return n._instance||(n._instance=new n),n._instance}init(){}showLoading(t=!1){if(this.loadingMc)this.m_sprMap.size(Laya.stage.width,Laya.stage.height),z.m_bIsIphoneX&&(this.m_Image.scaleX=z.IPHONEX_SCARE,this.m_Image.scaleY=z.IPHONEX_SCARE),this.m_Image.x=(this.m_sprMap.width-this.m_Image.width*this.m_Image.scaleX)/2,this.m_Image.y=(this.m_sprMap.height-this.m_Image.height*this.m_Image.scaleY)/2,this.m_sprMap.x=(C.instence.m_iStageWidth-this.m_sprMap.width*this.m_sprMap.scaleX)/2,this.m_sprMap.y=(C.instence.m_iStageHeight-this.m_sprMap.height*this.m_sprMap.scaleY)/2,this.m_sprMap.visible=!0,Laya.timer.clear(this,this.showLazyBg),t?(this.m_Image.alpha=1,this.showLazyBg()):(this.m_Image.alpha=0,this.m_sprMap&&(this.m_sprMap.graphics.clear(),this.m_sprMap.graphics.drawRect(0,0,Laya.stage.width,Laya.stage.height,"#000000")),Laya.timer.once(300,this,this.showLazyBg));else return}showLazyBg(){this.m_sprMap&&(this.m_sprMap.graphics.clear(),this.m_Image.alpha=1),this.loadingMc&&(this.loadingMc.x=Laya.stage.width/2,this.loadingMc.y=Laya.stage.height/2,this.loadingMc.play(),this.loadingMc.visible=!0)}hideLoading(){if(this.loadingMc)this.hideLoadingSHow();else return}hideLoadingSHow(){Laya.timer.clear(this,this.showLazyBg),this.loadingMc.stop(),this.loadingMc.visible=!1,this.m_sprMap.visible=!1}get isShow(){return this.loadingMc&&this.loadingMc.visible}dispose(){this.m_sprMap&&this.m_sprMap.graphics.clear(),Laya.timer.clear(this,this.showLazyBg),this.loadingMc&&(this.loadingMc.destroy(),this.loadingMc.removeSelf(),this.loadingMc=null)}};var{regClass:E2}=Laya,po=class extends nu{constructor(){super(...arguments);this.isLogout=!1;this.dotNum=0;this.m_nProgress=0}onAwake(){Laya.loader.on(Laya.Event.ERROR,this,this.onError),Laya.loader.load(["res/common/comm_bg/img_loading1_bg.jpg","res/loading/progress_load1.png","res/loading/progress_load1$bar.png"]).then(()=>{this.createUI(),this.init()})}onError(e){console.log("加载失败: "+e)}createUI(){this.m_nSendTime=Laya.timer.currTimer,Xe.instance.init(),Xe.instance.playMusicByName(Xe.soundName_bg,".mp3"),g.intance.on(f.EVENT_BACK_TO_LOGIN,this,this.backToLogin),g.intance.on(f.EVENT_LOGIN_GAME_END,this,this.loginGameEnd),g.intance.on(f.EVENT_ENTER_MAIN,this,this.loginCallBack),this.initLoad(),m.instance.FGM_GetLanguage();let e=z.User_Lan;var i=getGameVersion();this.txtLoad.text=i,console.log("VERSION: "+i);let a=new Ka;a.ID=1,a.Event="加载版本信息 "+i,He.instance.sendCustumEvent(1,null,a),$t.Initialize(Laya.stage,!0)}initLoad(){this.onAssetLoaded()}onAssetLoaded(){this.loadingProcess=0,this.m_nProgress=0,Laya.timer.loop(1800,this,this.onLoading,[this.m_nProgress])}set loadingProcess(e){e>1&&(e=1),this.mcProcess.value=e,this.txtProcess.text=Math.floor(e*100)+"%";var i=e*this.mcProcess.width-70;i<0&&(i=0),this.img_guang.x=i}init(){C.instence.init(),oe.intance.init(),_d.instance.init(),A.intance.init(),b.instance.init();let e=new Ka;e.ID=3,e.Event="加载资源信息",He.instance.sendCustumEvent(3,null,e),S.instance.init(),te.initParms()}backToLogin(){Laya.timer.clear(this,this.onLoading),this.m_nProgress=0,Laya.loader.load(S.instance.m_arrInitResource,Laya.Handler.create(this,this.getLoginData),Laya.Handler.create(this,this.onLoading2,null,!1))}getLoginData(){He.instance.sendCustumEvent(7),this.readyInitGame()}readyInitGame(){if(this.isLogout){g.intance.event(f.EVENT_LOADING_SUC);return}this.mcProcess&&(this.loadingProcess=.8+.2),z.isWhite?this.loginGame():this.onGetNotice()}async onGetNotice(){Laya.loader.maxLoader=50,v.requestPost("wxgame/sys/notice",{type:1},!1,!1).then(e=>{var i=e;if(i.list&&i.list.length>0){A.intance.openModule(y.NoticeDialog,[1,i]);return}this.loginGame()}).catch(e=>{A.intance.openModule(y.NoServerView)})}async loginGame(){g.intance.event(f.EVENT_LOADED_COMPLETE),await F.instance.init(),await F.instance.dappLogin()}async loginGameEnd(e){de.instance.showLoading(!0),He.instance.sendCustumEvent(8),_.intance.init(),sn.instance.init(),console.log("PreLoadingView.joinGame()");let i=Laya.timer.currTimer-this.m_nSendTime;if(He.instance.sendCustumEvent(22),!e){A.intance.openModule(y.NoServerView);return}e.loginState==1?(console.log("have no regist"),He.instance.sendCustumEvent(23),A.intance.openModule(y.CreateLoginView)):(He.instance.sendCustumEvent(30),e.playerDto?(He.instance.sendCustumEvent(31),console.log("registed "+e.playerDto.name),b.instance.playerDto=e.playerDto,this.loginCallBack()):(He.instance.sendCustumEvent(32),console.log("getRegisted error"),E.instance.notice(m.instance.getLanguage(135))))}async loginCallBack(){console.log("loginCallBack++++++++++++++++++++++++++++++++"),z.vType==2&&z.Debug==0&&(Laya.Browser.window.console.log=function(){}),b.instance.initData(),de.instance.hideLoading();var e=b.instance.playerDto;if(e.roomId>0){let i=await v.requestPost("wxgame/room/info",{roomId:e.roomId});B.instance.roomDto=i.roomDto,i.roomDto?e.roomState==10?lt.instance.initSocket():A.intance.openModule(y.EnterRoomView):E.instance.notice(m.instance.getLanguage(135))}else Le.logs("进入主界面",5),He.instance.sendCustumEvent(33),oe.intance.setCurrentScene(Y.M_SCENE_MAIN),b.instance.openWheelDialog();v.startHeart()}onLoading(e){this.m_nProgress+=.01,this.mcProcess&&e>this.mcProcess.value&&(this.loadingProcess=e*.4)}onLoading2(e){this.mcProcess&&(this.loadingProcess=0+e*1.1)}removeEvent(){g.intance.off(f.EVENT_BACK_TO_LOGIN,this,this.backToLogin),g.intance.off(f.EVENT_LOGIN_GAME_END,this,this.loginGameEnd),g.intance.off(f.EVENT_ENTER_MAIN,this,this.loginCallBack)}};po.m_iState=1,po=h([E2("xmaaYG8AQ1yC07pr_JvyPA")],po);var{regClass:w2,property:Yme}=Laya,_c=class extends Laya.Script{constructor(){super()}onEnable(){Laya.timer.frameLoop(1,this,this.onRunRoll),this.onScaleEnd1()}onRunRoll(){this.owner.rotation++}onScaleEnd1(){Laya.Tween.to(this.owner,{scaleX:1.1,scaleY:1.1,alpha:.8},500,null,Laya.Handler.create(this,this.onScaleEnd2))}onScaleEnd2(){Laya.Tween.to(this.owner,{scaleX:.8,scaleY:.8,alpha:.5},500,null,Laya.Handler.create(this,this.onScaleEnd1))}onDisable(){Laya.Tween.clearAll(this),Laya.timer.clearAll(this)}};_c=h([w2("w5pr4pHJTMOM3bYxCyc4Ag")],_c);var ho=class ho extends Laya.ColorFilter{constructor(t=null){super(t)}static addClickFilter(t){let e=t.filters||[];e.push(ho.clickFilter),t.filters=e}static clearClickFilter(t){let e=t.filters;if(e!=null&&e.length>0){for(let i=e.length-1;i>-1;i--)e[i]instanceof ho&&e.splice(i,1);t.filters=e}}};ho.clickFilter=new ho([1,0,0,0,-34,0,1,0,0,-34,0,0,1,0,-34,0,0,0,1,0]);var Qn=ho;var{regClass:T2,property:C2}=Laya,fo=class extends Laya.Script{constructor(){super();this.noSound=!1}onEnable(){let e=this.owner.scaleX;this.owner.on(Laya.Event.MOUSE_DOWN,this,this.onDown),Laya.stage.on(Laya.Event.MOUSE_UP,this,this.onUp)}onDown(){this.noSound||Xe.instance.playSoundByName(Xe.soundName4),Qn.addClickFilter(this.owner)}onUp(){Qn.clearClickFilter(this.owner)}onDisable(){Qn.clearClickFilter(this.owner),this.owner.off(Laya.Event.MOUSE_DOWN,this,this.onDown),Laya.stage.off(Laya.Event.MOUSE_UP,this,this.onUp)}};h([C2({type:"boolean"})],fo.prototype,"noSound",2),fo=h([T2("cL1AmqOiTHmtQWKayPNcTA")],fo);var{regClass:S2,property:nD}=Laya,Mr=class extends Laya.Script{onEnable(){b.instance.m_strLanguage==Yi.Lan_zh?this.chSkin&&(this.owner.skin=this.chSkin.url):b.instance.m_strLanguage==Yi.Lan_tr&&this.trSkin&&(this.owner.skin=this.trSkin.url)}};h([nD({type:Laya.Texture})],Mr.prototype,"chSkin",2),h([nD({type:Laya.Texture})],Mr.prototype,"trSkin",2),Mr=h([S2("SPRGcvdcQR2PHb7I7j7sXg")],Mr);var ct=class ct{constructor(){this.ROOM_1=1;this.ROOM_2=2;this.ROOM_3=3;this.ROOM_1_1=1;this.ROOM_1_2=2;this.ROOM_1_3=3;this.ROOM_2_1=201;this.ROOM_2_2=202;this.ROOM_2_3=203;this.ROOM_3_1=301;this.ROOM_3_2=302;this.ROOM_3_3=303;this.ROOM_4_6=406;this.ROOM_5_4=504;this.ROOM_5_4_SELF=5041}static get instance(){return ct._instance==null&&(ct._instance=new ct),ct._instance}};ct._instance=null,ct.ROOM_PRE_CONTRACT=401,ct.ROOM_PRE_CONTRACT_SELF=402,ct.ROOM_FRIEND_APPLY=4,ct.ROOM_MAIL=5,ct.RED_GUILD_APPLY=6,ct.RED_SHIELDS=7,ct.RED_ACTIVITY1=8,ct.RED_ACTIVITY2=9,ct.RED_ACTIVITY3=10,ct.RED_EVERY_RANK_TOTAL=11,ct.RED_EVERY_RANK_PRE=12,ct.RED_EVERY_RANK_AIR=13,ct.RED_EVERY_RANK_TRA=14,ct.PRO_RANK_DAY_FIGHT_1=15,ct.PRO_RANK_DAY_FIGHT_2=16,ct.PRO_RANK_DAY_FIGHT_3=17,ct.PRO_RANK_DAY_FIGHT_4=18,ct.REM_RANK=28,ct.LAST_DRAW=29,ct.MAIL_ANNOUNCE_RED=23,ct.ROOM_OFFER_CARD=24,ct.RED_IGO=25,ct.RED_WHEEL=26,ct.RED_RENTAL=27;var he=ct;var xe=class n{static toFixed(t,e){if(t.toString().indexOf(".")==-1)return t;{let i=t.toFixed(e);return parseFloat(i)}}static toFixedWithPercent(t,e,i="+"){let a;return t.toString().indexOf(".")==-1?a=i+t*100+"%":(e=e-2,e<0&&(e=0),a=i+(t*100).toFixed(e)+"%"),a}static getGoldStr(t){let e;return t>999999?e=parseInt(String(t/1e5))+"m":e=t,e}static numStringFormat(t){let e=t;return b.instance.m_strLanguage==2?t.length>4&&(e=String(t).replace(/(\d)(?=(\d{3})+$)/g,"$1 ")):e=String(t).replace(/(\d)(?=(\d{3})+$)/g,"$1,"),e}static numSimple(t){let e=t,i=parseInt(parseInt(e)/1e3+"");return i>0?i+"k":n.numStringFormat(e)}static numStringFormat2(t){let e;if(t>999999)e=n.getNumStr(t,1e6,"M");else if(t>999)e=n.getNumStr(t,1e3,"K");else return t+"";return e}static getNumStr(t,e,i){return parseInt(Math.floor(t/e)+"")+i}static getTimeStr(t){let e;return t<3600?e=m.instance.getLanguage(9024,Math.ceil(t/60)):t<3600*24?e=m.instance.getLanguage(9025,Math.ceil(t/3600)):e=m.instance.getLanguage(9025,Math.ceil(t/(3600*24))),e}static BigInt(t){return 0}static isInteger(t){return t%1===0}static isNumber(t){return typeof t=="number"}static formatNumber(t,e=8){return Number.isInteger(t)?t:parseFloat(t.toFixed(e))}static formatNumberStr(t,e=2){return Number.isInteger(t)?t:parseFloat(t.toFixed(e)).toString()}static filterNumFormat(t,e=2,i=!1,a=!1){if(!t)return t;if(t<1e3&&t>0)if(a){var r=Math.floor(Number(parseFloat(t*10**e+"").toPrecision(16)))/10**e;return parseFloat(r.toFixed(e)).toString()}else return parseFloat(t.toFixed(e)).toString();if(t==="0.00")return t;var s=[{value:1,symbol:""},{value:1e6,symbol:"M"},{value:1e9,symbol:"G"},{value:1e12,symbol:"T"},{value:1e15,symbol:"P"}];i&&(s=[{value:1,symbol:""},{value:1e3,symbol:"k"},{value:1e6,symbol:"M"},{value:1e9,symbol:"G"},{value:1e12,symbol:"T"},{value:1e15,symbol:"P"}]);var o=/\.0+$|(\.[0-9]*[1-9])0+$/,l;for(l=s.length-1;l>0&&!(t>=s[l].value);l--);let c=(t/s[l].value).toString();return c.indexOf(".")>-1&&(e>0?c=c.substr(0,c.indexOf(".")+e+1):c=c.substr(0,c.indexOf(".")+e)),c.replace(o,"$1")+s[l].symbol}static fromWei(t,e,i=0){if(!t)return 0;let a=t.length-e+i;if(a<=0)return 0;let r=t.toString().slice(0,a);if(i){let s=r.length-i;if(s<=0){let o="0.";for(let l=0;l<Math.abs(s);l++)o+="0";r=o+r}else r=r.slice(0,r.length-i)+"."+r.slice(r.length-i)}return r}static getNumberSuffix(t){let e=parseInt(t,10);return isNaN(e)?t:(e%1e9).toString()}};var vd=class extends Laya.Scene{};var{regClass:D2}=Laya,vc=class extends vd{constructor(){super(...arguments);this.currTab=0;this.arenaLv=1001;this.coinTypes=[];this.arenaType=1;this.nodeIds=[];this.selectArenaType=1;this.coinDatas=[];this.nodeDatas=[]}onAwake(){this.m_iLayerType=C.M_POP,this.m_iPositionType=C.UP}async onOpened(e){this.mouseThrough=this.mouseThrough=!0,this.updateTopInfo(),this.initNodeCombo(),this.initCoinCombo(),this.initArenaTypes(),this.onClickTab(this.selectArenaType);var i=Laya.stage.width-z.DESIGN_WIDTH>>1;this.leftX=this.leftMenu.x,this.leftMenu.x=this.leftX-i-this.leftMenu.width,Laya.Tween.to(this.leftMenu,{x:this.leftX-i},500),_.intance.testNodes()}updateTopInfo(){if(this.arenaType=k.instance.arenaType,this.arenaType==W.ARENA_TYPE_TEAM){this.btn_1.visible=this.btn_2.visible=this.btn_3.visible=!1,this.btn_4.x=this.btn_1.x;var e=this.btn_4.getChildByName("Label");e.text=m.instance.getLanguage(1769)}var i=_.intance.m_dicArenaTypes.get(this.arenaType);this.tf_name.text=m.instance.getLanguage(i.name),this.updateLocalAssets()}updateLocalAssets(){this.tf_3005.text=xe.filterNumFormat(b.instance.getConsumeValue(ge.TYPE_GOLD),0)}onEnable(){this.btn_back.on(Laya.Event.CLICK,this,this.setToMainScene),this.btn_join.on(Laya.Event.CLICK,this,this.onJoin),this.btn_myBookings.on(Laya.Event.CLICK,this,this.onShowMyBooking);for(let e=1;e<5;e++)this["btn_"+e].on(Laya.Event.CLICK,this,this.onClickTab,[e]);this.list_room.vScrollBarSkin="",this.list_room.array=[],Laya.timer.loop(1e3,this,this.refreshRoomTime),this.btn_create.clickHandler=new Laya.Handler(this,this.onclickBtnHandler,[this.btn_create]),g.intance.on(f.ROLE_INFO_CHANGE,this,this.updateTopInfo),g.intance.on(ti.UPDATE_LOCAL_WALLET_LIST_EVENT,this,this.updateLocalAssets),g.intance.on(f.EVENT_CHECK_ICON_SELECT,this,this.onCoinSelected),g.intance.on(f.EVENT_CHECK_NODE_SELECT,this,this.onNodeSelected),g.intance.on(f.EVENT_ENTER_MATCH_ROOM,this,this.onEnterMatchRoom)}onShowMyBooking(){A.intance.openModule(y.MyBookingView)}async onJoin(){let e=this.input_bookingUrl.text;if(e==""){E.instance.notice(m.instance.getUILang("Please input booking URL"));return}let i=Ae.instance.onGetBookingId(e),a=i[0];if(a){let r=i[1],s=parseInt(a),o=parseInt(r);Ae.instance.goBookingCreateRoomDialog(s,o)}else E.instance.notice(m.instance.getLanguage(1564))}setTab(e){for(let i=1;i<5;i++)e==i?(this["btn_"+i].getChildByName("btn_yellowBg").visible=!0,this["btn_"+i].getChildByName("Label").color="#143268"):(this["btn_"+i].getChildByName("btn_yellowBg").visible=!1,this["btn_"+i].getChildByName("Label").color="#ffffff")}onClickTab(e){if(this.currTab!=e){if(this.list_room.visible=!1,this.list_room4.visible=!1,this.currTab=e,this.showCoinCombo(),this.setTab(e),e==1){this.arenaLv=1;var i=this.getRoomByType()}else if(e==2){this.arenaLv=2;var i=this.getRoomByType()}else if(e==3){this.arenaLv=3;var i=this.getRoomByType()}else if(e==4)var i=this.getRoomByType()}}async getRoomByType(){if(Laya.timer.clear(this,this.getRoomByType),this.currTab==4){this.arenaType=k.instance.arenaType;let e=await v.requestPost("wxgame/roomPreContract/list",{lv:0,coinTypeList:this.coinTypes,arenaType:this.arenaType,nodeIds:this.nodeIds});if(this.destroyed)return;this.currTab==4&&(this.list_room4.array=e.list,this.list_room4.array.length>0?this.noDataBox.visible=!1:this.noDataBox.visible=!0,this.list_room4.visible=!0)}else{this.arenaType=k.instance.arenaType;let e=await v.requestPost("wxgame/room/list",{lv:this.arenaLv,coinTypeList:this.coinTypes,arenaType:this.arenaType,nodeIds:this.nodeIds});if(this.destroyed)return;this.currTab!=4&&(this.list_room.array=e.roomList,this.list_room.array.length>0?this.noDataBox.visible=!1:this.noDataBox.visible=!0,this.list_room.visible=!0)}Laya.timer.once(3e3,this,this.getRoomByType)}refreshRoomTime(){this.refreshRoomBtnRed();let e=this.list_room.array;if(!(e.length<1)){for(let i=0;i<e.length;i++)if(e[i]){let a=e[i];a.state==0?a.joinCd-=1e3:a.fightEndTime-=1e3}this.list_room.refresh()}}initArenaTypes(){var e=_.intance.m_dicArenaTypes.get(k.instance.arenaType),i=e.tabLvs,a=[1,2,3,4],r=-1;a.forEach(s=>{var o=this["btn_"+s],l=o.getChildByName("img_lock"),c=o.getChildByName("img_red");i.indexOf(s)!=-1?(o.disabled=!1,l.visible=!1,r==-1&&(r=s)):(o.disabled=!0,l.visible=!0)}),r!=-1&&(this.selectArenaType=r)}showCoinCombo(){k.instance.arenaType==3?this.list_coin.visible=!1:this.list_coin.visible=!0}initCoinCombo(){this.showCoinCombo();var e=_.intance.m_dicArenaTypes.get(k.instance.arenaType);this.coinTypes=[];var i=e.coinTypes;this.coinDatas=[],i.forEach(a=>{this.coinTypes.push(a);var r=_.intance.m_dicItems.get(a);this.coinDatas.push([a,!0,m.instance.getLanguage(r.name)])}),this.list_coin.array=this.coinDatas}onCoinSelected(){this.coinTypes=[],this.coinDatas.forEach(e=>{e[1]&&this.coinTypes.push(e[0])}),console.log("您选中了 coinType"+this.coinTypes),this.getRoomByType()}initNodeCombo(){this.nodeIds=[];var e=_.intance.m_dicNodes.values;this.nodeDatas=[],e.forEach(i=>{this.nodeIds.push(i.id),this.nodeDatas.push([i.id,!0,i])}),this.list_node.array=this.nodeDatas}onNodeSelected(){this.nodeIds=[],this.nodeDatas.forEach(e=>{e[1]&&this.nodeIds.push(e[0])}),console.log("您选中了 nodeType"+this.nodeIds),this.getRoomByType()}refreshRoomBtnRed(){var e=k.instance.arenaType;this.img_red_1.visible=b.instance.getRedDotById(he.instance.ROOM_1_1),this.img_red_1.visible=b.instance.getRedDotById(he.instance["ROOM_"+e+"_1"]),this.img_red_2.visible=b.instance.getRedDotById(he.instance["ROOM_"+e+"_2"]),this.img_red_3.visible=b.instance.getRedDotById(he.instance["ROOM_"+e+"_3"]),e==W.ARENA_TYPE_TEAM?(this.img_red_4.visible=b.instance.getRedDotById(he.instance.ROOM_5_4),this.img_red_myBooking.visible=b.instance.getRedDotById(he.instance.ROOM_5_4_SELF)):(this.img_red_4.visible=b.instance.getRedDotById(he.ROOM_PRE_CONTRACT),this.img_red_myBooking.visible=b.instance.getRedDotById(he.ROOM_PRE_CONTRACT_SELF))}async onclickBtnHandler(e){switch(e){case this.btn_create:this.currTab==4?A.intance.openModule(y.CreateRoomDialog,[W.ACTION_CREATE_BOOKING,!0,!0,0]):A.intance.openModule(y.CreateRoomDialog,[W.ACTION_CREATE,!0,!1,this.arenaLv]);break;default:E.instance.notice(m.instance.getLanguage(12));break}}setToMainScene(){oe.intance.setCurrentScene(Y.M_SCENE_MAIN)}onDisable(){g.intance.off(f.ROLE_INFO_CHANGE,this,this.updateTopInfo),g.intance.off(ti.UPDATE_LOCAL_WALLET_LIST_EVENT,this,this.updateLocalAssets),g.intance.off(f.EVENT_CHECK_ICON_SELECT,this,this.onCoinSelected),g.intance.off(f.EVENT_CHECK_NODE_SELECT,this,this.onNodeSelected),g.intance.off(f.EVENT_ENTER_MATCH_ROOM,this,this.onEnterMatchRoom),Laya.Tween.clearAll(this),Laya.timer.clearAll(this)}onEnterMatchRoom(e){e?Laya.timer.once(3e3,this,this.getRoomByType):Laya.timer.clear(this,this.getRoomByType)}};vc.M_B_FIRST_Open=!0,vc=h([D2("Kvjumjs4Q--HdgEZ8LzawA")],vc);var zi=class{constructor(){}};zi.MONTH="months",zi.DAYS="days",zi.HOURS="hours",zi.MINUTES="minutes",zi.SECOUNDS="seconds",zi.MS="ms";var Bt=class Bt{constructor(){}static formatMM(t){if(t<=0)return"00:000";let e,i;e=t/1e3,i=t%1e3;let a="";return e<=9&&(a+="0"),a+=Math.floor(e),a+=":",i<=9?a+="00":i<=99&&(a+="0"),a+=i,a}static format(t,e=":",i=!0){if(t<=0)return i?"00:00:00":"00:00";let a,r,s,o,l;o=t/3600,s=t%3600,l=s/60,a=s%60;let c="";return i&&(o<=9&&(c+="0"),c+=Math.floor(o)+e),l<=9&&(c+="0"),c+=Math.floor(l)+e,Math.ceil(a)<=9&&(c+="0"),c+=Math.ceil(a),c}static formatWithDay(t,e=":",i=!1){if(t<=0)return"00:00";let a,r,s,o,l;r=t/86400,s=t%86400,o=s/3600,s=s%3600,l=s/60,a=s%60;let c="";return r>=1?(c=m.instance.getLanguage(1660,Math.floor(r))+" ",o<=9&&(c+="0"),i&&a%2!=0&&(e=Le.getColorText(e,"#412b20")),c+=Math.floor(o)+e,l<=9&&(c+="0"),c+=Math.floor(l)):(o<=9&&(c+="0"),c=Math.floor(o)+e,l<=9&&(c+="0"),c+=Math.floor(l)+e,Math.ceil(a)<=9&&(c+="0"),c+=Math.ceil(a)),c}static formatWithSecondByMs(t){return`${t/1e3}`}static formatWithDayByMs(t,e=":",i=!1){if(t<=0)return"00:00";let a,r,s,o,l,c;s=t/864e5,o=t%864e5,l=o/36e5,o=o%36e5,c=o/6e4,o=o%6e4,r=o/1e3,a=o%1e3;let u="";return s>=1&&(u=m.instance.getLanguage(1660,Math.floor(s))+" "),l<=9&&(u+="0"),u+=Math.floor(l)+e,c<=9&&(u+="0"),u+=Math.floor(c)+e,Math.ceil(r)<=9&&(u+="0"),u+=Math.floor(r)+" ",u+=Math.ceil(a),u}static getTimeArray(t,e="HH-MM-SS"){if(t=Math.max(0,t),e.indexOf("-")==-1)return[];let i=[],a=e.split("-");for(let r of a)r=="DD"?i.push(Math.floor(t/Bt.OneDaySceond)):r=="HH"?i.push(Math.floor(t%Bt.OneDaySceond/Bt.OneHourSceond)):r=="MM"?i.push(Math.floor(t%Bt.OneHourSceond/Bt.OneMiniuteSecond)):r=="SS"&&i.push(t%Bt.OneMiniuteSecond);return i}static getServerDate(t){return new Date(t)}static formatTime(t){return(parseInt(t/60+"")+100).toString().substring(1)+":"+(parseInt(t%60+"")+100).toString().substring(1)}static formatTime000000(t){return t?(parseInt(t/3600+"")+100).toString().substring(1)+":"+(parseInt(t%3600/60+"")+100).toString().substring(1)+":"+(parseInt(t%60+"")+100).toString().substring(1):"00:00:00"}static formatTimeStamp(t,e="YY-MT-DD HH:MM:SS",i=!1){let a=Bt.getServerDate(t),r="";if(e.indexOf("YY")>=0&&(r=(i?a.getUTCFullYear():a.getFullYear())+"",e=e.replace("YY",r)),e.indexOf("MT")>=0){let s=(i?a.getUTCMonth():a.getMonth())+1;s>9?r=s+"":r="0"+s,e=e.replace("MT",r)}if(e.indexOf("DD")>=0){let s=i?a.getUTCDate():a.getDate();s>9?r=s+"":r="0"+s,e=e.replace("DD",r)}if(e.indexOf("HH")>=0){let s=i?a.getUTCHours():a.getHours();s>9?r=s+"":r="0"+s,e=e.replace("HH",r)}if(e.indexOf("MM")>=0){let s=i?a.getUTCMinutes():a.getMinutes();s>9?r=s+"":r="0"+s,e=e.replace("MM",r)}if(e.indexOf("SS")>=0){let s=i?a.getUTCSeconds():a.getSeconds();s>9?r=s+"":r="0"+s,e=e.replace("SS",r)}return e}static formatTimeStamps(t,e="YY-MT-DD HH:MM:SS"){let i=Bt.getServerDate(t),a=e;return a=Bt.parseTimeDetail(i,a,"YY",!1),a=Bt.parseTimeDetail(i,a,"MT",!1),a=Bt.parseTimeDetail(i,a,"DD",!1),a=Bt.parseTimeDetail(i,a,"HH",!0),a=Bt.parseTimeDetail(i,a,"MM",!0),a=Bt.parseTimeDetail(i,a,"SS",!0),a}static parseTimeDetail(t,e,i,a){if(e.indexOf(i)>=0){let r,s;i=="YY"?s=t.getFullYear():i=="MT"?s=t.getMonth()+1:i=="DD"?s=t.getDate():i=="HH"?s=t.getHours():i=="MM"?s=t.getMinutes():i=="SS"&&(s=t.getSeconds()),s>9||!a?r=s.toString():r="0"+s,e=e.replace(i,r)}return e}static getServerTimeStr(){return Bt.formatTimeStamp(Laya.timer.currTimer)}static getTimeArr(){return Bt.getServerTimeStr().split("/")}static get getDay(){let e=Bt.getServerTimeStr().split("/");return parseInt(e[2])}static parseSheetTime(t){let e="";if(t){let i=t.length;for(let a=0;a<i;a++){let r="";t[a]<10?r="0"+t[a]:r=t[a],a!==i-1&&(r=r+":"),e+=r}}return e}static dateStringToTimestamp(t,e){let[i,a,r]=t.split("-").map(Number),s=Number(e),o=new Date(i,a-1,r,s).getTime();return Number(o)}static getTimestamp(t,e,i,a,r){return new Date(t,e-1,i,a,r).getTime()}static getCurrentDayTimestamp(){let t=new Date,e=t.getHours();return t.setHours(e,0,0,0),t.getTime()}static getYearMonthDat(t){let e=new Date(t),i=e.getFullYear(),a=e.getMonth()+1<10?"0"+(e.getMonth()+1):""+(e.getMonth()+1),r=e.getDate()<10?"0"+e.getDate():""+e.getDate();return`${i}-${a}-${r}`}static formatDayAndTime(t,e="-"){let i=new Date(t),a=i.getFullYear(),r=String(i.getMonth()+1).padStart(2,"0"),s=String(i.getDate()).padStart(2,"0"),o=String(i.getHours()).padStart(2,"0"),l=String(i.getMinutes()).padStart(2,"0");return{date:`${a}${e}${r}${e}${s}`,time:`${o}:${l}`}}static formatTimeAgo(t){return t<60*1e3?m.instance.getLanguage(1188):t<60*60*1e3?m.instance.getLanguage(2004,Math.floor(t/6e4)):t<24*60*60*1e3?m.instance.getLanguage(2003,Math.floor(t/36e5)):m.instance.getLanguage(2002,Math.floor(t/(24*60*60*1e3)))}static colorTimeAgo(t){return t<60*1e3?"#43ef74":"#b4b4b4"}static formatTimeExpires(t){return t<60*1e3?m.instance.getLanguage(1214,t):t<60*60*1e3?m.instance.getLanguage(1215,Math.floor(t/6e4)):t<24*60*60*1e3?m.instance.getLanguage(1216,Math.floor(t/36e5)):m.instance.getLanguage(1217,Math.floor(t/(24*60*60*1e3)))}static getTimeDifference(t,e=zi.MONTH){let i=new Date,r=new Date(t*1e3).getTime()-i.getTime();if(r<0)return{months:0,days:0,hours:0,minutes:0,seconds:0,ms:0};let s=r,o=Math.floor(r/1e3),l=Math.floor(o/60),c=Math.floor(l/60),u=Math.floor(c/24),p=Math.floor(u/30);return e==="months"?(u%=30,c%=24,l%=60,o%=60,s%=1e3):e==="days"?(c%=24,l%=60,o%=60,s%=1e3,p=0):e==="hours"?(l%=60,o%=60,s%=1e3,p=0,u=0):e==="minutes"?(o%=60,s%=1e3,p=0,u=0,c=0):e==="seconds"?(s%=1e3,p=0,u=0,c=0,l=0):e==="ms"&&(p=0,u=0,c=0,l=0,o=0),{months:e==="months"?p:0,days:e==="months"||e==="days"?u:0,hours:e==="months"||e==="days"||e==="hours"?c:0,minutes:e==="months"||e==="days"||e==="hours"||e==="minutes"?l:0,seconds:e!=="ms"?o:0,ms:s}}};Bt.OneDaySceond=24*3600,Bt.OneHourSceond=3600,Bt.OneMiniuteSecond=60;var se=Bt;var xd=class extends Laya.Dialog{};var{regClass:A2}=Laya,Id=class extends xd{constructor(){super();this.destroyDoCancel=!1;this.canClose=!0}onEnable(){this.on(Laya.Event.CLICK,this,this.onClickEvent)}onClickEvent(e){let i=e.target;i.name=="okBtn"?(this._okHandler&&this._okHandler.runWith(null),this.close()):i.name=="cancleBtn"&&(this.destroyDoCancel=!1,this._cancelHandler&&this._cancelHandler.runWith(null),this.close())}setOpenData(e){if(e){if(this._okHandler=e.okHandler,this._cancelHandler=e.cancelHandler,this.destroyDoCancel=e.destroyDoCancel,e.flag<0?(this.cancleBtn.visible=!1,this.okBtn.visible=!1,this.canClose=!1):e.flag&P.YES&&!(e.flag&P.NO)?(this.okBtn.x=this.width-this.okBtn.width>>1,this.cancleBtn.visible=!1,this.okBtn.label="Sure"):e.flag&P.NO&&!(e.flag&P.YES)?this.okBtn.visible=!1:e.flag&P.YES&&e.flag&P.NO,e.data){var i=e.data,a=_.intance.m_dicGroupWar.get(i.groupId);if(a){var r=m.instance.getMultiLan(i.applicant.shortUnionName);r||(r="N/A"),this.tf_inviteTitle.text=m.instance.getLanguage(1654,i.applicant.name,r);var s=_.intance.m_dicArenaDic.get(i.arenaId);this.tf_arenaName.text=m.instance.getLanguage(s.name);var o=s.coinType,l=_.intance.m_dicItems.get(o),c=m.instance.getLanguage(l.name);this.tf_token.text=c,this.tf_groupName.text=m.instance.getLanguage(a.name),this.tf_startTime.text=se.formatTimeStamp(i.startTime,"MT-DD HH:MM")}}e.initHandler&&e.initHandler.runWith(this)}}onDisable(){this.destroyDoCancel&&this._cancelHandler&&this._cancelHandler.run(),this._okHandler=null,this._cancelHandler=null}close(e){e!="side"&&this.canClose&&super.close(e)}};Id=h([A2("TkYqV_cDTf6zOkSNHZa8ng")],Id);var Ed=class extends Laya.Box{};var{regClass:k2}=Laya,wd=class extends Ed{constructor(){super();this.isAddEvent=!1}createChildren(){super.createChildren()}addEvent(){this.isAddEvent||(this.check_coin.on(Laya.Event.CLICK,this,this.onCheck),this.isAddEvent=!0)}set dataSource(e){if(super.dataSource=e,!e)return;this.addEvent();let i=e;this.check_coin.selected=i[1];var a=i[2];this.img_node.skin=S.instance.getNodeIcon(a.area)}onCheck(){this._dataSource[1]=this.check_coin.selected,g.intance.event(f.EVENT_CHECK_NODE_SELECT)}};wd=h([k2("81z6wk15RUi5m_pFud3KHg")],wd);var Td=class extends Laya.Box{};var{regClass:B2}=Laya,Cd=class extends Td{constructor(){super();this.isAddEvent=!1}createChildren(){super.createChildren()}addEvent(){this.isAddEvent||(this.isAddEvent=!0)}set dataSource(e){if(super.dataSource=e,!e)return;this.addEvent();let i=e;this.tf_coin.text=m.instance.getLanguage(i[3])}onChange(e){e?this.check_coin.selected=!0:this.check_coin.selected=!1}};Cd=h([B2("zVQ6gbw9T-e9xifHx-wXrg")],Cd);var Sd=class extends Laya.Dialog{};var{regClass:M2}=Laya,Dd=class extends Sd{constructor(){super();this.destroyDoCancel=!1;this.canClose=!0}onEnable(){this.on(Laya.Event.CLICK,this,this.onClickEvent)}onClickEvent(e){let i=e.target;i.name=="okBtn"?(this._okHandler&&this._okHandler.runWith(null),this.close()):i.name=="cancleBtn"&&(this.destroyDoCancel=!1,this._cancelHandler&&this._cancelHandler.runWith(null),this.close())}setOpenData(e){if(e){if(this._okHandler=e.okHandler,this._cancelHandler=e.cancelHandler,this.destroyDoCancel=e.destroyDoCancel,e.flag<0?(this.cancleBtn.visible=!1,this.okBtn.visible=!1,this.canClose=!1):e.flag&P.YES&&!(e.flag&P.NO)?(this.okBtn.x=this.width-this.okBtn.width>>1,this.cancleBtn.visible=!1,this.okBtn.label="Sure"):e.flag&P.NO&&!(e.flag&P.YES)?this.okBtn.visible=!1:e.flag&P.YES&&e.flag&P.NO,e.data){var i=e.data,a=_.intance.m_dicGroupWar.get(i.groupId);if(a){this.tf_inviteTitle.text=m.instance.getLanguage(1628,i.friendName,a.groupPer);var r=_.intance.m_dicArenaDic.get(i.arenaId);this.tf_arenaName.text=m.instance.getLanguage(r.name);var s=r.coinType,o=_.intance.m_dicItems.get(s),l=m.instance.getLanguage(o.name);this.tf_token.text=l,this.tf_groupName.text=m.instance.getLanguage(a.name),this.tf_startTime.text=se.formatTimeStamp(i.startTime,"MT-DD HH:MM")}}e.initHandler&&e.initHandler.runWith(this)}}onDisable(){this.destroyDoCancel&&this._cancelHandler&&this._cancelHandler.run(),this._okHandler=null,this._cancelHandler=null}close(e){e!="side"&&this.canClose&&super.close(e)}};Dd=h([M2("8_1WgbqTTIqRSqG5gME9Rg")],Dd);var Ad=class extends Laya.Dialog{};var{regClass:R2}=Laya,kd=class extends Ad{constructor(){super(...arguments);this.m_strName="我是OpenSceneRuntime";this.m_iLayerType=C.M_PANEL;this.m_iPositionType=C.CENTER}onEnable(){this.btn_back.on(Laya.Event.CLICK,this,this.onBack)}onOpened(e){this.initLuckDrawView()}async initLuckDrawView(){this.list_room4.visible=!1;var e=k.instance.arenaType;let i=await v.requestPost("wxgame/roomPreContract/selfList",{arenaType:e});this.list_room4.array=i.list,this.list_room4.array.length>0?this.noDataBox.visible=!1:this.noDataBox.visible=!0,this.list_room4.visible=!0}onBack(){this.close()}onDisable(){this.removeEvent()}removeEvent(){Laya.Tween.clearAll(this),Laya.timer.clearAll(this)}};kd=h([R2("n7Y3cABUSqauk_SyBPv2qg")],kd);var Bd=class extends Laya.Dialog{};var{regClass:P2}=Laya,Md=class extends Bd{constructor(){super();this.friendData=null}onEnable(){}setOpenData(e){this.roomId=e[0],this.teamId=e[1],this.onGetList()}async onGetList(){let e=await v.requestPost("wxgame/friend/friendList",{});e&&e.list&&(b.instance.friendNum=e.list.length,this.list_friend.array=e.list,this.list_friend.visible=!0,this.friendData=e.list),(!e||!e.list||e.list.length<1)&&(this.noDataBox.visible=!0),console.log(e)}};Md=h([P2("0iWaxfs9RBKN2SAQf6r1dw")],Md);var Rd=class extends Laya.Box{};var{regClass:N2}=Laya,Pd=class extends Rd{constructor(){super();this.friendData=null;this.invited=!1}addEvent(){this.btn_invite.on(Laya.Event.CLICK,this,this.onClickInvite)}onDisable(){this.removeEvent()}removeEvent(){this.btn_invite.off(Laya.Event.CLICK,this,this.onClickInvite)}set dataSource(e){super.dataSource=e,e&&(this.friendData=e,this.setData(e),this.addEvent())}setData(e){this.tf_name.text=e.name,this.img_flag.skin=S.instance.getCountryIcon(e.country),this.playerIcon.headSkin=e.icon,e.online?(this.tf_online.text="on line",this.tf_online.color="#43ef74"):(this.tf_online.text=se.formatTimeAgo(e.lastLoginTime),this.tf_online.color="#b4b4b4")}async onClickInvite(){if(this.invited)return;let e=this.friendData.id,i=this.friendData.openid;console.log("onClickInvite",e,i);var a=this.parent.parent.parent,r=a.roomId,s=a.teamId,o=await v.requestPost("wxgame/roomPreContract/groupInvite",{roomId:r,teamId:s,targetPid:e});if(o){if(this.destroyed)return;this.btn_invite.skin="res/airdrop/img_com_join_button_1.png",this.btn_invite.label="Invited",this.btn_invite.labelColors="#4789c7",this.invited=!0}}};Pd=h([N2("fmYAqp9UQqmSfuho5FGK7g")],Pd);var Nd=class extends Laya.Dialog{};var{regClass:O2}=Laya,Od=class extends Nd{constructor(){super()}onEnable(){this.btn_invite.on(Laya.Event.CLICK,this,this.onInvite)}onInvite(){var e=this.roomId,i=this.teamDto.teamId;A.intance.openModule(y.MyFriendDialog,[e,i])}setOpenData(e){this.roomId=e[0],this.teamDto=e[1],this.tf_num.text=`${this.teamDto.curNum}/${this.teamDto.totalNum}`,this.teamDto&&this.teamDto.players&&(this.btn_invite.disabled=this.teamDto.curNum>=this.teamDto.totalNum,this.list_members.array=this.teamDto.players,!this.teamDto.players||this.teamDto.players.length<=0?this.noDataBox.visible=!0:this.noDataBox.visible=!1)}};Od=h([O2("hX77g-jXRXWpDYzwnZesiQ")],Od);var Hd=class extends Laya.Box{};var{regClass:H2}=Laya,Ud=class extends Hd{constructor(){super(...arguments);this.isAddEvent=!1}addEvent(){this.isAddEvent||(this.btn_copy.on(Laya.Event.CLICK,this,this.onCopy),this.isAddEvent=!0)}onCopy(){let e=this.roomPlayer.openId;doCopy(e),E.instance.notice(m.instance.getLanguage(132))}set dataSource(e){super.dataSource=e,this.roomPlayer=e,this.roomPlayer&&(this.addEvent(),this.setCurrentOutPut())}setCurrentOutPut(){let e=this.roomPlayer.icon;this.playerIcon.headSkin=e,this.tf_name.text=this.roomPlayer.name,this.tf_union.text=m.instance.getMultiLan(this.roomPlayer.shortUnionName),this.tf_address.text=Me.abbreviateString(this.roomPlayer.openId,18)}};Ud=h([H2("MsLl8of8Q-66zTyBsBmOng")],Ud);var ki=class{constructor(){}};ki.GREEN="#2ac84b",ki.YELLOW="#e8c833",ki.RED="#e04343";var Vd=class extends Laya.Box{};var{regClass:U2}=Laya,Fd=class extends Vd{constructor(){super();this.isAddEvent=!1}set dataSource(e){super.dataSource=e,this.nodeItem=e,this.img_node.skin=S.instance.getNodeIcon(this.nodeItem.area),this.tf_node.text=m.instance.getLanguage(this.nodeItem.name),this.onGameDelay(this.nodeItem.dT)}onGameDelay(e){var i=_.intance.getGeneralValueById(6),a=i[0],r=i[1];this.tf_delay.text=e+"ms",e>r?(this.img_delay.skin="res/common/comm/img_com_xinhao3.png",this.tf_delay.color=ki.RED):e>a?(this.img_delay.skin="res/common/comm/img_com_xinhao2.png",this.tf_delay.color=ki.YELLOW):(this.img_delay.skin="res/common/comm/img_com_xinhao1.png",this.tf_delay.color=ki.GREEN)}startTest(){Laya.timer.loop(5e3,this,this.onTestUrl)}onTestUrl(){v.stopHeartInStage||(this.nodeItem&&this.nodeItem.testUrl(),this.onGameDelay(this.nodeItem.dT))}onDisable(){Laya.timer.clearAll(this)}};Fd=h([U2("hhMSfaGLSJmVqJcF08xLgA")],Fd);var Gd=class extends Laya.Box{};var{regClass:V2}=Laya,Kd=class extends Gd{addEvent(){}set dataSource(e){super.dataSource=e;var i=e;i&&(this.addEvent(),this.img_icon.skin=S.instance.getNodeIcon(i.area),this.tf_name.text=m.instance.getLanguage(i.name),this.nodeDelaySign.dataSource=i)}onChange(e){e?(this.selectImg.visible=!0,this.tf_name.color="#ffffff"):(this.tf_name.color="#357cc0",this.selectImg.visible=!1)}onDisable(){}};Kd=h([V2("3WEF588kThqDCYUgf5gM6w")],Kd);var qd=class extends Laya.Dialog{};var{regClass:F2}=Laya,Wd=class extends qd{constructor(){super(...arguments);this.m_strName="我是OpenSceneRuntime";this.m_iLayerType=C.M_POP;this.m_iPositionType=C.CENTER}setOpenData(e){e&&(this.roomId=e[0],this.teamId=e[1],this.leaderName=e[2])}onEnable(){this.btn_copy.on(Laya.Event.CLICK,this,this.onClickCopy),this.btn_invite.on(Laya.Event.CLICK,this,this.onInvite),this.initContainer()}onClose(){this.close()}onDisable(){}initContainer(){this.tf_tip.text=m.instance.getLanguage(1652),this.tf_leaderName.text=this.leaderName,this.tf_teamId.text=this.teamId+"";var e=this.roomId,i=this.teamId;let a=Ae.instance.onGetNewUrl(e,i);this.input_bookingUrl.text=a}onInvite(){var e=this.roomId,i=this.teamId;A.intance.openModule(y.MyFriendDialog,[e,i])}async onJoin(){let e=this.input_bookingUrl.text;if(e==""){E.instance.notice(m.instance.getUILang("Please input booking URL"));return}let i=Ae.instance.onGetBookingId(e),a=i[0];if(a){let r=i[1],s=parseInt(a),o=parseInt(r);Ae.instance.goBookingCreateRoomDialog(s,o)}else E.instance.notice(m.instance.getLanguage(1564))}onClickCopy(){let e=this.input_bookingUrl.text;e&&(doCopy(e),E.instance.notice(m.instance.getLanguage(132)))}};Wd=h([F2("Dy-cG4svSO2sXy3rqqLgtA")],Wd);var Yd=class extends Laya.Dialog{};var{regClass:G2}=Laya,zd=class extends Yd{constructor(){super()}onEnable(){this.btn_create.on(Laya.Event.CLICK,this,this.onCreate)}onCreate(){Ae.instance.goBookingCreateRoomDialog(this.roomId)}async setOpenData(e){this.list_members.array=[],this.roomId=e,this.onUpdateData(),Laya.timer.loop(3e3,this,this.onUpdateData)}async onUpdateData(){this.destroyed||v.requestPost("wxgame/roomPreContract/teamList",{roomId:this.roomId}).then(e=>{if(!this.destroyed){var i=e.teamDtoList;this.myTeamId=e.myTeamId,this.btn_create.disabled=this.myTeamId>0,i&&i.length&&(this.list_members.array=i,!i||i.length<=0?this.noDataBox.visible=!0:this.noDataBox.visible=!1)}}).catch(e=>{this.close()})}onDisable(){Laya.timer.clearAll(this)}};zd=h([G2("vn92QbT4TOu8O2hiUdYh1w")],zd);var jd=class extends Laya.Box{};var{regClass:K2}=Laya,$d=class extends jd{constructor(){super(...arguments);this.isAddEvent=!1}addEvent(){this.isAddEvent||(this.btn_view.on(Laya.Event.CLICK,this,this.onView),this.btn_invite.on(Laya.Event.CLICK,this,this.onInvite),this.btn_share.on(Laya.Event.CLICK,this,this.onShare),this.btn_join.on(Laya.Event.CLICK,this,this.onJoin),this.btn_apply.on(Laya.Event.CLICK,this,this.onApply),this.isAddEvent=!0)}onView(){var e=this.parent.parent.parent,i=e.roomId,a=this.teamDto;A.intance.openModule(y.MyTeamDialog,[i,a])}onInvite(){var e=this.parent.parent.parent,i=e.roomId,a=this.teamDto.teamId;A.intance.openModule(y.MyFriendDialog,[i,a])}onShare(){var e=this.parent.parent.parent,i=e.roomId,a=this.teamDto.teamId;A.intance.openModule(y.TeamShareDialog,[i,a])}onJoin(){A.intance.openModule(y.TeamJoinUsingDialog)}async onApply(){var e=this.parent.parent.parent,i=e.roomId,a=this.teamDto.teamId,r=await v.requestPost("wxgame/roomPreContract/groupJoin",{roomId:i,teamId:a});if(r){if(this.destroyed)return;Le.popTip(1650)}}set dataSource(e){super.dataSource=e,this.teamDto=e,this.teamDto&&(this.addEvent(),this.setCurrentOutPut())}setCurrentOutPut(){this.leader=this.teamDto.leaderPlayer;let e=this.leader.icon;this.playerIcon.headSkin=e,this.tf_name.text=this.leader.name,this.tf_union.text=m.instance.getMultiLan(this.leader.shortUnionName),this.teamDto.curNum<this.teamDto.totalNum?(this.img_dengdai.skin="res/booking/img_com_dengdai.png",this.tf_people.text=`<font color="#e84d34">${this.teamDto.curNum}</font>/${this.teamDto.totalNum}`):(this.img_dengdai.skin="res/booking/img_com_gou.png",this.tf_people.text=`<font color="#25ff63">${this.teamDto.curNum}</font>/${this.teamDto.totalNum}`);var i=this.parent.parent.parent,a=i.myTeamId;a&&this.teamDto.teamId==a?(this.btn_invite.visible=!0,this.btn_share.visible=!0,this.btn_join.visible=!1,this.btn_apply.visible=!1,this.teamDto.curNum==this.teamDto.totalNum?(this.setBtnDisabled(this.btn_invite,!0),this.setBtnDisabled(this.btn_share,!0)):(this.setBtnDisabled(this.btn_invite,!1),this.setBtnDisabled(this.btn_share,!1))):(this.btn_invite.visible=!1,this.btn_share.visible=!1,this.btn_join.visible=!0,this.btn_apply.visible=!0,this.teamDto.curNum==this.teamDto.totalNum?(this.setBtnDisabled(this.btn_join,!0),this.setBtnDisabled(this.btn_apply,!0)):a?(this.setBtnDisabled(this.btn_join,!0),this.setBtnDisabled(this.btn_apply,!0)):(this.setBtnDisabled(this.btn_join,!1),this.setBtnDisabled(this.btn_apply,!1)))}setBtnDisabled(e,i){i?(e.skin="res/booking/img_com_anniu2.png",e.labelColors="#11c5fa"):(e.skin="res/booking/img_com_anniu1.png",e.labelColors="#ffffff"),e.disabled=i}};$d=h([K2("7oyF4ImKSpieTvgTF4Thew")],$d);var Xd=class extends Laya.Dialog{};var{regClass:q2}=Laya,Qd=class extends Xd{constructor(){super(...arguments);this.m_strName="我是OpenSceneRuntime";this.m_iLayerType=C.M_POP;this.m_iPositionType=C.CENTER}setOpenData(e){}onEnable(){this.btn_join.on(Laya.Event.CLICK,this,this.onJoin),this.initContainer()}onClose(){this.close()}onDisable(){}initContainer(){this.tf_tip.text=m.instance.getLanguage(1648),this.input_bookingUrl.text=""}async onJoin(){let e=this.input_bookingUrl.text;if(e==""){E.instance.notice(m.instance.getUILang("Please input booking URL"));return}let i=Ae.instance.onGetBookingId(e),a=i[0];if(a){let r=i[1],s=parseInt(a),o=parseInt(r);Ae.instance.goBookingCreateRoomDialog(s,o),this.close()}else E.instance.notice(m.instance.getLanguage(1564))}};Qd=h([q2("FJTW2dtzTA-7IRwokvDqbQ")],Qd);var Jd=class extends Laya.Dialog{};var{regClass:W2}=Laya,Zd=class extends Jd{constructor(){super(...arguments);this.m_strName="我是OpenSceneRuntime";this.m_iLayerType=C.M_POP;this.m_iPositionType=C.CENTER}setOpenData(e){e&&(this.roomId=e[0],this.teamId=e[1])}onEnable(){this.btn_copy.on(Laya.Event.CLICK,this,this.onClickCopy),this.initContainer()}onClose(){this.close()}onDisable(){}initContainer(){this.tf_tip.text=m.instance.getLanguage(1651);var e=this.roomId,i=this.teamId;let a=Ae.instance.onGetNewUrl(e,i);this.input_bookingUrl.text=a}async onJoin(){let e=this.input_bookingUrl.text;if(e==""){E.instance.notice(m.instance.getUILang("Please input booking URL"));return}let i=Ae.instance.onGetBookingId(e),a=i[0];if(a){let r=i[1],s=parseInt(a),o=parseInt(r);Ae.instance.goBookingCreateRoomDialog(s,o)}else E.instance.notice(m.instance.getLanguage(1564))}onClickCopy(){let e=this.input_bookingUrl.text;e&&(doCopy(e),E.instance.notice(m.instance.getLanguage(132)))}};Zd=h([W2("WZneRofHTmO4le4SOiIw8A")],Zd);var ef=class extends Laya.Dialog{};var{regClass:Y2}=Laya,tf=class extends ef{constructor(){super()}onEnable(){this.list_airdrop.visible=!1,this.tf_consume.text=m.instance.getUILang("Consume items"),this.tf_value.text=m.instance.getUILang("value/U"),this.setOpenData()}async setOpenData(){var t=await v.requestPost("wxgame/money/drawTokenPayOutRecord",{});t&&(t.records.push(void 0),this.list_airdrop.array=t.records,this.list_airdrop.visible=!0,!t.records||t.records.length<=0?this.noDataBox.visible=!0:this.noDataBox.visible=!1)}onDisable(){}};tf=h([Y2("u4LW1QxJTQOj64w92cnRVg")],tf);var af=class extends Laya.Box{};var{regClass:z2}=Laya,nf=class extends af{constructor(){super()}addEvent(){}set dataSource(t){if(super.dataSource=t,!t){this.visible=!1;return}this.setData(t),this.addEvent()}setData(t){let e=_.intance.getPuzzleExchangeByName("WBNB").value,i=se.formatDayAndTime(t.time);this.tf_day.text=i.date,this.tf_consume.text=`${t.count}`,this.tf_value.text=`${t.count*e}`,t.puzzleId==1?this.tf_limit.text=`${xe.filterNumFormat(t.coinValue,2)}`:this.tf_limit.text=`${xe.filterNumFormat(t.coinValue,6)}`;let a=_.intance.getPuzzleExchange(t.puzzleId).name;this.tf_type.text=`${a}`}};nf=h([z2("gHc-YmsARYaK65kwDLBAAw")],nf);var rf=class extends Laya.Scene{};var Ge=class{constructor(){}};Ge.TYPE_Consumption=1,Ge.TYPE_Equipment=2,Ge.TYPE_Currency=3,Ge.TYPE_Hero=4,Ge.TYPE_Fragment=5,Ge.TYPE_CARD=6,Ge.CHOOSE_Wallet=1,Ge.CHOOSE_PutOn=2,Ge.ITEM_PT=1086,Ge.ITEM_PT_EXP=1091,Ge.ITEM_SNAKE=3026;function sf(n,t){var e;t===void 0&&(t="0");var i=0,a=-1;n[0]=="-"&&(n=n.substring(1),XE(n)||(i++,a=1,n.length)),t[0]=="-"&&(t=t.substring(1),XE(t)||(i++,a=2,t.length)),n=di(n),t=di(t),e=tw(di(n),di(t)),n=e[0],t=e[1],i==1&&(a===1?n=jE(n):a===2&&(t=jE(t)));var r=uD(n,t);return i?i==2?"-"+di(r):n.length<r.length?di(r.substring(1)):"-"+di(jE(r)):di(r)}function jE(n){if(XE(n))return n;for(var t="",e=n.length,i=n.split(".")[1],a=i?i.length:0,r=0;r<e;r++)n[r]>="0"&&n[r]<="9"?t+=9-parseInt(n[r]):t+=n[r];var s=a>0?"0."+new Array(a).join("0")+"1":"1";return uD(t,s)}function di(n){var t=n.split(".");for(t[0]||(t[0]="0");t[0][0]=="0"&&t[0].length>1;)t[0]=t[0].substring(1);return t[0]+(t[1]?"."+t[1]:"")}function tw(n,t){var e=n.split("."),i=t.split("."),a=e[0].length,r=i[0].length;return a>r?i[0]=new Array(Math.abs(a-r)+1).join("0")+(i[0]?i[0]:""):e[0]=new Array(Math.abs(a-r)+1).join("0")+(e[0]?e[0]:""),a=e[1]?e[1].length:0,r=i[1]?i[1].length:0,(a||r)&&(a>r?i[1]=(i[1]?i[1]:"")+new Array(Math.abs(a-r)+1).join("0"):e[1]=(e[1]?e[1]:"")+new Array(Math.abs(a-r)+1).join("0")),n=e[0]+(e[1]?"."+e[1]:""),t=i[0]+(i[1]?"."+i[1]:""),[n,t]}function uD(n,t){var e;e=tw(n,t),n=e[0],t=e[1];for(var i="",a=0,r=n.length-1;r>=0;r--){if(n[r]==="."){i="."+i;continue}var s=parseInt(n[r])+parseInt(t[r])+a;i=s%10+i,a=Math.floor(s/10)}return a?a.toString()+i:i}function XE(n){return/^0[0]*[.]{0,1}[0]*$/.test(n)}function rD(n){return(typeof n=="number"||typeof n=="bigint")&&(n=n.toString()),n[0]=="-"?n.substring(1):n}var Ot;(function(n){n[n.CEILING=0]="CEILING",n[n.DOWN=1]="DOWN",n[n.FLOOR=2]="FLOOR",n[n.HALF_DOWN=3]="HALF_DOWN",n[n.HALF_EVEN=4]="HALF_EVEN",n[n.HALF_UP=5]="HALF_UP",n[n.UNNECESSARY=6]="UNNECESSARY",n[n.UP=7]="UP"})(Ot||(Ot={}));function xc(n,t,e){if(t===void 0&&(t=0),e===void 0&&(e=Ot.HALF_EVEN),e===Ot.UNNECESSARY)throw new Error("UNNECESSARY Rounding Mode has not yet been implemented");(typeof n=="number"||typeof n=="bigint")&&(n=n.toString());var i=!1;n[0]==="-"&&(i=!0,n=n.substring(1));var a=n.split("."),r=a[0],s=a[1];if(t<0){if(t=-t,r.length<=t)return"0";var o=r.substr(0,r.length-t);return n=o+"."+r.substr(r.length-t)+s,o=xc(n,0,e),(i?"-":"")+o+new Array(t+1).join("0")}if(t==0)return r.length,sD(a[1],r,i,e)&&(r=$E(r)),(i&&parseInt(r)?"-":"")+r;if(a[1]){if(a[1].length<t)return(i?"-":"")+r+"."+a[1]+new Array(t-a[1].length+1).join("0")}else return(i?"-":"")+r+"."+new Array(t+1).join("0");s=a[1].substring(0,t);var l=a[1].substring(t);return l&&sD(l,s,i,e)&&(s=$E(s),s.length>t)?(i?"-":"")+$E(r,parseInt(s[0]))+"."+s.substring(1):(i&&(parseInt(r)||parseInt(s))?"-":"")+r+"."+s}function sD(n,t,e,i){if(!n||n===new Array(n.length+1).join("0")||i===Ot.DOWN||!e&&i===Ot.FLOOR||e&&i===Ot.CEILING)return!1;if(i===Ot.UP||e&&i===Ot.FLOOR||!e&&i===Ot.CEILING)return!0;var a="5"+new Array(n.length).join("0");if(n>a)return!0;if(n<a)return!1;switch(i){case Ot.HALF_DOWN:return!1;case Ot.HALF_UP:return!0;case Ot.HALF_EVEN:default:return parseInt(t[t.length-1])%2==1}}function $E(n,t){t===void 0&&(t=0),t||(t=1),typeof n=="number"&&n.toString();for(var e=n.length-1,i="",a=e;a>=0;a--){var r=parseInt(n[a])+t;r==10?(t=1,r=0):t=0,i+=r}return t&&(i+=t),i.split("").reverse().join("")}function Jn(n){var t=n[0]==="-";for(t&&(n=n.substr(1));n[0]=="0";)n=n.substr(1);if(n.indexOf(".")!=-1)for(;n[n.length-1]=="0";)n=n.substr(0,n.length-1);return n==""||n=="."?n="0":n[n.length-1]=="."&&(n=n.substr(0,n.length-1)),n[0]=="."&&(n="0"+n),t&&n!="0"&&(n="-"+n),n}function QE(n,t){n=n.toString(),t=t.toString();var e=0;n[0]=="-"&&(e++,n=n.substr(1)),t[0]=="-"&&(e++,t=t.substr(1)),n=Jn(n),t=Jn(t);var i=0,a=0;n.indexOf(".")!=-1&&(i=n.length-n.indexOf(".")-1),t.indexOf(".")!=-1&&(a=t.length-t.indexOf(".")-1);var r=i+a;if(n=Jn(n.replace(".","")),t=Jn(t.replace(".","")),n.length<t.length){var s=n;n=t,t=s}if(t=="0")return"0";for(var o=t.length,l=0,c=[],u=o-1,p="",d=0;d<o;d++)c[d]=n.length-1;for(var d=0;d<2*n.length;d++){for(var L=0,x=t.length-1;x>=u&&x>=0;x--)c[x]>-1&&c[x]<n.length&&(L+=parseInt(n[c[x]--])*parseInt(t[x]));L+=l,l=Math.floor(L/10),p=L%10+p,u--}return p=Jn(j2(p,r)),e==1&&(p="-"+p),p}function j2(n,t){return t==0?n:(n=t>=n.length?new Array(t-n.length+1).join("0")+n:n,n.substr(0,n.length-t)+"."+n.substr(n.length-t,t))}function JE(n,t,e){if(e===void 0&&(e=8),t==0)throw new Error("Cannot divide by 0");if(n=n.toString(),t=t.toString(),n=n.replace(/(\.\d*?[1-9])0+$/g,"$1").replace(/\.0+$/,""),t=t.replace(/(\.\d*?[1-9])0+$/g,"$1").replace(/\.0+$/,""),n==0)return"0";var i=0;t[0]=="-"&&(t=t.substring(1),i++),n[0]=="-"&&(n=n.substring(1),i++);var a=t.indexOf(".")>0?t.length-t.indexOf(".")-1:-1;if(t=di(t.replace(".","")),a>=0){var r=n.indexOf(".")>0?n.length-n.indexOf(".")-1:-1;if(r==-1)n=di(n+new Array(a+1).join("0"));else if(a>r)n=n.replace(".",""),n=di(n+new Array(a-r+1).join("0"));else if(a<r){n=n.replace(".","");var s=n.length-r+a;n=di(n.substring(0,s)+"."+n.substring(s))}else a==r&&(n=di(n.replace(".","")))}var o=0,l=t.length,c="",u=n.indexOf(".")>-1&&n.indexOf(".")<l?n.substring(0,l+1):n.substring(0,l);if(n=n.indexOf(".")>-1&&n.indexOf(".")<l?n.substring(l+1):n.substring(l),u.indexOf(".")>-1){var p=u.length-u.indexOf(".")-1;u=u.replace(".",""),l>u.length&&(p+=l-u.length,u=u+new Array(l-u.length+1).join("0")),o=p,c="0."+new Array(p).join("0")}for(e=e+2;o<=e;){for(var d=0;parseInt(u)>=parseInt(t);)u=sf(u,"-"+t),d++;c+=d,n?(n[0]=="."&&(c+=".",o++,n=n.substring(1)),u=u+n.substring(0,1),n=n.substring(1)):(o||(c+="."),o++,u=u+"0")}return(i==1?"-":"")+di(xc(c,e-2))}function ZE(n,t){return n=n.toString(),t=t.toString(),t=ew(t),sf(n,t)}function ew(n){return n[0]=="-"?n=n.substr(1):n="-"+n,n}function oD(n,t){if(t==0)throw new Error("Cannot divide by 0");n=n.toString(),t=t.toString(),lD(n),lD(t);var e="";n[0]=="-"&&(e="-",n=n.substr(1)),t[0]=="-"&&(t=t.substr(1));var i=ZE(n,QE(t,xc(JE(n,t),0,Ot.FLOOR)));return e+i}function lD(n){if(n.indexOf(".")!=-1)throw new Error("Modulus of non-integers not supported")}function cD(n,t){var e,i,a=!1;if(e=[n,t].map(function(s){return Jn(s)}),n=e[0],t=e[1],n[0]=="-"&&t[0]!="-")return-1;if(n[0]!="-"&&t[0]=="-")return 1;if(n[0]=="-"&&t[0]=="-"&&(n=n.substr(1),t=t.substr(1),a=!0),i=tw(n,t),n=i[0],t=i[1],n.localeCompare(t)==0)return 0;for(var r=0;r<n.length;r++)if(n[r]!=t[r])return n[r]>t[r]?a?-1:1:a?1:-1;return 0}var dt=function(){function n(t){t===void 0&&(t="0"),this.value=n.validate(t)}return n.validate=function(t){if(t){if(t=t.toString(),isNaN(t))throw Error("Parameter is not a number: "+t);t[0]=="+"&&(t=t.substring(1))}else t="0";if(t.startsWith(".")?t="0"+t:t.startsWith("-.")&&(t="-0"+t.substr(1)),/e/i.test(t)){var e=t.split(/[eE]/),i=e[0],a=e[1];i=di(i);var r="";i[0]=="-"&&(r="-",i=i.substring(1)),i.indexOf(".")>=0?(a=parseInt(a)+i.indexOf("."),i=i.replace(".","")):a=parseInt(a)+i.length,i.length<a?t=r+i+new Array(a-i.length+1).join("0"):i.length>=a&&a>0?t=r+di(i.substring(0,a))+(i.length>a?"."+i.substring(a):""):t=r+"0."+new Array(-a+1).join("0")+i}return t},n.prototype.getValue=function(){return this.value},n.prototype.setValue=function(t){this.value=n.validate(t)},n.getPrettyValue=function(t,e,i){e===void 0&&(e=3),i===void 0&&(i=","),t=n.validate(t);var a=t.charAt(0)=="-";a&&(t=t.substring(1));var r=t.indexOf(".");r=r>0?r:t.length;for(var s="",o=r;o>0;)o<e?(e=o,o=0):o-=e,s=t.substring(o,o+e)+(o<r-e&&o>=0?i:"")+s;return(a?"-":"")+s+t.substring(r)},n.prototype.getPrettyValue=function(t,e){return t===void 0&&(t=3),e===void 0&&(e=","),n.getPrettyValue(this.value,t,e)},n.round=function(t,e,i){if(e===void 0&&(e=0),i===void 0&&(i=Ot.HALF_EVEN),t=n.validate(t),isNaN(e))throw Error("Precision is not a number: "+e);return xc(t,e,i)},n.prototype.round=function(t,e){if(t===void 0&&(t=0),e===void 0&&(e=Ot.HALF_EVEN),isNaN(t))throw Error("Precision is not a number: "+t);return new n(xc(this.value,t,e))},n.abs=function(t){return t=n.validate(t),rD(t)},n.prototype.abs=function(){return new n(rD(this.value))},n.floor=function(t){return t=n.validate(t),t.indexOf(".")===-1?t:n.round(t,0,Ot.FLOOR)},n.prototype.floor=function(){return this.value.indexOf(".")===-1?new n(this.value):new n(this.value).round(0,Ot.FLOOR)},n.ceil=function(t){return t=n.validate(t),t.indexOf(".")===-1?t:n.round(t,0,Ot.CEILING)},n.prototype.ceil=function(){return this.value.indexOf(".")===-1?new n(this.value):new n(this.value).round(0,Ot.CEILING)},n.add=function(t,e){return t=n.validate(t),e=n.validate(e),sf(t,e)},n.prototype.add=function(t){return new n(sf(this.value,t.getValue()))},n.subtract=function(t,e){return t=n.validate(t),e=n.validate(e),ZE(t,e)},n.prototype.subtract=function(t){return new n(ZE(this.value,t.getValue()))},n.multiply=function(t,e){return t=n.validate(t),e=n.validate(e),QE(t,e)},n.prototype.multiply=function(t){return new n(QE(this.value,t.getValue()))},n.divide=function(t,e,i){return t=n.validate(t),e=n.validate(e),JE(t,e,i)},n.prototype.divide=function(t,e){return new n(JE(this.value,t.getValue(),e))},n.modulus=function(t,e){return t=n.validate(t),e=n.validate(e),oD(t,e)},n.prototype.modulus=function(t){return new n(oD(this.value,t.getValue()))},n.compareTo=function(t,e){return t=n.validate(t),e=n.validate(e),cD(t,e)},n.prototype.compareTo=function(t){return cD(this.value,t.getValue())},n.negate=function(t){return t=n.validate(t),ew(t)},n.prototype.negate=function(){return new n(ew(this.value))},n.stripTrailingZero=function(t){return t=n.validate(t),Jn(t)},n.prototype.stripTrailingZero=function(){return new n(Jn(this.value))},n.RoundingModes=Ot,n}();var Ic=class{};var{regClass:$2}=Laya,of=class extends rf{constructor(){super(...arguments);this.withdrawText=null;this.allProp=[];this.puzzleNum=0;this.addPuzzleNum=0;this.wbnbRate=0;this.logPage=1;this.logPageSize=0;this.isSearch=!1;this.btnLock=!1;this.tokenData1=[];this.tokenDataAir=[];this.tokenTransData=[];this.currTab=0;this.type=1;this.coinType=-1;this.currencyTokenId=0;this.items=[]}onAwake(){this.m_iLayerType=C.M_POP,this.m_iPositionType=C.UP}onOpened(e){this.list_champ.array=[],e&&e.length>1&&(this.type=e[0],this.coinType=e[1],this.onClickTab(this.type)),this.withdrawText=this.withdrawCode.prompt}onEnable(){this.btn_champDetail.clickHandler=new Laya.Handler(this,this.handleClickBtn,[this.btn_champDetail]),this.btn_champRecord.clickHandler=new Laya.Handler(this,this.handleClickBtn,[this.btn_champRecord]),this.btn_withdrawRecord.label=m.instance.getUILang("ExtractionRecords"),this.btn_airRecord.label=m.instance.getUILang("ExtractionRecords"),this.tf_serviceRate1.text=m.instance.getUILang("service rate"),this.tf_tokenLabMont.text=m.instance.getUILang("token"),this.initTokenWebData(),this.initTokenWebDataAir(),this.initTokenTransData(),this.handleSelectTokenTrans(0),this.initLeftList(),this.initLogList(),this.handleSelectLogType(0),this.handleSelectLogDate(0),this.list_left.selectedIndex=0,this.refreshMoney(),this.btn_transferMoney.on(Laya.Event.CLICK,this,this.onTransferMoney),this.rechargeCode.on(Laya.Event.INPUT,this,this.onRechargeCodeInput),this.rechargeCode.on(Laya.Event.BLUR,this,this.testRechargeCodeInput),this.withdrawCode.on(Laya.Event.INPUT,this,this.onRechargewithdrawCodeInput),this.withdrawCode.on(Laya.Event.BLUR,this,this.testInputData),this.btn_hireRecord.on(Laya.Event.CLICK,this,this.onHireRecord),this.btn_proxyRecord.on(Laya.Event.CLICK,this,this.onProxyRecord),this.btn_claimHire.on(Laya.Event.CLICK,this,this.onClaimHire),this.btn_claimProxy.on(Laya.Event.CLICK,this,this.onClaimProxy),this.btn_claimGuild.on(Laya.Event.CLICK,this,this.onClaimGuild),this.list_web.renderHandler=Laya.Handler.create(this,this.onWebItemRender,null,!1),this.list_token.renderHandler=Laya.Handler.create(this,this.onTokenItemRender,null,!1),this.list_web2.renderHandler=Laya.Handler.create(this,this.onWebItemRender2,null,!1),this.list_token2.renderHandler=Laya.Handler.create(this,this.onTokenItemRender2,null,!1),this.list_token3.renderHandler=Laya.Handler.create(this,this.onTokenItemRender3,null,!1),this.list_token4.renderHandler=Laya.Handler.create(this,this.onTokenItemRender4,null,!1),this.list_left.renderHandler=new Laya.Handler(this,this.onLeftItemRender),this.box_web.on(Laya.Event.CLICK,this,this.onOpenWeb,[this.img_web_pad]),this.box_web2.on(Laya.Event.CLICK,this,this.onOpenWeb,[this.img_web_pad2]),this.box_tokenTrans.on(Laya.Event.CLICK,this,this.onOpenWeb,[this.img_token_pad4]),this.box_token.on(Laya.Event.CLICK,this,this.onOpenToken,[this.img_token_pad]),this.box_token2.on(Laya.Event.CLICK,this,this.onOpenToken,[this.img_token_pad2]),this.box_token3.on(Laya.Event.CLICK,this,this.onOpenToken,[this.img_token_pad3]),this.box_token4.on(Laya.Event.CLICK,this,this.onOpenToken,[this.img_token_pad4]),this.box_selectLog.on(Laya.Event.CLICK,this,this.onOpenToken,[this.img_logType_pad]),this.box_currentDate.on(Laya.Event.CLICK,this,this.onOpenToken,[this.img_logDate_pad]),this.list_logType.renderHandler=Laya.Handler.create(this,this.onlogTypeRender,null,!1),this.list_logDate.renderHandler=Laya.Handler.create(this,this.onlogDateRender,null,!1),this.list_logType.selectHandler=new Laya.Handler(this,this.handleSelectLogType),this.list_logDate.selectHandler=new Laya.Handler(this,this.handleSelectLogDate),this.btn_confirm.on(Laya.Event.CLICK,this,this.onbtnConfirm),this.btn_cardPay.on(Laya.Event.CLICK,this,this.onbtnCardPay),this.btn_max.on(Laya.Event.CLICK,this,this.onbtnMax),this.list_web.selectHandler=new Laya.Handler(this,this.handleSelectWeb),this.list_token.selectHandler=new Laya.Handler(this,this.handleSelectToken),this.list_web2.selectHandler=new Laya.Handler(this,this.handleSelectWebWithdraw),this.list_token2.selectHandler=new Laya.Handler(this,this.handleSelectTokenWithdraw),this.list_token3.selectHandler=new Laya.Handler(this,this.handleSelectTokenAir),this.list_token4.selectHandler=new Laya.Handler(this,this.handleSelectTokenTrans),this.list_left.selectHandler=new Laya.Handler(this,this.handleSelectLeft),this.tf_adress.text=F.instance.walletAddress,this.tf_adressAir.text=F.instance.walletAddress,this.btn_withdraw.on(Laya.Event.CLICK,this,this.onBtnWithdraw),this.btn_withdrawRecord.on(Laya.Event.CLICK,this,this.onBtnWithdrawRecord),this.btn_nodeRevenueRecord.on(Laya.Event.CLICK,this,this.onBtnNodeRevenueRecord),this.btn_jianE.on(Laya.Event.CLICK,this,this.onBtnJianE),this.btn_addE.on(Laya.Event.CLICK,this,this.onBtnAddE),this.btn_addMax.on(Laya.Event.CLICK,this,this.onBtnAddMax),this.btn_airRecord.on(Laya.Event.CLICK,this,this.onBtnAirRecord),this.btn_claimRecom.on(Laya.Event.CLICK,this,this.onClaimRem),g.intance.on(f.EVENT_WELFARE_CLAIM,this,this.onClaimWelfare),g.intance.on(f.CHANGE_ASSET_CHAIN,this,this.changeAssetChain),g.intance.on(f.EVENT_ADD_MONEY_ADDRESS,this,this.onAddMoneyAddress),g.intance.on(f.REFRESH_ALL_WITHDRAW_DATA,this,this.refreshWithdrawData),g.intance.on(f.EVENT_REFRESH_NODE_ONCHAIN_STATUS,this,this.onRefreshNodeStatus),this.btn_Search.on(Laya.Event.CLICK,this,this.searchLogArray,[!0]),this.btn_right.on(Laya.Event.CLICK,this,this.onBtnRightAndRight,[!0]),this.btn_left.on(Laya.Event.CLICK,this,this.onBtnRightAndRight,[!1]),this.btn_Combine.on(Laya.Event.CLICK,this,this.onBtnCombine),this.btn_back&&this.btn_back.on(Laya.Event.CLICK,this,this.setToMainScene),this.box_all.visible=!1,this.initDataView()}setTab(e){for(let i=1;i<11;i++)e==i?this["box_"+i]&&(this["box_"+i].visible=!0):this["box_"+i]&&(this["box_"+i].visible=!1)}async initDataView(){if(!this.destroyed){b.instance.playerDto.country?this.btn_cardPay.visible=!0:this.btn_cardPay.visible=!1,this.type?this.onClickTab(this.type):this.onClickTab(5),this.list_hire.visible=!1,this.list_proxy.visible=!1,this.list_reward.visible=!1,this.listHireReward.visible=!1;var e=b.instance.playerDto.status;e==2?(this.btn_withdraw.visible=!1,this.tf_noAllowed.visible=!0):(this.btn_withdraw.visible=!0,this.tf_noAllowed.visible=!1)}}async showHireData(){var e=await v.requestPost("wxgame/lease/outline",{});if(e&&e.reward){let a=te.processItemsArray(e.reward);e.reward.length>0?this.btn_claimHire.disabled=!1:this.btn_claimHire.disabled=!0;let r=a[0];this.list_hire.array=r,this.list_hire.selectedIndex=-1,this.list_hire.visible=!0,e.leaderCount?this.tf_hireNum.text=m.instance.getLanguage(1179,e.leaderCount):this.tf_hireNum.text=m.instance.getLanguage(1179,0);let s=a[1];var i=[];s.forEach(o=>{var l=new Ne(o.id);l.newAddCnt=o.count,i.push(l)}),this.listHireReward.array=i,this.listHireReward.selectedIndex=-1,this.listHireReward.visible=!0}}async showProxyData(){var e=await v.requestPost("wxgame/lease/outline",{});if(e&&e.childReward){let r=te.processItemsArray(e.childReward),s=r[0],o=r[2];e.childReward.length>0?this.btn_claimProxy.disabled=!1:this.btn_claimProxy.disabled=!0;var i=[],a=o;a.forEach(l=>{var c=new Ne(l.id);c.newAddCnt=l.count,i.push(c)}),this.list_reward.array=i,this.list_reward.visible=!0,this.list_proxy.array=s,this.list_proxy.visible=!0,this.list_proxy.selectedIndex=-1,e.childCount?this.tf_proxyNum.text=m.instance.getLanguage(1180,e.childCount):this.tf_proxyNum.text=m.instance.getLanguage(1180,0)}}async showGuildData(){var e=await v.requestPost("wxgame/money/unionBonusInfo",{});if(e&&e.reward){e.reward.length<1?this.btn_claimGuild.disabled=!0:this.btn_claimGuild.disabled=!1;let r=te.processItemsArray(e.reward),s=r[0],o=r[2];var i=[],a=o;a.forEach(l=>{var c=new Ne(l.id);c.newAddCnt=l.count,i.push(c)}),this.list_guild.array=s,this.list_guild.visible=!0,this.list_guild.selectedIndex=-1}}async showRecommendData(){let e=b.instance.playerDto;this.tf_recomNum.text=m.instance.getLanguage(1531,e.remCount);var i=await v.requestPost("wxgame/money/remRewardList",{});if(i&&i.reward){i.reward.length<1?this.btn_claimRecom.disabled=!0:this.btn_claimRecom.disabled=!1;let r=te.processItemsArray(i.reward)[0];this.list_recommend.array=r,this.list_recommend.visible=!0,this.list_recommend.selectedIndex=-1}}async showNodeRevenueData(){this.list_nodeRevenue.visible=!1;var e=await v.requestPost("paWallet/buyNodeRewardPanel",{});if(e){this.tf_nodeTip.text=m.instance.getLanguage(1835,e.usdt);var i=[],a=e.coinItems;a&&a.forEach(r=>{var s=_.intance.getNodeCurrencyByTokenAndChainId(r.token,r.chainId);s.id!=Ge.ITEM_SNAKE&&i.push(r)}),this.list_nodeRevenue.array=i,i.length>0?this.noDataBox_nodeRevenue.visible=!1:this.noDataBox_nodeRevenue.visible=!0,this.list_nodeRevenue.visible=!0}else E.instance.notice(m.instance.getLanguage(135))}onRefreshNodeStatus(){this.showNodeRevenueData()}initLeftList(){let e=["DEPOSIT","WITHDRAW","HIRE","PROXY","AIRDROP WITHDRAWAL","Token Transfer","Guild","RECOMMENDED BY","Node Revenue","ASSET LOGS"];this.list_left.array=e}async onClickTab(e){this.currTab=e,this.setTab(e),this.box_all.visible=!0,e==1?(this.box_1.visible=!0,await this.initContainer()):e==2?await this.initContainer():e==3?this.showHireData():e==4?this.showProxyData():e==5?this.initContainerAir():e==6?(this.list_address.array=[null],this.initTokenArray(this.list_token4.selectedIndex)):e==7?this.showGuildData():e==8?this.showRecommendData():e==9?this.showNodeRevenueData():e==10&&(this.isSearch||this.searchLogArray())}async handleClickBtn(e){switch(e){case this.btn_champDetail:{let i=await v.requestPost("wxgame/welfare/list",{});i.welfareDtoList?A.intance.openModule(y.ChampDetailDialog,i.welfareDtoList):E.instance.notice(m.instance.getLanguage(135))}break;case this.btn_champRecord:{let i=await v.requestPost("wxgame/welfare/takeList",{});i.welfareDtoList?A.intance.openModule(y.ChampRecordDialog,i.welfareDtoList):E.instance.notice(m.instance.getLanguage(135))}break}}setToMainScene(){oe.intance.setCurrentScene(Y.M_SCENE_MAIN)}onClaimWelfare(e){var i=this.list_champ.array;if(i instanceof Array){for(let a of i)if(a.coinType==e.coinType){a.takeValue=0;continue}this.list_champ.refresh()}}onDisable(){this.removeEvent()}removeEvent(){g.intance.off(f.EVENT_WELFARE_CLAIM,this,this.onClaimWelfare),this.rechargeCode.off(Laya.Event.INPUT,this,this.onRechargeCodeInput),g.intance.off(f.CHANGE_ASSET_CHAIN,this,this.changeAssetChain),this.btn_hireRecord.off(Laya.Event.CLICK,this,this.onHireRecord),this.btn_proxyRecord.off(Laya.Event.CLICK,this,this.onProxyRecord),this.btn_claimHire.off(Laya.Event.CLICK,this,this.onClaimHire),this.btn_claimProxy.off(Laya.Event.CLICK,this,this.onClaimProxy),this.box_web.off(Laya.Event.CLICK,this,this.onOpenWeb),this.box_web2.off(Laya.Event.CLICK,this,this.onOpenWeb),this.box_token.off(Laya.Event.CLICK,this,this.onOpenToken),this.box_token2.off(Laya.Event.CLICK,this,this.onOpenToken),this.box_token3.off(Laya.Event.CLICK,this,this.onOpenToken),this.box_token4.off(Laya.Event.CLICK,this,this.onOpenToken),this.box_selectLog.off(Laya.Event.CLICK,this,this.onOpenToken),this.box_currentDate.off(Laya.Event.CLICK,this,this.onOpenToken),this.btn_confirm.off(Laya.Event.CLICK,this,this.onbtnConfirm),this.btn_max.off(Laya.Event.CLICK,this,this.onbtnMax),this.btn_transferMoney.off(Laya.Event.CLICK,this,this.onTransferMoney),this.rechargeCode.off(Laya.Event.INPUT,this,this.onRechargeCodeInput),this.rechargeCode.off(Laya.Event.BLUR,this,this.testRechargeCodeInput),this.withdrawCode.off(Laya.Event.INPUT,this,this.onRechargewithdrawCodeInput),this.withdrawCode.off(Laya.Event.BLUR,this,this.testInputData),this.box_tokenTrans.off(Laya.Event.CLICK,this,this.onOpenWeb),this.btn_withdraw.off(Laya.Event.CLICK,this,this.onBtnWithdraw),this.btn_withdrawRecord.off(Laya.Event.CLICK,this,this.onBtnWithdrawRecord),this.btn_jianE.off(Laya.Event.CLICK,this,this.onBtnJianE),this.btn_addE.off(Laya.Event.CLICK,this,this.onBtnAddE),this.btn_addMax.off(Laya.Event.CLICK,this,this.onBtnAddMax),this.btn_airRecord.off(Laya.Event.CLICK,this,this.onBtnAirRecord),this.btn_Combine.off(Laya.Event.CLICK,this,this.onBtnCombine),this.btn_Search.off(Laya.Event.CLICK,this,this.searchLogArray),this.btn_right.off(Laya.Event.CLICK,this,this.onBtnRightAndRight),this.btn_left.off(Laya.Event.CLICK,this,this.onBtnRightAndRight),g.intance.offAllCaller(this)}onOpenWeb(e){e.visible==!1&&(e.visible=!0,Laya.stage.on(Laya.Event.MOUSE_DOWN,this,this.onHideList))}onOpenToken(e){e.visible==!1&&(e.visible=!0,Laya.stage.on(Laya.Event.MOUSE_DOWN,this,this.onHideList))}onWebItemRender(e,i){e&&e.onChange&&e.onChange(this.list_web.selectedIndex==i)}onWebItemRender2(e,i){e&&e.onChange&&e.onChange(this.list_web2.selectedIndex==i)}onTokenItemRender(e,i){e&&e.onChange&&e.onChange(this.list_token.selectedIndex==i)}onTokenItemRender2(e,i){e&&e.onChange&&e.onChange(this.list_token2.selectedIndex==i)}onTokenItemRender3(e,i){e&&e.onChange&&e.onChange(this.list_token3.selectedIndex==i)}onTokenItemRender4(e,i){e&&e.onChange&&e.onChange(this.list_token4.selectedIndex==i)}async createWebList(){this.currTab==1?(this.list_web.array=this.webData,this.list_web.visible=!0):(this.list_web2.array=this.webDataWithdraw,this.list_web2.visible=!0),await this.initNetComboBox()}async createTokenList(e){switch(this.currTab){case 1:if(e){let r=this.list_web.selectedItem;var i=_.intance.getTokensByChainId(r,this.currTab);this.list_token.array=i,this.list_token.visible=!0,i.length>0?(this.list_token.selectedIndex=-1,this.list_token.selectedIndex=0):(this.list_token.selectedIndex=-1,this.tf_token.text="N/A")}else this.list_token.array=[],this.list_token.selectedIndex=-1,this.tf_token.text="N/A";break;case 2:if(e){let r=this.list_web2.selectedItem;var a=_.intance.getTokensByChainId(r,this.currTab);this.list_token2.array=a,this.list_token2.visible=!0,a.length>0?(this.list_token2.selectedIndex=-1,this.list_token2.selectedIndex=0):(this.list_token2.selectedIndex=-1,this.tf_token2.text="N/A")}else this.list_token2.array=[],this.list_token2.selectedIndex=-1,this.tf_token2.text="N/A";break;case 6:this.list_token3.array=this.tokenDataAir,this.list_token3.visible=!0,this.list_token3.selectedIndex=0,this.tf_token3.text=`${this.tokenDataAir[0]}`;break;default:break}}onHideList(e){console.log("onHideList"),!(e.target&&e.target.selectImg)&&(this.img_web_pad.visible=!1,this.img_token_pad.visible=!1,this.img_web_pad2.visible=!1,this.img_token_pad2.visible=!1,this.img_token_pad3.visible=!1,this.img_token_pad4.visible=!1,this.img_logType_pad.visible=!1,this.img_logDate_pad.visible=!1,Laya.stage.off(Laya.Event.MOUSE_DOWN,this,this.onHideList))}async initContainer(){await this.createWebList()}async initContainerAir(){this.createTokenList(!0)}async getRestCoin(e){console.log("getRestCoin");try{let i=await F.instance.getBalance2(e.token),a=e.tokenDecimals,r=Dt(i,a);this.tf_rest.text=`${te.truncateToTwoDecimalPlaces(Number(r))}`}catch(i){if(i instanceof Error){let a=i.message;console.log("剩余货币错误",a)}this.tf_rest.text="0"}}async initNetComboBox(){let e=await F.instance.walletClient.getChainId();if(e)switch(this.currTab){case 1:let i=this.list_web.array.findIndex(r=>r==e);this.list_web.selectedIndex=-1,this.list_web.selectedIndex=i,i==-1&&(this.tf_web.text="N/A",this.createTokenList(!1));break;case 2:let a=this.list_web2.array.findIndex(r=>r==e);this.list_web2.selectedIndex=-1,this.list_web2.selectedIndex=a,a==-1&&(this.tf_web2.text="N/A",this.createTokenList(!1));break;case 6:this.handleSelectTokenAir(0);break;default:break}}async switchChain(e=!0){try{let i,a;switch(this.currTab){case 1:a=this.list_web.selectedItem;break;case 2:a=this.list_web2.selectedItem;break;case 6:break;default:break}let r=await F.instance.walletClient.getChainId();if(a!==r&&!await F.instance.switchChain(a)){console.log("切换失败，请手动切换"),await this.addChain(),await this.initNetComboBox();return}return}catch(i){if(i instanceof Error){let a=i.message;(a.includes("Unrecognized chain ID")||a.includes("An unKnown PRC"))&&await this.addChain()}this.initNetComboBox()}}async addChain(){let e;this.currTab===1?e=this.list_web.selectedItem:e=this.list_web2.selectedItem,await F.instance.addChain(e);let i=await F.instance.walletClient.getChainId();i&&this.switchChain(i)}async handleSelectLeft(e){let i=this.list_left.selectedItem;this.onClickTab(e+1)}onLeftItemRender(e,i){e&&e.onChange&&e.onChange(this.list_left.selectedIndex==i)}async handleSelectWeb(e){if(e!=-1){let i=this.list_web.selectedItem;this.tf_web.text=F.instance.getChainName(i),this.createTokenList(!0),await this.switchChain(!0)}else this.createTokenList(!1)}async handleSelectWebWithdraw(e){if(e!=-1){let i=this.list_web2.selectedItem;this.tf_web2.text=F.instance.getChainName(i),this.createTokenList(!0),await this.switchChain(!0)}else this.createTokenList(!1)}handleSelectToken(e){if(e!=-1){var i=this.list_token.selectedItem;this.tf_token.text=i.name,this.refreshToken()}}async refreshWithdrawData(){this.handleSelectTokenWithdraw(this.list_token2.selectedIndex)}async handleSelectTokenWithdraw(e){if(e!=-1){var i=this.list_token2.selectedItem;this.tf_token2.text=i.name;let r=0,s=i.id,o=i.chainId;r=b.instance.getConsumeValue(s),this.tf_appAmount.text=`${te.truncateToTwoDecimalPlaces(r)}`;let l=_.intance.getACoin(o,s);l&&(this.tf_servicerate.text=`${l.Commission/100}%`);var a=await v.requestPost("wxgame/payOrder/query",{chainId:o});if(a&&a.selfData){let c=this.searchRestMoney(a.selfData,s);this.tf_canAmount.text=`${te.truncateToTwoDecimalPlaces(c)}`}}}async handleSelectTokenAir(e){if(e!=-1){this.wbnbRate=0,this.tf_token3.text=`${this.tokenDataAir[e]}`,this.allProp=await this.getItemByType();let i=_.intance.getPuzzleExchangeByName(this.tf_token3.text),a=i.items,r=i.redeemTickets,s=new Ne;s.m_iId=r[0],s.m_iNum=r[1],this.img_extRe.skin=S.instance.getItemIcon(s.itemItem.icon);let o=this.getAirdropArrData(this.allProp,a);this.puzzleNum==0?this.btn_Combine.disabled=!0:this.btn_Combine.disabled=!1,this.listPuzzle.array=o,this.addPuzzleNum=0,this.tf_token3.text=="WICP"||this.tf_token3.text=="WKLAY"||this.tf_token3.text=="WBNRY",this.puzzleNum==0?(this.tf_extraRec.text="0",this.tf_ExtractNum.text="0",this.addPuzzleNum=0):(this.addPuzzleNum=1,this.showExtraNum(1))}}async initTokenArray(e){let i=this.tokenTransData[e];if(i==ge.TYPE_BNRY||i==ge.TYPE_BNB){let r=new Ic;r.checked=!0,r.num=0,z.vType!==2?r.openid="0x4774aF1F0fc3B81c080955ae2eEA8e98AF5E1191":r.openid="0x7571FeB15D5043B2A9e38786d424b5e7a02a5cB2",r.noInput=!0;var a=await v.requestPost("wxgame/sys/queryName",{openid:r.openid.toLowerCase()});r.playerName=a.name,this.list_address.array=[r]}else this.list_address.array=[null]}handleSelectTokenTrans(e){if(e!=-1){let a=this.tokenTransData[e];this.initTokenArray(e);var i=_.intance.m_dicItems.get(a);this.tf_tokenName.text=m.instance.getLanguage(i.name),this.currencyTokenId=a;let r=b.instance.getConsumeValue(a);r<1e-6&&(r=0),this.tf_tokenAmount.text=`${te.formatNumber(r)}`,this.img_token.skin=S.instance.getMoneyIcon(a)}this.img_token_pad4.visible=!1}async showExtraNum(e){this.tf_extraRec.text=`${e}`,this.tf_ExtractNum.text=`${this.addPuzzleNum}`}getAirdropArrData(e,i){let a=[];this.puzzleNum=0;for(let s=0;s<i.length;s++){let o=e.find(l=>l.itemItem.id==i[s][0]);if(o){a.push(o);let l=xe.formatNumber(o.m_iNum,8);a.length==1?this.puzzleNum=l:this.puzzleNum=Math.min(this.puzzleNum,l)}else{var r=new Ne(i[s][0]);r.newAddCnt=0,a.push(r),this.puzzleNum=0}}return this.refreshRestExtraValue(),a}refreshRestExtraValue(){let e=_.intance.getPuzzleExchangeByName(this.tf_token3.text).value,i=_.intance.getPuzzleExchangeByName("WBNB").value,a=`${this.puzzleNum*i}U / `;switch(this.tf_token3.text){case"WTOX":a+=`${xe.filterNumFormat(this.puzzleNum*e,2)}WTOX`;break;case"WBNB":a+=`${xe.filterNumFormat(this.puzzleNum*e*this.wbnbRate,6)}WBNB`;break;case"WGALA":a+=`${xe.filterNumFormat(this.puzzleNum*e*this.wbnbRate,6)}WGALA`;break;case"WGGG":a+=`${xe.filterNumFormat(this.puzzleNum*e*this.wbnbRate,6)}WGGG`;break;case"WICP":a+="?WICP";break;case"WKLAY":a+="?WKLAY";break;case"WBNRY":a+="?WBNRY";break;default:break}this.tf_extraVal.text=a}onRechargeCodeInput(){let e=Number(this.rechargeCode.text),i=te.isNumber(this.rechargeCode.text);(e<0||!i)&&(this.rechargeCode.text="0")}testRechargeCodeInput(){let e=Number(this.rechargeCode.text);this.rechargeCode.text=`${te.formatNumber(e)}`}async onbtnCardPay(){A.intance.openModule(y.CardPayView,1)}async onbtnConfirm(){if(this.btnLock)return;this.btnLock=!0,Laya.timer.once(1e3,this,()=>{this.btnLock=!1}),this.testRechargeCodeInput();let e=Number(this.tf_rest.text),i=Number(this.rechargeCode.text),a=await F.instance.walletClient.getChainId();if(!i){pe.instance().AlertByType(P.BASEALERTVIEW,Ee.instance.get(33),P.YES);return}if(e<i){pe.instance().AlertByType(P.BASEALERTVIEW,Ee.instance.get(34),P.YES);return}var r=this.list_token.selectedItem;if(!r){E.instance.notice(m.instance.getLanguage(1801));return}de.instance.showLoadingByInfo();let s=r.tokenAddress;await Yn.instance.rechargeToken(i,r,s)&&(this.getRestCoin(r),b.instance.rechargeEnd=!0)}async refreshToken(){console.log("refreshToken");try{var e=this.list_token.selectedItem;let i=await F.instance.getBalance2(e.token),a=e.tokenDecimals,r=Dt(i,a);this.tf_rest.text!==r&&(this.tf_rest.text=`${te.truncateToTwoDecimalPlaces(Number(r))}`,Laya.timer.clear(this,this.refreshToken))}catch{this.tf_rest.text="0"}}onbtnMax(){let e=Number(this.tf_rest.text);this.rechargeCode.text=`${e}`}initTokenWebData(){this.webData=[],this.webDataWithdraw=[];var e=_.intance.getGeneralValueById(7),i=_.intance.getGeneralValueById(8);e&&(z.vType==2?(this.webData=e[2],this.webDataWithdraw=i[2]):z.vType==1?(this.webData=e[1],this.webDataWithdraw=i[1]):(this.webData=e[0],this.webDataWithdraw=i[0]))}initTokenWebDataAir(){this.tokenDataAir=["WTOX","WBNB","WGGG","WGALA","WICP","WKLAY","WBNRY"]}initTokenTransData(){this.tokenTransData=_.intance.getGeneralValueById(31);var e=[];for(let a of this.tokenTransData){var i=_.intance.m_dicItems.get(a);i&&e.push(m.instance.getLanguage(i.name))}this.list_token4.array=e}changeAssetChain(){pe.instance().AlertByType(P.BASEALERTVIEW,Ee.instance.get(36),P.YES,Laya.Handler.create(this,()=>{this.switchChain(!0)}))}onHireRecord(){A.intance.openModule(y.HireDetailDialog)}onProxyRecord(){A.intance.openModule(y.ProxyDetailDialog)}async onClaimHire(){if(!this.btnLock){this.btnLock=!0,Laya.timer.once(1e3,this,()=>{this.btnLock=!1});var e=await v.requestPost("wxgame/lease/take",{});if(e&&e.reward.length>0){let i=e.reward,a=[];i.forEach(r=>{var s=new xt;s.id=r.id,s.count=r.count,a.push(s)}),A.intance.openModule(y.RewardGetDialog,a)}this.showHireData()}}async onClaimProxy(){if(!this.btnLock){this.btnLock=!0,Laya.timer.once(1e3,this,()=>{this.btnLock=!1});var e=await v.requestPost("wxgame/lease/childTake",{});if(e&&e.reward&&e.reward.length>0){let i=e.reward;A.intance.openModule(y.RewardGetDialog,i)}this.showProxyData()}}async onClaimGuild(){if(!this.btnLock){this.btnLock=!0,Laya.timer.once(1e3,this,()=>{this.btnLock=!1});var e=await v.requestPost("wxgame/money/unionBonusTake",{});if(e&&e.reward.length>0){let i=e.reward,a=[];i.forEach(r=>{var s=new xt;s.id=r.id,s.count=r.count,a.push(s)}),A.intance.openModule(y.RewardGetDialog,a)}this.showGuildData()}}async onClaimRem(){if(!this.btnLock){this.btnLock=!0,Laya.timer.once(1e3,this,()=>{this.btnLock=!1});var e=await v.requestPost("wxgame/money/remRewardTake",{});if(e&&e.list.length>0){let i=e.list,a=[];i.forEach(r=>{var s=new xt;s.id=r.id,s.count=r.count,a.push(s)}),A.intance.openModule(y.RewardGetDialog,a)}this.showRecommendData()}}onRechargewithdrawCodeInput(){let e=Number(this.withdrawCode.text),i=te.isNumber(this.withdrawCode.text);(e<0||!i)&&this.withdrawCode.text!==this.withdrawText&&(this.withdrawCode.text="0")}async testInputData(){let e=Number(this.withdrawCode.text);var i=this.list_token2.selectedItem;let a=i.id,r=i.chainId,s=_.intance.getACoin(r,a);if(!s)return;let o=Number(this.tf_appAmount.text);e>o?E.instance.notice(Ee.instance.get(111)):e>s.maxAmount?E.instance.notice(m.instance.getLanguage(1211,s.maxAmount)):e<s.minAmount&&E.instance.notice(m.instance.getLanguage(1212,s.minAmount));let l=s.Commission,c=e*(1-l/1e4);a==ge.TYPE_TOX&&r==Ki.id?this.tf_arrive.text=`${c.toFixed(2).replace(/\.?0+$/,"")}`:this.tf_arrive.text=`${c.toFixed(8).replace(/\.?0+$/,"")}`}async onBtnWithdraw(){if(this.btnLock)return;this.btnLock=!0,Laya.timer.once(1e3,this,()=>{this.btnLock=!1});let e=Number(this.tf_appAmount.text);var i=this.list_token2.selectedItem;let a=i.id,r=i.chainId,s=Number(this.withdrawCode.text),o=_.intance.getACoin(r,a);if(!o)return;let l=o.Commission,c=new dt(l/1e4),u=new dt(s),p=c.multiply(u).getValue();if(s>e){E.instance.notice(Ee.instance.get(111));return}if(s>o.maxAmount){E.instance.notice(m.instance.getLanguage(1211,o.maxAmount));return}else if(s<o.minAmount){E.instance.notice(m.instance.getLanguage(1212,o.minAmount));return}if(z.vType==2&&r==zn.id&&!await F.instance.getAuthStatus()){E.instance.notice(Ee.instance.get(113));return}if(i.bankAddress&&i.bankAddress.length>10){let M=await F.instance.getBankBalance(i.token,i.bankAddress,i.name);if(console.log("contractBalance: "+M),M){let H=i.tokenDecimals,V=Dt(M,H),q=Number(V);if(console.log("银行余额 constNum: "+q),q<s){de.instance.hideLoading(),E.instance.notice(m.instance.getLanguage(1356,i.name));return}}}let d=Number(this.tf_arrive.text),L=new dt(s).multiply(new dt(1).subtract(new dt(l).divide(new dt(1e4))));a==ge.TYPE_TOX&&r==Ki.id,d=Number(L.getValue()),console.log("payMoney: ",s,"fee: ",p,"arriveMoney: ",d);let w=_.intance.getCurrency(a,r).token||J.ADDRESS0,I=await v.requestPost("wxgame/payOrder/create",{chainId:r,coinType:a,payMoney:s,fee:p,arriveMoney:d,token:w});I&&I.errorCode==0&&Le.NoHeroError("Pending Review")}onBtnWithdrawRecord(){A.intance.openModule(y.WithDrawRecordDialog)}onBtnNodeRevenueRecord(){A.intance.openModule(y.NodeRevenueRecordDialog)}searchRestMoney(e,i){for(let a=0;a<e.length;a++)if(e[a][0]===i)return e[a][1];return 0}async onBtnCombine(){if(this.btnLock)return;this.btnLock=!0,Laya.timer.once(1e3,this,()=>{this.btnLock=!1});let i=_.intance.getPuzzleExchangeByName(this.tf_token3.text).id;var a=await v.requestPost("wxgame/equip/puzzleExchangeTicket",{puzzleId:i,count:this.addPuzzleNum});if(a){let s=await v.requestPost("wxgame/hero/bagList",{},!0,!0);b.instance.m_packageData.initData(s.data),this.handleSelectTokenAir(this.list_token3.selectedIndex);let o=a.reward;if(o){var r=new xt;r.id=o[0].id,r.count=o[0].count,A.intance.openModule(y.RewardGetDialog,[r])}}}async onBtnAddExtr(){}async getItemByType(){var e=Ge.TYPE_Consumption;this.items=[];for(var i=b.instance.m_packageData.getBackByType(e),a=0;a<i.length;a++){var r=i[a];r?this.items.push(r):this.items.push(new Ne(0))}return this.items}onBtnJianE(){this.addPuzzleNum=Math.max(0,this.addPuzzleNum-1),this.addPuzzleNum<=0?(this.tf_extraRec.text="0",this.tf_ExtractNum.text="0",this.btn_Combine.disabled=!0):this.showExtraNum(this.addPuzzleNum)}onBtnAddE(){this.addPuzzleNum=Math.min(this.puzzleNum,this.addPuzzleNum+1),this.showExtraNum(this.addPuzzleNum),this.addPuzzleNum>0&&(this.btn_Combine.disabled=!1)}onBtnAddMax(){this.puzzleNum<=0||(this.addPuzzleNum=this.puzzleNum,this.showExtraNum(this.addPuzzleNum))}onBtnAirRecord(){A.intance.openModule(y.AirdropRecordDialog)}onAddMoneyAddress(){console.log("onAddMoneyAddress: ",this.list_address.array);let e=new Ic;e.num=0,this.list_address.array||(this.list_address.array=[null]),this.list_address.setItem(this.list_address.array.length-1,e),this.list_address.addItem(null),this.list_address.refresh(),this.list_address.tweenTo(this.list_address.array.length-1)}async onTransferMoney(){if(this.btnLock)return;this.btnLock=!0,Laya.timer.once(1e3,this,()=>{this.btnLock=!1});var e=[];let i=0;this.list_address.array.forEach(s=>{s&&s.checked&&s.playerName&&s.openid&&s.num>0&&(e.push({address:s.openid,num:s.num}),i+=s.num)});let a=Number(this.tf_tokenAmount.text);if(i>a){E.instance.notice(Ee.instance.get(56));return}if(e.length>0){let s=this.currencyTokenId;var r=await v.requestPost("wxgame/welfare/coinTransfer",{list:e,id:s});if(r){let o=r.remainingCoin;s==o[0]&&(this.tf_tokenAmount.text=`${te.formatNumber(o[1])}`),E.instance.notice(m.instance.getLanguage(2e3));let l=Laya.Handler.create(this,()=>{this.list_address.array=[null]});s!==ge.TYPE_BNRY&&s!==ge.TYPE_BNB&&pe.instance().AlertByType(P.BASEALERTVIEW,m.instance.getLanguage(1551),P.SURE,l)}else E.instance.notice(m.instance.getLanguage(135))}else E.instance.notice(m.instance.getUILang("Please enter the recipient address."))}async refreshMoney(){var e=await v.requestPost("wxgame/money/panel",{});if(e&&this.currTab==2){let i=te.getCurrencyIdByName(this.tf_token2.text),a=b.instance.getConsumeValue(i);this.tf_appAmount.text=`${te.truncateToTwoDecimalPlaces(a)}`}}initLogList(){var e=_.intance.getGeneralValueById(21);this.list_logType.array=e,this.list_logType.selectedIndex=0;var i=_.intance.getGeneralValueById(22);this.list_logDate.array=i,this.list_logDate.selectedIndex=0,console.log(e)}onlogTypeRender(e,i){e&&e.onChange&&e.onChange(this.list_logType.selectedIndex==i)}onlogDateRender(e,i){e&&e.onChange&&e.onChange(this.list_logDate.selectedIndex==i)}handleSelectLogType(e){if(e!=-1){let i=this.list_logType.selectedItem;this.tf_selectLog.text=`${m.instance.getLanguage(i)}`}}handleSelectLogDate(e){if(e!=-1){let i=this.list_logDate.selectedItem;this.tf_selectLogDate.text=`${m.instance.getLanguage(i)}`}}async searchLogArray(e=!1){let i;switch(this.list_logType.selectedItem){case 1536:i=0;break;case 1537:i=2;break;case 1538:i=12;break;case 1539:i=20;break;case 1540:i=19;break;case 1541:i=6;break;case 1542:i=23;break;case 1549:i=31;break;case 1550:i=1;break;default:i=0;break}let a=this.list_logDate.selectedIndex+1;a==6&&(a=0),e&&(this.logPage=1),this.isSearch=!0;let r=await v.requestPost("wxgame/player/itemRecordPageList",{pageSize:10,pageIndex:this.logPage,logType:i,timeType:a});this.list_recordLog.array=r.list,this.tf_pearchPage.text=`${this.logPage}/${r.pages}`,this.logPageSize=r.pages,console.log(r)}onBtnRightAndRight(e){let i=this.logPage;e?this.logPage=Math.min(this.logPageSize,this.logPage+1):this.logPage=Math.max(1,this.logPage-1),i!==this.logPage&&this.searchLogArray()}};of=h([$2("lWg_-biNSI2538WxA3KVVw")],of);var{regClass:X2,property:iw}=Laya,Ec=Laya.Browser,Q2=Laya.Render,J2=Laya.SpriteUtils,rt=class extends Laya.Script{constructor(){super();rt.instance=this}onEnable(){this.videoBtn.on(Laya.Event.MOUSE_DOWN,this,()=>{this.createElementVideo()})}createElementVideo(){Ec.window.IframeElementRT=this;var e="aa289ea0-a5fc-41df-8288-7961c1b4cc87",i="1982f465-31d2-414b-ac52-5522e695a3c0";let a="https://uat-paymentapi.bitzaro.com/widget";var r=F.instance.walletAddress,s=b.instance.playerDto.pid,o="shasta",l="usdt";if(z.vType==2){var o="binance",l="usdt";a="https://paymentapi.bitzaro.com/widget";let d=window.location.hostname;var c={"app.phantomarena.ai":{email:"ceo@phantomarena.co",apiKey:"f2761d89-6305-4efe-b01b-a5c6c98f6d97",secretKey:"fe672313-dc47-42fc-9b6e-bf458f418255"},"www.phantomarena.ai":{email:"alanhung8888@gmail.com",apiKey:"daf670b4-10ab-4cfc-a91e-c41da2dc1112",secretKey:"0269186d-b10f-4ee4-8932-2dcdf1dc57b3"},"app.phantomarena.co":{email:"Clara.tuong@gmail.com",apiKey:"dcc9e12d-bcaa-4a95-832f-ccd455141684",secretKey:"7113752a-425e-434a-905f-7c35ce86e11a"},"www.phantomarena.co":{email:"yenlinh.tuong@gmail.com",apiKey:"5a6d0862-7f08-44d2-bd91-11d681fccfbe",secretKey:"87a01e91-7c36-48f1-9be1-57e98de0416b"}}[d];c&&(console.log("domain:",d),e=c.apiKey,i=c.secretKey)}getPayApi(a,e,i,r,o,l,s,this.createElementVideoDetail)}createElementVideoDetail(e){var i=e.link;i?(rt.instance.createScript(),rt.instance.createDiv(),rt.instance.createIframe(i),rt.instance.setDOMElementInArea(),Laya.stage.on(Laya.Event.RESIZE,rt.instance,rt.instance.setDOMElementInArea)):(console.error(e.message),rt.instance.videoBtn.label=e.message)}setDOMElementInArea(){this.iframeElement!=null&&J2.fitDOMElementInArea(this.iframeElement,this.iframeBox,0,0,this.iframeBox.width,this.iframeBox.height)}createScript(){this.scriptElement=Ec.document.createElement("script"),Ec.document.body.appendChild(this.scriptElement),this.scriptElement.innerHTML="function closeVideo(){IframeElementRT.closeVideo() }"}createIframe(e){this.iframeElement=Ec.createElement("iframe"),Ec.document.body.appendChild(this.iframeElement),this.iframeElement.style.zIndex=Q2.canvas.style.zIndex+998,this.iframeElement.src=e,this.iframeElement.allow="camera; microphone",this.iframeElement.style.margin="0",this.iframeElement.style.frameborder="0",this.iframeElement.style.border="none",this.iframeElement.style.borderRadius="0.5rem",this.iframeElement.style.background="white",this.iframeElement.style.padding="0",this.iframeElement.style.left="0",this.iframeElement.style.top="0px",this.iframeElement.style.position="absolute"}createDiv(){}closeVideo(){Laya.Browser.document.body.removeChild(this.scriptElement),Laya.Browser.document.body.removeChild(this.iframeElement),this.scriptElement=this.iframeElement=null,Laya.stage.off(Laya.Event.RESIZE,this,this.setDOMElementInArea)}};h([iw({type:Laya.Button})],rt.prototype,"videoBtn",2),h([iw({type:Laya.Box})],rt.prototype,"closeBox",2),h([iw({type:Laya.Box})],rt.prototype,"iframeBox",2),rt=h([X2("ZtMxoJHQTWipjGWyGV51jQ")],rt);var lf=class extends Laya.Dialog{};var{regClass:Z2}=Laya,cf=class extends lf{constructor(){super(...arguments);this.m_strName="我是OpenSceneRuntime";this.m_iLayerType=C.M_PANEL;this.m_iPositionType=C.CENTER;this.currTab=0}onEnable(){this.btn_back.on(Laya.Event.CLICK,this,this.onBack);for(let e=1;e<3;e++)this["btn_"+e].on(Laya.Event.CLICK,this,this.onClickTab,[e])}setOpenData(e){console.log("setOpenData: ",e),this.itemVo=e,this.onClickTab(1),this.callLater(this.createIframe)}createIframe(){rt.instance.iframeElement&&rt.instance.closeVideo(),!rt.instance.iframeElement&&rt.instance.createElementVideo()}onClickTab(e){this.currTab!=e&&(this.currTab=e,this.setTab(e),e==1?this.alertDesc.text=_.intance.getGeneralValueById(33):e==2&&(this.alertDesc.text=_.intance.getGeneralValueById(34)))}setTab(e){for(let i=1;i<3;i++)e==i?(this["btn_"+i].getChildByName("btn_yellowBg").visible=!0,this["btn_"+i].getChildByName("Label").color="#ffffff"):(this["btn_"+i].getChildByName("btn_yellowBg").visible=!1,this["btn_"+i].getChildByName("Label").color="#64b4ec")}onBack(){this.close()}onDisable(){this.removeEvent()}removeEvent(){this.btn_back.off(Laya.Event.CLICK,this,this.onBack),rt.instance.iframeElement&&rt.instance.closeVideo()}};cf=h([Z2("VKTfedC1Q_2f1d3bFS4oYQ")],cf);var uf=class extends Laya.Dialog{};var{regClass:eB}=Laya,mf=class extends uf{constructor(){super()}onEnable(){this.list_champ.renderHandler=Laya.Handler.create(this,this.onItemRender,null,!1)}setOpenData(t){t&&t instanceof Array&&(this.list_champ.array=t,!t||t.length<=0?this.noDataBox.visible=!0:this.noDataBox.visible=!1)}onItemRender(t,e){t.onSetIndex(e)}onDisable(){}};mf=h([eB("mXj9kkXUQny2iuvlC1REmA")],mf);var pf=class extends Laya.Box{};var{regClass:tB}=Laya,hf=class extends pf{set dataSource(e){super.dataSource=e,this.welfareDto=e,this.welfareDto&&this.setCurrentOutPut()}onSetIndex(e){this.tf_id.text=e+1+""}setCurrentOutPut(){this.tf_createDate.text=se.formatTimeStamp(this.welfareDto.createDate,"YY-MT-DD");let e=this.welfareDto.coinType;this.img_coinType.skin=S.instance.getMoneyIcon(e),this.tf_type.text=m.instance.getUILang("Staking_Type_"+this.welfareDto.type),this.tf_coinValue.text=xe.formatNumberStr(this.welfareDto.coinValue,8),this.tf_remainValue.text=xe.formatNumberStr(this.welfareDto.remainValue,8),this.tf_remainDays.text=this.welfareDto.remainDays+""}};hf=h([tB("b0cMZEy9S5q2q_vqsjWzDA")],hf);var df=class extends Laya.Box{};var{regClass:iB}=Laya,ff=class extends df{constructor(){super();this.isAddEvent=!1}addEvent(){this.isAddEvent||(this.btn_claim.on(Laya.Event.CLICK,this,this.onClaim),this.isAddEvent=!0)}async onClaim(){if(this.welfareOutlineDto.takeValue>0){let i=await v.requestPost("wxgame/welfare/take",{coinType:this.welfareOutlineDto.coinType});if(i){var e=new xt;e.id=i.coinType,e.count=i.coinValue,A.intance.openModule(y.RewardGetDialog,[e]),g.intance.event(f.EVENT_WELFARE_CLAIM,i)}else E.instance.notice(m.instance.getLanguage(135))}}set dataSource(e){super.dataSource=e,this.welfareOutlineDto=e,this.welfareOutlineDto&&(this.addEvent(),this.setCurrentOutPut())}async setCurrentOutPut(){let e=this.welfareOutlineDto.coinType;this.img_coinType.skin=S.instance.getItemIcon(e),this.tf_allValue.text=xe.formatNumberStr(this.welfareOutlineDto.allValue,8),this.tf_todayRelease.text=xe.formatNumberStr(this.welfareOutlineDto.todayRelease,8),this.tf_takeValue.text=xe.formatNumberStr(this.welfareOutlineDto.takeValue,8),this.btn_claim.disabled=this.welfareOutlineDto.takeValue<=0}};ff=h([iB("XTGeF2FhTp2j7VZIhqRAtg")],ff);var yf=class extends Laya.Dialog{};var{regClass:aB}=Laya,bf=class extends yf{constructor(){super()}onEnable(){this.list_champ.renderHandler=Laya.Handler.create(this,this.onItemRender,null,!1)}setOpenData(t){t&&t instanceof Array&&(this.list_champ.array=t,!t||t.length<=0?this.noDataBox.visible=!0:this.noDataBox.visible=!1)}onItemRender(t,e){t.onSetIndex(e)}onDisable(){}};bf=h([aB("RzcjHDjIS62Ejw744kaKKw")],bf);var gf=class extends Laya.Box{};var{regClass:nB}=Laya,Lf=class extends gf{set dataSource(e){super.dataSource=e,this.welfareTakeDto=e,this.welfareTakeDto&&this.setCurrentOutPut()}onSetIndex(e){this.tf_id.text=e+1+""}setCurrentOutPut(){this.tf_takeTime.text=se.formatTimeStamp(this.welfareTakeDto.takeTime,"YY-MT-DD");var e=this.welfareTakeDto.reward,i=[];e&&e.forEach(a=>{var r=new Ne(a.id);r.newAddCnt=a.count,i.push(r)}),this.list_reward.array=i}};Lf=h([nB("0TASbeEtRlmozr-j6sElTw")],Lf);var _f=class extends Laya.Dialog{};var{regClass:rB}=Laya,vf=class extends _f{constructor(){super()}onEnable(){this.setOpenData(),this.list_sum.visible=!1,this.list_sumProp.visible=!1,this.list_champ.visible=!1}async setOpenData(){var t=await v.requestPost("wxgame/lease/takeList",{});if(t){let i=t.list;i=te.addIndexToObjects(i),this.list_champ.array=i,this.list_champ.visible=!0;let a=te.sumItemCount(i),r=te.processItemsArray(a,!1),s=r[0],o=r[1];this.list_sum.array=s,this.list_sum.visible=!0,s.length>3?this.list_sum.y=506:this.list_sum.y=533;var e=[];o.forEach(l=>{var c=new Ne(l.id);c.newAddCnt=l.count,e.push(c)}),this.list_sumProp.array=e,this.list_sumProp.visible=!0}}onDisable(){}};vf=h([rB("ZG7XYFvMTD-oZPNAmJhfIQ")],vf);var xf=class extends Laya.Box{};var{regClass:sB}=Laya,If=class extends xf{constructor(){super()}set dataSource(e){super.dataSource=e,this.itemDto=e,this.itemDto&&this.setCurrentOutPut()}async setCurrentOutPut(){let e=this.itemDto.id;this.img_coinType.skin=S.instance.getItemIcon(e),this.tf_takeValue.text=xe.formatNumberStr(this.itemDto.count,8)}};If=h([sB("S4XctoHfRm66A2jjw3rSsQ")],If);var Ef=class extends Laya.Box{};var{regClass:oB}=Laya,wf=class extends Ef{constructor(){super();this.isAddEvent=!1}addEvent(){this.isAddEvent||(this.isAddEvent=!0)}set dataSource(e){super.dataSource=e,this.btnName=e,e=="Guild"&&b.instance.playerDto.unionLeader!==1?this.disabled=!0:this.disabled=!1,this.tf_txt.text=this.btnName,this.addEvent()}onChange(e){e?(this.selectBox.visible=!0,this.tf_txt.color="#143f6b"):(this.selectBox.visible=!1,this.tf_txt.color="#4e87b7")}};wf=h([oB("cbJ24As0TNGTuTkEeEDFzQ")],wf);var Tf=class extends Laya.Box{};var{regClass:lB}=Laya,Cf=class extends Tf{set dataSource(e){super.dataSource=e,e&&(this.tf_data.text=m.instance.getLanguage(e))}onDisable(){}onChange(e){e?(this.selectImg.visible=!0,this.tf_data.color="#ffffff"):(this.tf_data.color="#357cc0",this.selectImg.visible=!1)}};Cf=h([lB("mPcFFRzmR82zTzTJafri7Q")],Cf);var Sf=class extends Laya.Box{};var{regClass:cB}=Laya,Df=class extends Sf{constructor(){super();this.isAddEvent=!1;this.addL=1}createChildren(){super.createChildren()}addEvent(){this.isAddEvent||(this.tf_uid.on(Laya.Event.BLUR,this,this.setPlayerName),this.tf_uid.on(Laya.Event.FOCUS,this,this.uidFocus),this.btn_add.on(Laya.Event.CLICK,this,this.onAdd),this.btn_reduce.clickHandler=new Laya.Handler(this,this.handleClickBtn,[this.btn_reduce]),this.btn_plus.clickHandler=new Laya.Handler(this,this.handleClickBtn,[this.btn_plus]),this.isAddEvent=!0,this.tf_num.on(Laya.Event.BLUR,this,this.testRechargeCodeInput))}testRechargeCodeInput(){let e=Number(this.tf_num.text),i=te.isNumber(this.tf_num.text);if(e<0||!i)this.tf_num.text="",this.addL=0;else{let a=te.formatNumber(e);this.tf_num.text=`${a}`,this.addL=a}this.setItemNum()}set dataSource(e){super.dataSource=e,this.moneyAddressVo=e,this.moneyAddressVo?(this.btn_add.visible=!1,this.box_address.visible=!0,this.tf_uid.text=this.moneyAddressVo.openid,this.tf_player_name.text=this.moneyAddressVo.playerName,this.tf_uid.disabled=e.noInput,console.log("data1: ",e),this.addL=this.moneyAddressVo.num,this.setItemNum()):(this.btn_add.visible=!0,this.box_address.visible=!1,console.log("data2: ",e)),this.addEvent()}onAdd(){g.intance.event(f.EVENT_ADD_MONEY_ADDRESS)}async setPlayerName(){try{if(this.tf_uid.text=="")return;this.moneyAddressVo.openid=this.tf_uid.text.toLowerCase();var e=await v.requestPost("wxgame/sys/queryName",{openid:this.tf_uid.text.toLowerCase()});e&&(console.log(e),this.tf_player_name.text=e.name,this.moneyAddressVo.checked=!0,this.moneyAddressVo.playerName=e.name)}catch{}}uidFocus(){this.moneyAddressVo.openid="",this.moneyAddressVo.playerName="",this.moneyAddressVo.checked=!1,this.tf_uid.text="",this.tf_player_name.text=""}handleClickBtn(e){switch(e){case this.btn_reduce:this.addL>1&&(this.addL=te.formatNumber(this.addL-1)),this.setItemNum();break;case this.btn_plus:this.addL=te.formatNumber(this.addL+1),this.setItemNum();break}}setItemNum(){this.addL?this.tf_num.text=this.addL+"":this.tf_num.text="",this.moneyAddressVo.num=this.addL}onDisable(){this.removeEvent()}removeEvent(){this.tf_uid.off(Laya.Event.BLUR,this,this.setPlayerName),this.tf_uid.off(Laya.Event.FOCUS,this,this.uidFocus),this.btn_add.off(Laya.Event.CLICK,this,this.onAdd),this.tf_num.off(Laya.Event.BLUR,this,this.testRechargeCodeInput)}};Df=h([cB("J6QFYTIIQjqstznXD28nBA")],Df);var Af=class extends Laya.Box{};var kf=class n{constructor(){this.lastTime=0}static get instance(){return n._instance||(n._instance=new n),n._instance}async buyItemOnChain(t){var e=new Date().getTime();if(e-this.lastTime<1e3)return;this.lastTime=e;var i=t.chainId,a=_.intance.getNodeCurrencyByTokenAndChainId(t.token,t.chainId);let r=a.id;de.instance.showLoadingByInfo(m.instance.getLanguage(1119));let s=a.nodeRevenueAddress,o=F.instance.walletAddress,l=await F.instance.walletClient.getChainId();try{if(l!==i&&!await F.instance.switchChain(i)){this.onEndItemCallback(),console.log("===>> 切换失败，请手动切换");return}let ee=a.token;if(!ee){this.onEndItemCallback(),E.instance.notice(m.instance.getLanguage(1177,l));return}if(!s){this.onEndItemCallback(),E.instance.notice(m.instance.getLanguage(1174,l));return}var c=0,u=t.amount;let Be=new dt(u);console.log("===>> 获取当前余额 tokenAddress: "+ee+", chainIDData:"+i);let we=await F.instance.getBalance2(ee),$=pi(Be.getValue()+"",a.tokenDecimals);var p=a.token==0?$:pi("0",a.tokenDecimals);if(parseFloat(we)<parseFloat($)){this.onEndItemCallback(),Le.moneyNotEnought(r);return}console.log("===>> 开始验证 tokenAddress: "+ee+", chainIDData:"+i+", need:"+$+", have:"+we+", 转换后 need:"+Dt($,a.tokenDecimals)+", have:"+Dt(we,a.tokenDecimals));var d={token:a.token,chainId:i,amount:u};let Oe=await v.requestPost("paWallet/buyNodeRewardTake",d).catch(ve=>{console.log("===>> 检验失败"),this.onEndItemCallback(),de.instance.hideLoading()});if(!Oe)return!1;var L=Oe.sender,x=Oe.token,w=Oe.amount,I=Oe.pid,M=Oe.orderId,H=Oe.deadline,V=Oe.signature;this.orderId=M;var q=w==$;if(console.log("===>> 服务端: amount: "+w+", 客户端: need:"+$+", 是否一致:"+q+", signature:"+V),!q||V=="")return E.instance.notice(m.instance.getLanguage(2001)),console.log("===>> 签名失败: 【amount不一致】 或者 【签名为空】 或者 【orderId是0】 orderId:"+M),this.onEndItemCallback(),de.instance.hideLoading(),!1;var X=await F.instance.walletClient.writeContract({address:s,abi:J.nodeWithdrawToken_ABI,functionName:"withdrawToken",args:[L,x,w,I,M,H,V],account:o});let ce;return ce=await F.instance.publicClient.waitForTransactionReceipt({hash:X,pollingInterval:1e3}),console.log(`Tx with hash: ${X}`,ce),ce&&ce.status=="success"?(this.waitGetQuanReward(i,X),console.log(`Tx successful with hash: ${X}`),X):(this.onEndItemCallback(),Le.TransactionErrorTip(),!1)}catch(ee){var Z=ee.shortMessage;if(Z)if(Z.indexOf("does not match")!=-1){var Q=F.instance.getChainName(i);Z=m.instance.getLanguage(1172,Q),this.onEndItemCallback()}else Z.indexOf("User rejected the request")!=-1&&this.onEndItemCallback(1);else this.onEndItemCallback();if(console.log(Z),E.instance.notice(Z),ee instanceof K){let ae=ee.walk(Be=>Be instanceof vt);if(ae instanceof vt){let Be=ae.data?.errorName??"";console.log("===>> ============errorName: "+Be)}}return null}}onEndItemCallback(t=null){de.instance.hideLoading(),t&&g.intance.event(f.EVENT_REFRESH_NODE_ONCHAIN_STATUS,[t])}waitGetQuanReward(t,e){this.chainId=t,this.hashId=e,Laya.timer.loop(2e3,this,this.getItemReward)}async getItemReward(){var t=await v.requestPost("paWallet/buyNodeRewardTakeLoop",{orderId:this.orderId,chainId:this.chainId,hashId:this.hashId}).catch(i=>{}),e=t.status;t&&e>0&&(Laya.timer.clear(this,this.getItemReward),this.onEndItemCallback(1))}};var{regClass:uB}=Laya,Bf=class extends Af{constructor(){super();this.isAddEvent=!1}addEvent(){this.isAddEvent||(this.btn_claim.on(Laya.Event.CLICK,this,this.onClaim),this.isAddEvent=!0)}async onClaim(){this.buyNodeRewardDto.amount>0&&await kf.instance.buyItemOnChain(this.buyNodeRewardDto)}set dataSource(e){super.dataSource=e,this.buyNodeRewardDto=e,this.buyNodeRewardDto&&(this.addEvent(),this.setCurrentOutPut())}async setCurrentOutPut(){var e=_.intance.getNodeCurrencyByTokenAndChainId(this.buyNodeRewardDto.token,this.buyNodeRewardDto.chainId);let i=e.id;this.img_coinType.skin=S.instance.getItemIcon(i);var a=_.intance.m_dicItems.get(i);this.tf_coinName.text=m.instance.getLanguage(a.name),this.tf_claimed.text=xe.formatNumberStr(this.buyNodeRewardDto.takedAmount,8),this.tf_toBeClaimed.text=xe.formatNumberStr(this.buyNodeRewardDto.amount,8),this.btn_claim.disabled=this.buyNodeRewardDto.amount<=0}};Bf=h([uB("mLpxdBFjTryN4itcTshIvQ")],Bf);var Mf=class extends Laya.Dialog{};var{regClass:mB}=Laya,Rf=class extends Mf{constructor(){super()}onEnable(){this.list_champ.visible=!1,this.setOpenData()}async setOpenData(){var t=await v.requestPost("paWallet/buyNodeRewardTakeRecord",{});if(t){let e=t.records;this.list_champ.array=e,this.list_champ.visible=!0}!t.records||t.records.length<=0?this.noDataBox.visible=!0:this.noDataBox.visible=!1}onDisable(){}};Rf=h([mB("NH__XdhsQzSj7dMNXhabYg")],Rf);var Pf=class extends Laya.Box{};var{regClass:pB}=Laya,Nf=class extends Pf{constructor(){super()}addEvent(){}set dataSource(t){if(super.dataSource=t,!t){this.visible=!1;return}this.setData(t),this.addEvent()}setData(t){let e=se.formatDayAndTime(t.time);this.tf_time.text=e.date+" "+e.time;var i=_.intance.getNodeCurrencyByTokenAndChainId(t.token,t.chainId);let a=i.id;var r=_.intance.m_dicItems.get(a);switch(this.tf_coinName.text=m.instance.getLanguage(r.name),this.img_coinType.skin=S.instance.getMoneyIcon(a),this.tf_amounte.text=`${t.amount}`,this.tf_network.text=F.instance.getChainName(t.chainId),t.status){case 0:this.tf_status.text="Failed",this.tf_status.color="#cd4a4a";break;case 1:var s=m.instance.getUILang("successfully");this.tf_status.text=s,this.tf_status.color="#4be063";break}}};Nf=h([pB("dOQntgNfRi2U8cpYHzmOSg")],Nf);var Of=class extends Laya.Box{};var{regClass:hB}=Laya,Hf=class extends Of{constructor(){super();this.isAddEvent=!1}addEvent(){}set dataSource(e){super.dataSource=e,this.pledgeData=e,this.pledgeData&&(this.addEvent(),this.setCurrentOutPut())}async setCurrentOutPut(){let e=this.pledgeData.reward,i=te.processItemsArray(e,!1),a=i[0],r=i[1];this.list_champ.array=a,a.length>3?this.list_champ.y=14:this.list_champ.y=40,this.tf_id.text=`${this.pledgeData.index+1}`;var s=[];r.forEach(o=>{var l=new Ne(o.id);l.newAddCnt=o.count,s.push(l)}),this.listHireReward.array=s,this.tf_days.text=se.getYearMonthDat(this.pledgeData.takeTime)}};Hf=h([hB("_mG5oDuaQY6l5yGUFmpG4w")],Hf);var Uf=class extends Laya.Box{};var{regClass:dB}=Laya,Vf=class extends Uf{constructor(){super();this.isAddEvent=!1}addEvent(){}set dataSource(e){super.dataSource=e,this.pledgeData=e,e&&(this.addEvent(),this.setCurrentOutPut(e))}async setCurrentOutPut(e){this.img_coinType.skin=S.instance.getItemIcon(e.id),this.tf_coinValue.text=xe.formatNumberStr(e.count,8)}};Vf=h([dB("5t1LQunTRFOali6ENPwdqQ")],Vf);var Ff=class extends Laya.Dialog{};var{regClass:fB}=Laya,Gf=class extends Ff{constructor(){super()}onEnable(){this.setOpenData(),this.list_sum.visible=!1,this.list_sumProp.visible=!1,this.list_champ.visible=!1}async setOpenData(){var t=await v.requestPost("wxgame/lease/childTakeList",{});if(t){let i=t.list;i=te.addIndexToObjects(i),this.list_champ.array=i,this.list_champ.visible=!0;let a=te.sumItemCount(i),r=te.processItemsArray(a,!1),s=r[0],o=r[1];this.list_sum.array=s,this.list_sum.visible=!0,s.length>3?this.list_sum.y=506:this.list_sum.y=533;var e=[];o.forEach(l=>{var c=new Ne(l.id);c.newAddCnt=l.count,e.push(c)}),this.list_sumProp.array=e}}onDisable(){}};Gf=h([fB("hbicTwT0TxSxlRep4P48Tw")],Gf);var Kf=class extends Laya.Box{};var{regClass:yB}=Laya,qf=class extends Kf{constructor(){super();this.isAddEvent=!1}createChildren(){super.createChildren()}addEvent(){this.isAddEvent||(this.btn_copyFrom.on(Laya.Event.CLICK,this,this.onClickCopy,[!0]),this.btn_copyTo.on(Laya.Event.CLICK,this,this.onClickCopy,[!1]))}set dataSource(e){if(super.dataSource=e,!e)return;this.recordItemVo=e,this.tf_day.text=se.getYearMonthDat(this.recordItemVo.time),this.tf_quilty.text=`${this.recordItemVo.count}`;let i=_.intance.m_dicItems.get(this.recordItemVo.itemId);i&&(this.tf_item.text=m.instance.getLanguage(i.name)),this.setTypeData(),this.recordItemVo.from?(this.tf_from.text=`${te.shortenString(this.recordItemVo.from,8,6)}`,this.btn_copyFrom.visible=!0):(this.tf_from.text="N/A",this.btn_copyFrom.visible=!1),this.recordItemVo.to?(this.tf_to.text=`${te.shortenString(this.recordItemVo.to,8,6)}`,this.btn_copyTo.visible=!0):(this.tf_to.text="N/A",this.btn_copyTo.visible=!1),this.addEvent()}onClickCopy(e){e?doCopy(this.recordItemVo.from):doCopy(this.recordItemVo.to),E.instance.notice(m.instance.getLanguage(132))}setTypeData(){let e;switch(this.recordItemVo.logType){case 0:e=1536;break;case 2:e=1537;break;case 12:e=1538;break;case 20:e=1539;break;case 19:e=1540;break;case 6:e=1541;break;case 23:e=1542;break;case 31:e=1549;break;case 1:e=1550;break;default:e=1536;break}this.tf_type.text=m.instance.getLanguage(e)}onDisable(){this.removeEvent()}removeEvent(){}};qf=h([yB("DhTylrISSfmA8oRRMwHOnw")],qf);var Wf=class extends Laya.Box{};var{regClass:bB}=Laya,Yf=class extends Wf{set dataSource(e){if(super.dataSource=e,e){var i=e;this.tf_data.text=F.instance.getChainName(i)}}onDisable(){}onChange(e){e?(this.selectImg.visible=!0,this.tf_data.color="#ffffff"):(this.tf_data.color="#357cc0",this.selectImg.visible=!1)}};Yf=h([bB("psWSlYJaS8O0LUu-BH6R2Q")],Yf);var zf=class extends Laya.Box{};var{regClass:gB}=Laya,jf=class extends zf{set dataSource(e){if(super.dataSource=e,e){var i=e;this.tf_data.text=i.name}}onDisable(){}onChange(e){e?(this.selectImg.visible=!0,this.tf_data.color="#ffffff"):(this.tf_data.color="#357cc0",this.selectImg.visible=!1)}};jf=h([gB("2gLgNMBIQd-cWw6HJjr46Q")],jf);var $f=class extends Laya.Dialog{};var{regClass:LB}=Laya,Xf=class extends $f{constructor(){super()}onEnable(){this.list_champ.visible=!1,this.setOpenData()}async setOpenData(){var t=await v.requestPost("wxgame/payOrder/list",{});if(t){let e=t.orderItems;this.list_champ.array=e,this.list_champ.visible=!0}!t.orderItems||t.orderItems.length<=0?this.noDataBox.visible=!0:this.noDataBox.visible=!1}onDisable(){}};Xf=h([LB("y0xiZs-qSDWRAXN_oE10yg")],Xf);var Qf=class extends Laya.Box{};var{regClass:_B}=Laya,Jf=class extends Qf{constructor(){super()}addEvent(){}set dataSource(t){if(super.dataSource=t,!t){this.visible=!1;return}this.setData(t),this.addEvent()}setData(t){let e=se.formatDayAndTime(t.createTime);switch(this.tf_day.text=e.date,this.tf_minute.text=e.time,this.img_coinType.skin=S.instance.getMoneyIcon(t.coinType),this.tf_amounte.text=`${t.payMoney}`,this.tf_serviceRate.text=`${t.fee.toFixed(8).replace(/\.?0+$/,"")}`,this.tf_arrive.text=`${t.arriveMoney.toFixed(8).replace(/\.?0+$/,"")}`,this.tf_network.text=F.instance.getChainName(t.matchId),t.status){case 0:this.tf_status.text="Pending review",this.tf_status.color="#4be063";break;case 1:this.tf_status.text="Approved",this.tf_status.color="#4be063";break;case 2:this.tf_status.text="Not passed",this.tf_status.color="#cd4a4a";break;case 3:this.tf_status.text="Uploading",this.tf_status.color="#ffffff";break;case 4:this.tf_status.text="Upload Failed",this.tf_status.color="#cd4a4a";break;case 5:var i=m.instance.getUILang("successfully");this.tf_status.text=i,this.tf_status.color="#4be063";break;case 6:this.tf_status.text="Withdraw success",this.tf_status.color="#4be063";break}}};Jf=h([_B("tbS8gPlOTWuMdXb9g8wZAg")],Jf);var Zf=class extends Laya.Dialog{};var{regClass:vB}=Laya,ey=class extends Zf{constructor(){super();this.destroyDoCancel=!1;this.canClose=!0}onEnable(){this.on(Laya.Event.CLICK,this,this.onClickEvent)}onClickEvent(e){let i=e.target;i.name=="okBtn"?(this._okHandler&&this._okHandler.runWith(null),this.close()):i.name=="cancleBtn"&&(this.destroyDoCancel=!1,this._cancelHandler&&this._cancelHandler.runWith(null),this.close())}setOpenData(e){e&&(this._okHandler=e.okHandler,this._cancelHandler=e.cancelHandler,this.destroyDoCancel=e.destroyDoCancel,e.flag<0?(this.cancleBtn.visible=!1,this.okBtn.visible=!1,this.canClose=!1):e.flag&P.YES&&!(e.flag&P.NO)?(this.okBtn.x=this.width-this.okBtn.width>>1,this.cancleBtn.visible=!1,this.okBtn.label="Sure"):e.flag&P.NO&&!(e.flag&P.YES)?this.okBtn.visible=!1:e.flag&P.YES&&e.flag&P.NO,e.data&&this.alertDesc&&(e.data instanceof Array?(this.alertTitle.text=e.data[0],this.alertDesc.text=e.data[1]):this.alertDesc.text=e.data),e.initHandler&&e.initHandler.runWith(this))}onDisable(){this.destroyDoCancel&&this._cancelHandler&&this._cancelHandler.run(),this._okHandler=null,this._cancelHandler=null}close(e){this.canClose&&super.close(e)}};ey=h([vB("8G0DBvD7T_2CVupdfQXrBw")],ey);var ty=class extends Laya.Dialog{};var{regClass:xB}=Laya,iy=class extends ty{constructor(e){super();this.m_strName="我是OpenSceneRuntime";this.m_iLayerType=C.M_POP;this.m_iPositionType=C.CENTER}onEnable(){this.activityList.visible=!1,this.tab1.on(Laya.Event.CLICK,this,this.onTabClick,[1]),this.tab2.on(Laya.Event.CLICK,this,this.onTabClick,[2]),this.tab3.on(Laya.Event.CLICK,this,this.onTabClick,[3]),this.onTabClick(1),this.refreshRed(),g.intance.on(f.REFRESH_ACTIVITY_RED,this,this.refreshRed)}onChangeHead(){A.intance.openModule(y.SelectHeadDialog,!0)}async onTabClick(e){for(let a=1;a<4;a++)e==a?(this["tab"+a].skin="res/scholarship/img_transfer_tab2.png",this["tab"+a].getChildByName("tf_tit").color="#143268"):(this["tab"+a].skin="res/scholarship/img_transfer_tab1.png",this["tab"+a].getChildByName("tf_tit").color="#429fdf");let i=await v.requestPost("wxgame/player/remActiveList",{remType:e});i&&(this.activityList.array=i.list,this.activityList.visible=!0,this.tf_totalActivity.text=m.instance.getLanguage(1555,i.remRate),!this.activityList.array||this.activityList.array.length<=0?this.noDataBox.visible=!0:this.noDataBox.visible=!1,g.intance.event(f.REFRESH_MAINSCENE_HEAD_RED),g.intance.event(f.REFRESH_ROLEINFO_RED),this["tab"+e].getChildByName("img_red").visible=!1)}refreshRed(){this.tab1.getChildByName("img_red").visible=b.instance.getRedDotById(he.RED_ACTIVITY1),this.tab2.getChildByName("img_red").visible=b.instance.getRedDotById(he.RED_ACTIVITY2),this.tab3.getChildByName("img_red").visible=b.instance.getRedDotById(he.RED_ACTIVITY3)}onDisable(){g.intance.offAllCaller(this)}};iy=h([xB("GIxGfJ0QQmuel1O3zm7Weg")],iy);var ay=class extends Laya.Box{};var{regClass:IB}=Laya,ny=class extends ay{addEvent(){this.btn_copy.on(Laya.Event.CLICK,this,this.onCopy)}set dataSource(e){super.dataSource=e,this.activityItem=e,this.activityItem&&(this.setData(this.activityItem),this.addEvent())}setData(e){this.tf_name.text=e.name,this.tf_address.text=`${te.shortenString(e.openid,7,8)}`,this.tf_guild.text=m.instance.getMultiLan(e.unionName),this.tf_battle.text=`${e.fight}`,this.tf_score.text=`${e.ticket}`,this.playerIcon.headSkin=e.icon}onCopy(){let e=this.activityItem.openid;doCopy(e),E.instance.notice(m.instance.getLanguage(132))}};ny=h([IB("L-m245Z3S8-bKPqo8Afxww")],ny);var ry=class extends Laya.Dialog{};var{regClass:EB}=Laya,sy=class extends ry{constructor(e){super();this.m_strName="我是OpenSceneRuntime";this.m_iLayerType=C.M_POP;this.m_iPositionType=C.CENTER}onEnable(){this.list_head.vScrollBarSkin="",this.btn_confirm.on(Laya.Event.CLICK,this,this.onRegister),this.btn_custom.on(Laya.Event.CLICK,this,this.onBtnChangePic),this.initContainer()}initContainer(){this.list_head.vScrollBarSkin="",this.list_head.selectHandler=new Laya.Handler(this,this.handleSelectHead),this.createHeadList()}handleSelectHead(e){if(e!=-1){let i=this.list_head.selectedItem;b.instance.headId=i.id,this.playerIcon.headSkin=b.instance.headId}}createHeadList(){let e=_.intance.m_dicHead;this.list_head.array=e.values,this.list_head.visible=!0;let i=-1,a=0;this.playerIcon.headSkin=b.instance.headId;for(let r of e.values){if(r.id==b.instance.headId){i=a;break}a++}this.list_head.selectedIndex=i}onBtnChangePic(){var e=Laya.Render.canvas.style.zIndex,i=m.instance.getUILang("Upload picture"),a=m.instance.getUILang("Select Image"),r=m.instance.getUILang("Save changes");openUploadPic(this,e,i,a,r)}async openPicEnd(e,i){if(i.length>500){let a=await v.requestPost("wxgame/player/uploadImg",{base64Str:i},!1,!1);a&&(b.instance.headId=a.imgUrl,e.playerIcon.headSkin=a.imgUrl,console.log(a.imgUrl))}}onRegister(){let e=b.instance.headId;g.intance.event(f.EVENT_MODIFY_HEAD,[e]),this.close()}};sy=h([EB("BmtPy79ySCyg4IuEQC4zsQ")],sy);var oy=class extends Laya.Dialog{};var{regClass:wB}=Laya,ly=class extends oy{constructor(e){super();this.m_strName="我是OpenSceneRuntime";this.m_iLayerType=C.M_POP;this.m_iPositionType=C.CENTER}onEnable(){this.list_characterStar.visible=!1,this.onInit()}async onInit(){var e=_.intance.m_dicCharacterStars.values.filter(a=>a.starLv!==0);this.list_characterStar.array=e,this.list_characterStar.visible=!0,!this.list_characterStar.array||this.list_characterStar.array.length<=0?this.noDataBox.visible=!0:this.noDataBox.visible=!1;let i=await v.requestPost("wxgame/player/getPlayerInfo",{pid:b.instance.playerDto.pid});if(i){let a=i.star;ze.instance.setStar2(this,a);let r=i.starExp+""}else E.instance.notice(m.instance.getLanguage(135))}};ly=h([wB("JCb2ay9yQOa9uxMZE1fJrw")],ly);var cy=class extends Laya.Box{};var{regClass:TB}=Laya,uy=class extends cy{addEvent(){}set dataSource(e){super.dataSource=e,this.characterStarItem=e,this.characterStarItem&&(this.setData(this.characterStarItem),this.addEvent())}setData(e){let i=e.starLv;ze.instance.setStar2(this,i+""),this.tf_number.text=m.instance.getLanguage(1798,e.number),this.tf_pasAdd.text=e.pasAdd/100+"%"}};uy=h([TB("wA3mADC1Q7W-qEplQmRhhg")],uy);var my=class extends Laya.ComboBox{};var{regClass:CB}=Laya,py=class extends my{set defaultLabel(t){this._defaultLabel=t,this._selectedIndex<0&&(this._button.label=t)}onEnable(){this.list=this.comboList,this.list.renderHandler=Laya.Handler.create(this,this.onCountryItemRender,null,!1)}set dataSource(t){super.dataSource=t;var e=t;if(e){this.list.repeatY=e.length,this.list.width=this.width;var i=[];e.forEach(a=>{a instanceof Array?i.push(a[1]):i.push(a)}),this.labels=i.join(","),console.log("comboData.length: "+e.length,this.labels)}}onCountryItemRender(t,e){t.onChange(this.list.selectedIndex==e)}set isOpen(t){if(console.log("isOpen: "+t),this._isOpen!=t)if(this._isOpen=t,this._button.selected=this._isOpen,this._isOpen){this._list||this._createList(),this._listChanged&&!this._isCustomList&&this.changeList(),this._itemChanged&&this.changeItem();var e=this.localToGlobal(Laya.Point.TEMP.setTo(0,0)),i=e.y+this._button.height;i=i+this._listHeight<=Laya.stage.height||e.y-this._listHeight<0?i:e.y-this._listHeight,this.img_pad.addChild(this._list),this.img_pad.pos(e.x,i),this.img_pad.visible=!0,Laya.stage.addChild(this.img_pad),this.img_pad.zOrder=1001,Laya.stage.once(Laya.Event.MOUSE_DOWN,this,this.removeList),Laya.stage.on(Laya.Event.MOUSE_WHEEL,this,this._onStageMouseWheel),this._list.selectedIndex=this._selectedIndex}else this._list&&this._list.removeSelf(),this.img_pad&&this.img_pad.removeSelf()}};py=h([CB("AqEOSlrnRkmI9RUPCJUVqQ")],py);var hy=class extends Laya.List{};var{regClass:SB}=Laya,dy=class extends hy{};dy=h([SB("7DDHp602Rs6dL3bjAu4ArA")],dy);var fy=class extends Laya.Box{};var{regClass:DB}=Laya,yy=class extends fy{addEvent(){}set dataSource(e){this.zOrder=5,super.dataSource=e;var i=e;console.log("coinName: ",i),i&&i.label&&(this.addEvent(),this.tf_name.text=i.label)}onChange(e){e?(this.selectImg.visible=!0,this.tf_name.color="#ffffff"):(this.tf_name.color="#357cc0",this.selectImg.visible=!1)}onDisable(){}};yy=h([DB("nREGzTKFSX6LuiRnM5nPXA")],yy);var by=class extends Laya.Box{};var{regClass:AB}=Laya,gy=class extends by{addEvent(){}set dataSource(e){super.dataSource=e;var i=e;i&&(this.addEvent(),e.id==999?(this.img_icon.visible=!1,this.tf_name.text="All"):(this.img_icon.visible=!0,this.img_icon.skin=S.instance.getCountryIcon(i.id),this.tf_name.text=m.instance.getLanguage(i.name)))}onChange(e){e?(this.selectImg.visible=!0,this.tf_name.color="#ffffff"):(this.tf_name.color="#357cc0",this.selectImg.visible=!1)}onDisable(){}};gy=h([AB("LJ8PUf7kRCGUr4eT8Mhy3g")],gy);var Ly=class extends Laya.Dialog{};var yo=class extends Laya.Event{constructor(){super()}};yo.INIT_CREATELOGIN_EVENT="CreateLoginEvent:INIT_CREATELOGIN_EVENT";var{regClass:kB}=Laya,_y=class extends Ly{constructor(){super(...arguments);this.m_strName="我是OpenSceneRuntime";this.m_iLayerType=C.M_PANEL;this.m_iPositionType=C.CENTER}onEnable(){g.intance.on(yo.INIT_CREATELOGIN_EVENT,this,this.initCreateLoginView),g.intance.on(f.EVENT_MODIFY_HEAD,this,this.onChangeModifyHead),g.intance.on(f.EVENT_WAIT_PLAYERINFO,this,this.onWaitPlayerInfoBack),this.btn_setting.clickHandler=new Laya.Handler(this,this.handleClickBtn,[this.btn_setting]),this.btn_radio1.clickHandler=new Laya.Handler(this,this.handleClickBtn,[this.btn_radio1]),this.btn_radio2.clickHandler=new Laya.Handler(this,this.handleClickBtn,[this.btn_radio2]),this.btn_register.clickHandler=new Laya.Handler(this,this.handleClickBtn,[this.btn_register]),this.box_change.on(Laya.Event.CLICK,this,this.onChangeHead),this.input_name.prompt=m.instance.getLanguage(31),this.selectRadio(1),this.initCountry(),this.initCreateLoginView(),He.instance.sendCustumEvent(23)}initCountry(){this.list_country.selectHandler=new Laya.Handler(this,this.handleSelectCountry),this.createCountryList(),this.box_country.on(Laya.Event.CLICK,this,this.onOpenCountry),this.list_country.on(Laya.Event.MOUSE_DOWN,this,this.onListDown),this.list_country.mouseHandler=Laya.Handler.create(this,this.onCountryItemMouse,null,!1),this.list_country.renderHandler=Laya.Handler.create(this,this.onCountryItemRender,null,!1),this.list_country.scrollBar&&this.list_country.scrollBar.on(Laya.Event.MOUSE_DOWN,this,this.onScrollBarDown)}onCountryItemMouse(e,i){e.type===Laya.Event.CLICK&&(this.list_country.selectedIndex=i,this.onHideCountry())}onListDown(e){e.stopPropagation()}onScrollBarDown(e){e.stopPropagation()}onCountryItemRender(e,i){e.onChange(this.list_country.selectedIndex==i)}onOpenCountry(){this.img_country_pad.visible==!1&&(this.img_country_pad.visible=!0,Laya.stage.once(Laya.Event.MOUSE_DOWN,this,this.onHideCountry))}onHideCountry(){this.img_country_pad.visible=!1,Laya.stage.off(Laya.Event.MOUSE_DOWN,this,this.onHideCountry)}handleSelectCountry(e){if(console.log("handleSelectCountry: "+e),e!=-1){let i=this.list_country.selectedItem;b.instance.countryId=i.id,this.img_flag.skin=S.instance.getCountryIcon(i.id),this.tf_country.text=m.instance.getLanguage(i.name)}}createCountryList(){let e=_.intance.m_dicCountry;this.list_country.array=e.values,this.list_country.visible=!0;let i=-1,a=0;for(let r of e.values){if(r.id==b.instance.countryId){i=a;break}a++}this.list_country.selectedIndex=i}onChangeHeadBack(e,i){this.input_name.text=e,b.instance.headId=i,this.playerIcon.headSkin=i}onChangeModifyHead(e){b.instance.headId=e,this.playerIcon.headSkin=e}onChangeHead(){A.intance.openModule(y.ChangeHeadDialog)}onBtnChangePic(){var e=Laya.Render.canvas.style.zIndex,i=m.instance.getUILang("Upload picture"),a=m.instance.getUILang("Select Image"),r=m.instance.getUILang("Save changes");openUploadPic(this,e,i,a,r)}async openPicEnd(e,i){if(i.length>500){let a=await v.requestPost("wxgame/player/uploadImg",{base64Str:i},!1,!1);a&&(b.instance.headId=a.imgUrl,e.playerIcon.headSkin=a.imgUrl,console.log(a.imgUrl))}}selectRadio(e){let i=e==1;this.btn_radio1.selected=i,this.btn_radio2.selected=!i}handleClickBtn(e){switch(e){case this.btn_radio1:this.selectRadio(1);break;case this.btn_radio2:this.selectRadio(2);break;case this.btn_register:this.onRegister();break;case this.btn_setting:A.intance.openModule(y.GameSettingLanguageDialog);break}}async onRegister(){let e=this.input_name.text,i=this.btn_radio1.selected?1:2;if(e=e.trim(),e==""){E.instance.notice(m.instance.getLanguage(31));return}if(b.instance.countryId==-1){E.instance.notice(m.instance.getLanguage(1048));return}let s=new URL(window.location.href).searchParams.get("referral");console.log("referral: ",s);let o=await F.instance.createAcccount(e,i,b.instance.headId.toString(),b.instance.countryId,s);this.onWaitPlayerInfoBack(o)}onWaitPlayerInfoBack(e){e&&(de.instance.hideLoading(),b.instance.playerDto=e,this.close(),g.intance.event(f.EVENT_ENTER_MAIN))}initCreateLoginView(){}onDisable(){this.removeEvent()}removeEvent(){g.intance.off(yo.INIT_CREATELOGIN_EVENT,this,this.initCreateLoginView),g.intance.off(f.EVENT_MODIFY_HEAD,this,this.onChangeModifyHead),g.intance.off(f.EVENT_WAIT_PLAYERINFO,this,this.onWaitPlayerInfoBack)}};_y=h([kB("1K2SyFxcQY-12SasSSRXyQ")],_y);var vy=class extends Laya.Dialog{};var{regClass:BB}=Laya,xy=class extends vy{constructor(e){super();this.m_strName="我是OpenSceneRuntime";this.m_iLayerType=C.M_POP;this.m_iPositionType=C.CENTER;this.pageIndex=1;this.pageSize=20;this.scrolLock=!0;this.btnLock=!1;this.currTab=0}onEnable(){this.list_rental.visible=!1,this.btn_1.on(Laya.Event.CLICK,this,this.onClickTab,[1]),this.btn_2.on(Laya.Event.CLICK,this,this.onClickTab,[2]),this.btn_claim.on(Laya.Event.CLICK,this,this.onClaimRem),this.list_rental.scrollBar.on(Laya.Event.CHANGE,this,this.onScrollBarChange),this.list_toBeClaimed.on(Laya.Event.CLICK,this,this.clickList),this.initContainer()}initContainer(){this.getReferralData(),this.showReferralNum()}onScrollBarChange(){this.list_rental.scrollBar.value>=this.list_rental.scrollBar.max&&this.loadMoreData()}async getReferralData(e=!1){let i=await v.requestPost("wxgame/player/referralList1",{pageSize:this.pageSize,page:this.pageIndex});i&&(this.list_rental.array=i.list,this.list_rental.visible=!0,this.list_rental.array.length>0?this.noDataBox.visible=!1:this.noDataBox.visible=!0)}async loadMoreData(){if(this.scrolLock){this.pageIndex+=1,this.scrolLock=!1,Laya.timer.once(1e4,this,this.refreshLock);let e=await v.requestPost("wxgame/player/referralList1",{pageSize:this.pageSize,page:this.pageIndex});if(console.log(e),e){this.scrolLock=!0;let i=e.list;this.list_rental.array.push(...i),this.list_rental.array=this.list_rental.array,Laya.timer.clear(this,this.refreshLock)}}}refreshLock(){this.scrolLock=!0,console.log("重置锁")}async onClickTab(e){this.currTab!=e&&(this.setTab(e),e==2&&(this.noDataBox.visible=!1,this.showReceivedData()))}setTab(e){for(let i=1;i<3;i++)e==i?(this["btn_"+i].getChildByName("selectBox").visible=!0,this["btn_"+i].getChildByName("tf_txt").color="#143f6b",this["btn_"+i].getChildByName("selectBox").skin="res/role/img_transfer_tab2_1.png",this["box_"+i].visible=!0):(this["btn_"+i].getChildByName("selectBox").visible=!1,this["btn_"+i].getChildByName("tf_txt").color="#76c7ff",this["btn_"+i].getChildByName("selectBox").skin="res/role/img_transfer_tab1_1.png",this["box_"+i].visible=!1)}async showReferralNum(){let e=await v.requestPost("wxgame/player/referralListInfo",{pageSize:this.pageSize,page:this.pageIndex});console.log(e),e&&(this.tf_l1.text=`${e.total}`,this.tf_l2.text=`${e.twoTotal}`,this.tf_battle.text=`${e.totalBattles}`)}onDisable(){this.list_rental.scrollBar.off(Laya.Event.CHANGE,this,this.onScrollBarChange)}async showReceivedData(){var e=await v.requestPost("wxgame/money/remRewardListAll",{});if(e&&e.reward){e.reward.length<1?this.btn_claim.disabled=!0:this.btn_claim.disabled=!1;let a=te.processItemsArray(e.reward)[0];this.list_toBeClaimed.array=a,this.list_toBeClaimed.visible=!0,this.list_toBeClaimed.vScrollBarSkin="",this.list_toBeClaimed.selectedIndex=-1}if(e&&e.rewardRecord){let a=te.processItemsArray(e.rewardRecord)[0];this.list_claimed.array=a,this.list_claimed.visible=!0,this.list_claimed.vScrollBarSkin="",this.list_claimed.selectedIndex=-1}}async onClaimRem(){if(!this.btnLock){this.btnLock=!0,Laya.timer.once(1e3,this,()=>{this.btnLock=!1});var e=await v.requestPost("wxgame/money/remRewardTake",{});if(e&&e.list.length>0){let i=e.list,a=[];i.forEach(r=>{var s=new xt;s.id=r.id,s.count=r.count,a.push(s)}),A.intance.openModule(y.RewardGetDialog,a)}this.showReceivedData()}}clickList(){console.log("123333333")}};xy=h([BB("sawRNG-YR0WiyH87IfeHmg")],xy);var Iy=class extends Laya.Dialog{};var{regClass:MB}=Laya,Ey=class extends Iy{constructor(e){super();this.m_strName="我是OpenSceneRuntime";this.m_iLayerType=C.M_POP;this.m_iPositionType=C.CENTER;this.pageIndex=1;this.pageSize=20;this.scrolLock=!0}onEnable(){this.list_rental2.visible=!1,this.list_rental2.scrollBar.on(Laya.Event.CHANGE,this,this.onScrollBarChange)}setOpenData(e){e&&(console.log(e),this.pid=e.pid,this.getReferralData())}onScrollBarChange(){this.list_rental2.scrollBar.value>=this.list_rental2.scrollBar.max&&this.loadMoreData()}async getReferralData(){let e=await v.requestPost("wxgame/player/referralList2",{pageSize:this.pageSize,page:this.pageIndex,playerId:this.pid});e&&(this.list_rental2.array=e.list,this.list_rental2.visible=!0)}async loadMoreData(){if(this.scrolLock){this.pageIndex+=1,this.scrolLock=!1,Laya.timer.once(1e4,this,this.refreshLock);let e=await v.requestPost("wxgame/player/referralList2",{pageSize:this.pageSize,page:this.pageIndex,playerId:this.pid});if(console.log(e),e){this.scrolLock=!0;let i=e.list;this.list_rental2.array.push(...i),this.list_rental2.array=this.list_rental2.array,Laya.timer.clear(this,this.refreshLock)}}}refreshLock(){this.scrolLock=!0,console.log("重置锁")}onDisable(){this.list_rental2.scrollBar.off(Laya.Event.CHANGE,this,this.onScrollBarChange)}};Ey=h([MB("kAtevFvnTYGkg5Pu-ISlQw")],Ey);var wy=class extends Laya.Box{};var{regClass:RB}=Laya,Ty=class extends wy{constructor(){super()}createChildren(){super.createChildren()}onEnable(){this.btn_copy.on(Laya.Event.CLICK,this,this.onCopy),this.btn_battle.on(Laya.Event.CLICK,this,this.onBtnBattle)}set dataSource(e){e&&(super.dataSource=e,this.referralData=e,this.tf_name.text=e.name,this.tf_guild.text=m.instance.getMultiLan(e.unionName),this.playerIcon.headSkin=e.icon,this.tf_l2.text=e.fightTimes,e.openid?(this.fromBox.visible=!0,this.address=e.openid,this.tf_from.text=`${te.shortenString(e.openid,7,4)}`):this.fromBox.visible=!1)}onBtnBattle(){console.log("btn12"),this.referralData.fightTimes>0&&A.intance.openModule(y.TotalBattlesDialog,this.referralData)}onCopy(){let e=this.address;doCopy(e),E.instance.notice(m.instance.getLanguage(132))}};Ty=h([RB("6RSP0qtzSg-R9oUDT-GOCw")],Ty);var Cy=class extends Laya.Box{};var{regClass:PB}=Laya,Sy=class extends Cy{constructor(){super()}createChildren(){super.createChildren()}onEnable(){this.btn_copy.on(Laya.Event.CLICK,this,this.onCopy),this.btn_l2.on(Laya.Event.CLICK,this,this.onBtn12),this.btn_battle.on(Laya.Event.CLICK,this,this.onBtnBattle)}set dataSource(e){e&&(super.dataSource=e,this.referralData=e,this.tf_name.text=e.name,this.tf_guild.text=m.instance.getMultiLan(e.unionName),this.playerIcon.headSkin=e.icon,this.tf_l2.text=e.remNum,this.tf_battle.text=e.fightTimes,e.openid?(this.fromBox.visible=!0,this.address=e.openid,this.tf_from.text=`${te.shortenString(e.openid,7,4)}`):this.fromBox.visible=!1)}onBtn12(){this.referralData.remNum>0&&A.intance.openModule(y.ReferralL2Dialog,this.referralData)}onBtnBattle(){console.log("btn12"),this.referralData.fightTimes>0&&A.intance.openModule(y.TotalBattlesDialog,this.referralData)}onCopy(){let e=this.address;doCopy(e),E.instance.notice(m.instance.getLanguage(132))}};Sy=h([PB("QTOEy7PgRqi9dIWmX22OTw")],Sy);var Dy=class extends Laya.Dialog{};var{regClass:NB}=Laya,Ay=class extends Dy{constructor(e){super();this.m_strName="我是OpenSceneRuntime";this.m_iLayerType=C.M_POP;this.m_iPositionType=C.CENTER}onEnable(){Xe.instance.playSoundByName(Xe.soundName32)}onDisable(){}};Ay=h([NB("szfg-Zt_RRWZ_nHMppjUMA")],Ay);var ky=class extends Laya.Box{};var{regClass:OB}=Laya,By=class extends ky{set dataSource(t){super.dataSource=t;var e=t;e&&(this.img_icon.skin="res/role/img_icon_"+e[0]+".png",this.tf_name.text=m.instance.getUILang(e[1]),this.tf_num.text=e[2])}};By=h([OB("WJ5TDeRBSkC9yMqJ72B0Ow")],By);var My=class extends Laya.Box{};var{regClass:HB}=Laya,Ry=class extends My{set dataSource(e){super.dataSource=e,this.headItem=e,this.headItem&&this.setCurrentOutPut()}async setCurrentOutPut(){let e=this.headItem.id;this.playerIcon.headSkin=e}onChange(e){}};Ry=h([HB("AwN_JFPwQsKswm1N53Bmkg")],Ry);var Py=class extends Laya.Dialog{};var{regClass:UB}=Laya,Ny=class extends Py{constructor(e){super();this.m_strName="我是OpenSceneRuntime";this.m_iLayerType=C.M_POP;this.m_iPositionType=C.CENTER}onEnable(){this.btn_copy.on(Laya.Event.CLICK,this,this.onCopy),this.btn_copy2.on(Laya.Event.CLICK,this,this.onCopy2),this.btn_copyReferral.on(Laya.Event.CLICK,this,this.onCopyReferral),this.btn_changeHead.on(Laya.Event.CLICK,this,this.onChangeHead),this.btn_receive.on(Laya.Event.CLICK,this,this.onReceive),this.btn_activity.on(Laya.Event.CLICK,this,this.onActivity),this.btn_starView.on(Laya.Event.CLICK,this,this.onOpenCharacterStarDialog),this.btn_detail.on(Laya.Event.CLICK,this,this.onDetail),this.redemptionCode.on(Laya.Event.FOCUS,this,this.redemFocus),g.intance.on(f.ROLE_INFO_CHANGE,this,this.updateRoleInfo),g.intance.on(f.REFRESH_ROLEINFO_RED,this,this.refreshActivityRed),this.refreshActivityRed(),this.updateRoleInfo()}redemFocus(){this.redemptionCode.text=""}updateRoleInfo(){let e=b.instance.playerDto;this.tf_name.text=e.name,this.img_sex.skin=e.sex==1?"res/role/img_icon_xb_1.png":"res/role/img_icon_xb_2.png",this.tf_uid.text=e.pid.toString(),this.tf_myCode.text=e.remCode,this.ally_num.text=`${e.remCount}`,this.tf_myCode.text==""?this.btn_copy2.disabled=!0:this.btn_copy2.disabled=!1,e.superRemCode?(this.btn_receive.disabled=!0,this.redemptionCode.text=`${e.superRemCode}`,this.yf_receive.text="Received"):this.yf_receive.text="Receive";var i=_.intance.m_dicCountry.get(e.country);this.img_country.skin=S.instance.getCountryIcon(e.country+""),this.tf_address.text=Me.formatWalletAddress(F.instance.walletAddress);let a=e.icon;this.playerIcon.headSkin=a,this.onGetAttr(e.pid)}async onGetAttr(e){let i=this,a=await v.requestPost("wxgame/player/getPlayerInfo",{pid:e});if(a){this.box_starui.visible=!0;let r=a.star;ze.instance.setStar2(this,r),this.box_starui.visible=!0;let s=a.starExp+"",l=_.intance.getCharacterStars(r).number;this.tf_mntArenaNum.text=m.instance.getUILang("MNT Arena")+`: <font color="#87f17f">${s}</font>/${l} <img src='res/roleStar/img_jiantou.png' />`,this.fighting_value.text=a.fightTimes,this.victory_num.text=a.winTimes,this.fail_num.text=`${a.fightTimes-a.winTimes}`,this.runAway_num.text=a.taopao}else E.instance.notice(m.instance.getLanguage(135))}onChangeHead(){A.intance.openModule(y.SelectHeadDialog,!0)}async onReceive(){if(this.redemptionCode.text=="Enter the redemption code to claim equipment(unique)"||this.redemptionCode.text=="輸入兌換碼領取裝備（唯一）"||this.redemptionCode.text==""){pe.instance().AlertByType(P.BASEALERTVIEW,m.instance.getLanguage(1123),P.YES,null);return}if(this.redemptionCode.text==this.tf_myCode.text&&this.redemptionCode.text!==""){pe.instance().AlertByType(P.BASEALERTVIEW,"You cannot enter your own invitation code.",P.YES,null);return}let e=this.redemptionCode.text,i=await v.requestPost("wxgame/player/setRem",{code:e});i&&(A.intance.openModule(y.RemGetDialog),b.instance.playerDto.superRemCode=i.code,this.btn_receive.disabled=!0,this.yf_receive.text="Received",this.tf_myCode.text=i.recommendCode,b.instance.playerDto.remCode=i.recommendCode,this.tf_myCode.text==""?this.btn_copy2.disabled=!0:this.btn_copy2.disabled=!1)}onCopy(){let e=F.instance.walletAddress;doCopy(e),E.instance.notice(m.instance.getLanguage(132))}onCopy2(){let e=this.tf_myCode.text;doCopy(e),E.instance.notice(m.instance.getLanguage(132))}onCopyReferral(){let e=this.tf_myCode.text,i=this.onGetNewUrl(e);doCopy(i),E.instance.notice(m.instance.getLanguage(132))}onGetNewUrl(e){let i=new URL(window.location.href),a=i.searchParams;a.get("referral")&&a.delete("referral"),a.has("debug")&&a.delete("debug"),a.has("address")&&a.delete("address");let s=e;return a.append("referral",s+""),i.search=a.toString(),i.toString()}onDisable(){g.intance.off(f.ROLE_INFO_CHANGE,this,this.updateRoleInfo),g.intance.offAllCaller(this),this.redemptionCode.off(Laya.Event.FOCUS,this,this.redemFocus)}onActivity(){A.intance.openModule(y.ActivityInfoDialog)}onOpenCharacterStarDialog(){A.intance.openModule(y.CharacterStarDialog)}onDetail(){A.intance.openModule(y.ReferralDialog)}refreshActivityRed(){this.img_activieyRed.visible=b.instance.getRedDotById(he.RED_ACTIVITY1)||b.instance.getRedDotById(he.RED_ACTIVITY3)}};Ny=h([UB("T7g565QQR7-fZgZNjVg92A")],Ny);var Oy=class extends Laya.Dialog{};var{regClass:VB}=Laya,Hy=class extends Oy{constructor(){super(...arguments);this.m_strName="我是OpenSceneRuntime";this.m_iLayerType=C.M_POP;this.m_iPositionType=C.CENTER}setOpenData(e){}onEnable(){this.list_head.vScrollBarSkin="",this.btn_confirm.on(Laya.Event.CLICK,this,this.onRegister),this.btn_custom.on(Laya.Event.CLICK,this,this.onBtnChangePic),this.input_name.prompt=m.instance.getLanguage(31),this.initContainer();let e=_.intance.getGeneralValueById(13);this.tf_nameGold.text=e[1],this.img_nameGold.skin=S.instance.getMoneyIcon(e[0]),console.log(e)}initContainer(){this.list_head.vScrollBarSkin="",this.list_head.selectHandler=new Laya.Handler(this,this.handleSelectHead),this.createHeadList(),this.initCountry()}handleSelectHead(e){if(e!=-1){let i=this.list_head.selectedItem;b.instance.headId=i.id,this.playerIcon.headSkin=b.instance.headId}}createHeadList(){let e=_.intance.m_dicHead;this.list_head.array=e.values,this.list_head.visible=!0;let i=-1,a=0;b.instance.headId=b.instance.playerDto.icon,this.playerIcon.headSkin=b.instance.headId,this.input_name.text=b.instance.playerDto.name;for(let r of e.values){if(r.id==b.instance.headId){i=a;break}a++}this.list_head.selectedIndex=i}initCountry(){this.list_country.selectHandler=new Laya.Handler(this,this.handleSelectCountry),this.createCountryList(),this.box_country.on(Laya.Event.CLICK,this,this.onOpenCountry),this.list_country.on(Laya.Event.MOUSE_DOWN,this,this.onListDown),this.list_country.mouseHandler=Laya.Handler.create(this,this.onCountryItemMouse,null,!1),this.list_country.renderHandler=Laya.Handler.create(this,this.onCountryItemRender,null,!1),this.list_country.scrollBar&&this.list_country.scrollBar.on(Laya.Event.MOUSE_DOWN,this,this.onScrollBarDown)}onCountryItemMouse(e,i){e.type===Laya.Event.CLICK&&(this.list_country.selectedIndex=i,this.onHideCountry())}onListDown(e){e.stopPropagation()}onScrollBarDown(e){e.stopPropagation()}onCountryItemRender(e,i){e.onChange(this.list_country.selectedIndex==i)}onOpenCountry(){this.img_country_pad.visible==!1&&(this.img_country_pad.visible=!0,Laya.stage.once(Laya.Event.MOUSE_DOWN,this,this.onHideCountry))}onHideCountry(){this.img_country_pad.visible=!1,Laya.stage.off(Laya.Event.MOUSE_DOWN,this,this.onHideCountry)}handleSelectCountry(e){if(console.log("handleSelectCountry: "+e),e!=-1){let i=this.list_country.selectedItem;b.instance.countryId=i.id,this.img_flag.skin=S.instance.getCountryIcon(i.id),this.tf_country.text=m.instance.getLanguage(i.name)}}createCountryList(){let e=_.intance.m_dicCountry;this.list_country.array=e.values,this.list_country.visible=!0;let i=-1,a=0;b.instance.countryId=b.instance.playerDto.country;for(let r of e.values){if(r.id==b.instance.countryId){i=a;break}a++}this.list_country.selectedIndex=i}onBtnChangePic(){var e=Laya.Render.canvas.style.zIndex,i=m.instance.getUILang("Upload picture"),a=m.instance.getUILang("Select Image"),r=m.instance.getUILang("Save changes");openUploadPic(this,e,i,a,r)}async openPicEnd(e,i){if(i.length>500){let a=await v.requestPost("wxgame/player/uploadImg",{base64Str:i},!1,!1);a&&(b.instance.headId=a.imgUrl,e.playerIcon.headSkin=a.imgUrl,e.list_head.selectedIndex=-1,console.log(a.imgUrl))}}onRegister(){let e=this.input_name.text;if(e=e.trim(),e==""){E.instance.notice(m.instance.getLanguage(31));return}if(b.instance.playerDto.name!==e&&b.instance.getConsumeValue(ge.TYPE_GOLD)<Number(this.tf_nameGold.text)){E.instance.notice(Ee.instance.get(51));return}b.instance.headId!=-1?this.onModify(e,b.instance.headId,b.instance.countryId):E.instance.notice(m.instance.getLanguage(134))}async onModify(e,i,a){if(e==""){E.instance.notice(m.instance.getLanguage(31));return}let r=await zr.instance.updateProfile(e,i.toString(),a);this.destroyed||(r?(b.instance.playerDto=r,this.close(),g.intance.event(f.ROLE_INFO_CHANGE)):E.instance.notice(m.instance.getLanguage(135)))}};Hy=h([VB("3CibwwHGSPG2Qkeq4rbMag")],Hy);var Uy=class extends Laya.Dialog{};var{regClass:FB}=Laya,Vy=class extends Uy{constructor(e){super();this.m_strName="我是OpenSceneRuntime";this.m_iLayerType=C.M_POP;this.m_iPositionType=C.CENTER;this.pageIndex=1;this.pageSize=20;this.scrolLock=!0}onEnable(){this.list_battle.scrollBar.on(Laya.Event.CHANGE,this,this.onScrollBarChange)}setOpenData(e){e&&(console.log(e),this.pid=e.pid,this.getReferralData())}onScrollBarChange(){this.list_battle.scrollBar.value>=this.list_battle.scrollBar.max&&this.loadMoreData()}async getReferralData(){let e=await v.requestPost("wxgame/player/battlesList",{pageSize:this.pageSize,page:this.pageIndex,playerId:this.pid});e&&(this.list_battle.array=e.list,this.list_battle.visible=!0)}async loadMoreData(){if(this.scrolLock){this.pageIndex+=1,this.scrolLock=!1,Laya.timer.once(1e4,this,this.refreshLock);let e=await v.requestPost("wxgame/player/battlesList",{pageSize:this.pageSize,page:this.pageIndex,playerId:this.pid});if(console.log(e),e){this.scrolLock=!0;let i=e.list;this.list_battle.array.push(...i),this.list_battle.array=this.list_battle.array,Laya.timer.clear(this,this.refreshLock)}}}refreshLock(){this.scrolLock=!0,console.log("重置锁")}onDisable(){this.list_battle.scrollBar.off(Laya.Event.CHANGE,this,this.onScrollBarChange)}};Vy=h([FB("qq0DrNoKSVmnXx-7vsMvNw")],Vy);var Fy=class extends Laya.Box{};var{regClass:GB}=Laya,Gy=class extends Fy{constructor(){super()}createChildren(){super.createChildren()}onEnable(){}set dataSource(e){if(!e)return;super.dataSource=e;let i=se.formatDayAndTime(e.time);this.tf_endDate.text=`${i.date} ${i.time}`;var a=_.intance.m_dicArenaDic.get(e.arenaId);this.tf_arena.text=m.instance.getLanguage(a.name),this.img_coinType2.skin=S.instance.getMoneyIcon(e.coinType),this.tf_ticket.text=`${e.ticketValue}`,this.tf_bonus.text=`${e.bonus}`;let r=b.instance.getConsumeValue(e.coinType),s=_.intance.m_dicItems.get(e.coinType),o=m.instance.getLanguage(s.name);this.tf_moneyName.text=o}onBtn12(){this.referralData.l2>0&&A.intance.openModule(y.ReferralL2Dialog,this.referralData)}onCopy(){let e=this.address;doCopy(e),E.instance.notice(m.instance.getLanguage(132))}};Gy=h([GB("iUE6F1pjTg-jhQSieKM2hg")],Gy);var Ky=class extends Laya.ComboBox{};var{regClass:KB}=Laya,qy=class extends Ky{set defaultLabel(t){this._defaultLabel=t,this._selectedIndex<0&&(this._button.label=t),this._button.labelAlign="center"}onEnable(){this.list=this.comboList}set dataSource(t){super.dataSource=t;var e=t;e&&(this.labels=e.join(","),console.log("comboData.length: "+e.length),this.list.repeatY=e.length,this.list.width=this.width,this.list.renderHandler=Laya.Handler.create(this,this.onCountryItemRender,null,!1))}onCountryItemRender(t,e){t.onChange(this.list.selectedIndex==e)}set isOpen(t){if(console.log("isOpen: "+t),this._isOpen!=t)if(this._isOpen=t,this._button.selected=this._isOpen,this._isOpen){this._list||this._createList(),this._listChanged&&!this._isCustomList&&this.changeList(),this._itemChanged&&this.changeItem();var e=this.localToGlobal(Laya.Point.TEMP.setTo(0,0)),i=e.y+this._button.height;i=i+this._listHeight<=Laya.stage.height||e.y-this._listHeight<0?i:e.y-this._listHeight,this.img_pad.addChild(this._list),this.img_pad.pos(e.x,i),this.img_pad.visible=!0,Laya.stage.addChild(this.img_pad),this.img_pad.zOrder=1001,Laya.stage.once(Laya.Event.MOUSE_DOWN,this,this.removeList),Laya.stage.on(Laya.Event.MOUSE_WHEEL,this,this._onStageMouseWheel),this._list.selectedIndex=this._selectedIndex}else this._list&&this._list.removeSelf(),this.img_pad&&this.img_pad.removeSelf()}};qy=h([KB("Fns-7UW3RpSb95NWnjiDFQ")],qy);var Wy=class extends Laya.Box{};var{regClass:qB}=Laya,Yy=class extends Wy{constructor(){super()}addEvent(){}set dataSource(t){super.dataSource=t,t&&(this.setData(t),this.addEvent())}setData(t){this.playerIcon.headSkin=t.pic,this.tf_name.text=t.name;var e=new Ne(t.itemId);t.itemId<1e6?(e.itemItem&&(this.img_prop.skin=S.instance.getItemIcon(e.itemItem.icon)),this.tf_value.text=`x${t.itemCount}`,this.img_prop.visible=!0):(this.tf_value.text="x1",this.img_prop.visible=!1)}};Yy=h([qB("5m33h8fgRfuOQ2uY1AqnNw")],Yy);var zy=class extends Laya.Dialog{};var{regClass:WB}=Laya,jy=class extends zy{constructor(e){super();this.m_strName="我是OpenSceneRuntime";this.m_iLayerType=C.M_POP;this.m_iPositionType=C.CENTER;this.wheelType=1}onEnable(){}setOpenData(e){}onDisable(){}};jy=h([WB("A1lCmwZyTaakvRLkYjnuQA")],jy);var $y=class extends Laya.Dialog{};var{regClass:YB}=Laya,Xy=class extends $y{constructor(e){super();this.m_strName="我是OpenSceneRuntime";this.m_iLayerType=C.M_POP;this.m_iPositionType=C.CENTER;this.needNum=1;this.propNum=0;this.allProp=[];this.wheelType=1;this.items=[]}onEnable(){this.listPanel1.visible=!1,this.listPanel1.selectHandler=new Laya.Handler(this,this.handleSelectProp),this.btn_wheel.on(Laya.Event.CLICK,this,this.onBtnWheel),this.initPropList()}setOpenData(e){e&&(this.wheelType=e[0])}async initPropList(){let e=[];this.allProp=await this.getItemByType();let i=_.intance.getWheelByType(this.wheelType);console.log(i);let a=i[0].consumption;this.needNum=a[0][1],console.log("需要碎片======================》",this.needNum);let r=this.getAirdropArrData(this.allProp,a);console.log(r),this.listPanel1.array=r,this.listPanel1.visible=!0,this.listPanel1.selectedIndex=0}async getItemByType(){var e=Ge.TYPE_Consumption;this.items=[];for(var i=b.instance.m_packageData.getBackByType(e),a=0;a<i.length;a++){var r=i[a];r?this.items.push(r):this.items.push(new Ne(0))}return this.items}getAirdropArrData(e,i){let a=[];for(let r=0;r<i.length;r++){let s=e.find(o=>o._m_iId==i[r][0]);s&&a.push(s)}return a}handleSelectProp(e){if(e!==-1){let i=this.listPanel1.selectedItem;i&&(this.propNum=Number(i._m_iNum),console.log("该物品拥有数量:",this.propNum))}}async onBtnWheel(){let e=this.listPanel1.selectedItem,i=Number(e._m_iNum);if(this.needNum>i)E.instance.notice("Insufficient puzzle pieces");else{let a=await v.requestPost("wxgame/wheel/turn",{type:this.wheelType,itemId:e._m_iId,itemCount:this.needNum});a&&(console.log(a),this.close(),Et.instance.ownerBag(),g.intance.event(f.SEND_WHEEL_RESULT,a),Et.instance.ownerBag())}}onDisable(){}};Xy=h([YB("tOKleLLDR9uKlH2QwK8wHw")],Xy);var Qy=class{};var Jy=class extends Laya.Scene{};var{regClass:zB,property:x0e}=Laya,Zy=class extends Jy{constructor(){super(...arguments);this.text="";this.wheelReward=[];this.wheelLock=!1;this.wheelId=0}onAwake(){this.m_iLayerType=C.M_POP,this.m_iPositionType=C.UP}onEnable(){g.intance.on(f.SEND_WHEEL_RESULT,this,this.startLottery),this.btn_1.on(Laya.Event.CLICK,this,this.onClickTab,[1]),this.btn_2.on(Laya.Event.CLICK,this,this.onClickTab,[2]),this.btn_3.on(Laya.Event.CLICK,this,this.onClickTab,[3]),this.btn_openFree1.on(Laya.Event.CLICK,this,this.openPropDialog,[1]),this.btn_openFree2.on(Laya.Event.CLICK,this,this.openPropDialog,[2]),this.btn_openFree3.on(Laya.Event.CLICK,this,this.openPropDialog,[3]),this.check_records.on(Laya.Event.CLICK,this,this.onCheck),this.btn_openFree1.label=m.instance.getLanguage(1665,1),this.btn_openFree2.label=m.instance.getLanguage(1665,5),this.btn_openFree3.label=m.instance.getLanguage(1665,10),this.check_records.selected=!1,this.initContainer(1),this.initContainer(2),this.initContainer(3),this.showNameList(),this.close&&this.btn_back.on(Laya.Event.CLICK,this,this.setToMainScene),this.onClickTab(1)}async onClickTab(e){this.wheelLock||(this.setTab(e),this.box_all.visible=!0)}async openPropDialog(e){this.wheelLock||A.intance.openModule(y.DailyTaskPropsDialog,[e])}setTab(e){for(let i=1;i<4;i++)e==i?(this["btn_"+i].getChildByName("selectBox").visible=!0,this["btn_"+i].getChildByName("tf_txt").color="#143f6b",this["box_"+i]&&(this["box_"+i].visible=!0)):(this["btn_"+i].getChildByName("selectBox").visible=!1,this["btn_"+i].getChildByName("tf_txt").color="#7ff1fe",this["box_"+i]&&(this["box_"+i].visible=!1))}setTopTab(e){for(let i=1;i<4;i++)console.log(i),e==i?(this["btn_top_"+i].getChildByName("selectBox").visible=!0,this["btn_top_"+i].getChildByName("tf_txt").color="#ffffff"):(this["btn_top_"+i].getChildByName("selectBox").visible=!1,this["btn_top_"+i].getChildByName("tf_txt").color="#4e87b7")}initContainer(e){let i=_.intance.getWheelByType(e);console.log(i);for(let a=0;a<i.length;a++){let r=i[a];if(r){let s=this["turntableBox_"+e+"_"+(a+1)].getChildByName("propBox"),o=S.instance.getItemIcon(r.wheelImage);s.getChildByName("img_reardIcon").skin=o,s.visible=!0,s.getChildByName("tf_name").text=m.instance.getLanguage(r.name);let l=s.getChildByName("tf_num");l&&(l.text=`x${r.rewardNum}`,r.rewardNum==0&&(l.visible=!1))}}}async showNameList(){let e=await v.requestPost("wxgame/wheel/panel",{});if(e)if(console.log(e),!this.check_records.selected)this.list_name.array=e.rewards;else{let i=[];i=e.rewards.filter(a=>a.pid==b.instance.playerDto.pid),this.list_name.array=i}}setToMainScene(){this.wheelLock||oe.intance.setCurrentScene(Y.M_SCENE_MAIN)}getTargetIdxByWheelId(e){return e<7?e:e>=7&&e<15?e-6:e-14}startLottery(e){let i=e.type;console.log("btn_openFree",e),this.wheelLock=!0;let a=this.getTargetIdxByWheelId(e.wheelId),r=this["turntableBox_"+i+"_"+a].getChildByName("propBox"),s,o,l;this.wheelReward=e.reward,this.wheelId=e.wheelId,console.log("wheelReward=======================>",this.wheelReward),i==1?(s=6,o=this.img_pan1,l=r.getChildByName("img_guang")):i==2?(s=8,o=this.img_pan2,l=this.img_guang2):(s=10,o=this.img_pan3,l=r.getChildByName("img_guang")),l.visible=!1;let c=360/s,u=360-a*c+c,d=(Math.floor(Math.random()*5)+5)*360+u,L=new Laya.Tween,x=this;L.to(o,{rotation:d},7e3,Laya.Ease.expoInOut,Laya.Handler.create(this,function(){console.log("抽奖完成，抽中奖品："+a),o.rotation=u,Laya.timer.once(150,x,()=>{x.blinkImage(l,3)})}))}blinkImage(e,i){let a=0,r=this;function s(){if(!(!e||!r))if(e.visible=!e.visible,a++,a<i*2)Laya.timer.once(100,r,s);else{if(r.wheelLock=!1,e.visible=!1,r.wheelId==23){let o=[];r.wheelReward.forEach(l=>{var c=new Qy;c.id=l.id,o.push(c)}),b.instance.herosDataUpdataHandler(o)}else if(r.wheelReward&&r.wheelReward.length>0){let o=[];r.wheelReward.forEach(l=>{var c=new xt;c.id=l.id,c.count=l.count,o.push(c)}),A.intance.openModule(y.RewardGetDialog,o)}else A.intance.openModule(y.DailyTaskNoPropsDialog);r.showNameList()}}s()}onCheck(){this.showNameList()}onDisable(){this.removeEvent()}removeEvent(){Laya.Tween.clearAll(this),Laya.timer.clearAll(this),g.intance.off(f.SEND_WHEEL_RESULT,this,this.startLottery)}};Zy=h([zB("lukqyw9IQG6emThMQcQxNg")],Zy);var eb=class extends Laya.Scene{};var{regClass:jB,property:q0e}=Laya,tb=class extends eb{constructor(){super(...arguments);this.text="";this.wheelReward=[];this.wheelLock=!1;this.wheelId=0;this.tabIndex=1;this.totalTabNum=9;this.timeMap=new Map;this.targetNumber=0;this.duration=2e3;this.updateInterval=30;this.currentValue=0;this.step=0}onAwake(){this.m_iLayerType=C.M_POP,this.m_iPositionType=C.UP}onEnable(){g.intance.on(f.SEND_WHEEL_RESULT,this,this.startLottery);for(let r=1;r<=this.totalTabNum;r++)this["btn_"+r].on(Laya.Event.CLICK,this,this.onClickTab,[r]);this.btn_refresh.on(Laya.Event.CLICK,this,this.showPrizePool),this.btn_openFree1.on(Laya.Event.CLICK,this,this.useWheel,[1]),this.btn_openFree2.on(Laya.Event.CLICK,this,this.useWheel,[2]),this.btn_openFree3.on(Laya.Event.CLICK,this,this.useWheel,[3]),this.btn_openFree4.on(Laya.Event.CLICK,this,this.useWheel,[4]),this.btn_openFree8.on(Laya.Event.CLICK,this,this.useWheel,[8]),this.btn_openFree5.on(Laya.Event.CLICK,this,this.openPropDialog,[1]),this.btn_openFree6.on(Laya.Event.CLICK,this,this.openPropDialog,[2]),this.btn_openFree7.on(Laya.Event.CLICK,this,this.openPropDialog,[3]),this.check_records.on(Laya.Event.CLICK,this,this.onCheck),this.tab0.on(Laya.Event.CLICK,this,this.setBoxTab,[0]),this.tab1.on(Laya.Event.CLICK,this,this.setBoxTab,[1]),this.tab2.on(Laya.Event.CLICK,this,this.setBoxTab,[2]),this.btn_openFree5.label=m.instance.getLanguage(1665,1),this.btn_openFree6.label=m.instance.getLanguage(1665,5),this.btn_openFree7.label=m.instance.getLanguage(1665,10),this.check_records.selected=!1,this.initContainer(1),this.initContainer(2),this.initContainer(3),this.initContainer(4),this.initContainer(5),this.initContainer(6),this.initContainer(7),this.initContainer(8),this.close&&this.btn_back.on(Laya.Event.CLICK,this,this.setToMainScene),this.onClickTab(1);let i=_.intance.getWheel2ByType(1)[0].consumption[0],a=this.btn_openFree8.getChildByName("tf_btn");a.text=m.instance.getLanguage(1726,i[1])}async onClickTab(e){this.wheelLock||(e==9?(this.nameBox.visible=!1,this.img_bj.skin="res/dailyTasks/img_com_bj5.jpg",await this.showPrizePool()):(this.box_all_1.visible&&this.img_bj.skin!="res/dailyTasks/bj_1.jpg"&&(this.img_bj.skin="res/dailyTasks/bj_1.jpg"),await this.getRestWheelNumData(e)),this.BoxsetTab(e))}async showPrizePool(){let e=await v.requestPost("wxgame/wheel1/prizePool",{});if(e){var i=e.totalNum;i=Math.floor(i),this.animateNumber(i)}}animateNumber(e){Laya.timer.clear(this,this.addNumber),this.currentValue=0,this.targetNumber=e,this.step=this.targetNumber/(this.duration/this.updateInterval),Laya.timer.loop(this.updateInterval,this,this.addNumber)}addNumber(){this.currentValue+=this.step,this.currentValue>=this.targetNumber&&(this.currentValue=this.targetNumber,Laya.timer.clear(this,this.addNumber));var e=this.padNumber(Math.floor(this.currentValue),9);this.fontClip_poolNum.value=e}padNumber(e,i){return e.toString().padStart(i,"0")}setBoxTab(e){for(let i=0;i<3;i++)e==i?(this["tab"+i].skin="res/dailyTasks/img_tab-xz.png",this["tab"+i].getChildByName("tf_tit").color="#ffffff"):(this["tab"+i].skin="res/dailyTasks/img_tabdi.png",this["tab"+i].getChildByName("tf_tit").color="#79c7fe");this.box_all_1.visible=e==0,this.box_all_2.visible=e==1,this.box_all_3.visible=e==2,e==0?(this.img_bj.skin="res/dailyTasks/bj_1.jpg",this.onClickTab(1)):e==1?(this.img_bj.skin="res/dailyTasks/bj.jpg",this.onClickTab(5)):this.onClickTab(8)}async openPropDialog(e){this.wheelLock||A.intance.openModule(y.DailyTaskPropsDialog,[e])}BoxsetTab(e){this.tabIndex=e;for(let i=1;i<=this.totalTabNum;i++)if(e==i){if(this["btn_"+i].getChildByName("selectBox").visible=!0,this["btn_"+i].getChildByName("tf_txt").color="#143f6b",this["box_"+i]&&(this["box_"+i].visible=!0),e<5){let a=this.getRestWheelNumByType(i),r=this["btn_openFree"+i].getChildByName("tf_left"),s=this["btn_openFree"+i].getChildByName("tf_btn");a>0?r&&(r.text=m.instance.getLanguage(1704,a),r.visible=!0,s.visible=!1):(r.visible=!1,s.visible=!0)}}else this["btn_"+i].getChildByName("selectBox").visible=!1,this["btn_"+i].getChildByName("tf_txt").color="#7ff1fe",this["box_"+i]&&(this["box_"+i].visible=!1)}setTopTab(e){for(let i=1;i<5;i++)console.log(i),e==i?(this["btn_top_"+i].getChildByName("selectBox").visible=!0,this["btn_top_"+i].getChildByName("tf_txt").color="#ffffff"):(this["btn_top_"+i].getChildByName("selectBox").visible=!1,this["btn_top_"+i].getChildByName("tf_txt").color="#4e87b7")}initContainer(e){let i;e<=4?i=_.intance.getWheel1ByType(e):e>4&&e<8?i=_.intance.getWheelByType(e-4):i=_.intance.getWheel2ByType(e-7);for(let a=0;a<i.length;a++){let r=i[a];if(r){let s=this["turntableBox_"+e+"_"+(a+1)].getChildByName("propBox"),o=S.instance.getItemIcon(r.wheelImage);s.getChildByName("img_reardIcon").skin=o,s.visible=!0,s.getChildByName("tf_name").text=m.instance.getLanguage(r.name);let l=s.getChildByName("tf_num");l&&(l.text=`x${r.rewardNum}`,r.rewardNum==0&&(l.visible=!1));let c=this["btn_openFree"+e].getChildByName("tf_btn");if(c){let u=[];i.length>0&&(u=i[0].consumption[0]);let p=_.intance.m_dicItems.get(u[0]),d=m.instance.getLanguage(p.name);e==8?c.text=`${u[1]} Phantom Credit`:c.text=m.instance.getLanguage(1703,u[1],d,u[2])}}}}setToMainScene(){this.wheelLock||oe.intance.setCurrentScene(Y.M_SCENE_MAIN)}getTargetIdxByWheelId(e){return this.tabIndex<5?e<9?e:e>=9&&e<19?e-8:e>=19&&e<33?e-18:e-32:this.tabIndex>=5&&this.tabIndex<8?e<7?e:e>=7&&e<15?e-6:e-14:e}startLottery(e){let i=e.type;this.tabIndex>=5&&this.tabIndex<8?i+=4:this.tabIndex>=8&&(i+=7),this.wheelLock=!0;let a=this.getTargetIdxByWheelId(e.wheelId),r=this["turntableBox_"+i+"_"+a].getChildByName("propBox"),s,o,l;switch(this.wheelReward=e.reward,this.wheelId=e.wheelId,i){case 1:s=8,o=this.img_pan1,l=this.img_guang;break;case 2:s=10,o=this.img_pan2,l=r.getChildByName("img_guang");break;case 3:s=14,o=this.img_pan3,l=r.getChildByName("img_guang");break;case 4:s=16,o=this.img_pan4,l=r.getChildByName("img_guang");break;case 5:s=6,o=this.img_pan5,l=r.getChildByName("img_guang");break;case 6:s=8,o=this.img_pan6,l=this.img_guang6;break;case 7:s=10,o=this.img_pan7,l=r.getChildByName("img_guang");break;case 8:s=16,o=this.img_pan8,l=r.getChildByName("img_guang");break}l.visible=!1;let c=360/s,u=360-a*c+c,d=(Math.floor(Math.random()*5)+30)*360+u,L=new Laya.Tween,x=this;L.to(o,{rotation:d},12e3,Laya.Ease.expoInOut,Laya.Handler.create(this,function(){console.log("抽奖完成，抽中奖品："+a),o.rotation=u,Laya.timer.once(150,x,()=>{x.blinkImage(l,3)})}))}blinkImage(e,i){let a=0,r=this;function s(){if(!(!e||!r))if(e.visible=!e.visible,a++,a<i*2)Laya.timer.once(100,r,s);else{if(r.wheelLock=!1,e.visible=!1,r.wheelId==23,r.wheelReward&&r.wheelReward.length>0){let o=[];r.wheelReward.forEach(l=>{var c=new xt;c.id=l.id,c.count=l.count,o.push(c)}),A.intance.openModule(y.RewardGetDialog,o)}else A.intance.openModule(y.DailyTaskNoPropsDialog);r.getRestWheelNumData(r.tabIndex)}}s()}onCheck(){this.getRestWheelNumData(this.tabIndex)}useWheel(e){if(this.wheelLock)return;if(this.getRestWheelNumByType(e)>0)this.turnWheel(e);else{let a;e==8?a=_.intance.getWheel2ByType(1):a=_.intance.getWheel1ByType(e);let r=0;a.length>0&&(r=a[0].consumption[0][1]);let s=b.instance.getConsumeValue(a[0].consumption[0][0]),o=_.intance.m_dicItems.get(a[0].consumption[0][0]),l=m.instance.getLanguage(o.name);if(s<r){let c=Laya.Handler.create(this,()=>{oe.intance.setCurrentScene(Y.M_SCENE_ASSET),this.close()});pe.instance().AlertByType(P.BASEALERTVIEW,m.instance.getLanguage(1706,l),P.CANCEL,c)}else{let c=Laya.Handler.create(this,()=>{e==8?this.buyTurn2Times(1):this.buyTurnTimes(e)});pe.instance().AlertByType(P.BASEALERTVIEW,m.instance.getLanguage(1705,r,l),P.CANCEL,c)}}}async buyTurnTimes(e){let i=await v.requestPost("wxgame/wheel1/buy",{type:e});if(console.log(i),i){let a=i.times;this.timeMap.set(e,a),this.setOpenFree(e,a),this.turnWheel(e)}}async buyTurn2Times(e){let i=await v.requestPost("wxgame/wheelPc/buy",{type:e});console.log(i),i&&this.turnWheel2(e)}setOpenFree(e,i){let a=this["btn_openFree"+e].getChildByName("tf_left"),r=this["btn_openFree"+e].getChildByName("tf_btn");a.text=m.instance.getLanguage(1704,i),i>0?(a.visible=!0,r.visible=!1):(a.visible=!1,r.visible=!0)}async turnWheel(e){let i=await v.requestPost("wxgame/wheel1/turn",{type:e});if(console.log(i),i){let a=i.times;this.timeMap.set(e,a),this.setOpenFree(e,a),this.startLottery(i)}}async turnWheel2(e){let i=await v.requestPost("wxgame/wheelPc/turn",{type:e});console.log(i),i&&this.startLottery(i)}async getRestWheelNumData(e){let i;if(e<5?i=await v.requestPost("wxgame/wheel1/panel",{type:e}):e>=5&&e<8?i=await v.requestPost("wxgame/wheel/panel",{}):i=await v.requestPost("wxgame/wheelPc/panel",{}),console.log(i),i){let a=i.times;if(this.timeMap.set(e,a),!this.check_records.selected)this.list_name.array=i.rewards;else{let r=[];r=i.rewards.filter(s=>s.pid==b.instance.playerDto.pid),this.list_name.array=r}this.nameBox.visible=!0}}getRestWheelNumByType(e){return this.timeMap.has(e)?this.timeMap.get(e):0}onDisable(){this.removeEvent()}removeEvent(){Laya.Tween.clearAll(this),Laya.timer.clearAll(this),g.intance.off(f.SEND_WHEEL_RESULT,this,this.startLottery),this.btn_1.off(Laya.Event.CLICK,this,this.onClickTab),this.btn_2.off(Laya.Event.CLICK,this,this.onClickTab),this.btn_3.off(Laya.Event.CLICK,this,this.onClickTab),this.btn_4.off(Laya.Event.CLICK,this,this.onClickTab),this.btn_5.off(Laya.Event.CLICK,this,this.onClickTab),this.btn_6.off(Laya.Event.CLICK,this,this.onClickTab),this.btn_7.off(Laya.Event.CLICK,this,this.onClickTab),this.btn_8.off(Laya.Event.CLICK,this,this.onClickTab),this.btn_openFree1.off(Laya.Event.CLICK,this,this.useWheel),this.btn_openFree2.off(Laya.Event.CLICK,this,this.useWheel),this.btn_openFree3.off(Laya.Event.CLICK,this,this.useWheel),this.btn_openFree4.off(Laya.Event.CLICK,this,this.useWheel),this.btn_openFree5.off(Laya.Event.CLICK,this,this.useWheel),this.btn_openFree6.off(Laya.Event.CLICK,this,this.useWheel),this.btn_openFree7.off(Laya.Event.CLICK,this,this.useWheel),this.btn_openFree8.off(Laya.Event.CLICK,this,this.useWheel),this.tab0.off(Laya.Event.CLICK,this,this.setBoxTab,[0]),this.tab1.off(Laya.Event.CLICK,this,this.setBoxTab,[1]),this.tab2.off(Laya.Event.CLICK,this,this.setBoxTab,[2]),this.check_records.off(Laya.Event.CLICK,this,this.onCheck),this.btn_back.off(Laya.Event.CLICK,this,this.setToMainScene)}};tb=h([jB("7RZoY37eR_CbuJ-KiG2xcA")],tb);var ib=class extends Laya.Box{};var{regClass:$B}=Laya,ab=class extends ib{constructor(){super();this.friendData=null}addEvent(){this.btn_cancel.on(Laya.Event.CLICK,this,this.onClickCancel),this.btn_claim.on(Laya.Event.CLICK,this,this.onClickClaim)}onDisable(){this.removeEvent()}removeEvent(){this.btn_cancel.off(Laya.Event.CLICK,this,this.onClickCancel),this.btn_claim.off(Laya.Event.CLICK,this,this.onClickClaim)}set dataSource(e){super.dataSource=e,e&&(this.friendData=e,this.btn_claim.label=m.instance.getUILang("agree"),this.setData(e),this.addEvent())}setData(e){this.tf_name.text=e.name,this.img_flag.skin=S.instance.getCountryIcon(e.country),this.playerIcon.headSkin=e.icon}async onClickCancel(){let e=await v.requestPost("wxgame/friend/friendApplyHandle",{fid:this.friendData.id,agree:!1});console.log(e),e&&pe.instance().AlertByType(P.BASEALERTVIEW,Ee.instance.get(310),P.YES,Laya.Handler.create(this,()=>{g.intance.event(f.CHANGE_FRIEND_APPLY_LIST,this.friendData.id)}))}async onClickClaim(){let e=_.intance.getGeneralValueById(11);if(b.instance.friendNum>=e){pe.instance().AlertByType(P.BASEALERTVIEW,Ee.instance.get(301),P.YES);return}let i=await v.requestPost("wxgame/friend/friendApplyHandle",{fid:this.friendData.id,agree:!0});console.log(i),i&&(pe.instance().AlertByType(P.BASEALERTVIEW,Ee.instance.get(309),P.YES),g.intance.event(f.CHANGE_FRIEND_APPLY_LIST))}};ab=h([$B("5M3de4CbRMertZBZtmoOIQ")],ab);var nb=class extends Laya.Box{};var{regClass:XB}=Laya,rb=class extends nb{constructor(){super();this.friendData=null}addEvent(){this.btn_app.on(Laya.Event.CLICK,this,this.onClickApp)}onDisable(){this.removeEvent()}removeEvent(){this.btn_app.off(Laya.Event.CLICK,this,this.onClickApp)}async onClickApp(){let e=_.intance.getGeneralValueById(11);if(b.instance.friendNum>=e){pe.instance().AlertByType(P.BASEALERTVIEW,Ee.instance.get(301),P.YES);return}let i=await v.requestPost("wxgame/friend/addFriend",{openid:this.friendData.openid});console.log(i),i&&pe.instance().AlertByType(P.BASEALERTVIEW,Ee.instance.get(307),P.YES,Laya.Handler.create(this,()=>{g.intance.event(f.REFRSH_APPLY_FRIEND_LIST,this.friendData.id)}))}set dataSource(e){if(super.dataSource=e,!e){this.visible=!1;return}this.btn_app.label=m.instance.getUILang("application"),console.log(e),this.friendData=e,this.setData(e),this.addEvent()}setData(e){this.tf_name.text=e.name,this.img_flag.skin=S.instance.getCountryIcon(e.country),this.playerIcon.headSkin=e.icon}};rb=h([XB("EI72MOH9RbqdGkjSCxI8Kg")],rb);var sb=class extends Laya.Box{};var{regClass:QB}=Laya,ob=class extends sb{constructor(){super();this.friendData=null}addEvent(){this.btn_remove.on(Laya.Event.CLICK,this,this.onClickRemove),this.btn_talk.on(Laya.Event.CLICK,this,this.onClickTalk)}onDisable(){this.removeEvent()}removeEvent(){this.btn_remove.off(Laya.Event.CLICK,this,this.onClickRemove),this.btn_talk.off(Laya.Event.CLICK,this,this.onClickTalk)}set dataSource(e){super.dataSource=e,e&&(this.friendData=e,this.setData(e),this.addEvent())}setData(e){this.tf_name.text=e.name,this.img_flag.skin=S.instance.getCountryIcon(e.country),this.playerIcon.headSkin=e.icon,e.online?(this.tf_online.text="on line",this.tf_online.color="#43ef74"):(this.tf_online.text=se.formatTimeAgo(e.lastLoginTime),this.tf_online.color="#b4b4b4")}async onClickRemove(){await v.requestPost("wxgame/friend/delFriend",{fid:this.friendData.id})&&(pe.instance().AlertByType(P.BASEALERTVIEW,Ee.instance.get(308),P.YES),g.intance.event(f.CHANGE_FRIEND_LIST,this.friendData.id))}async onClickTalk(){A.intance.openModule(y.PrivateChatDialog,this.friendData)}};ob=h([QB("hh1cVJJ6Sr2JZvqUJFzF6Q")],ob);var lb=class extends Laya.Scene{};var{regClass:JB,property:JIe}=Laya,cb=class extends lb{constructor(){super(...arguments);this.text="";this.refreshCd=0;this.friendData=null;this.recommendFriend=null;this.applyFriend=null;this.inputFriendAddress=!1}onAwake(){this.m_iLayerType=C.M_POP,this.m_iPositionType=C.UP}onEnable(){this.list_friend.visible=!1,this.list_apply.visible=!1,this.list_add.visible=!1,this.btn_myFriend.on(Laya.Event.CLICK,this,this.onClickMy),this.btn_addFriend.on(Laya.Event.CLICK,this,this.onClickAdd),this.btn_application.on(Laya.Event.CLICK,this,this.onClickApp),this.btn_addByDress.on(Laya.Event.CLICK,this,this.onClickAddByDress),this.btn_lookup.on(Laya.Event.CLICK,this,this.onClickLookup),this.btn_refresh.on(Laya.Event.CLICK,this,this.onClickRefresh),this.tf_nickname.on(Laya.Event.FOCUS,this,this.nameFocus),g.intance.on(f.REFRSH_APPLY_FRIEND_LIST,this,this.deleApplyFriendList),g.intance.on(f.CHANGE_FRIEND_APPLY_LIST,this,this.onClickApp),g.intance.on(f.CHANGE_FRIEND_LIST,this,this.deleFriendList),this.tf_uid.on(Laya.Event.FOCUS,this,this.uidFocus),this.close&&this.btn_back.on(Laya.Event.CLICK,this,this.setToMainScene),this.onClickMy(),this.refreshRed()}setTabState(e,i,a,r){e.getChildByName("selectBox").visible=i,e.getChildByName("tf_txt").color=i?a:r}onClickMy(){this.box_1.visible=!0,this.box_2.visible=!1,this.box_3.visible=!1,this.noDataBox.visible=!1,this.setTabState(this.btn_myFriend,!0,"#143f6b","#7ff1fe"),this.setTabState(this.btn_addFriend,!1,"#143f6b","#7ff1fe"),this.setTabState(this.btn_application,!1,"#143f6b","#7ff1fe"),this.setFriendData()}async setFriendData(){let e=await v.requestPost("wxgame/friend/friendList",{});if(e&&e.list){b.instance.friendNum=e.list.length,this.list_friend.array=e.list,this.list_friend.visible=!0,this.friendData=e.list;let i=this.countOnlineUsers(e.list);console.log(i);let a=_.intance.getGeneralValueById(11);this.tf_friendNum.text=`${b.instance.friendNum}/${a}`}else this.tf_friendNum.text="0/0";(!e||!e.list||e.list.length<1)&&(this.noDataBox.visible=!0),console.log(e)}async onClickAdd(){if(this.box_1.visible=!1,this.box_2.visible=!0,this.box_3.visible=!1,this.noDataBox.visible=!1,this.setTabState(this.btn_addFriend,!0,"#143f6b","#7ff1fe"),this.setTabState(this.btn_myFriend,!1,"#143f6b","#7ff1fe"),this.setTabState(this.btn_application,!1,"#143f6b","#7ff1fe"),!this.recommendFriend||this.recommendFriend.length<=0){let e=await v.requestPost("wxgame/friend/recommend",{});e&&e.list&&(this.recommendFriend=e.list,this.list_apply.array=e.list,this.list_apply.visible=!0,this.list_apply.vScrollBarSkin="")}}async onClickAddByDress(){if(this.tf_uid.text==F.instance.walletAddress){pe.instance().AlertByType(P.BASEALERTVIEW,m.instance.getLanguage(1162),P.YES),this.tf_uid.text="";return}let e=this.tf_uid.text;if(e.length<=0||!this.inputFriendAddress){pe.instance().AlertByType(P.BASEALERTVIEW,m.instance.getLanguage(1298),P.YES);return}let i=_.intance.getGeneralValueById(11);if(b.instance.friendNum>=i){pe.instance().AlertByType(P.BASEALERTVIEW,Ee.instance.get(301),P.YES);return}if(this.friendData.findIndex(r=>r.openid==e.toLowerCase())>-1){pe.instance().AlertByType(P.BASEALERTVIEW,Ee.instance.get(302),P.YES);return}pe.instance().AlertByType(P.BASEALERTVIEW,Ee.instance.get(303),P.SURE,Laya.Handler.create(this,async()=>{let r=await v.requestPost("wxgame/friend/addFriend",{openid:e});console.log(r),r&&E.instance.notice(Ee.instance.get(307))}))}nameFocus(){this.tf_nickname.text=""}uidFocus(){this.tf_uid.text="",this.inputFriendAddress=!0}async onClickApp(){this.box_1.visible=!1,this.box_2.visible=!1,this.box_3.visible=!0,this.noDataBox.visible=!1,this.setTabState(this.btn_addFriend,!1,"#143f6b","#7ff1fe"),this.setTabState(this.btn_myFriend,!1,"#143f6b","#7ff1fe"),this.setTabState(this.btn_application,!0,"#143f6b","#7ff1fe");let e=await v.requestPost("wxgame/friend/friendApplyList",{});e&&e.list&&(this.list_add.array=e.list,this.list_add.visible=!0,this.applyFriend=e.list,e.list.length<=0&&(this.Img_social.visible=!1)),(!e||!e.list||e.list.length<1)&&(this.noDataBox.visible=!0)}onDisable(){this.removeEvent()}removeEvent(){this.btn_myFriend.off(Laya.Event.CLICK,this,this.onClickMy),this.btn_addFriend.off(Laya.Event.CLICK,this,this.onClickAdd),this.btn_application.off(Laya.Event.CLICK,this,this.onClickApp),this.btn_addByDress.off(Laya.Event.CLICK,this,this.onClickAddByDress),this.btn_lookup.off(Laya.Event.CLICK,this,this.onClickLookup),this.btn_refresh.off(Laya.Event.CLICK,this,this.onClickRefresh),this.tf_nickname.off(Laya.Event.FOCUS,this,this.nameFocus),g.intance.off(f.REFRSH_APPLY_FRIEND_LIST,this,this.deleApplyFriendList),g.intance.off(f.CHANGE_FRIEND_APPLY_LIST,this,this.onClickApp),g.intance.off(f.CHANGE_FRIEND_LIST,this,this.deleFriendList),this.tf_uid.off(Laya.Event.FOCUS,this,this.uidFocus),this.btn_back.off(Laya.Event.CLICK,this,this.setToMainScene)}setToMainScene(){oe.intance.setCurrentScene(Y.M_SCENE_MAIN)}countOnlineUsers(e){return e.filter(i=>i.online).length}async onClickLookup(){if(this.tf_nickname.text==""){pe.instance().AlertByType(P.BASEALERTVIEW,Ee.instance.get(304),P.YES);return}let e=this.tf_nickname.text,i=await v.requestPost("wxgame/friend/search",{nickName:e});i&&i.list&&(this.recommendFriend=i.list,this.list_apply.array=i.list)}deleApplyFriendList(e){let i=this.recommendFriend.findIndex(a=>a.id==e);i>-1&&this.recommendFriend.splice(i,1),this.list_apply.array=this.recommendFriend}deleFriendList(e){let i=this.friendData.findIndex(r=>r.id==e);i>-1&&this.friendData.splice(i,1),this.list_friend.array=this.friendData,b.instance.friendNum=this.friendData.length;let a=_.intance.getGeneralValueById(11);this.tf_friendNum.text=`${b.instance.friendNum}/${a}`,this.list_friend.array.length<=0&&(this.noDataBox.visible=!0)}async onClickRefresh(){if(this.refreshCd>0){E.instance.notice(m.instance.getLanguage(1287,this.refreshCd));return}let e=await v.requestPost("wxgame/friend/recommend",{});e&&e.list&&(this.recommendFriend=e.list,this.list_apply.array=e.list),console.log(e),this.tf_nickname.text="PLEASE ENTER A NICKNAME TO FIND FRIENDS",this.tf_uid.text="Enter wallet address to add friends",this.inputFriendAddress=!1,E.instance.notice(Ee.instance.get(306)),this.refreshCd=5,Laya.timer.loop(1e3,this,this.RefreshCount)}RefreshCount(){this.refreshCd-=1,this.refreshCd<=0&&Laya.timer.clear(this,this.RefreshCount)}refreshRed(){this.Img_social.visible=b.instance.getRedDotById(he.ROOM_FRIEND_APPLY)}};cb=h([JB("W8WIf5GlS3S-dEWvgrU0ow")],cb);var ub=class extends Laya.Dialog{};var{regClass:ZB}=Laya,mb=class extends ub{constructor(e){super();this.friendData=null}onEnable(){this.btn_send.on(Laya.Event.CLICK,this,this.onClickSend),this.giftInput.on(Laya.Event.INPUT,this,this.onGoldInput)}setOpenData(e){e&&(this.friendData=e),this.playerIcon.headSkin=this.friendData.icon,this.tf_name.text=this.friendData.name,this.tf_gold.text=xe.filterNumFormat(b.instance.getConsumeValue(ge.TYPE_GOLD),0)}async onClickSend(){if(console.log(this.messageInput.text==""),this.messageInput.text.length<10){E.instance.notice(m.instance.getLanguage(1288,10));return}let e=Number(this.giftInput.text),i=Number(this.tf_gold.text);if(e>i){E.instance.notice(Ee.instance.get(313));return}await v.requestPost("wxgame/friend/sendMassage",{fid:this.friendData.id,content:this.messageInput.text,sendGold:e})&&pe.instance().AlertByType(P.BASEALERTVIEW,Ee.instance.get(314),P.YES,Laya.Handler.create(this,()=>{this.close()}))}onGoldInput(){let e=Number(this.giftInput.text),i=te.isNumber(this.giftInput.text),a=this.giftInput.text.includes(".");(e<0||!i||a)&&(this.giftInput.text="0")}onDisable(){this.btn_send.off(Laya.Event.CLICK,this,this.onClickSend),this.giftInput.off(Laya.Event.INPUT,this,this.onGoldInput)}};mb=h([ZB("MBJ6xxrTTGe8qOrAIMZfeQ")],mb);var pb=class extends Laya.Dialog{};var{regClass:eM}=Laya,Zn=class extends Laya.Script{constructor(){super();this._isLeft=!1}onAwake(){}get isLeft(){return this._isLeft}set isLeft(e){this._isLeft=e,this.btn_bg=this.owner.getChildByName("btn_bg"),this.label_left=this.owner.getChildByName("label_left"),this.label_right=this.owner.getChildByName("label_right"),this.isLeft?(this.btn_bg.x=4,this.label_left.color="#213343",this.label_right.color="#52a5e0"):(this.btn_bg.x=this.owner.width-this.btn_bg.width-4,this.label_left.color="#52a5e0",this.label_right.color="#213343")}};Zn=h([eM("-1MGS4JRSMOn_RKPUuuV9Q")],Zn);var{regClass:tM}=Laya,hb=class extends pb{constructor(e){super();this.m_strName="我是OpenSceneRuntime";this.m_iLayerType=C.M_POP;this.m_iPositionType=C.CENTER;this.totalLans=[1,6,7];this.currLan=0}onEnable(){this.musicSwitchButton=this.box_music.getComponent(Zn),this.soundSwitchButton=this.box_sound.getComponent(Zn),this.initContainer(),this.box_music.on(Laya.Event.CLICK,this,this.onClickHandler,[this.box_music]),this.box_sound.on(Laya.Event.CLICK,this,this.onClickHandler,[this.box_sound]),this.btn_copy.clickHandler=new Laya.Handler(this,this.onClickHandler,[this.btn_copy]),this.btn_referral.on(Laya.Event.CLICK,this,this.onClickHandler,[this.btn_referral]);for(let i=0;i<this.totalLans.length;i++){var e=this.totalLans[i];this["btn_"+e].on(Laya.Event.CLICK,this,this.onClickTab,[e])}}onClickHandler(e){switch(e){case this.box_music:this.musicSwitchButton.isLeft=!this.musicSwitchButton.isLeft,Xe.instance.switchMusic(this.musicSwitchButton.isLeft);break;case this.box_sound:this.soundSwitchButton.isLeft=!this.soundSwitchButton.isLeft,Xe.instance.switchSound(this.soundSwitchButton.isLeft);break;case this.btn_referral:A.intance.openModule(y.InviteRewardDialog);break;case this.btn_copy:{let i=this.inviteUrl;doCopy(i),E.instance.notice(m.instance.getLanguage(132))}break}}initContainer(){this.musicSwitchButton.isLeft=Xe.instance.m_bPlayMusic,this.soundSwitchButton.isLeft=Xe.instance.m_bPlayeSound,this.currLan=b.instance.m_strLanguage,this.setTab(b.instance.m_strLanguage),this.inviteUrl=Pa.getInviteUrl(),this.label_url.text=Me.shortStr(this.inviteUrl,50)}onClickTab(e){if(this.currLan==e)return;this.currLan=e,this.setTab(e);let i=m.instance.getLanTypeById(e);m.instance.FGM_SetLanguage(i),He.instance.reload()}setTab(e){for(let a=0;a<this.totalLans.length;a++){var i=this.totalLans[a];e==i?(this["btn_"+i].getChildByName("btn_yellowBg").visible=!0,this["btn_"+i].getChildByName("Label").color="#213343"):(this["btn_"+i].getChildByName("btn_yellowBg").visible=!1,this["btn_"+i].getChildByName("Label").color="#52a5e0")}}webCopyString(e){let i=e,a=window.document.createElement("textarea");a.value=i,a.setAttribute("readonly",""),a.style.contain="strict",a.style.position="absolute",a.style.left="-9999px",a.style.fontSize="12pt";let r=window.getSelection(),s=!1;r.rangeCount>0&&(s=r.getRangeAt(0)),window.document.body.appendChild(a),a.select(),a.selectionStart=0,a.selectionEnd=i.length;let o=!1;try{o=window.document.execCommand("copy")}catch(l){console.error(l)}return window.document.body.removeChild(a),s&&(r.removeAllRanges(),r.addRange(s)),o}};hb=h([tM("yJfJZzgZRluE_rgB44yTvg")],hb);var db=class extends Laya.Scene{};var{regClass:iM}=Laya,fb=class extends db{onAwake(){}onOpened(e){this.closeHandle=e[0]}onEnable(){this.btn_next.on(Laya.Event.CLICK,this,this.onBtnNext),this.btn_receive.on(Laya.Event.CLICK,this,this.onClickRec),this.tf_address.text=F.instance.walletAddress}onDisable(){this.closeHandle&&this.closeHandle.run(),this.removeEvent()}removeEvent(){}onBtnNext(){this.close()}async onClickRec(){let e=F.instance.walletAddress,i=await v.requestPost("wxgame/money/matQuery",{address:e});if(i&&i.use==1){pe.instance().AlertByType(P.BASEALERTVIEW,Ee.instance.get(122),P.YES,Laya.Handler.create(this,()=>{this.onBtnNext()}));return}try{(await v.requestPost("wxgame/money/matTake",{address:e})).errorcode==0?pe.instance().AlertByType(P.BASEALERTVIEW,m.instance.getUILang("You have applied to claim the MAT Tokens and they will be sent to your address [0X...]."),P.YES,Laya.Handler.create(this,()=>{this.onBtnNext()})):pe.instance().AlertByType(P.BASEALERTVIEW,Ee.instance.get(122),P.YES,Laya.Handler.create(this,()=>{this.onBtnNext()}))}catch{pe.instance().AlertByType(P.BASEALERTVIEW,Ee.instance.get(122),P.YES,Laya.Handler.create(this,()=>{this.onBtnNext()}))}}};fb=h([iM("wkgHnIZwR_-St6rzEoxYPQ")],fb);var yb=class extends Laya.Scene{};var{regClass:aM}=Laya,bb=class extends yb{constructor(){super(...arguments);this.restTime=5}onAwake(){}onOpened(e){console.log(e),this.closeHandle=e[0]}onEnable(){this.skipBox.on(Laya.Event.CLICK,this,this.onBtnSkip),b.instance.m_strLanguage==Yi.Lan_zh?this.img_bg.skin="res/getMat/img_open_chn.jpg":this.img_bg.skin="res/getMat/img_open_eng.jpg",console.log("langid:",b.instance.m_strLanguage),this.restTime=5,this.runTime(),this.tf_skip.text=m.instance.getUILang("Skip")}runTime(){Laya.timer.loop(1e3,this,this.countTime)}countTime(){this.restTime-=1,this.tf_restTime.text=`${this.restTime}`,this.restTime==0&&(Laya.timer.clear(this,this.countTime),this.close())}onDisable(){this.closeHandle&&this.closeHandle.run(),this.removeEvent()}removeEvent(){}async onBtnSkip(){Laya.timer.clear(this,this.countTime),this.close()}};bb=h([aM("t3HJXNipRty7KBcnDKApfA")],bb);var gb=class extends Laya.Box{};var{regClass:nM}=Laya,ua=class extends gb{constructor(){super();this.isAddEvent=!1;this.isReady=!1;this.needChangeAni=!0;this.loop=!0;this.isInited=!1}onEnable(){this.sk=this.box_sk,this.sk.on(Laya.Event.READY,this,this.onSkReady),this.sk.loop=this.loop,console.log("onEnable: + this.animationName： "+this.animationName),this.animationName&&(this.sk.animationName=this.animationName),this.spineTemplet?(this.sk.templet=this.spineTemplet,console.log("onEnable: + this.spineTemplet ")):this.templateUrl?Laya.loader.load(this.templateUrl,Laya.Loader.SPINE).then(e=>{this.destroyed||(this.sk.templet=e,console.log("this.templateUrl: "+this.templateUrl))}):this.animationName||(this.sk.animationName="animation"),this.isInited=!0}onSkReady(){this.isReady=!0,console.log("onSkReady this.visible: "+this.visible)}play(e,i,a,r,s,o,l){if(!this.isReady){console.log("动画未准备好，不能play");return}this.sk.play(e,i,a,r,s,o,l)}stop(){if(!this.isReady){console.log("动画未准备好，不能stop");return}this.sk.stop()}init(e,i="animation",a=!0){console.log("init: ",i,e),this.animationName=i,this.spineTemplet=e,this.loop=a,this.visible=!0,this.isInited&&(this.animationName&&(this.sk.animationName=this.animationName),this.sk.templet=this.spineTemplet)}initUrl(e,i="animation",a=!0){console.log("initUrl: ",e),this.animationName=i,this.templateUrl=e,this.loop=a,this.visible=!0,this.isInited&&Laya.loader.load(this.templateUrl,Laya.Loader.SPINE).then(r=>{this.destroyed||(this.animationName&&(this.sk.animationName=this.animationName),this.sk.templet=r,console.log("this.templateUrl: "+this.templateUrl))})}onDisable(){Laya.Pool.recover(ua.aniSkPrefab,this),this.box_sk.off(Laya.Event.READY,this,this.onSkReady),this.sk.templet=null}};ua.aniSkPrefab="aniSkPrefab",ua=h([nM("2rJV0EbMT9K2L6-6HOpDHw")],ua);var Lb=class extends Laya.Box{};var{regClass:rM}=Laya,_b=class extends Lb{set dataSource(t){super.dataSource=t;var e=t;if(!e)return;let i=Number(e[0]),a=e[1],r=_.intance.getAttributeDataById(i);this.tf_name.text=m.instance.getUILang(r.identification),i==1010||i==1011||i==1013||i==1014?this.tf_num.text=`${a/100}%`:this.tf_num.text=a}};_b=h([rM("lWiDi5bCR-CNy4v3ZMd42w")],_b);var Tt=class Tt{constructor(){}static pointEquil(t,e){return t&&e&&t.x==e.x&&t.y==e.y}static isEmpty(t){for(let e in t)return!1;return!0}static showTxtEffect(t,e){let i=parseInt(t.text),a=Math.floor((e-i)/5),r=0;Laya.timer.loop(60,null,s);let s=function(){r++,i+=a,r>=5&&(i=e,Laya.timer.clear(null,s)),t.text=i+""}}static showTxtFlash(t){let e=t.color;t.color=Tt.COLORS[0],Laya.Tween.to(t,{},10,null,Laya.Handler.create(null,i),50);let i=function(){t.color=Tt.COLORS[1],Laya.Tween.to(t,{},10,null,Laya.Handler.create(null,a),50)},a=function(){t.color=Tt.COLORS[0],Laya.Tween.to(t,{},10,null,Laya.Handler.create(null,r),50)},r=function(){t.color=Tt.COLORS[1],Laya.Tween.to(t,{},10,null,Laya.Handler.create(null,s),50)},s=function(){t.color=Tt.COLORS[0],Laya.Tween.to(t,{},10,null,Laya.Handler.create(null,o),50)},o=function(){t.color=Tt.COLORS[1],Laya.Tween.to(t,{},10,null,Laya.Handler.create(null,l),50)},l=function(){t.color=e}}static getProKey(t){return Tt.PRO_DIC[t]?Tt.PRO_DIC[t]:t}static getIconName(t){return Tt.proList[t]}static clonePoint(t){return new Laya.Point(t.x,t.y)}static copyObj(t){let e={};for(let i in t)e[i]=t[i];return e}static mergeObj(t,e){for(let i in e)t[i]?t[i]=parseFloat(t[i])+parseFloat(e[i]):t[i]=e[i];return t}static checkHit(t){return t.visible&&t.mouseX>0&&t.mouseY>0&&t.mouseX<=t.width&&t.mouseY<=t.height}static separateObj(t,e){if(e)for(let i in e)t[i]&&(t[i]=parseFloat(t[i])-parseFloat(e[i]));return t}static toFixed(t,e=1){if((t+"").indexOf(".")!=-1){let i=parseFloat(t).toFixed(e);return e==1&&i.charAt(i.length-1)=="0"&&(i=parseInt(i)+""),i}return t+""}static formatResWith(t){return t>=1e12?Math.floor(t/1e12)+Tt.RES_W[3]:t>=1e9?Math.floor(t/1e9)+Tt.RES_W[2]:t>=1e6?Math.floor(t/1e6)+Tt.RES_W[1]:t>=1e4?Math.floor(t/1e3)+Tt.RES_W[0]:t+""}static formatNumWithSign(t,e=","){t=Math.floor(t);let i=t+"",a=1,r=[];for(let s=i.length-1;s>=0;s--)r.push(i.charAt(s)),a>0&&a%3==0&&r.push(e),a++;return r.reverse(),r[0]==e&&r.shift(),r.join("")}static autoRecyle(t,e=!1){t.on(Laya.Event.COMPLETE,null,i,[t]),t.isPlaying||t.play(1,!1);let i=function(a){a.off(Laya.Event.COMPLETE,null,i),a.stop(),a.removeSelf(),e&&Laya.Pool.recover("Animation",a)}}static createEllipse(t,e,i,a,r,s=1,o="#ffffff"){let l=[],c=a>r?s/a:s/r;for(let u=0;u<2*Math.PI;u+=c)l.push(e+a*Math.cos(u)-a/2,i+r*Math.sin(u));return t&&t.drawPoly(l.shift(),l.shift(),l,o),l}};Tt.blackFilter=new Laya.ColorFilter([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,.78,0]),Tt.blackFilter2=new Laya.ColorFilter([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,.5,0]),Tt.qualityColors=["#78cefd","#89e47a","#78cefd","#d5a8ff","#fdd378","#ffa8a8","#ffa8a8","#ffa8a8"],Tt.noColors=["#7efcc5","#7efbfc","#acfffa","#c1c5ff","#ffcdcd","#ecceff","#fff5bd","#ffcee3","#ffdcbd","#f0ffc4"],Tt.COLORS=["#69ff4c","#FFFFFF"],Tt.PRO_DIC={HP:"hp",ATK:"attack",DEF:"defense",SPEED:"speed",RES:"resilience",CDMG:"critDamage",CDMGR:"critDamReduct"},Tt.proList={hp:"HP",attack:"ATK",defense:"DEF",speed:"SPEED",hit:"hit",dodge:"dodge",crit:"crit",critDamage:"CDMG",resilience:"RES",critDamReduct:"CDMGR"},Tt.RES_W=["K","M","B","T"];var Ct=Tt;var vb=class extends Laya.Box{};var{regClass:sM}=Laya,xb=class extends vb{constructor(){super();this.isAddEvent=!1}createChildren(){super.createChildren()}addEvent(){this.isAddEvent||(this.isAddEvent=!0)}set dataSource(e){super.dataSource=e,this.equipItem=e,this.equipItem&&(this.addEvent(),this.setCurrentOutPut())}async setCurrentOutPut(){if(!this.equipItem)return;this.btn_remove.visible=!1,this.knapsackItem.dataSource=this.equipItem;let e=this.equipItem.itemItem.id;if(this.equipItem.type==Ge.TYPE_Equipment){this.tf_des.visible=!1,this.img_att.visible=!0,this.list_attrs.visible=!0;let a=_.intance.getEquipDataById(e),r=a.attribute;this.list_attrs.array=r,this.tf_name.text=m.instance.getLanguage(this.equipItem.itemItem.name),this.tf_name.color=Ct.qualityColors[this.equipItem.itemItem.quality-1],this.tf_part.text=m.instance.getUILang(`Part_${a.type}:`),this.tf_grade.color=Ct.qualityColors[this.equipItem.itemItem.quality-1];let s=_.intance.getEquipSuitDataById(e);if(s&&s.skill){let o=s.skill;var i=_.intance.m_dicSkills.get(o);this.skillListItem.dataSource=i,this.skillListItem.visible=!0}else this.skillListItem.visible=!1;this.tf_grade.text=m.instance.getUILang(`Quality_${this.equipItem.itemItem.quality}:`)}else{let a=_.intance.getArrFromDicItemByKey("id",e);if(this.img_att.visible=!1,this.list_attrs.visible=!1,this.tf_des.visible=!0,a.length>0){let r=a[0];this.tf_des.text=m.instance.getLanguage(r.des),this.tf_name.text=m.instance.getLanguage(this.equipItem.itemItem.name),this.tf_name.color=Ct.qualityColors[this.equipItem.itemItem.quality-1],this.tf_part.text=m.instance.getUILang(`Part_${r.type}:`),this.tf_grade.color=Ct.qualityColors[this.equipItem.itemItem.quality-1];let s=r.skillId;if(s){var i=_.intance.m_dicSkills.get(s);this.skillListItem.dataSource=i,this.skillListItem.visible=!0}else this.skillListItem.visible=!1;this.tf_grade.text=m.instance.getUILang(`Quality_${this.equipItem.itemItem.quality}:`)}}}};xb=h([sM("Aiuw9-xTQyukAos8XwcRDA")],xb);var Ib=class extends Laya.Dialog{};var ri=class{constructor(){}};ri.UPDATE_HERO_EVENT="HeroEvent:UPDATE_HERO_EVENT",ri.UPDATE_HERO_UPGRADE_EVENT="HeroEvent:UPDATE_HERO_UPGRADE_EVENT",ri.UPDATE_HERO_EQUIP="HeroEvent:UPDATE_HERO_EQUIP";var{regClass:oM}=Laya,Eb=class extends Ib{constructor(){super(...arguments);this.m_strName="我是OpenSceneRuntime";this.m_iLayerType=C.M_POP;this.m_iPositionType=C.CENTER;this.selectPos=1;this.equipInfo=[];this.hostPid=0;this.clientPid=0;this.cardList=[];this.upgradeLock=!1}setOpenData(e){e&&(this._vo=e[0],e[1]&&(this.hostPid=e[1],this.clientPid=e[2],this.clientPid&&this.clientPid==b.instance.playerDto.pid&&(this._vo.state=4)),this._vo.newFightFlag||Le.isFightHero(this._vo.pk)||this._vo.state!==0?this.btn_upgrade.disabled=!0:this.btn_upgrade.disabled=!1)}onComplete(){}onEnable(){this.initEquipBg(),this.initEquip(),this.btn_last.on(Laya.Event.CLICK,this,this.onClickLast),this.btn_next.on(Laya.Event.CLICK,this,this.onClickNext),this.btn_upgrade.on(Laya.Event.CLICK,this,this.onClickUpgrade),this.btn_out.on(Laya.Event.CLICK,this,this.onClickOut),g.intance.on(ri.UPDATE_HERO_EQUIP,this,this.wearSucess);for(let a=1;a<8;a++)this["equip_"+a].on(Laya.Event.CLICK,this,this.onClickEquip,[a]);this.EquipDetailBox.getChildByName("btn_remove").on(Laya.Event.CLICK,this,this.onUnequip);let i=this.EquipDetailBox.getChildByName("knapsackItem");if(i){let a=i.getChildByName("txt_num");a&&a.visible&&(a.visible=!1)}}async onClickUpgrade(){if(this.upgradeLock)return;this.upgradeLock=!0;let e=_.intance.getConsumptionByLevel(this._vo.heroItem.level);if(e&&e[0]){let i=e[0].consumption;console.log(i);let a=i[1],r=Laya.Handler.create(this,async()=>{let s=await v.requestPost("wxgame/hero/star",{heroPk:this._vo.pk});if(s){let o=s.hero;this._vo.id=o.id,this._vo.lv=o.lv,this._vo.color=o.color,this._vo.pk=o.pk,this._vo.newFightFlag=o.newFightFlag,this.showViewByVo(this._vo),this.initEquip(),g.intance.event(ri.UPDATE_HERO_EVENT),E.instance.notice(m.instance.getLanguage(1684)),this.upgradeLock=!1}else this.upgradeLock=!1});pe.instance().AlertByType(P.BASEALERTVIEW,m.instance.getLanguage(1683,a),P.SURE,Laya.Handler.create(this,()=>{r&&r.run()}),Laya.Handler.create(this,()=>{this.upgradeLock=!1}))}}onClickNext(){let e=ze.instance.getNextHero(this._vo);e&&(this._vo=e,this.showViewByVo(e))}onClickLast(){let e=ze.instance.getLastHero(this._vo);e&&(this._vo=e,this.showViewByVo(e))}addEvent(){g.intance.on(ri.UPDATE_HERO_UPGRADE_EVENT,this,this.onHeroUpgrade),this.equipBgBox.on(Laya.Event.CLICK,this,this.hideTips);for(let e=1;e<7;e++){let i=this["equip"+e];i.on(Laya.Event.CLICK,this,this.onClickEquip),this._vo.state!==0&&(i.disabled=!0)}}hideTips(){this.EquipDetailBox.visible=!1,this.equipBgBox.visible=!1,this.equipBgBox.off(Laya.Event.CLICK,this,this.hideTips)}onClickEquip(e,i){let a=this["equip_"+e],r=e,s,o=_.intance.getGeneralValueById(26);o&&(e==5?(r=12,s=o[0][0]):e==6?(r=12,s=o[1][0]):e==7?(r=12,s=o[2][0]):s=e);let l=a.getChildByName("knapsackItem");if(l&&l.visible){this.resetEquipInfoData(l.get_dataSource()),this.selectPos=s,this.EquipDetailBox.x=a.x+80,this.EquipDetailBox.visible=!0,this.equipBgBox.visible=!0,this.equipBgBox.on(Laya.Event.CLICK,this,this.hideTips);let c=this.EquipDetailBox.getChildByName("btn_remove");c.visible=!0}else A.intance.openModule(y.WalletChoosePropsDialog,[Ge.CHOOSE_PutOn,r,this._vo.pk,s,this.cardList])}resetEquipInfoData(e){let i=e;this.EquipDetailBox.dataSource=i,this.equipBgBox.off(Laya.Event.CLICK,this,this.hideTips)}onDisable(){this.removeEvent()}removeEvent(){this.selectPos=null,g.intance.off(ri.UPDATE_HERO_UPGRADE_EVENT,this,this.onHeroUpgrade),g.intance.off(ri.UPDATE_HERO_EQUIP,this,this.wearSucess)}onHeroUpgrade(){this._vo=b.instance.m_heroData.heroVoDic.get(this._vo.pk),this._vo&&this.showViewByVo(this._vo)}updateEquip(){let e=this._vo.equipDtoList;for(let i=0;i<e.length;i++){let a=e[i];this["equip"+(i+1)].dataSource=a}}async showViewByVo(e){console.log("showViewByVo",e),this.txt_name.text=e.name;let i=e.heroItem.level+"";e.heroItem.level>=6||e.newFightFlag||Le.isFightHero(this._vo.pk)||this._vo.state!==0?this.btn_upgrade.disabled=!0:this.btn_upgrade.disabled=!1,ze.instance.setStar(this,i),this.box_star.visible=!0,this.heroSk.dataSource=e,this.list_attrs.array=this.heroAttr;var a=[];e.heroItem.skillIds.forEach(r=>{var s=_.intance.m_dicSkills.get(r);a.push(s)}),this.list_skills.array=a,this.updatePk()}async updatePk(){let e=null;this._vo.state!==0?(console.log("this._vo.state: ",this._vo.state),this._vo.state==1?(this.btn_out.disabled=!0,this.btn_upgrade.disabled=!0,this.btn_out.label=m.instance.getLanguage(1037)):this._vo.state==2||this._vo.state==4?(this.btn_upgrade.disabled=!0,Le.isFightHero(this._vo.pk)?(this.box_sign.visible=!0,this.btn_out.disabled=!0,this.btn_out.label=m.instance.getLanguage(1038)):(this.box_sign.visible=!1,this.btn_out.disabled=!1,this.btn_out.label=m.instance.getLanguage(1037),this.btn_upgrade.disabled=!0)):this._vo.state==3?(this.box_sign.visible=!1,this.btn_out.disabled=!0,this.btn_upgrade.disabled=!0,this.btn_out.label=m.instance.getLanguage(1037)):this._vo.state==4&&(this.btn_upgrade.disabled=!0),(this._vo.state==1||this._vo.state==2)&&(e=await v.requestPost("wxgame/lease/heroInfo",{heroPk:this._vo.pk}),e&&e.info&&e.info.startTime&&e.info.startTime>se.getCurrentDayTimestamp()&&(this.btn_out.disabled=!0,this.btn_upgrade.disabled=!0))):Le.isFightHero(this._vo.pk)?(this.box_sign.visible=!0,this.btn_out.disabled=!0,this.btn_out.label=m.instance.getLanguage(1038)):(this.box_sign.visible=!1,this.btn_out.disabled=!1,this.btn_out.label=m.instance.getLanguage(1037))}async initEquip(){let e;if(this._vo.state==4?e=await v.requestPost("wxgame/equip/info",{heroPk:this._vo.pk}):this.hostPid?e=await v.requestPost("wxgame/equip/info",{heroPk:this._vo.pk,heroPid:this.hostPid}):e=await v.requestPost("wxgame/equip/info",{heroPk:this._vo.pk}),e){console.log(e);let i=[];this.cardList=[];for(let a in e.equipInfo){let r=e.equipInfo[a];r.pos=Number(a),i.push(r)}this.equipInfo=i||[],e.attr&&(this.heroAttr=Object.entries(e.attr),this.equipInfo&&this.refreshEquipShow())}}refreshEquipShow(){for(let e=1;e<8;e++){let i=this.equipInfo[e-1];if(i){let a=_.intance.getArrFromDicItemByKey("id",i.id)[0],r=_.intance.getGeneralValueById(26),s;i.pos==r[0][0]?s=5:i.pos==r[1][0]?s=6:i.pos==r[2][0]?s=7:s=a.subType;let o=this["equip_"+s];if(o){let l=o.getChildByName("img_default");l.visible=!1;let c=o.getChildByName("knapsackItem");c.visible=!0;let u=new Ne(i.id);c.dataSource=u,s<5&&(this._vo.state==2||this._vo.state==4)&&(o.disabled=!i.own)}}}this.showEquipRed()}wearSucess(e){let i=e.type,a=_.intance.getGeneralValueById(26);i!==a[0][1]&&i!==a[1][1]&&i!==a[2][1]&&(this.equipInfo.push(e),this.refreshEquipShow())}initEquipBg(){for(let e=1;e<8;e++){let i=this["equip_"+e];if(i.disabled=this._vo.state!==0,!i)return;let a=i.getChildByName("img_default"),r=i.getChildByName("knapsackItem"),s=r.getChildByName("txt_num");switch(e<5?s.visible=!1:s.visible=!0,e){case 1:i.disabled=this._vo.state==1||this._vo.state==3,a.skin="res/heroDetail/img_information_wuqi.png";break;case 2:i.disabled=this._vo.state==1||this._vo.state==3,a.skin="res/heroDetail/img_information_toukui.png";break;case 3:i.disabled=this._vo.state==1||this._vo.state==3,a.skin="res/heroDetail/img_information_kuijia.png";break;case 4:i.disabled=this._vo.state==1||this._vo.state==3,a.skin="res/heroDetail/img_information_xuezi.png";break;case 5:i.disabled=this._vo.state==1||this._vo.state==3,a.skin="res/heroDetail/img_information_dunpai.png";break;case 6:i.disabled=this._vo.state==1||this._vo.state==3,a.skin="res/heroDetail/img_information_dunpai.png";break;case 7:i.disabled=this._vo.state==1||this._vo.state==3,a.skin="res/heroDetail/img_information_dunpai.png";break;case 101:case 102:case 103:a.skin="res/heroDetail/img_information_dunpai.png";break}a.visible=!0,r.visible=!1}}showEquipRed(){console.log(this.equipInfo);let e=_.intance.getGeneralValueById(26);var i=b.instance.m_packageData.getBackByType(5);for(let c=1;c<8;c++){let u=this["equip_"+c],p=c;e&&(c==5?p=e[0][1]:c==6?p=e[1][1]:c==7&&(p=e[2][1]));var a=b.instance.m_packageData.getListBySubType(p);if(u&&a.length>0){let d=u.getChildByName("red_mail");d&&(d.visible=!0)}}let r=[],s=!0,o;this.cardList=[];for(let c=0;c<this.equipInfo.length;c++){let u=this.equipInfo[c];this.cardList.push(u.id);let p=_.intance.getArrFromDicItemByKey("id",u.id);if(p&&p[0].subType!==e[0][1]&&p[0].subType!==e[1][1]&&p[0].subType!==e[2][1]&&(o=_.intance.getEquipSuitDataById(u.id),!s||!o||r.indexOf(o.id)<-1&&r.length>0?s=!1:r.push(o.id)),p&&p.length>0){let d=p[0].subType;u.pos==e[0][0]?d=5:u.pos==e[1][0]?d=6:u.pos==e[2][0]&&(d=7);let L=this["equip_"+d],x=L.getChildByName("knapsackItem"),w=x.getChildByName("txt_num");if(d<5)w.visible=!1;else{w.visible=!0;var l=b.instance.m_packageData.getCountById(u.id);w.text=l+"",x.gray=!(l>0)}let I=i.findIndex(M=>M.subType==p[0].subType&&M.itemItem.quality>p[0].quality);if(I<0&&(console.log(I),L)){let M=L.getChildByName("red_mail");M&&(M.visible=!1)}}}this.showViewByVo(this._vo)}async onClickOut(){if(Ae.instance.inMinWaiting){E.instance.notice(m.instance.getLanguage(1187));return}let e=this,i=this._vo.newFightFlag==1?1:0,a=await v.requestPost("wxgame/hero/heroFight",{pk:this._vo.pk,type:i});a?(a.type==1?b.instance.playerDto.newFightHeroPk=a.pk:b.instance.playerDto.fightHeroPk=a.pk,e.updatePk(),g.intance.event(ri.UPDATE_HERO_EVENT,i)):E.instance.notice(m.instance.getLanguage(135))}async onUnequip(){let e=_.intance.getGeneralValueById(26),i=this.selectPos===e[0][1]?101:this.selectPos;this.selectPos===e[0][0]?i=e[0][0]:this.selectPos===e[1][0]?i=e[1][0]:this.selectPos===e[2][0]?i=e[2][0]:i=this.selectPos;let a=await v.requestPost("wxgame/equip/takeOff",{heroPk:this._vo.pk,pos:i});if(a){for(let r=0;r<this.equipInfo.length;r++){let s=this.equipInfo[r];if(_.intance.getArrFromDicItemByKey("id",s.id)[0]&&s.pos===a.pos){this.equipInfo.splice(r,1);break}}this.initEquipBg(),this.refreshEquipShow(),this.hideTips()}else console.error("Failed to unequip: ",a)}};Eb=h([oM("Qri7gUY9SiWsYhtvNCEOQQ")],Eb);var wb=class extends Laya.Box{};var{regClass:lM}=Laya,Tb=class extends wb{constructor(){super();this.isAddEvent=!1;this.needPop=!0}createChildren(){super.createChildren()}addEvent(){this.isAddEvent||(this.on(Laya.Event.CLICK,this,this.toDetail),this.isAddEvent=!0)}set dataSource(e){if(super.dataSource=e,this.heroVo=e,!this.heroVo){this.img_back.skin=S.instance.getHeroBackIcon(0),this.box_show.visible=!1;return}this.needPop&&this.addEvent(),this.setCurrentOutPut()}async setCurrentOutPut(){var e=[];Le.isFightHero(this.heroVo.pk)&&e.push(1),this.heroVo.state==4&&e.push(14),this.heroVo.state==3&&e.push(13),this.heroVo.state==2&&e.push(3),this.heroVo.state==1&&e.push(2),this.heroVo.newFightFlag==1?(e.push(5),this.img_newFightFlag.visible=!0):this.img_newFightFlag.visible=!1,this.list_state.array=e,this.img_back.skin=S.instance.getHeroBackIcon(this.heroVo.heroItem.quality),this.img_front.skin=S.instance.getHeroFrontIcon(this.heroVo.heroItem.quality),this.img_hero.skin=this.heroVo.simgurl,this.tf_name.text=Me.shortHeroStr(this.heroVo.name);let i=this.heroVo.heroItem.level+"";ze.instance.setStar(this,i),this.box_show.visible=!0,this.destroyed}toDetail(){this.heroVo.id&&A.intance.openModule(y.HeroDetailDialog,[this.heroVo])}};Tb=h([lM("PfeS1F4rQCqM4vXJpBZVWQ")],Tb);var Cb=class extends Laya.Box{};var{regClass:cM}=Laya,Sb=class extends Cb{constructor(){super();this.isAddEvent=!1;this.isReady=!1;this.skinIndex=0;this.spineAniIndex=0;this.skinArray=["goblin","goblingirl"];this.needChangeAni=!0}onEnable(){this.sk=this.box_sk}addEvent(){this.isAddEvent||(this.isAddEvent=!0,this.needChangeAni&&this.on(Laya.Event.CLICK,this,this.changeAni),this.box_sk.on(Laya.Event.READY,this,this.onSkReady))}onSkReady(){this.isReady=!0}set dataSource(e){super.dataSource=e,this.heroVo=e,this.addEvent(),this.createSpine()}createSpine(){Laya.loader.load(this.heroVo.sk,Laya.Loader.SPINE).then(e=>{this.destroyed||(this.sk.templet=e,this.sk.animationName=Je.ANI_daiji,this.spineAniNum=Je.ANIS.length)})}changeAni(){if(this.isReady){this.spineAniIndex++,this.spineAniIndex>=this.spineAniNum&&(this.spineAniIndex=0);var e=Je.ANIS[this.spineAniIndex];this.sk.play(e,!0,!0)}}changeSkin(){this.sk.showSkinByName(this.skinArray[this.skinIndex]),++this.skinIndex>=this.skinArray.length&&(this.skinIndex=0)}onDisable(){this.box_sk.off(Laya.Event.READY,this,this.onSkReady)}play(e,i,a,r,s,o,l){if(!this.isReady){console.log("动画未准备好，不能play");return}var c=this.parent.parent;i?(this.sk.play(e,i,a,r,s,o,l),c.beyond&&this.sk.paused()):c.beyond||this.sk.play(e,i,a,r,s,o,l)}paused(){this.isReady&&(this.sk?this.sk.paused():console.log("动画: paused, sk is null"))}resume(){this.isReady&&(this.sk?this.sk.resume():console.log("动画: resume, sk is null"))}};Sb=h([cM("kS5K53GHRWOdgfXoo6VH1A")],Sb);var Db=class extends Laya.Box{};var nTe={9001:"0x3f76562685E9Cd18ba88C062bBC5999D78275734",56:"0x837656c3f5858692cCdce13BA66e09d2685073df",97:"0x6f4DceCEe81bfB85872BEaBC44C303b7c2f6c108"},rTe={9001:"0x96397347Ea2beE29713Bc48749eB277D6A36A407",56:"0x837656c3f5858692cCdce13BA66e09d2685073df",97:"0x6f4DceCEe81bfB85872BEaBC44C303b7c2f6c108"},sTe={9001:"0x67Dc36C19835Fa65Bf4B100FAC9a80A9E9280fB9",56:"0x55d398326f99059ff775485246999027b3197955",97:"0x44004827f2F72566E12884A38f63f72F2a5143ea"},oTe={9001:"0x67Dc36C19835Fa65Bf4B100FAC9a80A9E9280fB9"},lTe={9001:"0x67Dc36C19835Fa65Bf4B100FAC9a80A9E9280fB9"},cTe={9001:"0x2418F7F0486deBc9270E16126F36526925EDAAE4"},uTe={97:"0xa2f97A458c62f321f9565f03289f30BF4E0377Ab",9001:"0x84d225321122E69406B198e3A9B82Dc1BdF897e6"},mTe={9001:"0x945103b2fEa1EAc6cea4d25e9BBaA5284d128b29"},pTe={97:"0xfe261946218873F6eaec714BF757493256817534",9001:"0xfB51603B7863267a19736B070Bf9Cb2e5Fa256AF"},hTe={9001:"0xa2f97A458c62f321f9565f03289f30BF4E0377Ab"},wc={5611:"0x6B2a7485a342726F4E3968683111a539B160566D"},aw={[od.OpBNB]:"0x6536C561934B0dbC76757274dFf3e2dA723d61b6"},Tc={97:"0xfe261946218873F6eaec714BF757493256817534",9001:"0xE3a61771Ce3CA772D446e687AFd52DC28eC9cCb8",5611:"0x552a9558723d2B44B65237D4d52306442ac4Cf93"},nw={[od.OpBNB]:"0x5ee3dc2e3Fe6570deB69266f5e6b62647D72288D"};var Ab=class{constructor(){this.pool_contract=null;this.rewardTokenAddress=""}stakeTokenAndReward(){return this.heroesId?[[this.heroesId,this.capacity/24]]:[]}async calcCapacity(t){for(let e of t){let i=ze.instance.heroOutputRateDic.get(e.mineralLevel);e.staking_second_rewards=i.capacity*this.baseYield/24+""}return t}async earnedAll(){return this.yieldValue}async refreshVo(){let t=await v.requestPost("cybertron-sys-api/api/v1/mineral/getMineralPool",{mineralId:this.id});this.heroesId=0,this.yieldValue=0,Object.assign(this,t)}async stake(t){if(!await F.instance.checkHeroIsBuzy(t))return de.instance.showLoading(!0),await this.pool_contract.methods.stake(t,this.id).send({from:F.instance.walletAddress},(i,a)=>{if(i)return de.instance.hideLoading(),!1}),!0}async withdrawAllAndClaim(){return de.instance.showLoading(!0),await this.pool_contract.methods.withdraw(this.heroesId).send({from:F.instance.walletAddress},(t,e)=>{if(t)return de.instance.hideLoading(),!1}),await this.refreshVo(),!0}async claimAllReward(){de.instance.showLoading(!0),await v.requestPost("cybertron-sys-api/api/v1/mineral/collect",{mineralId:this.id}),await this.refreshVo(),de.instance.hideLoading()}async getAccountTokens(){await this.refreshVo()}};var Cc=class n{constructor(){this.poolAry=[];this.pool_contract=null}static get instance(){return n._instance||(n._instance=new n),n._instance}init(){this.poolDic=new le}async initPoolList(){this.poolAry=[];let t=await v.requestPost("cybertron-sys-api/api/v1/mineral/getMineralPoolList",{});for(let e of t){let i=new Ab;Object.assign(i,e);let a=_.intance.m_dicItems.get(i.resourcesType);i.rewardTokenAddress=a.tokenId,i.pool_contract=this.pool_contract,this.poolDic.set(i.rewardTokenAddress,i),this.poolAry.push(i)}}async getHeroTokenIds(){let t=F.instance.walletAddress;try{console.log("getHeroTokenIds, account:"+t);var e;let a;z.vType==2?(e=qi.id,a=aw[e]):z.vType==1?(e=Wi.id,a=wc[e]):(e=Wi.id,a=wc[e]);let r=await F.instance.walletClient.getChainId();if(e!==r){var i=await F.instance.switchChain(e);if(!i){await F.instance.addChain(e),await F.instance.resetPublicAndWallet(e);let o=await F.instance.walletClient.getChainId();if(e!==o)return this.onEndHeroList(),console.log("切换失败，请手动切换"),null}}else await F.instance.resetPublicAndWallet(e);return a?(console.log("publicClient",F.instance.publicClient),await F.instance.publicClient.readContract({address:a,abi:J.HERO_LIST_ABI,functionName:"list",args:[t]})):(this.onEndHeroList(),E.instance.notice(m.instance.getLanguage(1219,r)),null)}catch(a){if(console.log("获取英雄列表错误====》",a),a instanceof Error){let r=a.message;console.log("获取英雄列表 错误====》",r)}}}async transferHero(t,e){de.instance.showLoadingByInfo(m.instance.getLanguage(1119));try{var i;let l;z.vType==2?(i=qi.id,l=nw[i]):z.vType==1?(i=Wi.id,l=Tc[i]):(i=Wi.id,l=Tc[i]);let c=await F.instance.walletClient.getChainId();if(i!==c){var a=await F.instance.switchChain(i);if(!a){this.onEndHeroList(),console.log("切换失败，请手动切换");return}}if(!l)return this.onEndHeroList(),E.instance.notice(m.instance.getLanguage(1220,c)),!1;if(console.log("判断授权 transferHeroAddress: "+l+", acceptAddress:"+t+", chainIDData:"+i),!await this.setApprovalForAll(l))return console.log("未授权"),this.onEndHeroList(),E.instance.notice(m.instance.getLanguage(15)),!1;console.log("授权成功 开始购买");var r=await F.instance.walletClient.writeContract({account:F.instance.walletAddress,address:l,abi:J.TRANSFER_HERO_ABI,functionName:"batchTransfer",args:[t,e]});console.log("============"+r);let p=await F.instance.publicClient.waitForTransactionReceipt({hash:r});return console.log(`Tx with hash: ${r}`,p),p&&p.status=="success"?(this.delHero(e),this.waitGetHero(i,r),console.log(`Tx successful with hash: ${r}`),r):(this.onEndHeroList(),Le.TransactionErrorTip(),!1)}catch(l){this.onEndHeroList();var s=l.shortMessage;if(s&&s.indexOf("does not match")!=-1){var o=F.instance.getChainName(i);s=m.instance.getLanguage(1172,o)}if(console.log(s),E.instance.notice(s),l instanceof K){let c=l.walk(u=>u instanceof vt);if(c instanceof vt){let u=c.data?.errorName??"";console.log("============errorName: "+u)}}return null}}async setApprovalForAll(t){let e=F.instance.walletAddress;try{console.log("查看是否已经授权, owner:"+e+", spender:"+t);let a;var i;z.vType==2?(i=qi.id,a=nw[i]):z.vType==1?(i=Wi.id,a=Tc[i]):(i=Wi.id,a=Tc[i]);let r;z.vType==2?(i=qi.id,r=aw[i]):z.vType==1?(i=Wi.id,r=wc[i]):(i=qi.id,r=wc[i]);let s=await F.instance.publicClient.readContract({address:r,abi:J.HERO_LIST_ABI,functionName:"isApprovedForAll",args:[e,a]});if(console.log("allowance",s),s)return!0;{console.log("未授权，进行授权, owner:"+e);let o=await F.instance.walletClient.writeContract({address:r,abi:J.HERO_LIST_ABI,functionName:"setApprovalForAll",args:[t,!0],account:e});console.log("============"+o);let l=await F.instance.publicClient.waitForTransactionReceipt({hash:o});return console.log(`setApprovalForAll with hash: ${o}`,l),l&&l.status=="success"?(console.log(`setApprovalForAll successful with hash: ${o}`),!0):!1}}catch(a){if(console.log("授权错误====》",a),a instanceof Error){let r=a.message;console.log("授权错误====》",r)}}}onEndHeroList(t=null){de.instance.hideLoading(),t&&g.intance.event(f.EVENT_END_HEROTRANSFER,[t])}waitGetHero(t,e){this.chainId=t,this.hashId=e,Laya.timer.loop(2e3,this,this.getHero)}delHero(t=null){var e=v.requestPost("wxgame/mutiNft/delHero",{heroList:t}).catch(i=>{})}async getHero(){var t=await v.requestPost("wxgame/mutiNft/check",{chainId:this.chainId,hashId:this.hashId}).catch(e=>{});t&&t.heroList&&t.heroList.length>0&&(Laya.timer.clear(this,this.getHero),this.onNewAddHero(t.heroList))}onNewAddHero(t){b.instance.m_heroData.herosDataRemoveHandler(t),this.onEndHeroList(t)}};var kb=class extends Laya.Dialog{};var{regClass:uM}=Laya,on=class extends kb{constructor(){super(...arguments);this.m_strName="我是OpenSceneRuntime";this.m_iLayerType=C.M_PANEL;this.m_iPositionType=C.CENTER;this.myHeroesNum=0;this.selectedNum=0}onEnable(){this.btn_back.on(Laya.Event.CLICK,this,this.onBack),this.btn_readClipboard.disabled=!navigator.clipboard,this.btn_readClipboard.on(Laya.Event.CLICK,this,this.readClipboard),this.btn_transferRecords.on(Laya.Event.CLICK,this,this.onShowTransferRecord),this.btn_approve.on(Laya.Event.CLICK,this,this.onTransferHero),this.btn_checkBox.on(Laya.Event.CLICK,this,this.onSelectAll),g.intance.on(f.EVENT_END_HEROTRANSFER,this,this.onEndHeroTransfer),g.intance.on(f.EVENT_REFRESH_HEROTRANSFER,this,this.onRefreshHeroTransfer),this.list_hero.array=[]}async readClipboard(){navigator.clipboard?navigator.clipboard.readText().then(e=>{console.log("剪切板中的文本内容:",e),this.input_acceptAddress.text=e}).catch(e=>{console.error("无法读取剪切板内容:",e)}):console.error("当前浏览器不支持 Clipboard API")}onOpened(e){this.getHeroTokenIds()}async getHeroTokenIds(){var e=await Cc.instance.getHeroTokenIds();console.log("获得链上英雄ID heroTokenIds: ",e),this.heroVos=[],e&&e.length>0&&e.forEach(i=>{i=parseInt(i);var a=b.instance.m_heroData.getCanTransferHero(i);a&&this.heroVos.push(a)}),this.list_hero.array=this.heroVos,this.updateNum()}onEndHeroTransfer(e){this.heroVos=this.heroVos.filter(i=>!e.includes(i.pk)),this.list_hero.array=this.heroVos,this.updateNum()}onRefreshHeroTransfer(){this.list_hero.refresh(),this.updateNum()}updateNum(){!this.heroVos||this.heroVos.length<=0?this.noDataBox.visible=!0:this.noDataBox.visible=!1,this.selectedNum=0,this.heroVos.forEach(e=>{e&&e.checked&&this.selectedNum++}),on.chooseNum=this.selectedNum,this.myHeroesNum=this.heroVos.length,this.tf_myHeroesNum.text=m.instance.getLanguage(1222,this.heroVos.length),this.tf_selectedNum.text=m.instance.getLanguage(1223,this.selectedNum)}onSelectAll(){var e=this.btn_checkBox.selected;let i=0;e&&this.heroVos.forEach(a=>{a&&(a.checked=!1)}),this.heroVos.forEach(a=>{i+=1,i<101&&a&&(a.checked=e)}),this.list_hero.refresh(),this.updateNum()}onBack(){this.close()}async onTransferHero(){var e=this.input_acceptAddress.text;if(e==""){E.instance.notice(m.instance.getUILang("PLEASE ENTER THE ACCEPT ADDRESS"));return}var i=[];this.heroVos.forEach(a=>{a.checked&&i.push(a.pk)}),i.length>0?await Cc.instance.transferHero(e,i):E.instance.notice(m.instance.getLanguage(1218))}onShowTransferRecord(){A.intance.openModule(y.TransferRecordDialog)}onDisable(){this.removeEvent()}removeEvent(){g.intance.off(f.EVENT_END_HEROTRANSFER,this,this.onEndHeroTransfer),g.intance.off(f.EVENT_REFRESH_HEROTRANSFER,this,this.onRefreshHeroTransfer)}};on.chooseNum=0,on=h([uM("rERE5ZadTfqASnxDrsNtyw")],on);var{regClass:mM}=Laya,Bb=class extends Db{constructor(){super();this.isAddEvent=!1}createChildren(){super.createChildren()}addEvent(){this.isAddEvent||(this.on(Laya.Event.CLICK,this,this.toDetail),this.isAddEvent=!0)}set dataSource(e){super.dataSource=e,this.heroVo=e,this.heroVo&&(this.img_checked.visible=this.heroVo.checked,this.heroListItem.needPop=!1,this.heroListItem.dataSource=this.heroVo,this.addEvent())}toDetail(){on.chooseNum>=100&&!this.heroVo.checked||(this.heroVo.checked=!this.heroVo.checked),g.intance.event(f.EVENT_REFRESH_HEROTRANSFER)}};Bb=h([mM("tzBcfqNYSL6KP4NjtslyHA")],Bb);var Mb=class extends Laya.Scene{};var{regClass:pM}=Laya,Rb=class extends Mb{constructor(){super(...arguments);this.currTab=0;this.type=1;this.items=[];this.hasItem=!1}onAwake(){this.m_iLayerType=C.M_POP,this.m_iPositionType=C.UP}onOpened(e){this.type=e}onEnable(){this.list_hero.vScrollBarSkin="",this.btn_back&&this.btn_back.on(Laya.Event.CLICK,this,this.setToMainScene),this.btn_transfer.on(Laya.Event.CLICK,this,this.onTransfer),g.intance.on(ri.UPDATE_HERO_EVENT,this,this.updateHero),this.btn_1.on(Laya.Event.CLICK,this,this.onClickTab,[1]),this.btn_2.on(Laya.Event.CLICK,this,this.onClickTab,[2]),this.initContainer()}initContainer(){this.list_hero.visible=!1,this.list_hero.vScrollBarSkin="",this.createHeadList();let e=b.instance.m_heroData.heroVoDic.values,i=te.filterObjectsByState(e,1),a=te.filterObjectsByState(e,2),r=te.filterObjectsByNewFightFlag(e);this.tf_hireHero.text=`${i.length}`,this.tf_proxyTotal.text=`${a.length}`,this.tf_heroTotal.text=`${r.length}`,console.log(i,a)}updateHero(e){this.type=e+1,this.createHeadList()}async createHeadList(){await Et.instance.ownerHero(!0),!this.destroyed&&(this.type?this.onClickTab(this.type):this.onClickTab(1))}async onClickTab(e){if(this.currTab!=e){if(this.setTab(e),e==1){if(this.destroyed)return;var i=await this.getItemByType(1);i.sort((a,r)=>{if(a===null&&r!==null)return 1;if(a!==null&&r===null)return-1;if(a!==null&&r!==null){if(a.heroItem.quality!==r.heroItem.quality)return r.heroItem.quality-a.heroItem.quality;if(a.heroItem.icon===null&&r.heroItem.icon!==null)return 1;if(a.heroItem.icon!==null&&r.heroItem.icon===null)return-1;if(a.heroItem.icon!==r.heroItem.icon)return a.heroItem.icon<r.heroItem.icon?-1:1}return 0}),this.list_hero.array=i,this.list_hero.visible=!0,this.btn_transfer.visible=!0}else{if(this.list_hero.visible=!0,this.destroyed)return;var i=await this.getItemByType(2);i.sort((r,s)=>{if(r===null&&s!==null)return 1;if(r!==null&&s===null)return-1;if(r!==null&&s!==null){if(r.heroItem.quality!==s.heroItem.quality)return s.heroItem.quality-r.heroItem.quality;if(r.heroItem.icon===null&&s.heroItem.icon!==null)return 1;if(r.heroItem.icon!==null&&s.heroItem.icon===null)return-1;if(r.heroItem.icon!==s.heroItem.icon)return r.heroItem.icon<s.heroItem.icon?-1:1}return 0}),this.list_hero.dataSource=i,this.btn_transfer.visible=!1}this.list_hero.selectedIndex=-1,this.hasItem&&(this.list_hero.selectedIndex=0)}}async getItemByType(e){var i=e==1?Je.TYPE_Professional:Je.TYPE_Training;this.items=[],this.hasItem=!1;let a=b.instance.m_heroData.getListByType(i);for(var r=a.length>10?a.length:10,s=0;s<r;s++){var o=a[s];o?(s==0&&(this.hasItem=!0),this.items.push(o)):this.items.push(null)}return this.items}setTab(e){for(let i=1;i<3;i++)e==i?(this["btn_"+i].getChildByName("selectBox").visible=!0,this["btn_"+i].getChildByName("tf_txt").color="#143f6b"):(this["btn_"+i].getChildByName("selectBox").visible=!1,this["btn_"+i].getChildByName("tf_txt").color="#7ff1fe")}setToMainScene(){oe.intance.setCurrentScene(Y.M_SCENE_MAIN)}onTransfer(){A.intance.openModule(y.HeroTransferView)}onDisable(){g.intance.off(ri.UPDATE_HERO_EVENT,this,this.updateHero)}};Rb=h([pM("eEFn-xcRTXagUEZFDdSujw")],Rb);var Pb=class extends Laya.Box{};var{regClass:hM}=Laya,Nb=class extends Pb{set dataSource(t){super.dataSource=t;var e=t;if(!e)return;let a=_.intance.getAttributeDataById(e[0]).identification;this.tf_name.text=a,this.tf_num.text=`+${e[1]}`}};Nb=h([hM("NAU4mWDMR0mrfUY9FO6URw")],Nb);var Ob=class extends Laya.Box{};var{regClass:dM}=Laya,Hb=class extends Ob{set dataSource(t){super.dataSource=t;var e=t;e&&(this.tf_name.text=m.instance.getUILang(e[1]),this.tf_num.text=e[2])}};Hb=h([dM("BFrnzfZDRh2v3vDKqrNVwA")],Hb);var Ub=class extends Laya.Box{};var{regClass:fM}=Laya,Vb=class extends Ub{constructor(){super();this.isBig=!1;this.isAddEvent=!1}set dataSource(e){super.dataSource=e,this.skillItem=e,this.skillItem&&(this.txt_num.text="",this.img_icon.skin=S.instance.getSkillIcon(this.skillItem.icon,this.isBig))}};Vb=h([fM("qJVd2M3_Td-5eIx8PsQpAw")],Vb);var Fb=class extends Laya.Box{};var{regClass:yM}=Laya,Gb=class extends Fb{constructor(){super();this.isAddEvent=!1}createChildren(){super.createChildren()}addEvent(){this.isAddEvent||(this.on(Laya.Event.CLICK,this,this.toDetail),this.isAddEvent=!0)}set dataSource(e){super.dataSource=e,this.skillItem=e,this.skillItem&&(this.addEvent(),this.setCurrentOutPut())}async setCurrentOutPut(){this.skillItem&&(this.skillIconItem.dataSource=this.skillItem)}toDetail(){this.skillItem&&A.intance.openModule(y.SkillTipDialog,this.skillItem)}};Gb=h([yM("VRh1GpjHSyqm75euC37ZKw")],Gb);var Kb=class extends Laya.Dialog{};var{regClass:bM}=Laya,qb=class extends Kb{constructor(){super(...arguments);this.m_strName="我是OpenSceneRuntime";this.m_iLayerType=C.M_POP;this.m_iPositionType=C.CENTER}setOpenData(e){e&&(this.skillItem=e)}onEnable(){this.item.dataSource=this.skillItem,this.tf_name.text=m.instance.getLanguage(this.skillItem.name);var e=[["type","S_type",m.instance.getLanguage(this.skillItem.name)],["distance","S_distance",this.skillItem.distance],["hurt","S_hurt",this.skillItem.hurt/100+"%"],["cd","S_cd",this.skillItem.cd/1e3+m.instance.getUILang("S_S")],["displacement","S_displacement",this.skillItem.displacement],["targetsType","S_targetsType",m.instance.getUILang("S_targetsType"+this.skillItem.targetsType)]];this.list_skillAttrs.array=e}removeEvent(){}};qb=h([bM("PiBuXnP8ToeveVbB_bfhUQ")],qb);var Wb=class extends Laya.Box{};var{regClass:gM}=Laya,Yb=class extends Wb{constructor(){super();this.isBig=!1;this.isAddEvent=!1}set dataSource(e){super.dataSource=e,e&&(this.img_icon.skin=`gameIcon/hero/heroDetail/img_hero_state_${e}.png`)}};Yb=h([gM("kgETBhusT2WQRM1T39-4EA")],Yb);var zb=class extends Laya.Dialog{};var{regClass:LM}=Laya,jb=class extends zb{constructor(){super()}onOpened(t){this.list_record.array=[],this.onGetList()}async onGetList(){var t=await v.requestPost("wxgame/mutiNft/record",{});t&&t.record?(this.list_record.array=t.record,!t.record||t.record.length<=0?this.noDataBox.visible=!0:this.noDataBox.visible=!1):E.instance.notice(m.instance.getLanguage(135))}};jb=h([LM("nkhiH9TpSY6e2tWJ07b86g")],jb);var $b=class extends Laya.Box{};var{regClass:_M}=Laya,Xb=class extends $b{constructor(){super(...arguments);this.isAddEvent=!1}addEvent(){this.isAddEvent||(this.btn_copy.on(Laya.Event.CLICK,this,this.onCopy),this.isAddEvent=!0)}onCopy(){let e=this.heroTransferDto.toAddress;doCopy(e),E.instance.notice(m.instance.getLanguage(132))}set dataSource(e){super.dataSource=e,this.heroTransferDto=e,this.heroTransferDto&&(this.addEvent(),this.setCurrentOutPut())}setCurrentOutPut(){if(this.tf_createDate.text=se.formatTimeStamp(this.heroTransferDto.createTime,"YY-MT-DD HH:MM"),this.tf_tokenId.text=this.heroTransferDto.nftId,this.tf_from.text=Me.abbreviateString(this.heroTransferDto.fromAddress,18),this.tf_to.text=Me.abbreviateString(this.heroTransferDto.toAddress,18),this.heroTransferDto.id>0){var e=new Ht;e.id=this.heroTransferDto.id,e.lv=this.heroTransferDto.lv,e.color=this.heroTransferDto.color,this.heroListItem.needPop=!1,this.heroListItem.dataSource=e}}};Xb=h([_M("STy30_L-RjafQhbdmoDLDw")],Xb);var Qb=class extends Laya.Dialog{};var{regClass:vM}=Laya,Jb=class extends Qb{constructor(e){super();this.m_strName="我是OpenSceneRuntime";this.m_iLayerType=C.M_POP;this.m_iPositionType=C.CENTER;this.checkIndex=1}onEnable(){this.initContainer()}initContainer(){this.check_coin1.on(Laya.Event.CLICK,this,this.onCheck,[1]),this.check_coin2.on(Laya.Event.CLICK,this,this.onCheck,[2]),this.check_coin3.on(Laya.Event.CLICK,this,this.onCheck,[3]),this.check_coin4.on(Laya.Event.CLICK,this,this.onCheck,[4]),this.btn_join.on(Laya.Event.CLICK,this,this.onBuy),this.btn_record.on(Laya.Event.CLICK,this,this.onRecord),this.buyCode.on(Laya.Event.INPUT,this,this.onRechargeCodeInput),this.buyCode.on(Laya.Event.BLUR,this,this.testRechargeCodeInput),this.tf_address.text=`${F.instance.walletAddress}`,this.checkChain(),this.onCheck(1)}async checkChain(){let e=await F.instance.walletClient.getChainId(),i=z.vType==2?Ki.id:Ra.id;e==i?this.getRest():await F.instance.switchChain(i)&&this.getRest()}async getRest(){let e=await F.instance.getIgoUSD(),i=await F.instance.getBalance2(e),r=Dt(i,18);this.tf_rest.text=`${te.truncateToTwoDecimalPlaces(Number(r))}`,console.log(i)}onRechargeCodeInput(){let e=Number(this.buyCode.text),i=te.isNumber(this.buyCode.text);(e<0||!i)&&(this.buyCode.text="0")}testRechargeCodeInput(){let e=Number(this.buyCode.text);this.buyCode.text=`${te.formatNumber(e)}`}onCheck(e){this.checkIndex=e;for(let i=1;i<5;i++){let a=this["check_coin"+i];a&&(e==i?a.selected=!0:a.selected=!1)}}async onBuy(){let e=0;switch(this.checkIndex){case 1:e=1e4;break;case 2:e=5e3;break;case 3:e=2e3;break;case 4:e=Number(this.buyCode.text);break}let i=await F.instance.getRechargedIgoUSD(),a=await F.instance.getAllRechargedMoney(),s=Number(Dt(a,18)),o=z.vType==2?Ki.id:Ra.id,l=await F.instance.walletClient.getChainId(),c=await F.instance.getIgoLimitTime(),u=new Date().getTime();if(l!==o){await F.instance.switchChain(o)&&this.getRest();return}else if(Number(c)*1e3<=u)E.instance.notice(m.instance.getLanguage(1636));else if(i<=0&&e<100){E.instance.notice(m.instance.getLanguage(1637));return}else if(+(s<e)){E.instance.notice(m.instance.getLanguage(1638));return}else if(Number(this.tf_rest.text)<e){E.instance.notice(m.instance.getLanguage(1639));return}else if(this.passCode.text!=="fodc888"){E.instance.notice(m.instance.getLanguage(1640));return}else{let p=await F.instance.getIgoUSD(),d=z.vType==2?Ki.id:Ra.id;await F.instance.rechargeIgoUSD(e,d,p)&&(E.instance.notice(m.instance.getLanguage(1641)),this.getRest())}}onRecord(){A.intance.openModule(y.IgoRecordDialog)}onDisable(){this.check_coin1.off(Laya.Event.CLICK,this,this.onCheck),this.check_coin2.off(Laya.Event.CLICK,this,this.onCheck),this.check_coin3.off(Laya.Event.CLICK,this,this.onCheck),this.check_coin4.off(Laya.Event.CLICK,this,this.onCheck),this.btn_join.off(Laya.Event.CLICK,this,this.onBuy),this.btn_record.off(Laya.Event.CLICK,this,this.onRecord),this.buyCode.off(Laya.Event.INPUT,this,this.onRechargeCodeInput),this.buyCode.off(Laya.Event.BLUR,this,this.testRechargeCodeInput)}};Jb=h([vM("vvPDCXWeRSidA4q06p09sA")],Jb);var Zb=class extends Laya.Scene{};var{regClass:xM}=Laya,eg=class extends Zb{constructor(){super(...arguments);this.isDown=!1}onAwake(){}onOpened(e){}onEnable(){this.btn_back&&this.btn_back.on(Laya.Event.CLICK,this,this.setToMainScene),this.btn_join.on(Laya.Event.CLICK,this,this.onJoin),this.btn_register.on(Laya.Event.CLICK,this,this.onPreResign),this.initPage(),this.refreshJoinBtnRed(),this.refreshTime(),Laya.timer.loop(1e3,this,this.refreshTime)}initPage(){let e=Laya.LocalStorage.getItem(z.COOKIE_CF_LAN),i=e=="zh"?"res/igoPage/img_com_bj1.jpg":"res/igoPage/img_com_bj4.jpg",a=e=="zh"?"res/igoPage/img_com_bj2.jpg":"res/igoPage/img_com_bj5.jpg",r=e=="zh"?"res/igoPage/img_com_bj3.jpg":"res/igoPage/img_com_bj6.jpg";this.img_bg1.skin=i,this.img_bg2.skin=a,this.img_bg3.skin=r;let s=e=="zh"?"res/igoPage/img_com_anniu3.png":"res/igoPage/img_com_anniu2.png",o=e=="zh"?"res/igoPage/img_com_anniu4.png":"res/igoPage/img_com_anniu.png";Laya.timer.once(500,this,()=>{this.btn_join.skin=s,this.btn_register.skin=o}),e=="zh"?(this.tf_mon.y=this.tf_day.y=this.tf_hour.y=this.tf_min.y=this.tf_secs.y=4330,this.btn_register.y=4830):(this.tf_mon.y=this.tf_day.y=this.tf_hour.y=this.tf_min.y=this.tf_secs.y=4380,this.btn_register.y=4851),this.pageBox.scrollRect=new Laya.Rectangle(0,0,2e3,Laya.stage.height);var l=0;console.log("this.pageBox.scrollRect.y",this.pageBox.scrollRect.y);let c=this;this.pageBox.on(Laya.Event.MOUSE_DOWN,this,function(){c.isDown=!0,l=c.pageBox.mouseY}),this.pageBox.on(Laya.Event.MOUSE_UP,this,function(){c.isDown=!1}),this.pageBox.on(Laya.Event.MOUSE_MOVE,this,function(){if(c.isDown){var u=c.pageBox.mouseY-l;l=c.pageBox.mouseY;var p=c.pageBox.scrollRect.y-u;p<0?p=0:p>c.longBox.height-Laya.stage.height&&(p=c.longBox.height-Laya.stage.height),c.pageBox.scrollRect.y=p}})}onDisable(){this.closeHandle&&this.closeHandle.run(),this.removeEvent()}refreshJoinBtnRed(){this.img_red&&(this.img_red.visible=b.instance.getRedDotById(he.RED_IGO))}removeEvent(){Laya.timer.clear(this,this.refreshTime),this.btn_back.off(Laya.Event.CLICK,this,this.setToMainScene),this.btn_join.off(Laya.Event.CLICK,this,this.onJoin),this.btn_register.off(Laya.Event.CLICK,this,this.onPreResign)}setToMainScene(){oe.intance.setCurrentScene(Y.M_SCENE_MAIN)}refreshTime(){let e=new Date(2024,10,1,0,0,0),i=Math.floor(e.getTime()/1e3),a=se.getTimeDifference(i);a&&(this.tf_mon.text=`${a.months}`,this.tf_day.text=`${a.days}`,this.tf_hour.text=`${a.hours}`,this.tf_min.text=`${a.minutes}`,this.tf_secs.text=`${a.seconds}`)}async onJoin(){await v.requestPost("wxgame/sys/redPointClear",{type:he.RED_IGO}),A.intance.openModule(y.IgoJoinDialog),this.img_red.visible=!1}onPreResign(){E.instance.notice(m.instance.getLanguage(12))}};eg=h([xM("b4l4liAxTZSR9wvhcYm1kw")],eg);var tg=class extends Laya.Dialog{};var{regClass:IM}=Laya,ig=class extends tg{constructor(e){super();this.m_strName="我是OpenSceneRuntime";this.m_iLayerType=C.M_POP;this.m_iPositionType=C.CENTER}onEnable(){this.btn_sure.on(Laya.Event.CLICK,this,this.onSure),this.initContainer()}async initContainer(){let e=await F.instance.getIgoRecord();this.list_record.array=e;let i=await F.instance.getMyAllRechargedMoney(),r=Number(Dt(i,18));this.tf_all.text=`${r}`,console.log("records",e);let s=0;r<2e3&&r>=100?s=25:r<5e3&&r>=2e3?s=35:r<1e4&&r>=5e3?s=40:r>=1e4&&(s=50),this.tf_rate.text=`${s}%`}onSure(){this.close()}onDisable(){this.btn_sure.off(Laya.Event.CLICK,this,this.onSure)}};ig=h([IM("8m39UgG6S7mRkF5J0l8ICw")],ig);var ag=class extends Laya.Box{};var{regClass:EM}=Laya,ng=class extends ag{constructor(){super()}createChildren(){super.createChildren()}set dataSource(t){super.dataSource=t,this.setData(t)}setData(t){if(!t)return;this.btn_copy.on(Laya.Event.CLICK,this,this.onClickCopy),this.tf_from.text=`${te.shortenString(F.instance.walletAddress,7,8)}`;let e=t.amount,a=Dt(e,18);this.tf_amount.text=`${te.truncateToTwoDecimalPlaces(Number(a))} USDT`;let r=t.timestamp,s=se.formatDayAndTime(Number(r)*1e3);this.tf_createDate.text=`${s.date}  ${s.time}`}onClickCopy(){doCopy(F.instance.walletAddress),E.instance.notice(m.instance.getLanguage(132))}onDisable(){this.removeEvent()}removeEvent(){this.btn_copy.off(Laya.Event.CLICK,this,this.onClickCopy)}};ng=h([EM("kYsWN9XrQiiZLpBD1NVAEw")],ng);var rg=class extends Laya.Box{};var{regClass:wM}=Laya,sg=class extends rg{constructor(){super();this.showAdd=!1;this.isAddEvent=!1}createChildren(){super.createChildren()}addEvent(){this.isAddEvent||(this.on(Laya.Event.CLICK,this,this.toDetail),this.isAddEvent=!0)}set dataSource(e){super.dataSource=e,this.itemVo=e,this.itemVo&&(this.addEvent(),this.setCurrentOutPut())}async setCurrentOutPut(){if(!this.itemVo)return;let e=this.itemVo.itemItem;if(this.knapsackItem.dataSource=this.itemVo,e?this.disabled=!1:this.disabled=!0,this.img_jiaobiao.visible=!1,this.img_win.visible=!1,this.itemVo.m_iId==ge.TYPE_QUAN_MNT){var i;this.itemVo.prizeStatus&&(this.itemVo.prizeStatus==2?(this.img_win.visible=!0,i=m.instance.getUILang("Won")):this.itemVo.prizeStatus==1&&(i=m.instance.getUILang("No Won"))),this.itemVo.chainStatus==1?(this.img_jiaobiao.visible=!0,this.img_jiaobiao.skin="res/item/img_chainStatus_2.png",i=m.instance.getUILang("On-Chain")):this.itemVo.lateStatus==1?i=m.instance.getUILang("Expired"):(this.img_jiaobiao.visible=!0,this.img_jiaobiao.skin="res/item/img_chainStatus_1.png",i=m.instance.getUILang("Off-Chain"))}}toDetail(){console.log(this.x),!(!this.itemVo||!this.itemVo.needTip)&&(this.itemVo.type===Ge.TYPE_Equipment||this.itemVo.type===Ge.TYPE_CARD)&&g.intance.event(f.SHOW_EQUIP_TIP,{data:this.itemVo,positionX:this.x})}};sg=h([wM("HYoZb6e-RFKj8fjDKbl-7Q")],sg);var og=class extends Laya.Box{};var{regClass:TM}=Laya,lg=class extends og{constructor(){super();this.showAdd=!1;this.isAddEvent=!1}createChildren(){super.createChildren()}addEvent(){this.isAddEvent||(this.on(Laya.Event.CLICK,this,this.toDetail),this.isAddEvent=!0)}set dataSource(e){super.dataSource=e,this.coinItems=e,this.coinItems&&(this.addEvent(),this.setCurrentOutPut())}async setCurrentOutPut(){if(this.coinItems){var e=this.coinItems[0];this.txt_num.text=xe.filterNumFormat(b.instance.getConsumeValue(this.coinItems[0]),this.coinItems[1],!1,!0),this.img_icon.skin=S.instance.getMoneyIcon(this.coinItems[0]),this.img_add.visible=e!=ge.TYPE_GOLD}}toDetail(){var e=this.coinItems[0];!this.coinItems||e==ge.TYPE_GOLD||(console.log(e),Le.onGetMoney(e))}};lg=h([TM("NIAfVcg_S72kTvDQGuZ7vA")],lg);var cg=class extends Laya.Box{};var{regClass:CM}=Laya,ug=class extends cg{set dataSource(t){super.dataSource=t;var e=t;if(!e)return;this.tf_attNum1.text=`+${e[1]}`,this.tf_attNum2.text=`+${e[2]}`;let i=_.intance.getAttributeDataById(e[0]);this.tf_att1.text=i.identification,this.tf_att2.text=i.identification}};ug=h([CM("9sZiQib_QceUIq6wXx7r9w")],ug);var mg=class extends Laya.Dialog{};var{regClass:SM}=Laya,pg=class extends mg{constructor(e){super();this.m_strName="我是OpenSceneRuntime";this.m_iLayerType=C.M_POP;this.m_iPositionType=C.CENTER;this.equipData=null}onEnable(){this.btn_upStar.on(Laya.Event.CLICK,this,this.onRisingStar)}setOpenData(e){e&&(console.log(e),this.initContainer(e))}initContainer(e){if(this.equipData=e,this.equipData){let a=this.equipData.m_iId,r=this.equipData.m_iId+1,s=new Ne(a),o=new Ne(r);this.oldEquip.dataSource=s,this.newEquip.dataSource=o;let l=this.oldEquip.getChildByName("txt_num"),c=this.newEquip.getChildByName("txt_num");l&&(l.visible=!1),c&&(c.visible=!1);let u=_.intance.getEquipDataById(r),p=_.intance.getEquipDataById(a);console.log(u.attribute,p.attribute);let d=p.upStar[1];if(u){this.tf_have.text=`${this.equipData.m_iNum}`;let L=u.attribute;this.tf_need.text=`${d}`,this.equipData.m_iNum>d?this.tf_have.color="#88ff71":this.tf_have.color="#ed4842";let x=_.intance.getEquipSuitDataById(r).skill;if(x){var i=_.intance.m_dicSkills.get(x);this.skillListItem.dataSource=i,this.skillListItem.visible=!0}else this.skillListItem.visible=!1;let w=te.categorizeArrays(p.attribute,u.attribute);this.list_attrs.array=w}}}async onRisingStar(){let e=await v.requestPost("wxgame/equip/star",{bagPk:this.equipData.m_iPk});if(e){g.intance.event(f.EVENT_REFRESH_KNAPSACK,e.bagItem.id);let a=[];var i=new xt;i.id=e.bagItem.id,i.count=1,a.push(i),A.intance.openModule(y.RewardGetDialog,a),this.close()}}onDisable(){}};pg=h([SM("DzwdOKWlRK2iP7OBwMXXoA")],pg);var hg=class extends Laya.Dialog{};var{regClass:DM}=Laya,dg=class extends hg{constructor(e){super();this.m_strName="我是OpenSceneRuntime";this.m_iLayerType=C.M_POP;this.m_iPositionType=C.CENTER}onEnable(){this.initContainer(),Xe.instance.playSoundByName(Xe.soundName32)}initContainer(){var e=ut.instance.getOneItem();if(e){var i;e instanceof Array?(i=new Ne(e[0]),i.newAddCnt=e[1]):i=e,this.showItem(i)}}showItem(e){this.knapsackItem.showAdd=!0,this.knapsackItem.dataSource=e,this.tf_name.text=m.instance.getLanguage(e.itemItem.name)}onDisable(){g.intance.event(f.EVENT_CHECK_REMAIN,y.ItemGetDialog)}};dg=h([DM("tC2uDJDVQMaI41Lys60O5Q")],dg);var fg=class extends Laya.Box{};var{regClass:AM}=Laya,yg=class extends fg{constructor(){super();this.showAdd=!1;this.isAddEvent=!1}addEvent(){this.isAddEvent||(this.isAddEvent=!0)}set dataSource(e){super.dataSource=e,this.itemVo=e,this.itemVo&&(this.addEvent(),this.setCurrentOutPut())}async setCurrentOutPut(){let e=new Ne;if(!this.itemVo)return;this.itemVo.m_iId==ge.TYPE_QUAN_MNT?(this.tf_quanId.visible=!0,this.tf_quanId.text=this.itemVo.m_iPk):this.tf_quanId.visible=!1;let i=this.itemVo.itemItem;A.intance.hasOpenView(y.PveChoosePropsDialog)&&(this.txt_num.visible=!1),i?(this.showAdd?this.txt_num.text=""+xe.formatNumber(this.itemVo.newAddCnt,8):this.itemVo.m_iNum?this.txt_num.text=""+xe.formatNumber(this.itemVo.m_iNum,8):this.txt_num.text=""+xe.formatNumber(this.itemVo.newAddCnt,8),this.img_icon.skin=S.instance.getItemIcon(i.icon),this.img_box.skin="gameIcon/items/itemBg/img_"+i.quality+".png"):(this.txt_num.text="",this.img_icon.skin=null,this.img_box.skin="gameIcon/items/itemBg/img_0.png"),this.tf_isSch.visible=this.itemVo.isScholarship}toDetail(){!this.itemVo||!this.itemVo.needTip||(this.itemVo.type===Ge.TYPE_Equipment?A.intance.openModule(y.EquipDetailDialog,this.itemVo):A.intance.openModule(y.KnapsackTipDialog,this.itemVo))}};yg=h([AM("LzxJYKybT_m3CJav3RyDmg")],yg);var bg=class extends Laya.Scene{};var{regClass:kM}=Laya,gg=class extends bg{constructor(){super(...arguments);this.subBagInfo=null;this.subType=null;this.selectId=null;this.currTab=0;this.quanTabIndex=7;this.totalSubTab=4;this.needRefresh=!1;this.type=1;this.totalTab=8;this.items=[];this.hasItem=!1;this.nftTabIndex=1}onAwake(){this.m_iLayerType=C.M_POP,this.m_iPositionType=C.UP,this.listPanel1.visible=!1}onOpened(e){e&&e[0]&&(this.type=e[0]||1,this.subType=e[1]),this.initLuckDrawView()}onEnable(){this.nomalY=this.list_btn.y,g.intance.on(f.EVENT_REFRESH_KNAPSACK,this,this.onRefreshKnapsack),g.intance.on(f.EVENT_REFRESH_QUAN_STATUS,this,this.onRefreshQuan);for(let i=1;i<this.totalTab;i++)this["btn_"+i].on(Laya.Event.CLICK,this,this.onClickTab,[i]);for(let i=1;i<=this.totalSubTab;i++)this["tab_nft_"+i].on(Laya.Event.CLICK,this,this.onNftTabClick,[i]);this.btn_back&&this.btn_back.on(Laya.Event.CLICK,this,this.setToMainScene),this.listPanel1.vScrollBarSkin="",this.listPanel1.selectHandler=Laya.Handler.create(this,this.onSelectItem,null,!1),this.box_show.visible=!1,this.box_2.visible=!1;let e=(Laya.stage.height-z.DESIGN_HEIGHT)/2}setTab(e){for(let i=1;i<this.totalTab;i++)e==i?(this["btn_"+i].getChildByName("selectBox").visible=!0,this["btn_"+i].getChildByName("tf_txt").color="#143f6b"):(this["btn_"+i].getChildByName("selectBox").visible=!1,this["btn_"+i].getChildByName("tf_txt").color="#7ff1fe")}async initLuckDrawView(){await Et.instance.ownerBag(),!this.destroyed&&(this.type?this.onClickTab(this.type):this.onClickTab(1))}async onClickTab(e){if(!(!this.needRefresh&&this.currTab==e)&&(this.setTab(e),this.type=e,this.box_2.visible=!0,!this.destroyed))if(e==this.quanTabIndex)this.onNftTabClick(1);else{var i=await this.getItemByType(e);this.onSetData(i)}}async onSetData(e){if(this.listPanel1.array=e,this.listPanel1.visible=!0,this.selectId!==null){let i=this.getIndexById(e);this.listPanel1.selectedIndex=i,this.selectId=null}else this.listPanel1.selectedIndex=-1,this.hasItem&&(this.listPanel1.selectedIndex=0)}async getItemByType(e,i=1){this.items=[],this.hasItem=!1;var a;if(e==this.quanTabIndex){if(this.hengTabBox.visible=!0,a=await b.instance.m_packageData.getQuan(i),this.nftTabIndex!=i)return}else this.hengTabBox.visible=!1,a=b.instance.m_packageData.getBackByType(e);if(e==2){if(!this.subBagInfo){let u=(await v.requestPost("wxgame/lease/bag",{})).list,p={};for(let d of u)d.ticketId in p?p[d.ticketId]+=d.ticketCount:p[d.ticketId]=d.ticketCount;this.subBagInfo=Object.keys(p).map(d=>({ticketId:d,ticketCount:p[d]}))}if(this.subBagInfo)for(let c=0;c<this.subBagInfo.length;c++){let u=this.subBagInfo[c];if(u.ticketCount){var r=new Ne(u.ticketId);r.newAddCnt=u.ticketCount,r.isScholarship=!0,console.log(r),a.push(r)}}console.log(this.subBagInfo)}this.subType!==null&&e==5&&(a=a.filter(c=>c.subType==this.subType));for(var s=a.length>30?a.length:30,o=0;o<s;o++){var l=a[o];l?(o==0&&(this.hasItem=!0),this.items.push(l)):this.items.push(new Ne(0))}return this.items}getIndexById(e){return e.findIndex(a=>a.m_iId==this.selectId)||0}onSelectItem(e,i){if(this.itemVo=this.items[e],this.tf_des.visible=!1,this.tf_des2.visible=!1,console.log(this.itemVo),this.itemVo){let l=this.itemVo.itemItem;if(!l)return;if(this.img_icon.skin=S.instance.getItemIcon(l.icon),this.tf_name.text=m.instance.getLanguage(l.name),this.itemVo.m_iId==ge.TYPE_QUAN_MNT){this.tf_quanId.visible=!0,this.tf_expTime.visible=!0,this.tf_quanId.text=this.itemVo.m_iPk,this.tf_expTime.text=m.instance.getLanguage(1802)+": "+se.formatTimeStamp(this.itemVo.expTime);var a;this.itemVo.prizeStatus?this.itemVo.prizeStatus==2?a=m.instance.getUILang("Won"):this.itemVo.prizeStatus==1&&(a=m.instance.getUILang("No Won")):this.itemVo.chainStatus==1?a=m.instance.getUILang("On-Chain"):this.itemVo.lateStatus==1?a=m.instance.getUILang("Expired"):a=m.instance.getUILang("Off-Chain"),this.tf_status.text=a,this.tf_status.visible=!0}else this.tf_expTime.visible=!1,this.tf_quanId.visible=!1,this.tf_status.visible=!1;if(l.type==Ge.TYPE_Equipment){this.img_att.visible=!0,this.tf_des.text="",this.box_show.visible=!1,this.box_show2.visible=!0,this.tf_name2.text=m.instance.getLanguage(l.name),this.knapsackItem.dataSource=this.itemVo;let c=this.itemVo.itemItem.id;this.tf_name2.color=Ct.qualityColors[l.quality-1],this.tf_grade.color=Ct.qualityColors[this.itemVo.itemItem.quality-1],this.tf_grade.text=m.instance.getUILang(`Quality_${this.itemVo.itemItem.quality}:`);let u=_.intance.getEquipDataById(c);if(u){this.tf_part.text=m.instance.getUILang(`Part_${u.type}:`);let p=u.attribute;this.list_attrs.array=p;let d=_.intance.getEquipSuitDataById(c);if(d&&d.skill){let L=d.skill;var r=_.intance.m_dicSkills.get(L);this.skillListItem.dataSource=r,this.skillListItem.visible=!0,this.img_skill.visible=!0}else this.skillListItem.visible=!1,this.img_skill.visible=!1}this.list_btn.y=this.nomalY+50}else if(l.type==Ge.TYPE_CARD){this.img_skill.visible=!0,this.img_att.visible=!1,this.tf_des2.visible=!0;let u=_.intance.getArrFromDicItemByKey("id",l.id)[0];this.box_show.visible=!1,this.box_show2.visible=!0,this.tf_des2.text=m.instance.getLanguage(u.des),this.tf_name2.text=m.instance.getLanguage(l.name),this.tf_name2.color=Ct.qualityColors[l.quality-1],this.knapsackItem.dataSource=this.itemVo,this.tf_grade.color=Ct.qualityColors[this.itemVo.itemItem.quality-1],this.tf_grade.text=m.instance.getUILang(`Quality_${this.itemVo.itemItem.quality}:`),this.tf_part.text=m.instance.getUILang(`Part_${u.type}:`);let p=u.attribute;this.list_attrs.array=p;let d=u.skillId;if(d){var r=_.intance.m_dicSkills.get(d);this.skillListItem.dataSource=r,this.skillListItem.visible=!0}else this.skillListItem.visible=!1;this.list_btn.y=this.nomalY+50}else this.img_skill.visible=!1,this.tf_des.visible=!0,this.tf_des.text=m.instance.getLanguage(l.des),this.box_show.visible=!0,this.box_show2.visible=!1,this.tf_name.text=m.instance.getLanguage(l.name),this.list_btn.y=this.nomalY;var s=l.use,o=[];s&&s.forEach(c=>{if(c==1){var u=!1,p=!1;this.itemVo.subType==8&&b.instance.playerDto.unionLeader!=1||(u=!0),this.itemVo.subType==7&&(p=!1),u&&o.push([c,this.itemVo,p])}else if(c==2){var u=!1,p=!1;if(l&&l.effect.length==2)var d=l.effect[0][0],L=l.effect[0][1],x=b.instance.m_packageData.getCountById(d),p=L>x;o.push([c,this.itemVo,p])}else if(c==3){var p=!1;o.push([c,this.itemVo,p])}else if(c==6){var p=!1,w=b.instance.m_serverTime;if(this.itemVo.chainStatus==1||w>this.itemVo.expTime)var p=!0;o.push([c,this.itemVo,p])}}),this.list_btn.array=o,this.list_btn.visible=!0}else this.list_btn.visible=!1,this.img_icon.skin=null,this.tf_name.text="",this.tf_des.text="",this.box_show.visible=!1,this.box_show2.visible=!1}setToMainScene(){oe.intance.setCurrentScene(Y.M_SCENE_MAIN)}stopAni(e){console.log("stopAni: "+e)}async onRefreshQuan(){this.onRefreshKnapsack(null),E.instance.notice(m.instance.getLanguage(2e3))}async onRefreshKnapsack(e){this.needRefresh=!0,e&&(this.selectId=e),await this.initLuckDrawView(),this.needRefresh=!1}removeEvent(){g.intance.off(f.EVENT_REFRESH_KNAPSACK,this,this.onRefreshKnapsack),g.intance.off(f.EVENT_REFRESH_QUAN_STATUS,this,this.onRefreshQuan)}onRisingStar(){A.intance.openModule(y.EquipStarUpDialog,this.itemVo)}onNftTabClick(e){for(let i=1;i<=this.totalSubTab;i++)e==i?(this["tab_nft_"+i].getChildByName("img").skin="res/shop/img_com_tab (2).png",this["tab_nft_"+i].getChildByName("tf_tit").color="#ffffff",this.getNftDataByIndex(e)):(this["tab_nft_"+i].getChildByName("img").skin="",this["tab_nft_"+i].getChildByName("tf_tit").color="#84ccff")}async getNftDataByIndex(e){this.nftTabIndex=e;var i=await this.getItemByType(this.quanTabIndex,e);!i||this.nftTabIndex!=e||this.onSetData(i)}};gg=h([kM("6IPqO9JvTmygjIZQXMwq2A")],gg);var Lg=class extends Laya.Dialog{};var{regClass:BM}=Laya,_g=class extends Lg{constructor(){super(...arguments);this.m_strName="我是OpenSceneRuntime";this.m_iLayerType=C.M_POP;this.m_iPositionType=C.CENTER}setOpenData(e){e&&(this.itemVo=e)}onEnable(){this.item.dataSource=this.itemVo;let e=this.itemVo.itemItem;this.tf_name.text=m.instance.getLanguage(e.name),this.txt_type.text=m.instance.getLanguage(6060)+m.instance.getLanguage(e.type),this.txt_desc.text=m.instance.getLanguage(e.des)}removeEvent(){}};_g=h([BM("or8jNdIhRpSbAG2JBhH-wA")],_g);var vg=class extends Laya.Dialog{};var{regClass:MM}=Laya,xg=class extends vg{constructor(e){super();this.m_strName="我是OpenSceneRuntime";this.m_iLayerType=C.M_POP;this.m_iPositionType=C.CENTER}onEnable(){Xe.instance.playSoundByName(Xe.soundName32)}setOpenData(e){e&&(this.reward=e);var i=[],a=this.reward;a.forEach(c=>{if(c.id&&c.id>0){var u=new Ne(c.id);u.newAddCnt=c.count,c.id==3011&&(u.itemItem.icon=c.id),i.push(u)}});var r=this.list_reward.spaceX,s=this.list_reward.itemTemplate.width,o=i.length;this.list_reward.repeatX=o;var l=o*s+r*(o-1);this.list_reward.width=l,this.list_reward.x=this.width-l>>1,this.list_reward.array=i}};xg=h([MM("xwYUFnd4S3uJGIJSjjbRag")],xg);var er=class n{constructor(){this.lastTime=0}static get instance(){return n._instance||(n._instance=new n),n._instance}async addTicketLog(t,e){var i=new Date().getTime();if(i-this.lastTime<1e3)return;this.lastTime=i,this.type=t,this.tid=e,de.instance.showLoadingByInfo(m.instance.getLanguage(1119));let a=z.vType==2?J.ADDLOG_ADDRESS:J.ADDLOG_ADDRESS_TEST,r=z.vType==2?Wn:rn,s=F.instance.walletAddress,o=await F.instance.walletClient.getChainId();if(a)try{if(o!==r.id&&!await F.instance.switchChain(r.id)){this.onEndQuanList(),console.log("切换失败，请手动切换");return}let u=b.instance.playerDto.pid,p=await F.instance.walletClient.writeContract({address:a,abi:J.ADDLOG_ABI,functionName:"addTicketLog",args:[u,e,t],account:s}),d;return d=await F.instance.publicClient.waitForTransactionReceipt({hash:p,pollingInterval:1e3}),console.log(`Tx with hash: ${p}`,d),d&&d.status=="success"?(this.waitGetQuanReward(r.id,p),console.log(`Tx successful with hash: ${p}`),p):(this.onEndQuanList(),Le.TransactionErrorTip(),!1)}catch(u){this.onEndQuanList();var l=u.shortMessage;if(l&&l.indexOf("does not match")!=-1){var c=F.instance.getChainName(r.id);l=m.instance.getLanguage(1172,c)}if(console.log(l),E.instance.notice(l),u instanceof K){let p=u.walk(d=>d instanceof vt);if(p instanceof vt){let d=p.data?.errorName??"";console.log("============errorName: "+d)}}return null}}onEndQuanList(t=null){de.instance.hideLoading(),t&&g.intance.event(f.EVENT_REFRESH_QUAN_STATUS,[t])}waitGetQuanReward(t,e){this.chainId=t,this.hashId=e,Laya.timer.loop(2e3,this,this.getQuanReward)}async getQuanReward(){if(this.type==1){var t=await v.requestPost("wxgame/loserTicket/loserTicketChainCheck",{tid:this.tid}).catch(a=>{});t&&t.takeUp==1&&(Laya.timer.clear(this,this.getQuanReward),de.instance.hideLoading(),this.onEndQuanList(t))}else if(this.type==2){var e=await v.requestPost("wxgame/loserTicket/takeChainCheck",{tid:this.tid}).catch(a=>{});if(e&&e.takeUp==1&&e.bonus>0){Laya.timer.clear(this,this.getQuanReward);var i=new xt;i.id=ge.TYPE_MNT,i.count=e.bonus,de.instance.hideLoading(),A.intance.openModule(y.RewardGetDialog,[i]),this.onEndQuanList(e)}}}};var Ig=class extends Laya.Box{};var{regClass:RM}=Laya,Eg=class extends Ig{constructor(){super();this.isAddEvent=!1}addEvent(){this.isAddEvent||(this.btn_transfer.on(Laya.Event.CLICK,this,this.toDetail),this.isAddEvent=!0)}set dataSource(e){if(super.dataSource=e,!!e){this.useType=e[0],this.useType==1?this.btn_transfer.label=m.instance.getUILang("Transfer"):this.useType==2?this.btn_transfer.label=m.instance.getUILang("Combine"):this.useType==3?this.btn_transfer.label=m.instance.getUILang("Rising star"):this.useType==6&&(this.btn_transfer.label=m.instance.getUILang("To Chain")),this.itemVo=e[1];var i=e[2];this.btn_transfer.disabled=i,this.addEvent()}}async toDetail(){if(this.useType)if(this.useType==1)this.itemVo.subType==8?A.intance.openModule(y.UnionTransferView,this.itemVo):this.itemVo.subType==7||this.itemVo.subType==11?A.intance.openModule(y.TicketTransferView,this.itemVo):A.intance.openModule(y.TicketTransferView,this.itemVo);else if(this.useType==2){var e=await v.requestPost("wxgame/equip/composition",{id:this.itemVo.m_iId});e&&e.equipData?(A.intance.openModule(y.RewardGetDialog,[e.equipData]),g.intance.event(f.EVENT_REFRESH_KNAPSACK)):E.instance.notice(m.instance.getLanguage(135))}else this.useType==3?A.intance.openModule(y.EquipStarUpDialog,this.itemVo):this.useType==6&&this.onClaim()}async onClaim(){var e=b.instance.m_serverTime;if(e>this.itemVo.expTime){E.instance.notice(m.instance.getUILang("Expired"));return}var i=1,a=this.itemVo.m_iPk;await er.instance.addTicketLog(i,a)&&(console.log("记录逆袭券日志成功"),this.onClaimed())}onClaimed(){this.btn_transfer.disabled=!0}};Eg=h([RM("vkadzuILSDikVEPYvNZKcQ")],Eg);var wg=class extends Laya.Dialog{};var{regClass:PM}=Laya,Tg=class extends wg{constructor(e){super();this.m_strName="我是OpenSceneRuntime";this.m_iLayerType=C.M_POP;this.m_iPositionType=C.CENTER}onEnable(){this.list_data.visible=!1,this.onGetLastDrawList(),this.onGetStatus(),g.intance.on(f.EVENT_REFRESH_QUAN_STATUS,this,this.onGetLastDrawList)}async onGetStatus(){var e=await v.requestPost("wxgame/loserTicket/loserBonusOpenInfo",{});if(e){var i=e.curTime,a=e.openTime,r=e.cd,s=e.configId,o=e.over,l=i-a,c=_.intance.m_dicWinNumbers.values;this.winNumberItem=null;for(var u of c)if(i>=a+u.time*1e3&&i<a+u.toTime*1e3){this.winNumberItem=u;break}this.winNumberItem?(this.nextCoolDownTime=Math.ceil((a+u.toTime*1e3-i)/1e3),this.nextCoolDownTime>0?(this.onSetCoolTime(),Laya.timer.loop(1e3,this,this.onSetCoolTime)):this.onClearCoolTime()):this.tf_title.text=m.instance.getUILang("Last Draw")}}onSetCoolTime(){if(this.nextCoolDownTime>=0){var e=se.format(this.nextCoolDownTime,":",!1);this.winNumberItem&&(e=m.instance.getLanguage(this.winNumberItem.language,e)),this.tf_title.text=e,this.nextCoolDownTime--}else this.onClearCoolTime()}async onClearCoolTime(){Laya.timer.clear(this,this.onSetCoolTime),this.onGetLastDrawList(),this.onGetStatus()}async onGetLastDrawList(){let e=await v.requestPost("wxgame/loserTicket/championPack",{});if(e=e.data,e){let i=b.instance.playerDto.pid;e.sort((a,r)=>{if(a.pid===i&&r.pid!==i)return-1;if(r.pid===i&&a.pid!==i)return 1;let s=Number(a.rank),o=Number(r.rank);return s<o?-1:s>o?1:0}),this.list_data.array=e,this.list_data.visible=!0,!this.list_data.array||this.list_data.array.length<=0?this.noDataBox.visible=!0:this.noDataBox.visible=!1}}onDisable(){g.intance.off(f.EVENT_REFRESH_QUAN_STATUS,this,this.onGetLastDrawList),g.intance.offAllCaller(this)}};Tg=h([PM("OO2lbeVpR06fuUlzarIaOA")],Tg);var Cg=class extends Laya.Box{};var{regClass:NM}=Laya,Sg=class extends Cg{addEvent(){this.isAddEvent||(this.btn_claim.on(Laya.Event.CLICK,this,this.onClaim),this.btn_copy.on(Laya.Event.CLICK,this,this.onCopy),this.isAddEvent=!0)}set dataSource(e){super.dataSource=e,this.lastDrawDto=e,this.lastDrawDto&&(this.setData(this.lastDrawDto),this.addEvent())}setData(e){let i=e.pid===b.instance.playerDto.pid,a=e.rank+"";if(this.tf_name.text=e.name,this.tf_union.text=m.instance.getMultiLan(e.shortUnionName),this.tf_rank.text=a,this.playerIcon.headSkin=e.head,this.tf_address.text=`${te.shortenString(e.address,7,4)}`,this.tf_tid.text=e.tid,this.img_flag.skin=S.instance.getCountryIcon(e.country),e.icon){let s=S.instance.getUnionIcon(e.icon);this.img_lvIcon.skin=s,this.img_lvIcon.visible=!0}else this.img_lvIcon.visible=!1;this.btn_claim.visible=this.img_bg.visible=i;let r=ge.TYPE_MNT;this.img_coinType.skin=S.instance.getMoneyIcon(r),this.tf_amount.text=xe.formatNumberStr(e.prize,8),e.upStatus?(this.btn_claim.label=m.instance.getUILang("Claimed"),this.btn_claim.disabled=!0):(this.btn_claim.label=m.instance.getUILang("Claim"),this.btn_claim.disabled=!1)}async onClaim(){var e=2,i=this.lastDrawDto.tid;await er.instance.addTicketLog(e,i)&&(console.log("兑奖上链成功"),this.onClaimed())}onClaimed(){this.btn_claim.label=m.instance.getUILang("Claimed"),this.btn_claim.disabled=!0}onCopy(){let e=this.lastDrawDto.address;doCopy(e),E.instance.notice(m.instance.getLanguage(132))}};Sg=h([NM("IC0pm1gWRlehJmSHpz-Alw")],Sg);var Dg=class extends Laya.Scene{};var{regClass:OM}=Laya,Ag=class extends Dg{constructor(){super(...arguments);this.currUnionId=1}onAwake(){this.m_iLayerType=C.M_POP,this.m_iPositionType=C.UP}onOpened(e){this.currUnionId=e,this.onGetLifeChangePool()}onEnable(){this.btn_back&&this.btn_back.on(Laya.Event.CLICK,this,this.setToMainScene),this.btn_goFight.on(Laya.Event.CLICK,this,this.goFight),this.btn_help.on(Laya.Event.CLICK,this,this.onHelp),this.btn_lastDraw.on(Laya.Event.CLICK,this,this.onOpenLastDraw),this.refreshApplyBtnRed(),Laya.timer.loop(1e3,this,this.refreshApplyBtnRed)}refreshApplyBtnRed(){this.img_red.visible=b.instance.getRedDotById(he.LAST_DRAW)}goFight(){k.instance.arenaType=W.ARENA_TYPE_PROFESSIONAL,oe.intance.setCurrentScene(Y.M_SCENE_AIRDROP)}onHelp(){var e=m.instance.getLanguage(1799),i=m.instance.getLanguage(1800);A.intance.openModule(y.HelpDialog,[2,e,i])}onOpenLastDraw(){A.intance.openModule(y.LastDrawDialog)}setToMainScene(){oe.intance.setCurrentScene(Y.M_SCENE_MAIN)}async onGetLifeChangePool(){var e=await v.requestPost("wxgame/loserTicket/bonusInfo",{}),i=e;if(i){this.tf_currPoolAmount.text=i.currentBonus,this.tf_poolAmount.text=m.instance.getUILang("Pool Amount")+": "+i.allBonus;var a=i.localBonus;this.tf_80toCurrent.text=m.instance.getUILang("80% to Current")+": "+a;var r=i.nextBonus;this.tf_20toNext.text=m.instance.getUILang("20% to Next")+": "+r,this.tf_lastPool.text=m.instance.getUILang("From Last Pool")+": "+i.beforeBonus,this.tf_myLcTicket.text=m.instance.getUILang("My L-C ticket")+`: <font color="#ff683a">${i.ticketCount}</font>`,this.tf_drawDate.text=se.formatTimeStamp(i.openTime,"YY-MT-DD HH:MM")}else E.instance.notice(m.instance.getLanguage(135))}onDisable(){Laya.timer.clearAll(this)}};Ag=h([OM("A_npk_biQS6P0BGIhOOH5g")],Ag);var kg=class extends Laya.Box{};var{regClass:HM}=Laya,Bg=class extends kg{constructor(){super();this.m_strName="我是OpenSceneRuntime";this.m_iLayerType=C.M_POP;this.m_iPositionType=C.CENTER}onEnable(){console.log("OpenScene onEnable："+this.m_strName)}getName(){console.log(this.m_strName)}onDisable(){}};Bg=h([HM("sQS5mrqRQLWcBk-SgfBGJw")],Bg);var Mg=class extends Laya.Box{};var{regClass:UM}=Laya,Rg=class extends Mg{constructor(){super();this.showAdd=!1;this.isAddEvent=!1}createChildren(){super.createChildren()}set dataSource(e){super.dataSource=e,this.mailDto=e,this.mailDto&&this.setCurrentOutPut()}async setCurrentOutPut(){this.mailDto&&(this.mailDto.type==2?(this.tf_title.visible=!1,this.fromBox.visible=!0,this.mailDto.fromPlayerName?this.tf_from.text=`From ${this.mailDto.fromPlayerName}`:this.tf_from.text=""):(this.tf_title.visible=!0,this.fromBox.visible=!1,this.tf_title.text=this.mailDto.title),this.tf_time.text=se.formatDayAndTime(this.mailDto.createTime,".").date,this.img_reward.visible=this.mailDto.reward&&this.mailDto.reward.length>0,this.img_red.visible=(this.mailDto.state==0||this.mailDto.receive==0)&&!this.mailDto.isAnnounce,this.img_box.skin=this.mailDto.state==0?"res/mail/img_mail_state_0.png":"res/mail/img_mail_state_1.png")}};Rg=h([UM("UKoifNR5Qmm4eq8sXy0K3A")],Rg);var Pg=class extends Laya.Scene{};var{regClass:VM}=Laya,Ng=class extends Pg{constructor(){super(...arguments);this.subBagInfo=null;this.noOpenLock=!1;this.currTab=0;this.type=1;this.items=[];this.hasItem=!1}onAwake(){this.m_iLayerType=C.M_POP,this.m_iPositionType=C.UP,this.listPanel1.visible=!1}onOpened(e){this.type=e}onEnable(){this.btn_receive.on(Laya.Event.CLICK,this,this.onReceive),this.tf_des.on(Laya.Event.CLICK,this,this.dexclick),this.btn_one_claim.on(Laya.Event.CLICK,this,this.onOneClaim),this.btn_one_deletior.on(Laya.Event.CLICK,this,this.noRead),this.btn_1.on(Laya.Event.CLICK,this,this.onClickTab,[1,!1]),this.btn_2.on(Laya.Event.CLICK,this,this.onClickTab,[2,!1]),this.btn_3.on(Laya.Event.CLICK,this,this.onClickTab,[3,!1]),this.btn_copy.on(Laya.Event.CLICK,this,this.onClickCopy),g.intance.on(f.REFRESH_MAIL_RED,this,this.resetRedData),this.btn_back&&this.btn_back.on(Laya.Event.CLICK,this,this.setToMainScene),this.listPanel1.vScrollBarSkin="",this.listPanel1.selectHandler=Laya.Handler.create(this,this.onSelectItem,null,!1),this.box_show.visible=!1,this.box_2.visible=!1,this.initLuckDrawView();let e=(Laya.stage.height-z.DESIGN_HEIGHT)/2}setTab(e){this.currTab=e;for(let i=1;i<4;i++)e==i?(this["btn_"+i].getChildByName("selectBox").visible=!0,this["btn_"+i].getChildByName("tf_txt").color="#143f6b"):(this["btn_"+i].getChildByName("selectBox").visible=!1,this["btn_"+i].getChildByName("tf_txt").color="#7ff1fe")}async initLuckDrawView(){let e=await v.requestPost("wxgame/mail/list",{},!0,!0);await b.instance.m_mailData.initData(e.data),this.resetRedData(),!this.destroyed&&(this.type?this.onClickTab(this.type):this.onClickTab(1))}async refreshView(e=!0){let i=await v.requestPost("wxgame/mail/list",{},!0,!0);await b.instance.m_mailData.initData(i.data),this.resetRedData(),e&&this.onClickTab(this.currTab,!0)}refreshMailRed(){let e=b.instance.m_mailData.m_dicTypeList.get(1)}removeHtmlTags(e){return e.replace(/<[^>]+>/g,"")}getAnnounceMail(e){let i=[],a=Laya.LocalStorage.getItem(z.COOKIE_CF_LAN);for(let r=0;r<e.length;r++){let s=e[r],o=a=="zh"?s.title[6]:s.title[1],l=a=="zh"?s.contents[6]:s.contents[1],c=[],u={content:l,createTime:s.createTime,expTime:s.expTime,fromPlayerId:0,pid:1032,receive:0,state:3,title:o,type:1,reward:c,isAnnounce:!0};i.push(u)}return i}async onClickTab(e,i=!1){if(!i){if(this.currTab==e)return;this.setTab(e)}if(e>0){if(this.box_2.visible=!0,this.destroyed)return;var a=await this.getItemByType(e);if(e==3){let r=await v.requestPost("wxgame/sys/noticeAll",{});console.log("announceData============>",r),this.items=this.getAnnounceMail(r.list),a=this.items,this.hasItem=this.items.length>0,this.img_annRed.visible=!1}else a=await this.getItemByType(e);this.listPanel1.array=a,this.listPanel1.visible=!0}this.listPanel1.selectedIndex=-1,this.box_show.visible=!1,this.hasItem?(this.noDataBox.visible=!1,this.listPanel1.selectedIndex=0,this.btn_one_deletior.visible=!0):(this.noDataBox.visible=!0,this.btn_one_deletior.visible=!1),this.currTab==3&&(this.btn_one_deletior.visible=!1)}async getItemByType(e){var i=e;return this.items=[],this.hasItem=!1,this.items=b.instance.m_mailData.getListByType(i),this.hasItem=this.items.length>0,this.items}async onSelectItem(e,i){if(console.log("onSelectItem selectIndex: "+e),this.currMailDto=this.items[e],console.log(this.currMailDto),this.currMailDto){this.tf_title.text=this.currMailDto.title,this.tf_des.text=this.currMailDto.content,this.tf_time.text=se.formatDayAndTime(this.currMailDto.createTime,".").date;var a=[],r=this.currMailDto.reward;if(r.forEach(o=>{var l=new Ne(o.id);l.newAddCnt=o.count,a.push(l)}),this.list_reward.array=a,this.list_reward.gray=this.currMailDto.receive==1,this.list_reward.length<=0&&this.currTab==3?(this.img_xian.visible=!1,this.panel_des.height=359,this.tf_des.height=this.tf_des.textField.textHeight+10):(this.img_xian.visible=!0,this.panel_des.height=169,this.tf_des.height=this.tf_des.textField.textHeight+10),this.box_show.visible=!0,this.btn_receive.labelSize=28,this.currMailDto.state==0&&!this.noOpenLock){var s=await v.requestPost("wxgame/mail/read",{id:this.currMailDto.id});if(s.errorCode==0){let o=this.listPanel1.selectedIndex;await this.refreshView(),this.listPanel1.selectedIndex=o}}this.noOpenLock=!1,this.currMailDto.type==2?(this.btn_receive.disabled=!1,this.tf_title.visible=!1,this.fromBox.visible=!0,this.panel_des.y=145,this.tf_re.text=`Re ${b.instance.playerDto.name}`,this.tf_re.visible=!0,this.address=this.currMailDto.fromPlayerAddress,this.address?this.tf_from.text=`From ${te.shortenString(this.address,8,6)}`:this.tf_from.text="",a.length>0?this.currMailDto.receive==0?(this.btn_receive.label="Receive and reply",this.btn_receive.labelSize=24):this.btn_receive.label="Reply":this.btn_receive.label="Reply"):(this.panel_des.y=112,this.tf_re.visible=!1,this.tf_title.visible=!0,this.fromBox.visible=!1,this.currMailDto.reward.length>0&&this.currMailDto.receive==0?(this.btn_receive.label="Receive",this.btn_receive.disabled=!1):(this.btn_receive.disabled=this.currMailDto.state>0,this.btn_receive.label="Mark as read"))}else this.box_show.visible=!1}dexclick(){console.log("click")}async onReceive(){if(this.currMailDto){if(this.currMailDto.type==2){let i={icon:this.currMailDto.fromPlayerIcon,name:this.currMailDto.fromPlayerName,id:this.currMailDto.fromPlayerId};if(this.currMailDto.reward.length>0&&this.currMailDto.receive==0){var e=await v.requestPost("wxgame/mail/receive",{id:this.currMailDto.id});e.errorCode==0?(e.reward&&e.reward.length>0?(A.intance.openModule(y.PrivateChatDialog,i),A.intance.openModule(y.RewardGetDialog,e.reward)):(E.instance.notice(m.instance.getLanguage(2e3)),A.intance.openModule(y.PrivateChatDialog,i)),this.refreshView()):E.instance.notice(m.instance.getLanguage(135))}else A.intance.openModule(y.PrivateChatDialog,i)}else if(this.currMailDto.reward.length>0&&this.currMailDto.receive==0){var e=await v.requestPost("wxgame/mail/receive",{id:this.currMailDto.id});e.errorCode==0?(e.reward&&e.reward.length>0?A.intance.openModule(y.RewardGetDialog,e.reward):E.instance.notice(m.instance.getLanguage(2e3)),this.refreshView()):E.instance.notice(m.instance.getLanguage(135))}}}async onOneClaim(){if(this.currMailDto){var e=await v.requestPost("wxgame/mail/readOneKey",{});e.errorCode==0?(e.reward&&e.reward.length>0?A.intance.openModule(y.RewardGetDialog,e.reward):E.instance.notice(m.instance.getLanguage(2e3)),this.refreshView()):E.instance.notice(m.instance.getLanguage(135))}}async onOneDeletior(){if(this.currMailDto){var e=await v.requestPost("wxgame/mail/delOneKey",{});e.errorCode==0?(E.instance.notice(m.instance.getLanguage(2e3)),this.refreshView()):E.instance.notice(m.instance.getLanguage(135))}}async noRead(){let e=this.listPanel1.array[this.listPanel1.selectedIndex];if(this.noOpenLock=!1,console.log(e),e){let a=this.listPanel1.selectedIndex;var i=await v.requestPost("wxgame/mail/noRead",{id:e.id});this.listPanel1.selectedIndex=a,i.errorCode==0&&(this.listPanel1.selectedIndex==0&&(this.noOpenLock=!0),this.refreshView())}}setToMainScene(){oe.intance.setCurrentScene(Y.M_SCENE_MAIN)}onClickCopy(){this.address&&(doCopy(this.address),E.instance.notice(m.instance.getLanguage(132)))}removeEvent(){this.btn_copy.off(Laya.Event.CLICK,this,this.onClickCopy),g.intance.offAllCaller(this)}onDisable(){this.removeEvent()}resetRedData(){this.img_sysRed.visible=!1,this.img_friendRed.visible=!1,this.img_annRed.visible=!1;let e=b.instance.m_mailData.getRedData();e.system&&(this.img_sysRed.visible=!0),e.friend&&(this.img_friendRed.visible=!0),b.instance.getRedDotById(he.MAIL_ANNOUNCE_RED)&&(this.img_annRed.visible=!0)}};Ng=h([VM("XwqkX1FmRISr-BmvQwE88Q")],Ng);var Og=class extends Laya.Box{};var{regClass:FM}=Laya,Hg=class extends Og{onEnable(){}notice(e){this.speed=2+1;let i=e;this.label_tf.text=e,console.log("notice: ",e),this.image_bg.width=this.label_tf.textField.textWidth+100,this.alpha=1,this.visible=!0}get view(){return this}get width(){return this.image_bg.width}update(){this.x-=this.speed}isOffScreen(){return this.x+this.width<0}onDisable(){console.log("barrageSpr recover"),Laya.Pool.recover("barrageSpr",this)}};Hg=h([FM("pMWsUZPhS4iK2yN8OCI4Yw")],Hg);var Ug=class extends Laya.Box{};var{regClass:GM}=Laya,Vg=class extends Ug{constructor(){super();this.isAddEvent=!1}createChildren(){super.createChildren()}addEvent(){this.isAddEvent||(this.check_coin.on(Laya.Event.CLICK,this,this.onCheck),this.isAddEvent=!0)}set dataSource(e){if(super.dataSource=e,!e)return;this.addEvent();let i=e;this.check_coin.selected=i[1],this.tf_coin.text=i[2]}onCheck(){this._dataSource[1]=this.check_coin.selected,g.intance.event(f.EVENT_CHECK_ICON_SELECT)}};Vg=h([GM("UTGHsPbQS6C5FohXv8T25Q")],Vg);var Fg=class extends Laya.Dialog{};var{regClass:KM}=Laya,Gg=class extends Fg{constructor(){super(...arguments);this.m_strName="我是OpenSceneRuntime";this.m_iLayerType=C.M_PANEL;this.m_iPositionType=C.CENTER;this.isInit=!1;this.numIndex=0;this.coinType=3001;this.nodeId=-1;this.passMoneyNum=0;this.inApply=-1;this.dateOpenState=0;this.startDate={year:0,month:0,day:0,hour:0,minutes:0};this.beforeYearIndex=null;this.beforeMonthIndex=null;this.beforeDayIndex=null;this.beforeHourIndex=null;this.beforeMinuteIndex=null;this.plChoose=[];this.groupWars=[];this.teamDatas=[];this.arenaLvs=[];this.arenaLvDatas=[];this.coinIds=[];this.no=0}async setOpenData(e){if(e){if(this.matchType=e[0],this.isCreate=e[1],this.isBooking=e[2],this.isBookingMust=e[4],this.arenaType=k.instance.arenaType,this.matchType==W.ACTION_CREATE)this.arenaLv=e[3];else if(this.matchType==W.ACTION_CREATE_BOOKING)this.arenaLv=1;else if(this.matchType==W.ACTION_JOIN_BOOKING){var i=e[3];let s;this.roomDto=i[0],this.inApply=i[1];var a=_.intance.m_dicArenaDic.get(this.roomDto.arenaId);this.arenaLv=a.lv,this.arenaType=a.type}else if(this.matchType==W.ACTION_JOIN){var r=e[3];let s;this.roomDto=r;var a=_.intance.m_dicArenaDic.get(this.roomDto.arenaId);this.arenaLv=a.lv,this.arenaType=a.type}this.initContainer()}}onEnable(){this.btn_back.on(Laya.Event.CLICK,this,this.onClose),g.intance.on(f.EVENT_Close_CreateRoom,this,this.onClose),this.btn_create.on(Laya.Event.CLICK,this,this.onCreate),this.input_customName.on(Laya.Event.INPUT,this,this.onInputChange),this.yearList.on(Laya.Event.MOUSE_UP,this,this.onListStop,[this.yearList,"year"]),this.monthList.on(Laya.Event.MOUSE_UP,this,this.onListStop,[this.monthList,"month"]),this.dayList.on(Laya.Event.MOUSE_UP,this,this.onListStop,[this.dayList,"day"]),this.hourList.on(Laya.Event.MOUSE_UP,this,this.onListStop,[this.hourList,"hour"]),this.minutesList.on(Laya.Event.MOUSE_UP,this,this.onListStop,[this.minutesList,"minutes"]),this.yearList.scrollBar.on(Laya.Event.CHANGE,this,this.onScrollBarChange,[this.yearList,"year",this.img_date_pad]),this.monthList.scrollBar.on(Laya.Event.CHANGE,this,this.onScrollBarChange,[this.monthList,"month",this.img_date_pad]),this.dayList.scrollBar.on(Laya.Event.CHANGE,this,this.onScrollBarChange,[this.dayList,"day",this.img_date_pad]),this.hourList.scrollBar.on(Laya.Event.CHANGE,this,this.onScrollBarChange,[this.hourList,"hour",this.img_date_pad]),this.minutesList.scrollBar.on(Laya.Event.CHANGE,this,this.onScrollBarChange,[this.minutesList,"minutes",this.img_date_pad]),this.btn_view.on(Laya.Event.CLICK,this,this.onView),this.btn_invite.on(Laya.Event.CLICK,this,this.onInvite),this.box_date.on(Laya.Event.CLICK,this,this.onOpenDate,[this.img_date_pad,this.box_date]),this.yearList.scrollBar.rollRatio=0,this.monthList.scrollBar.rollRatio=0,this.dayList.scrollBar.rollRatio=0,this.hourList.scrollBar.rollRatio=0,this.minutesList.scrollBar.rollRatio=0}onView(){var e=this.roomDto.roomId,i=this.roomDto.teamDto;A.intance.openModule(y.MyTeamDialog,[e,i])}onInvite(){var e=this.roomDto.roomId,i=this.roomDto.teamDto.teamId;A.intance.openModule(y.MyFriendDialog,[e,i])}onClose(){this.close()}onDisable(){g.intance.off(f.EVENT_Close_CreateRoom,this,this.onClose),this.yearList.off(Laya.Event.MOUSE_UP,this,this.onListStop),this.monthList.off(Laya.Event.MOUSE_UP,this,this.onListStop),this.dayList.off(Laya.Event.MOUSE_UP,this,this.onListStop),this.hourList.off(Laya.Event.MOUSE_UP,this,this.onListStop),this.minutesList.off(Laya.Event.MOUSE_UP,this,this.onListStop),this.yearList.scrollBar.off(Laya.Event.CHANGE,this,this.onScrollBarChange),this.monthList.scrollBar.off(Laya.Event.CHANGE,this,this.onScrollBarChange),this.dayList.scrollBar.off(Laya.Event.CHANGE,this,this.onScrollBarChange),this.hourList.scrollBar.off(Laya.Event.CHANGE,this,this.onScrollBarChange),this.minutesList.scrollBar.off(Laya.Event.CHANGE,this,this.onScrollBarChange),this.box_date.on(Laya.Event.CLICK,this,this.onOpenDate,[this.img_date_pad,this.box_date])}initContainer(){if(this.arenaType==W.ARENA_TYPE_TEAM?this.box_teamContainer.visible=!0:(this.box_teamContainer.visible=!1,this.box_bottomContainer.y-=this.box_teamContainer.height-10),this.isCreate?(this.btn_create.label=m.instance.getUILang("Create"),this.isBooking==!1):(this.inApply==1?(this.btn_create.label=m.instance.getLanguage(1556),this.btn_create.disabled=!0):(this.btn_create.label=m.instance.getUILang("Join"),this.btn_create.disabled=!1),this.box_node.disabled=!0,this.arenaLvCombo.disabled=!0,this.teamCombo.disabled=!0,this.coinCombo.disabled=!0,this.input_customName.disabled=!0,this.check_anonymous.disabled=!0,this.check_closeLive.disabled=!0),this.roomDto){let a=this.roomDto.leader;if(a){this.tf_roleName.text=a.name;let r=a.icon;this.playerIcon.headSkin=r,a.country?this.img_country.skin=S.instance.getCountryIcon(a.country+""):this.img_country.skin=null}}else{let a=b.instance.playerDto;if(!a)return;this.tf_roleName.text=a.name;let r=a.icon;this.playerIcon.headSkin=r,this.img_country.skin=S.instance.getCountryIcon(a.country+"")}var e=_.intance.m_dicArenaTypes.get(this.arenaType),i=e.passwordSwitch==1;i?this.box_pwd.disabled=!1:this.box_pwd.disabled=!0,this.initNode(),this.initTime(),this.initPlayerNumCombo(e),this.initTeamCombo(e),this.initArenaLvCombo(e),this.isCreate&&(this.arenaType==W.ARENA_TYPE_PROFESSIONAL||this.arenaType==W.ARENA_TYPE_TEAM)||this.initCoinCombo(e),this.initCustomName(),this.initAnonymous(),this.initCloseLive()}initAnonymous(){this.roomDto?this.check_anonymous.selected=this.roomDto.anonymous==1:this.check_anonymous.selected=!0}initCloseLive(){this.roomDto?this.check_closeLive.selected=this.roomDto.closeLive==1:this.check_closeLive.selected=!0}initCustomName(){let e=_.intance.getGeneralValueById(14);this.tf_nameGold.text=e[1],this.img_nameGold.skin=S.instance.getMoneyIcon(e[0]),console.log(e)}initPlayerNumCombo(e){if(this.groupId)this.box_playerNum_select.visible=!1,this.box_playerNum.visible=!1;else if(this.isCreate?this.plChoose=e.plChoose:this.plChoose=[],this.plChoose.length>0){var i=[];this.plChoose.forEach(s=>{i.push(s)}),console.log("comboData: ",i),this.list_playerNum.selectHandler=new Laya.Handler(this,this.onPlayerNumSelected),this.list_playerNum.renderHandler=Laya.Handler.create(this,this.onPlayerNumRender,null,!1),this.list_playerNum.dataSource=i;let a=-1,r=0;i.length>0&&(a=0),this.list_playerNum.selectedIndex=a,this.box_playerNum_select.visible=!0,this.box_playerNum.visible=!1}else this.box_playerNum_select.visible=!1,this.box_playerNum.visible=!0}onShowPlayNum(){this.groupId?(this.box_playerNum_select.visible=!1,this.box_playerNum.visible=!1):this.plChoose.length>0?(this.box_playerNum_select.visible=!0,this.box_playerNum.visible=!1):(this.box_playerNum_select.visible=!1,this.box_playerNum.visible=!0)}onPlayerNumRender(e,i){e.onChange(this.list_playerNum.selectedIndex==i)}onPlayerNumSelected(e){if(e!=-1){var i=this.plChoose[e];console.log("您选中了 _plChooseItem: "+i),this.numIndex=e,this.isInit&&this.setRoomInfo()}}initTeamCombo(e){let i=_.intance.m_dicGroupWar;this.groupWars=i.values,this.teamDatas=[],this.groupWars.forEach(o=>{if(this.isCreate){if(!this.isBooking&&!this.isBookingMust){if(o.groupPer>0)return}else if(e.arenaType==W.ARENA_TYPE_TEAM){if(o.groupPer==0)return}else if(o.groupPer>0)return}this.teamDatas.push([o,m.instance.getLanguage(o.name)])}),console.log("this.teamDatas: ",this.teamDatas),this.teamCombo.selectHandler=new Laya.Handler(this,this.onSelectedTeam),this.teamCombo.dataSource=this.teamDatas;let a=-1,r=0;if(this.teamDatas.length>0&&(a=0),this.box_myTeam_btn.visible=!1,this.tf_myTeamNum.text="N/A",this.roomDto){var s=this.roomDto.teamDto;s&&(this.tf_myTeamNum.text=`<font color="#fec623" >${s.curNum}</font> / ${s.totalNum}`,this.box_myTeam_btn.visible=!0,this.btn_invite.disabled=s.curNum>=s.totalNum);for(let o of this.teamDatas){if(o[0].id==this.roomDto.groupId){a=r;break}r++}}this.teamCombo.selectedIndex=a}onSelectedTeam(e){e!=-1&&(this.groupId=this.teamDatas[e][0].id,console.log("您选中了 groupWarId"+this.groupId),this.isInit&&this.setRoomInfo())}initArenaLvCombo(e){this.arenaLvs=e.arenaLvs,this.arenaLvDatas=[],this.arenaLvs.forEach(r=>{this.isBooking||this.isBookingMust?r!=4&&this.arenaLvDatas.push([r,m.instance.getUILang("arenaLv_"+r)]):(r<4||r==5)&&this.arenaLvDatas.push([r,m.instance.getUILang("arenaLv_"+r)])}),console.log("this.arenaLvDatas: ",this.arenaLvDatas),this.arenaLvCombo.selectHandler=new Laya.Handler(this,this.onSelectedArenaLv),this.arenaLvCombo.dataSource=this.arenaLvDatas;let i=-1,a=0;if(this.arenaLvDatas.length>0&&(i=0),this.roomDto)for(let r of this.arenaLvDatas){if(r[0]==this.arenaLv){i=a;break}a++}else for(let r of this.arenaLvDatas){if(r[0]==this.arenaLv){i=a;break}a++}this.arenaLvCombo.selectedIndex=i}onSelectedArenaLv(e){if(e!=-1)if(this.arenaLv=this.arenaLvDatas[e][0],console.log("您选中了 arenaLv"+this.arenaLv),this.isCreate&&(this.arenaType==W.ARENA_TYPE_PROFESSIONAL||this.arenaType==W.ARENA_TYPE_TEAM)){var i=_.intance.m_dicArenaTypes.get(this.arenaType);this.initCoinCombo(i,!0)}else this.isInit&&this.setRoomInfo()}initCoinCombo(e,i=!1){this.arenaType==3&&(this.coinCombo.disabled=!0),this.coinIds=[];var a=e.coinTypes,r=[];a.forEach(l=>{if(i&&l==ge.TYPE_PC){if(this.arenaLv==1){var c=_.intance.m_dicItems.get(l);r.push(m.instance.getLanguage(c.name)),this.coinIds.push(l)}}else{var c=_.intance.m_dicItems.get(l);r.push(m.instance.getLanguage(c.name)),this.coinIds.push(l)}}),this.coinCombo.selectHandler=new Laya.Handler(this,this.onSelectCoin),this.coinCombo.dataSource=r;let s=-1,o=0;if(r.length>0&&(s=0),this.roomDto)for(let l of this.coinIds){if(l==this.roomDto.coinType){s=o;break}o++}this.coinCombo.selectedIndex=s}onSelectCoin(e){e!=-1&&(this.coinType=this.coinIds[e],console.log("您选中了 coinType"+this.coinType),this.isInit||(this.isInit=!0),this.setRoomInfo())}setRoomInfo(){var e=this.arenaType;e==W.ARENA_TYPE_TRAINING?this.arenaItem=_.intance.getSheetDataByMultiKey(_.intance.m_dicArenaNumMulDic,[e,this.arenaLv,this.coinType]):this.arenaItem=_.intance.getSheetDataByMultiKey(_.intance.m_dicArenaMulDic,[e,this.arenaLv,this.coinType]);var i=m.instance.getLanguage(this.arenaItem.name);this.isCreate?this.isBooking||this.isBookingMust?this.arenaType==W.ARENA_TYPE_TEAM?i=m.instance.getLanguage(1711,i):i=m.instance.getLanguage(1557,i):i=m.instance.getLanguage(1558,i):this.isBooking||this.isBookingMust?this.arenaType==W.ARENA_TYPE_TEAM?this.inApply==1?i=m.instance.getLanguage(1712,i):i=m.instance.getLanguage(1713,i):this.inApply==1?i=m.instance.getLanguage(1559,i):i=m.instance.getLanguage(1560,i):i=m.instance.getLanguage(1561,i),this.tf_arenaName.text=i,this.onShowPlayNum(),this.onGetRoomNo()}async onGetRoomNo(){if(this.isCreate){this.btn_create.disabled=!0;let e=this,i=await v.requestPost("wxgame/room/getRoomNameSequence",{arenaId:this.arenaItem.id});if(i){this.no=i.no,this.onSetRoomName(),this.passMoneyNum=i.createNum;let a=_.intance.getGeneralValueById(28),r,s=a[1][0];this.passMoneyNum<s?r=a[0]:r=a[1],console.log("当前是第 "+this.passMoneyNum+" 次 密码付费，预计扣金币："+r[2]+" , 请核对！"),this.tf_namePassGold.text=r[2],this.img_namePassGold.skin=S.instance.getMoneyIcon(r[1])}else E.instance.notice(m.instance.getLanguage(135))}else this.tf_min.text=this.roomDto.minCount+"",this.tf_max.text=this.roomDto.maxCount+"",this.tf_roomName.text=B.instance.setRoomAnonymousLabel(this.roomDto.roomName,this.roomDto.anonymous)}onSetRoomName(){if(!this.destroyed){var e=_.intance.m_dicItems.get(this.coinType),i=m.instance.getLanguage(e.name),a="";this.arenaType==W.ARENA_TYPE_PROFESSIONAL?a="PRO."+i:this.arenaType==W.ARENA_TYPE_AIRDROP?a="AD."+i:this.arenaType==W.ARENA_TYPE_TRAINING?a="TRG":this.arenaType==W.ARENA_TYPE_TEAM&&(a="TEAM."+i),a=a+"."+this.no,this.tf_roomName.text=a,this.inApply!=1&&(this.btn_create.disabled=!1)}}onInputChange(){Laya.timer.frameOnce(1,this,this.checkAndTruncate)}checkAndTruncate(){let e=this.input_customName.text,i=0,a="";for(let r=0;r<e.length;r++){let s=e.charAt(r),o=this.isDoubleByte(s)?2:1;if(i+o<=15)a+=s,i+=o;else break}e!==a&&(this.input_customName.text=a,this.input_customName.focus=!0,this.input_customName.editable=!0)}isDoubleByte(e){return e.charCodeAt(0)>255}initTime(){this.box_countdown.visible=!1,this.box_date.disabled=!0,this.matchType==W.ACTION_CREATE?(this.tf_start.text="N/A",this.tf_hour.text=""):this.isCreate?this.initListTime():this.roomDto.startTime>0?(this.tf_start.text=se.formatTimeStamps(this.roomDto.startTime,"YY-MT-DD"),this.tf_hour.text=se.formatTimeStamps(this.roomDto.startTime,"HH:MM"),this.box_countdown.visible=!0,this.onStartCountDown()):(this.tf_start.text="N/A",this.tf_hour.text="")}onStartCountDown(){var e=this.roomDto.startTime-this.roomDto.curTime;this.startCoolDownTime=Math.round(e/1e3),this.startCoolDownTime>0?(this.onSetCoolTime(),Laya.timer.loop(1e3,this,this.onSetCoolTime)):(Laya.timer.clear(this,this.onSetCoolTime),this.close())}onSetCoolTime(){this.startCoolDownTime>=0?(this.tf_time.text=se.formatWithDay(this.startCoolDownTime,":",!0),this.startCoolDownTime--):(Laya.timer.clear(this,this.onSetCoolTime),this.tf_time.text="00:00"),console.log("onSetCoolTime ",this.startCoolDownTime,this.tf_time.text)}initNode(){this.list_node.selectHandler=new Laya.Handler(this,this.handleSelectNode),this.createNodeList(),this.box_node.on(Laya.Event.CLICK,this,this.onOpenNode),this.list_node.on(Laya.Event.MOUSE_DOWN,this,this.onListDown),this.list_node.mouseHandler=Laya.Handler.create(this,this.onNodeItemMouse,null,!1),this.list_node.renderHandler=Laya.Handler.create(this,this.onNodeItemRender,null,!1),this.list_node.scrollBar&&this.list_node.scrollBar.on(Laya.Event.MOUSE_DOWN,this,this.onScrollBarDown)}onNodeItemMouse(e,i){e.type===Laya.Event.CLICK&&(this.list_node.selectedIndex=i,this.onHideNode())}onListDown(e){e.stopPropagation()}onScrollBarDown(e){e.stopPropagation()}onNodeItemRender(e,i){e.onChange(this.list_node.selectedIndex==i)}onOpenNode(){this.img_node_pad.visible==!1&&(this.img_node_pad.visible=!0,Laya.stage.once(Laya.Event.MOUSE_DOWN,this,this.onHideNode))}onHideNode(){this.img_node_pad.visible=!1,this.img_date_pad.visible=!1,Laya.stage.off(Laya.Event.MOUSE_DOWN,this,this.onHideNode),this.img_bg.off(Laya.Event.MOUSE_DOWN,this,this.onHideNode)}handleSelectNode(e){if(console.log("handleSelectNode: "+e),e!=-1){let i=this.list_node.selectedItem;this.nodeId=i.id,this.img_node.skin=S.instance.getNodeIcon(i.area),this.tf_node.text=m.instance.getLanguage(i.name),this.nodeDelaySign.dataSource=i}}createNodeList(){let e=_.intance.m_dicNodes;this.list_node.array=e.values,this.list_node.visible=!0;let i=-1,a=0;if(e.values.length>0&&(i=0),this.roomDto)for(let r of e.values){if(r.id==this.roomDto.nodeId){i=a;break}a++}this.list_node.selectedIndex=i}async onCreate(){let e=this.input_customName.text;if(this.isCreate){if(e!=""&&b.instance.getConsumeValue(ge.TYPE_GOLD)<Number(this.tf_nameGold.text)){E.instance.notice(m.instance.getLanguage(1362));return}if(this.arenaType!=W.ARENA_TYPE_TEAM&&this.numIndex==-1){E.instance.notice(m.instance.getLanguage(1593));return}}let i=this.tf_roomName.text;if(!i||i==""){E.instance.notice(m.instance.getLanguage(1361));return}let a=this.input_pwd.text,r=_.intance.getGeneralValueById(28),s,o=r[1][0];this.passMoneyNum<=o-1?s=r[0]:s=r[1];let l=s[1];if(a&&b.instance.getConsumeValue(s[1])<s[2]){E.instance.notice(m.instance.getLanguage(1639));return}var c=this.arenaItem.id,u=new oo;if(u.arenaId=c,u.nodeId=this.nodeId,u.roomName=i,u.customName=e,u.isBookingMust=this.isBookingMust,u.numIndex=this.numIndex,!this.isCreate&&(this.roomDto&&this.roomDto.roomId&&(u.roomId=this.roomDto.roomId,u.teamDto=this.roomDto.teamDto,u.groupId=this.roomDto.groupId),!u.roomId)){E.instance.notice(m.instance.getLanguage(135));return}if(this.matchType==W.ACTION_CREATE_BOOKING){var p=se.getTimestamp(this.startDate.year,this.startDate.month,this.startDate.day,this.startDate.hour,this.startDate.minutes),d=_.intance.getGeneralValueById(23),L=new Date().getTime()+d*60*1e3;if(p<L){E.instance.notice(m.instance.getLanguage(1562,d));return}u.startTime=p,u.groupId=this.groupId}u.anonymous=this.check_anonymous.selected?1:0,u.closeLive=this.check_closeLive.selected?1:0,Ae.instance.onCreateAndJoinWithPwd(this.matchType,u,a)}onListStop(e,i){let a=this.startDate,r=Math.floor(e.startIndex),s=r+1,o=this.calculateVisibleHeight(e,r),l=this.calculateVisibleHeight(e,s),c=o+14>=l?r:s;(i==="month"||i==="day"||i==="hour")&&(c=Math.min(c,e.array.length-5)),e.scrollTo(c),e.selectedIndex=c;let u=e.getCell(c+1);u.tf_date.color="#ffffff";let p=u.tf_date.text;if(p&&u){switch(i){case"year":this.onYearChange(c+1),a.year=Number(p);break;case"month":this.onMonthChange(c+1),a.month=Number(p);break;case"day":a.day=Number(p);break;case"hour":a.hour=Number(p);break;case"minutes":a.minutes=Number(p);break}this.refreshStartTime()}}calculateVisibleHeight(e,i){let a=e.getCell(i);return Math.min(a.y+a.height,e.scrollBar.value+e.height)-Math.max(a.y,e.scrollBar.value)}onYearChange(e){!this.yearList.array||this.monthList.selectedIndex<0||this.updateDayList(parseInt(this.yearList.array[e]),parseInt(this.monthList.array[this.monthList.selectedIndex]))}onMonthChange(e){!this.yearList.array||this.monthList.selectedIndex<0||this.updateDayList(parseInt(this.yearList.array[this.yearList.selectedIndex]),parseInt(this.monthList.array[e]))}updateDayList(e,i){let a=[];for(let r=1;r<=te.getDaysInMonth(e,i);r++)a.push(r.toString());for(let r=1;r<=3;r++)a.push("");a=["",...a],this.dayList.array=a}refreshStartTime(){let e=this.startDate.month>=10?this.startDate.month:`0${this.startDate.month}`,i=this.startDate.day>=10?this.startDate.day:`0${this.startDate.day}`;this.tf_start.text=`${this.startDate.year}-${e}-${i}`;let a=this.startDate.minutes,r=a>=10?`${a}`:`0${a}`;this.tf_hour.text=`${this.startDate.hour}:${r}`}initListTime(){this.box_date.disabled=!1;var e=_.intance.getGeneralValueById(23),i=new Date().getTime()+e*60*1e3;let a=new Date(i);this.startDate={year:a.getFullYear(),month:a.getMonth()+1,day:a.getDate(),hour:a.getHours(),minutes:a.getMinutes()},this.refreshStartTime()}onScrollBarChange(e,i,a){if(!a.visible)return;let r=this.startDate;console.log("startDate",this.startDate);let s=Math.floor(e.startIndex),o=s+1,l=this.calculateVisibleHeight(e,s),c=this.calculateVisibleHeight(e,o),u=l+14>=c?s:o,p=e.getCell(u+1);p.tf_date.color="#ffffff";let d,L;switch(i){case"year":L=this.beforeYearIndex,this.beforeYearIndex=u+1;break;case"month":L=this.beforeMonthIndex,this.beforeMonthIndex=u+1;break;case"day":L=this.beforeDayIndex,this.beforeDayIndex=u+1;break;case"hour":L=this.beforeHourIndex,this.beforeHourIndex=u+1;break;case"minutes":L=this.beforeMinuteIndex,this.beforeMinuteIndex=u+1;break}L!==u+1&&(d=e.getCell(L),this.resetListStyle(d));let x=p.tf_date.text;if(p.tf_date.color="#ffffff",x&&p){switch(i){case"year":this.onYearChange(u+1),r.year=Number(x);break;case"month":this.onMonthChange(u+1),r.month=Number(x);break;case"day":r.day=Number(x);break;case"hour":r.hour=Number(x);break;case"minutes":r.minutes=Number(x);break}this.refreshStartTime()}}resetListStyle(e){e&&(e.tf_date.color="#357cc0")}onOpenDate(e,i){this.resetColors(this.yearList,this.monthList,this.dayList,this.hourList,this.minutesList),e.visible==!1?(this.dateOpenState=1,this.getDateInfo(),e.visible=!0,this.img_bg.on(Laya.Event.CLICK,this,this.onHideNode)):(e.visible=!1,this.dateOpenState=0)}resetColors(e,i,a,r,s){let o=[e,i,a,r,s];for(let u of o)for(var l=0;l<u.cells.length;l++){var c=u.cells[l];c.tf_date.color="#357cc0"}}getDateInfo(){this.renderDateInfo(this.startDate,this.yearList,this.monthList,this.dayList,this.hourList,this.minutesList)}renderDateInfo(e,i,a,r,s,o){let l=e;this.fillList(i,l.year,2e3,2050),this.fillList(a,l.month,1,12);let c=new Date().getFullYear(),u=new Date().getMonth()+1,p=te.getDaysInMonth(c,u);this.fillList(r,l.day,1,p),this.fillList(s,l.hour,0,23),this.fillList(o,l.minutes,0,59)}fillList(e,i,a,r){let s=[],o=this.yearList,l=this.monthList,c=this.dayList,u=this.hourList,p=this.minutesList;for(let L=a;L<=r;L++)s.push(L.toString());for(let L=1;L<=3;L++)s.push("");s=["",...s],e.array=s;let d=s.indexOf(`${i}`);if(d>-1){e.scrollTo(d-1),e.selectedIndex=d-1;let L=e.getCell(d);L.tf_date.color="#ffffff",e==o?this.beforeYearIndex=d:e==l?this.beforeMonthIndex=d:e==c?this.beforeDayIndex=d:e==u?this.beforeHourIndex=d:e==p&&(this.beforeMinuteIndex=d)}}};Gg=h([KM("_y9qJpZZRk2p26xdgYPRyA")],Gg);var Kg=class extends Laya.Box{};var{regClass:qM}=Laya,qg=class extends Kg{constructor(){super(...arguments);this.hasOpened=!1}onEnable(){this.on(Laya.Event.CLICK,this,this.openMaxView),g.intance.on(f.EVENT_UPDATE_MATCH_ROOM,this,this.onUpdateMatchRoom)}onUpdateMatchRoom(){this.tf_coolTime.text=se.format(B.instance.coolDownTime,":",!1),B.instance.coolDownTime==5&&!this.hasOpened&&(console.log("onUpdateMatchRoom "+B.instance.coolDownTime),this.openMaxView(),this.hasOpened=!0)}openMaxView(){Ae.instance.openMaxView()}onDisable(){g.intance.off(f.EVENT_UPDATE_MATCH_ROOM,this,this.onUpdateMatchRoom)}};qg=h([qM("7hINWNN3S8SmWSveWJQJSw")],qg);var Wg=class{constructor(t){this.normalBarrages=[];this.specialBarrages=[];this.normalBarrageQueue=[];this.specialBarrageQueue=[];this.barrageHeight=44;this.lineNormalBarrageDic=new le;this.lineSpecialBarrageDic=new le;this.screenWidth=t.width,this.screenHeight=t.height,this.barrageContainer=t}addBarrage(t){let e=Laya.Pool.getItemByCreateFun("barrageSpr",Ae.instance.barrageSprPrefab.create,Ae.instance.barrageSprPrefab);e.notice(t),e.x=this.screenWidth,this.normalBarrageQueue.push(e)}addSpecialBarrage(t){this.specialBarrageQueue.push(t)}update(){this.updateNormalBarrages(),this.updateSpecialBarrages()}updateNormalBarrages(){for(let e=this.normalBarrages.length-1;e>=0;e--){let i=this.normalBarrages[e];if(i.update(),i.isOffScreen()){this.normalBarrages.splice(e,1);var t=this.lineNormalBarrageDic.get(i.rowIndex);t&&t==i&&this.lineNormalBarrageDic.remove(i.rowIndex),this.barrageContainer.removeChild(i)}}for(;this.normalBarrageQueue.length>0;){let e=this.findAvailableYPositionForNormalBarrage();if(e!==-1){let i=this.normalBarrageQueue.shift();i.y=e*this.barrageHeight,this.normalBarrages.push(i),i.rowIndex=e,this.lineNormalBarrageDic.set(e,i),this.barrageContainer.addChild(i)}else break}}updateSpecialBarrages(){for(let e=this.specialBarrages.length-1;e>=0;e--){let i=this.specialBarrages[e];if(i.update(),i.isFinished()){this.specialBarrages.splice(e,1);var t=this.lineSpecialBarrageDic.get(i.rowIndex);t&&t==i&&this.lineSpecialBarrageDic.remove(i.rowIndex),this.barrageContainer.removeChild(i)}}for(;this.specialBarrageQueue.length>0;){let e=this.findAvailableYPositionForSpecialBarrage();if(e!==-1){let i=this.specialBarrageQueue.shift(),a=this.screenHeight-100-e*this.barrageHeight,r=Laya.Pool.getItemByCreateFun("specialBarrageSpr",Ae.instance.specialBarrageSprPrefab.create,Ae.instance.specialBarrageSprPrefab);r.notice(i),r.x=(this.screenWidth-r.width)/2,r.y=a,this.specialBarrages.push(r),r.rowIndex=e,this.lineSpecialBarrageDic.set(e,r),this.barrageContainer.addChild(r)}else break}}findAvailableYPositionForNormalBarrage(){let t=this.screenHeight/2,e=Math.floor(t/this.barrageHeight);for(let a=0;a<e;a++){var i=this.lineNormalBarrageDic.get(a);if(!i||i.x+i.width+10<this.screenWidth)return i?console.log("findAvailableYPositionForNormalBarrage: ",a,i.x,i.width,this.screenWidth,this.screenWidth-(i.x+i.width+10)):console.log("findAvailableYPositionForNormalBarrage: ",a,this.screenWidth),a}return-1}findAvailableYPositionForSpecialBarrage(){for(let i=0;i<5;i++){var e=this.lineSpecialBarrageDic.get(i);if(!e)return console.log("findAvailableYPositionForSpecialBarrage: ",i),i}return-1}};var Yg=class extends Laya.Dialog{};var{regClass:WM}=Laya,zg=class extends Yg{constructor(){super(...arguments);this.m_strName="我是OpenSceneRuntime";this.m_iLayerType=C.M_PANEL;this.m_iPositionType=C.CENTER;this.isMax=!1;this.groupPer=0;this.lastState=-1;this.isSetRepeat=!1;this.currTab=0}onEnable(){g.intance.on(f.EVENT_CHANGE_HEAD,this,this.onColorSelect),g.intance.on(f.EVENT_CLICK_HERO,this,this.onClickHero),this.btn_switch.on(Laya.Event.CLICK,this,this.onSwitchClick),this.btn_emoji.on(Laya.Event.CLICK,this,this.onEmojiClick),this.btn_color.on(Laya.Event.CLICK,this,this.onColorClick),this.btn_send.on(Laya.Event.CLICK,this,this.onSendClick),this.tf_launch.on(Laya.Event.CLICK,this,this.onShowBarrageBtn),this.img_bg.on(Laya.Event.CLICK,this,this.onHideMenu),this.list_wait_hero.on(Laya.Event.CLICK,this,this.onHideMenu),this.list_team.on(Laya.Event.CLICK,this,this.onHideMenu),this.input_chat.on(Laya.Event.ENTER,this,this.onSendClick),this.btn_1.on(Laya.Event.CLICK,this,this.onClickTab,[1]),this.btn_2.on(Laya.Event.CLICK,this,this.onClickTab,[2]),this.btn_3.on(Laya.Event.CLICK,this,this.onClickTab,[3]),this.btn_help.on(Laya.Event.CLICK,this,this.onHelp),this.btn_showSignUp.on(Laya.Event.CLICK,this,this.onShowSignUp),this.btn_min.on(Laya.Event.CLICK,this,this.onMinClick),this.btn_exit.on(Laya.Event.CLICK,this,this.onExitClick),g.intance.event(f.EVENT_ENTER_MATCH_ROOM,!1),g.intance.on(f.EVENT_UPDATE_MATCH_ROOM,this,this.onUpdateMatchRoom),v.stopHeartInRoom=!0,this.initContainer(),He.instance.sendCustumEvent(40)}setOpenData(e){e&&(this.isMax=e)}initContainer(){this.list_wait_hero.visible=!0,this.onSetStateTest();var e=B.instance.roomDto,i=B.instance.roomDto.groupId,a=_.intance.m_dicGroupWar.get(i);this.groupPer=a.groupPer;var r=e.roomId,s=e.arenaId,o=e.coinType,l=e.state,c=B.instance.roomWatcher;c&&(this.btn_min.visible=!1,this.btn_showSignUp.visible=!1),console.log("initContainer",i,this.groupPer,c),this.groupPer>0&&!c&&(this.btn_exit.visible=!1),this.tf_live.visible=c;var u=_.intance.m_dicArenaDic.get(s);B.instance.currArenaItem=u,this.tf_arenaName.text=m.instance.getLanguage(u.name),this.arenaNo.text=r+"",Ae.instance.init(),this.tf_roomName.text=B.instance.setRoomAnonymousLabel(B.instance.roomDto.roomName,B.instance.roomDto.anonymous);var p=B.instance.roomDto.nodeId;if(p){var d=_.intance.m_dicNodes.get(p);this.nodeDelaySign.dataSource=d,this.nodeDelaySign.startTest()}if(this.updateExitCD(),(l==W.STATE_WAIT||l==W.STATE_SIGNUP)&&this.initChat(),this.initCumulative(),l==W.STATE_START){this.list_wait_hero.visible=!1,this.list_team.visible=!1,this.box_barrage_btn.visible=!1;var L=m.instance.getLanguage(1525);this.tf_coolTime.text=L}}updateExitCD(){if(B.instance.roomWatcher){this.btn_exit.disabled=!1,this.tf_exit.text=m.instance.getUILang("Exit");return}var e=Math.round(B.instance.roomDto.joinCd/1e3),i=e-B.instance.currArenaItem.notQuit;i>B.instance.currArenaItem.exitTime&&(i=B.instance.currArenaItem.exitTime),B.instance.limitCd=i,B.instance.limitCd>0?(this.onSetExitTime(),Laya.timer.loop(1e3,this,this.onSetExitTime)):(Laya.timer.clear(this,this.onSetExitTime),this.btn_exit.disabled=!0,this.tf_exit.text="Exit")}onSetExitTime(){B.instance.limitCd>=0?(this.tf_exit.text=m.instance.getUILang("Exit")+" ("+B.instance.limitCd+"s)",B.instance.limitCd--,this.btn_exit.disabled=!1):(Laya.timer.clear(this,this.onSetExitTime),this.btn_exit.disabled=!0,this.tf_exit.text="Exit")}onMinClick(){var e=B.instance.roomDto.state;e==W.STATE_WAIT?B.instance.coolDownTime>5&&(this.close(),Ae.instance.openMinView()):console.log("不是房间等待状态，不能最小化")}async onExitClick(){var e=B.instance.roomWatcher,i=B.instance.roomDto.state;e||i==W.STATE_WAIT?await v.requestPost("wxgame/room/leave",{roomId:B.instance.roomDto.roomId})?Ae.instance.close():E.instance.notice(m.instance.getLanguage(135)):console.log("不是房间等待状态，不能退出")}onUpdateMatchRoom(){this.onSetStateTest();var e=B.instance.roomDto.state,i=B.instance.roomDto.groupData,a=this.groupPer>0;this.lastState!=e&&(this.lastState=e,e==W.STATE_WAIT?(this.list_wait_hero.visible=!a,this.list_team.visible=a,this.box_barrage.visible=!0,this.box_barrage_btn.visible=!0,this.box_state_signUp.visible=!1,this.box_state_group.visible=!1):e==W.STATE_SIGNUP?B.instance.currArenaItem.type==W.ARENA_TYPE_PROFESSIONAL||B.instance.currArenaItem.type==W.ARENA_TYPE_TEAM?(this.list_wait_hero.visible=!a,this.list_team.visible=a,this.box_barrage.visible=!0,this.box_barrage_btn.visible=!0,this.box_state_signUp.visible=!0,this.box_state_group.visible=!1,this.onShowSignUp(null)):(this.list_wait_hero.visible=!a,this.list_team.visible=a,this.box_barrage.visible=!0,this.box_barrage_btn.visible=!0,this.box_state_signUp.visible=!1,this.box_state_group.visible=!1):e==W.STATE_GROUPED&&(i&&i.length>0?(this.list_wait_hero.visible=!1,this.list_team.visible=!1,this.box_barrage.visible=!1,this.box_barrage_btn.visible=!1,this.box_state_signUp.visible=!1,this.box_state_group.visible=!0,this.clearChat()):(this.list_wait_hero.visible=!a,this.list_team.visible=a,this.box_barrage.visible=!0,this.box_barrage_btn.visible=!0,this.box_state_signUp.visible=!1,this.box_state_group.visible=!1)));var r=B.instance.roomDto.members.length;this.tf_people.text=r+"";var s=B.instance.roomDto.maxCount;if(B.instance.playerJoinDic==null&&(B.instance.playerJoinDic=new le),this.groupPer>0)this.onGetRoomGroupList(e);else{this.heros=[];for(var o=0;o<s;o++){var l=B.instance.roomDto.members[o];l?(this.heros.push(l),B.instance.playerJoinDic.set(l.id,l)):this.heros.push(null)}(e==W.STATE_WAIT||e==W.STATE_SIGNUP)&&(this.list_wait_hero.array=this.heros)}var c="";if(e==W.STATE_GROUPED?i&&i.length>0?c=m.instance.getLanguage(1376):c=m.instance.getLanguage(1525):e==W.STATE_SIGNUP?B.instance.currArenaItem.type==W.ARENA_TYPE_PROFESSIONAL||B.instance.currArenaItem.type==W.ARENA_TYPE_TEAM?c=m.instance.getLanguage(1089):c=m.instance.getLanguage(1525):c=m.instance.getLanguage(1089),console.log("MatchModel.instance.coolDownTime: "+B.instance.coolDownTime),this.tf_coolTime.text=c+" <font color='#ff5388'>"+se.format(B.instance.coolDownTime,":",!1)+"</font>",e==W.STATE_WAIT?B.instance.coolDownTime>5?this.btn_min.disabled=!1:this.btn_min.disabled=!0:this.btn_min.disabled=!0,e==W.STATE_WAIT)this.groupPer>0?this.list_team.visible=!0:this.list_wait_hero.visible=!0;else if(e==W.STATE_SIGNUP)this.groupPer>0?this.list_team.visible=!0:this.list_wait_hero.visible=!0,(B.instance.currArenaItem.type==W.ARENA_TYPE_PROFESSIONAL||B.instance.currArenaItem.type==W.ARENA_TYPE_TEAM)&&(this.tf_cumulative.text=m.instance.getLanguage(1374,B.instance.roomDto.groupApplyList.length),this.list_groupApply.array=B.instance.roomDto.groupApplyList);else if(e==W.STATE_GROUPED&&this.groupInfos==null){var i=B.instance.roomDto.groupData;if(this.groupInfos=[],i){var u=1;i.forEach(d=>{this.groupInfos.push([u,d]),u++})}this.list_group.array=this.groupInfos}}onGetRoomGroupList(e){this.heros=[],B.instance.roomDto.members.forEach(s=>{B.instance.playerJoinDic.set(s.id,s)});var i=e==W.STATE_WAIT||e==W.STATE_SIGNUP;if(i){var a=[],r=B.instance.roomDto.roomGroupMap;for(let s in r)r.hasOwnProperty(s)&&a.push(r[s]);this.setListByData(),this.list_team.array=a,this.list_team.selectedIndex=-1}}setListByData(){if(this.isSetRepeat)return;this.isSetRepeat=!0;var e=this.list_team.itemTemplate,i=this.list_team.spaceX,a=this.list_team.spaceY,r=e.list_members.itemTemplate.width,s=e.list_members.itemTemplate.height,o=this.groupPer,l=-1,c=-1,u=3;o<=3?(l=3,this.list_team.repeatX=2):o<=5?(l=5,u=5,this.list_team.repeatX=1):(l=5,u=5,c=o%5===0?o/5:Math.floor(o/5)+1,this.list_team.repeatX=1);var p,d,L,x;l!=-1&&(p=l*r+i*(l-1),L=e.list_members.x+p+22,console.log("memberListW: ",r,l,p,L),l==5&&(this.list_team.width=L)),c!=-1&&(d=c*s+a*(c-1),x=e.list_members.y+d+10,console.log("memberListH: ",s,c,d,x));let w=()=>{var I=Laya.HierarchyParser.parse(this.list_team.itemRender,{skinBaseUrl:this._skinBaseUrl})[0];return l!=-1&&(I.list_members.repeatX=u,I.list_members.width=p,I.img_bg.width=L,I.width=L),c!=-1&&(I.list_members.height=d,I.list_members.repeatY=c,I.img_bg.height=x,I.height=x),I.hideFlags=Laya.HideFlags.HideAndDontSave,I};this.list_team.createItem=w}initChat(){this.lastSendTime=0,this.box_barrage.width=Laya.stage.width,this.box_barrage.x=this.width-this.box_barrage.width>>1,this.box_barrage.visible=!0,this.barrageManager=new Wg(this.box_barrage),Laya.timer.frameLoop(1,this,this.update),Laya.timer.loop(1500,this,this.onRecvMsg),this.onEmojiHide(),this.onColorHide(),this.list_wait_hero.selectHandler=new Laya.Handler(this,this.onUserSelected),this.list_color.selectHandler=new Laya.Handler(this,this.handleSelectColor),this.list_emoji.selectHandler=Laya.Handler.create(this,this.onSelectEmojiItem,[],!1),this.createColorList(),this.onClickTab(1)}clearChat(){Laya.timer.clear(this,this.update),Laya.timer.clear(this,this.onRecvMsg)}update(){this.barrageManager.update()}handleSelectColor(e){if(e!=-1){let i=this.list_color.selectedItem;i&&(b.instance.colorId=i.id),this.onColorHide()}}createColorList(){let e=_.intance.m_dicFontColor;this.list_color.array=e.values,this.list_color.visible=!0;let i=-1,a=0;for(let r of e.values){if(r.id==b.instance.colorId){i=a;break}a++}this.list_color.selectedIndex=i}onUserSelected(e,i){if(console.log("onUserSelected: ",e,i),B.instance.roomDto.anonymous!=1&&this.img_box_btn_2.visible){var a=this.list_wait_hero.selectedItem;if(a){var r=a.name,s=`@${r}`,o=this.input_chat.text;o.indexOf(s)==-1&&(this.input_chat.text=`${s}  ${o}`),this.list_wait_hero.selectedIndex=-1}}}onClickHero(e){if(console.log("onClickHero: ",e),B.instance.roomDto.anonymous!=1&&this.img_box_btn_2.visible&&e){var i=`@${e}`,a=this.input_chat.text;a.indexOf(i)==-1&&(this.input_chat.text=`${i}  ${a}`)}}onColorSelect(e){console.log("fontColorItem: ",e)}onSwitchClick(){console.log("onSwitchClick"),this.box_barrage.visible=!this.box_barrage.visible,this.box_barrage.visible?(this.btn_switch.skin="res/chat/img_chat_switch_1.png",this.btn_send.disabled=!1):(this.btn_switch.skin="res/chat/img_chat_switch_2.png",this.btn_send.disabled=!0)}onEmojiClick(){console.log("onEmojiClick"),this.img_box_emoji.visible==!1?this.onEmojiShow():this.onEmojiHide(),this.onColorHide()}onColorClick(){console.log("onColorClick"),this.img_box_color.visible==!1?this.onColorShow():this.onColorHide(),this.onEmojiHide()}onEmojiShow(){console.log("onEmojiShow"),this.img_box_emoji.visible=!0,this.btn_emoji.skin="res/chat/btn_emoji_1.png"}onEmojiHide(){console.log("onEmojiHide"),this.img_box_emoji.visible=!1,this.btn_emoji.skin="res/chat/btn_emoji_2.png"}onColorShow(){console.log("onColorShow"),this.img_box_color.visible=!0,this.btn_color.skin="res/chat/btn_color_1.png"}onColorHide(){console.log("onColorHide"),this.img_box_color.visible=!1,this.btn_color.skin="res/chat/btn_color_2.png"}onShowBarrageBtn(){this.img_box_btn_2.visible=!0,this.img_box_btn_1.visible=!1}onHideMenu(){this.onEmojiHide(),this.onColorHide()}onSendClick(){console.log("onSendClick");var e=this.input_chat.text;if(!e||e=="")return;let i=Date.now();if(i-this.lastSendTime<1e3){E.instance.notice(m.instance.getLanguage(1359,1));return}this.lastSendTime=i;var a=_.intance.m_dicFontColor.get(b.instance.colorId);let r=a.colorValue;var s=B.instance.roomDto,o=s.roomId;v.requestPost("wxgame/room/danmuPublish",{roomId:o,msg:e,color:r}),this.input_chat.text=""}async onRecvMsg(){console.log("onRecvMsg");let e=await v.requestPost("wxgame/room/danmuLoop",{roomId:B.instance.roomDto.roomId});if(!this.destroyed){var i=e.msgList;i&&i.forEach(a=>{this.onSetMsg(a)})}}onSetMsg(e){var i=e.msg;if(!(!i||i=="")){var a=e.color,r=this.parseEmojis(i);i=r[0];var s=r[1];if(B.instance.roomDto.anonymous!=1){var o=e.name;i=`${o}: ${i}`}i=`<font  color='${a}'>${i}</font>`;var l=e.watch;l?this.barrageManager.addSpecialBarrage(i):this.barrageManager.addBarrage(i)}}parseEmojis(e){let i=e,a=/\[:(\d+)\]/g,r,s=0;for(;(r=a.exec(e))!==null;){let c=parseInt(r[1]);console.log("parseEmojis: ",r[0],r[1]);let u;var o=_.intance.m_dicExpression.get(c);if(o){var l=S.instance.getEmoji(o.type,o.icon);u=`<img src='${l}' width='55' height='55'/>`,s++}else u=r[0];i=i.replace(r[0],u)}return[i,s]}onClickTab(e){if(this.currTab!=e){this.setTab(e);var i=this.getItemByType(e);this.list_emoji.array=i}}setTab(e){for(let i=1;i<4;i++)e==i?(this["btn_"+i].getChildByName("selectBox").visible=!0,this["btn_"+i].getChildByName("img_tab_icon").skin="res/chat/img_tab_"+i+"_1.png"):(this["btn_"+i].getChildByName("selectBox").visible=!1,this["btn_"+i].getChildByName("img_tab_icon").skin="res/chat/img_tab_"+i+"_2.png")}getItemByType(e){var i=_.intance.m_dicExpression.values,a=[],r=-1,s=0;return i.forEach(o=>{o.type==e&&a.push(o)}),a}onSelectEmojiItem(e){var i=this.list_emoji.selectedItem;if(console.log("onSelectItem expressionItem: ",i),i){let a=`[:${i.id}]`;this.input_chat.text+=a,this.onEmojiHide(),this.list_emoji.selectedIndex=-1}}isOnlyEmojis(e){return/^(\[:\d+\])*$/.test(e)}initCumulative(){}onHelp(){var e=m.instance.getLanguage(1377),i=m.instance.getLanguage(1378);A.intance.openModule(y.HelpDialog,[2,e,i])}onShowSignUp(e){if(console.log("onShowSignUp"),!B.instance.roomWatcher){var i=B.instance.roomDto.groupApplyList,a=!1;if(i&&i.forEach(L=>{L==b.instance.playerDto.pid&&(a=!0)}),a)e!=null&&E.instance.notice(m.instance.getLanguage(1375));else{var r="",s=B.instance.currArenaItem;if(s.item&&s.item.length>1){var o=s.item[0],l=s.item[1];let L=_.intance.getGeneralValueById(15);var c=2,u=_.intance.m_dicItems.get(o);if(u.itemValue.length>1){var p=S.instance.getMoneyIcon(u.itemValue[0]),d=xe.formatNumber(u.itemValue[1]*l)+"";r=m.instance.getLanguage(1363,L,d,p)}else{var p=S.instance.getMoneyIcon(3005);r=m.instance.getLanguage(1363,L,0,p)}}pe.instance().AlertByType(P.MatchConfimDialog,r,P.CANCEL,Laya.Handler.create(this,this.onSignUp))}}}onSignUp(){var e=B.instance.roomDto;Ae.instance.onCreateAndJoinWithPwd(W.ACTION_SIGNUP,e,"")}onSetStateTest(){}onDisable(){this.removeEvent(),console.log("EnterRoomView onDisable"),g.intance.off(f.EVENT_UPDATE_MATCH_ROOM,this,this.onUpdateMatchRoom),oe.intance.preSceneName==Y.M_SCENE_MATCH||(oe.intance.currSceneName!=Y.M_SCENE_AIRDROP?(console.log("SceneManager.intance.currSceneName: ",oe.intance.currSceneName),k.instance.arenaType=B.instance.currArenaItem.type,oe.intance.setCurrentScene(Y.M_SCENE_AIRDROP)):g.intance.event(f.EVENT_ENTER_MATCH_ROOM,!0)),this.barrageManager&&(this.barrageManager=null),v.stopHeartInRoom=!1}removeEvent(){Laya.timer.clearAll(this),g.intance.off(f.EVENT_CHANGE_HEAD,this,this.onColorSelect),g.intance.off(f.EVENT_CLICK_HERO,this,this.onClickHero),Laya.Pool.clearBySign("barrageSpr")}};zg=h([WM("IwpLh2K2T5Gh7QXYnJakAw")],zg);var jg=class extends Laya.Box{};var{regClass:YM}=Laya,$g=class extends jg{constructor(){super(...arguments);this.isAddEvent=!1}set dataSource(e){super.dataSource=e,this.expressionItem=e,this.expressionItem&&(this.addEvent(),this.setCurrentOutPut())}async setCurrentOutPut(){let e=this.expressionItem.id;this.img_emoji.skin=S.instance.getEmoji(this.expressionItem.type,this.expressionItem.icon)}addEvent(){this.isAddEvent||(this.on(Laya.Event.CLICK,this,this.onCheck),this.isAddEvent=!0)}onCheck(){g.intance.event(f.EVENT_EMOJI_ICON_SELECT,this.expressionItem)}};$g=h([YM("UrCKcS-wTbm0LjT3KCsUYA")],$g);var Xg=class extends Laya.Box{};var{regClass:zM}=Laya,Qg=class extends Xg{set dataSource(e){super.dataSource=e,this.fontColorItem=e,this.fontColorItem&&this.setCurrentOutPut()}async setCurrentOutPut(){let e=this.fontColorItem.id;this.img_color.skin=S.instance.getFontColor(e)}onChange(e){}};Qg=h([zM("Vf8n1XGhQRK0Y2ndcK1U3g")],Qg);var Jg=class extends Laya.Dialog{};var{regClass:jM}=Laya,Zg=class extends Jg{constructor(){super(...arguments);this.m_strName="我是OpenSceneRuntime";this.m_iLayerType=C.M_POP;this.m_iPositionType=C.CENTER}setOpenData(e){e&&(this.roomDto=e[0])}onEnable(){g.intance.on(f.EVENT_Close_CreateRoom,this,this.onClose),this.btn_join.on(Laya.Event.CLICK,this,this.onJoin),this.initContainer()}onClose(){this.close()}onDisable(){g.intance.off(f.EVENT_Close_CreateRoom,this,this.onClose)}initContainer(){var e=_.intance.m_dicItems.get(this.roomDto.coinType),i=m.instance.getLanguage(e.name),a=_.intance.m_dicArenaDic.get(this.roomDto.arenaId);this.tf_roomName.text=m.instance.getLanguage(a.name),this.input_pwd.text=""}async onJoin(){let e=this.input_pwd.text;Ae.instance.onCreateAndJoinWithPwd(W.ACTION_JOIN,this.roomDto,e)}};Zg=h([jM("bn6StZy0ROGBH9GCTateCA")],Zg);var eL=class extends Laya.Scene{};var tL=class n{constructor(){this._inited=!1}static getInstance(){return n._instance||(n._instance=new n),n._instance}init(){this._inited||(this._inited=!0)}};var{regClass:$M}=Laya,tr=class extends eL{constructor(){super(...arguments);this.currIconAni=1;this.targetNumber=0;this.duration=2e3;this.updateInterval=30;this.currentValue=0;this.step=0}onAwake(){this.m_iLayerType=C.M_POP,this.m_iPositionType=C.UP,tL.getInstance().init()}async onOpened(e){this.mouseThrough=this.mouseThrough=!0,this.headBox.mouseThrough=!0;let i=this.getChildByName("mcMain");i&&(i.mouseThrough=!0),this.btn_fullScreen.visible=!1,this.updateTopInfo();var a=Laya.stage.width-z.DESIGN_WIDTH>>1;if(this.leftX=this.leftMenu.x,this.rightX=this.rightMenu.x,this.leftMenu.x=this.leftX-a-this.leftMenu.width,this.rightMenu.x=this.rightX+a+this.rightMenu.width,Laya.Tween.to(this.leftMenu,{x:this.leftX-a},500),Laya.Tween.to(this.rightMenu,{x:this.rightX+a},500),this.initBtnLanguage(),this.initBtnAni(),He.instance.sendCustumEvent(34),tr.M_B_FIRST_Open&&(z.bookingId&&Ae.instance.goBookingCreateRoomDialog(z.bookingId,z.teamId),v.requestPost("wxgame/sys/notice",{type:2},!0,!0).then(o=>{console.log(o);var l=o,l=o;if(l.list&&l.list.length>0){A.intance.openModule(y.NoticeDialog,[2,l]);return}})),tr.M_B_FIRST_Open=!1,!!b.instance.playerDto){var s=null;showChatBtn(!0,F.instance.walletAddress,s),this.refreshHeadRed(),this.refreshRankRed(),this.refreshIGORed(),this.refreshWheelRed()}}initBtnAni(){for(var e=1;e<6;e++){var i=this["spine_"+e];i.initUrl("gameIcon/effect/main/icon/icon"+e+"/spine.skel","animation",!0),i.visible=!1}Laya.timer.once(1e3,this,this.startBtnAni)}startBtnAni(){this.currIconAni>5&&(this.currIconAni=1),this["spine_"+this.currIconAni].play(0,!1),this["spine_"+this.currIconAni].visible=!0,this.currIconAni++,Laya.timer.once(2e3,this,this.startBtnAni)}changeMailFlag(){}updateTopInfo(){let e=b.instance.playerDto;if(!e)return;this.tf_roleName.text=e.name,this.levelTF.text=e.lv.toString(),e.needTip=!0,this.playerIcon.dataSource=e,this.updateExp(),this.changeMailFlag();let i=new Date(b.instance.m_serverTime);console.log("server time toLocaleString："+i.toLocaleString()),console.log("server time offset date："+b.instance.timeZoneOff/60/60),this.updateLocalAssets()}updateExp(){}requestAssets(){g.intance.event(f.UPDATE_ASSETS)}async updataBalence(){await F.instance.getBalance()}async updateAssets(){await Yn.instance.updateAssetsBalance()}updateLocalAssets(){this.tf_3005.text=xe.filterNumFormat(b.instance.getConsumeValue(ge.TYPE_GOLD),0)}onEnable(){for(let e=1;e<6;e++)this["btn_"+e].on(Laya.Event.CLICK,this,this.onClickTab,[e]),this["btn_"+e].on(Laya.Event.CLICK,this,this.onClickTab,[e]);this.btn_8.on(Laya.Event.CLICK,this,this.onClickTab,[1]),this.btn_roomInfo1.on(Laya.Event.CLICK,this,this.onClickRoomInfo,[1]),this.btn_roomInfo2.on(Laya.Event.CLICK,this,this.onClickRoomInfo,[2]),this.btn_roomInfo3.on(Laya.Event.CLICK,this,this.onClickRoomInfo,[3]),Laya.timer.loop(1e3,this,this.refreshRoomTime),this.showPrizePool(),Laya.timer.loop(6e4,this,this.showPrizePool),this.btn_shop.clickHandler=new Laya.Handler(this,this.onclickBtnHandler,[this.btn_shop]),this.btn_guild.clickHandler=new Laya.Handler(this,this.onclickBtnHandler,[this.btn_guild]),this.btn_lcPool.clickHandler=new Laya.Handler(this,this.onclickBtnHandler,[this.btn_lcPool]),this.btn_heroes.clickHandler=new Laya.Handler(this,this.onclickBtnHandler,[this.btn_heroes]),this.btn_backpack.clickHandler=new Laya.Handler(this,this.onclickBtnHandler,[this.btn_backpack]),this.btn_asset.clickHandler=new Laya.Handler(this,this.onclickBtnHandler,[this.btn_asset]),this.btn_scholarshop.clickHandler=new Laya.Handler(this,this.onclickBtnHandler,[this.btn_scholarshop]),this.btn_leaderboard.clickHandler=new Laya.Handler(this,this.onclickBtnHandler,[this.btn_leaderboard]),this.btn_social.clickHandler=new Laya.Handler(this,this.onclickBtnHandler,[this.btn_social]),this.btn_mail.clickHandler=new Laya.Handler(this,this.onclickBtnHandler,[this.btn_mail]),this.btn_activities.clickHandler=new Laya.Handler(this,this.onclickBtnHandler,[this.btn_activities]),this.btn_chat.clickHandler=new Laya.Handler(this,this.onclickBtnHandler,[this.btn_chat]),this.btn_igo.clickHandler=new Laya.Handler(this,this.onclickBtnHandler,[this.btn_igo]),this.btn_setting.clickHandler=new Laya.Handler(this,this.onclickBtnHandler,[this.btn_setting]),this.btn_fullScreen.clickHandler=new Laya.Handler(this,this.onclickBtnHandler,[this.btn_fullScreen]),g.intance.on(f.UPDATE_RED_STATE_EVENT,this,this.changeMailFlag),g.intance.on(f.ROLE_INFO_CHANGE,this,this.updateTopInfo),g.intance.on(f.UPDATE_ASSETS,this,this.updateAssets),g.intance.on(ti.UPDATE_LOCAL_WALLET_LIST_EVENT,this,this.updateLocalAssets),g.intance.on("CHANG_NAME",this,this.changeName),g.intance.on("open_buy",this,this.openBuyDialog),g.intance.on("msg_173",this,this.onFirstRecharge),g.intance.on("ACCOUNTVO_UPDATE",this,this.updateExp),g.intance.on(f.EVENT_ENTER_MATCH_ROOM,this,this.onEnterMatchRoom),this.initBtnBox(),this.box_Tele1.on(Laya.Event.CLICK,this,this.onBtnTele,[1]),this.box_Tele2.on(Laya.Event.CLICK,this,this.onBtnTele,[2]),this.box_Tele3.on(Laya.Event.CLICK,this,this.onBtnTele,[3]),this.box_Tele4.on(Laya.Event.CLICK,this,this.onBtnTele,[4]),this.btn_LiveChat.on(Laya.Event.CLICK,this,this.onBtnLiveChat,[4]),g.intance.on(f.REFRESH_MAINSCENE_HEAD_RED,this,this.refreshHeadRed),g.intance.on(f.REFRESH_ACTIVITY_RED,this,this.refreshRankRed),g.intance.on(f.REFRESH_IGO_RED,this,this.refreshRankRed),g.intance.on(f.REFRESH_ACTIVITY_RED,this,this.refreshIGORed),g.intance.on(f.REFRESH_WHEEL_RED,this,this.refreshWheelRed)}onClickRoomInfo(e){A.intance.openModule(y.RoomInfoDialog,[e])}onClickTab(e){e==1?(k.instance.arenaType=W.ARENA_TYPE_PROFESSIONAL,oe.intance.setCurrentScene(Y.M_SCENE_AIRDROP)):e==2?(k.instance.arenaType=W.ARENA_TYPE_AIRDROP,oe.intance.setCurrentScene(Y.M_SCENE_AIRDROP)):e==3?(k.instance.arenaType=W.ARENA_TYPE_TRAINING,oe.intance.setCurrentScene(Y.M_SCENE_AIRDROP)):e==4?(k.instance.arenaType=W.ARENA_TYPE_PVE,oe.intance.setCurrentScene(Y.M_SCENE_PVE)):e==5&&(k.instance.arenaType=W.ARENA_TYPE_TEAM,oe.intance.setCurrentScene(Y.M_SCENE_AIRDROP))}async showPrizePool(){let e=await v.requestPost("wxgame/loserTicket/loserBonusSummary",{});if(e){var i=e.bonus;i=Math.ceil(i),this.duration=i*100,this.duration>2e3?this.duration=2e3:this.duration<100&&(this.duration=100),this.animateNumber(i)}}animateNumber(e){Laya.timer.clear(this,this.addNumber),this.currentValue=0,this.targetNumber=e,this.step=this.targetNumber/(this.duration/this.updateInterval),Laya.timer.loop(this.updateInterval,this,this.addNumber)}addNumber(){this.currentValue+=this.step,this.currentValue>=this.targetNumber&&(this.currentValue=this.targetNumber,Laya.timer.clear(this,this.addNumber));var e=this.padNumber(Math.floor(this.currentValue),7),i=_.intance.m_dicItems.get(ge.TYPE_MNT);this.tf_poolAmount.text=e+" "+m.instance.getLanguage(i.name)}padNumber(e,i){return e.toString().padStart(i,"0")}refreshRoomTime(){this.refreshRoomBtnRed()}refreshRoomBtnRed(){this.img_red_1.visible=b.instance.getRedDotById(he.instance.ROOM_1_1)||b.instance.getRedDotById(he.instance.ROOM_1_2)||b.instance.getRedDotById(he.instance.ROOM_1_3)||b.instance.getRedDotById(he.ROOM_PRE_CONTRACT)||b.instance.getRedDotById(he.ROOM_PRE_CONTRACT_SELF),this.img_red_2.visible=b.instance.getRedDotById(he.instance.ROOM_2_1)||b.instance.getRedDotById(he.instance.ROOM_2_2)||b.instance.getRedDotById(he.instance.ROOM_2_3),this.img_red_3.visible=b.instance.getRedDotById(he.instance.ROOM_3_1)||b.instance.getRedDotById(he.instance.ROOM_3_2)||b.instance.getRedDotById(he.instance.ROOM_3_3),this.img_red_4.visible=b.instance.getRedDotById(he.instance.ROOM_4_6),this.img_red_5.visible=b.instance.getRedDotById(he.instance.ROOM_5_4)||b.instance.getRedDotById(he.instance.ROOM_5_4_SELF),this.Img_social.visible=b.instance.getRedDotById(he.ROOM_FRIEND_APPLY),this.red_mail.visible=b.instance.getRedDotById(he.ROOM_MAIL)||b.instance.getRedDotById(he.MAIL_ANNOUNCE_RED),this.red_guild.visible=b.instance.getRedDotById(he.RED_GUILD_APPLY),this.img_red_shields.visible=b.instance.getRedDotById(he.RED_SHIELDS)||b.instance.getRedDotById(he.ROOM_OFFER_CARD)||b.instance.getRedDotById(he.RED_RENTAL)}refreshHeadRed(){this.img_headRed.visible=b.instance.getRedDotById(he.RED_ACTIVITY1)||b.instance.getRedDotById(he.RED_ACTIVITY2)||b.instance.getRedDotById(he.RED_ACTIVITY3)}refreshRankRed(){this.img_rankRed&&(this.img_rankRed.visible=b.instance.getRedDotById(he.RED_EVERY_RANK_TOTAL)||b.instance.getRedDotById(he.RED_EVERY_RANK_PRE)||b.instance.getRedDotById(he.RED_EVERY_RANK_AIR)||b.instance.getRedDotById(he.RED_EVERY_RANK_TRA)||b.instance.getRedDotById(he.PRO_RANK_DAY_FIGHT_1)||b.instance.getRedDotById(he.PRO_RANK_DAY_FIGHT_2)||b.instance.getRedDotById(he.PRO_RANK_DAY_FIGHT_3)||b.instance.getRedDotById(he.PRO_RANK_DAY_FIGHT_4))}refreshIGORed(){this.img_igored&&(this.img_igored.visible=b.instance.getRedDotById(he.RED_IGO))}refreshWheelRed(){this.img_wheelRed&&(this.img_wheelRed.visible=b.instance.getRedDotById(he.RED_WHEEL))}onFirstRecharge(e){}initBtnBox(){this.sortIconView()}sortIconView(){}async onclickBtnHandler(e){switch(e){case this.btn_shop:oe.intance.setCurrentScene(Y.M_SCENE_SHOP);break;case this.btn_heroes:oe.intance.setCurrentScene(Y.M_SCENE_HERO);break;case this.btn_backpack:oe.intance.setCurrentScene(Y.M_SCENE_KNAPSACK);break;case this.btn_social:{oe.intance.setCurrentScene(Y.M_SCENE_FRIEND);break}case this.btn_mail:oe.intance.setCurrentScene(Y.M_SCENE_MAIL);break;case this.btn_lcPool:oe.intance.setCurrentScene(Y.M_SCENE_LCPOOL);break;case this.btn_guild:b.instance.playerDto.union>0?oe.intance.setCurrentScene(Y.M_SCENE_MYUNION,b.instance.playerDto.union):oe.intance.setCurrentScene(Y.M_SCENE_UNION);break;case this.btn_setting:A.intance.openModule(y.GameSettingLanguageDialog);break;case this.btn_fullScreen:Le.fullScreen(!Le.isFullScreen);break;case this.btn_friend:A.intance.openModule(y.FriendMemberDialog);break;case this.btn_asset:oe.intance.setCurrentScene(Y.M_SCENE_ASSET);break;case this.btn_scholarshop:oe.intance.setCurrentScene(Y.M_SCENE_SHOLARSHIP);break;case this.btn_chat:this.Img_tele.visible||(this.Img_tele.visible=!0,Laya.stage.on(Laya.Event.MOUSE_DOWN,this,this.onHideList));break;case this.btn_leaderboard:oe.intance.setCurrentScene(Y.M_SCENE_RANK);break;case this.btn_igo:oe.intance.setCurrentScene(Y.M_SCENE_IGO_PAGE);break;case this.btn_activities:oe.intance.setCurrentScene(Y.M_SCENE_DAILY_TASK);break;default:E.instance.notice(m.instance.getLanguage(12));break}}openBuyDialog(e){switch(parseInt(e)){case 3:this.buyGoldBtn();break;case 4:this.clickRecharge();break}}onHideList(){this.Img_tele.visible=!1,Laya.stage.off(Laya.Event.MOUSE_DOWN,this,this.onHideList)}clickRecharge(){if(z.m_bInstantGame==!0){let e=m.instance.getLanguage(500004);pe.instance().AlertByType(P.BASEALERTVIEW,e,P.YES);return}g.intance.event(f.EVENT_OPEN_MODULE,[y.RechargeDialog])}changeName(e){}buyGoldBtn(){g.intance.event(f.EVENT_OPEN_MODULE,[y.GetMoreDialog])}onDisable(){g.intance.off(f.UPDATE_RED_STATE_EVENT,this,this.changeMailFlag),g.intance.off(f.ACCOUNTVO_UPDATE,this,this.updateExp),g.intance.off(f.ROLE_INFO_CHANGE,this,this.updateTopInfo),g.intance.off(f.UPDATE_ASSETS,this,this.updateAssets),g.intance.off(ti.UPDATE_LOCAL_WALLET_LIST_EVENT,this,this.updateLocalAssets),g.intance.off("CHANG_NAME",this,this.changeName),g.intance.off("open_buy",this,this.openBuyDialog),g.intance.off("msg_173",this,this.onFirstRecharge),g.intance.off(f.EVENT_ENTER_MATCH_ROOM,this,this.onEnterMatchRoom),g.intance.off(f.REFRESH_MAINSCENE_HEAD_RED,this,this.refreshHeadRed),g.intance.off(f.REFRESH_ACTIVITY_RED,this,this.refreshIGORed),g.intance.off(f.REFRESH_WHEEL_RED,this,this.refreshWheelRed),g.intance.offAllCaller(this),Laya.Tween.clearAll(this),Laya.timer.clearAll(this),showChatBtn(!1)}onEnterMatchRoom(e){e?Laya.timer.once(2e3,this,this.startBtnAni):Laya.timer.clear(this,this.startBtnAni)}onBtnTele(e){let i=_.intance.getOtcTelegrams(e),a=i.telegram;i&&(z.isInto?(doCopy(a),E.instance.notice(m.instance.getLanguage(1552))):window.open(a,"_blank"))}onBtnLiveChat(){doChatMax()}initBtnLanguage(){}};tr.M_B_FIRST_Open=!0,tr=h([$M("pxhiJrX5SkKKvyFr8uIlNA")],tr);var iL=class extends Laya.Box{};var{regClass:XM}=Laya,aL=class extends iL{constructor(){super();this.isAddEvent=!1}onEnable(){g.intance.on(f.EVENT_Game_Delay,this,this.onGameDelay)}onGameDelay(e){var i=_.intance.getGeneralValueById(6),a=i[0],r=i[1];this.tf_delay.text=e+"ms",e>r?(this.img_delay.skin="res/common/comm/img_com_xinhao3.png",this.tf_delay.color=ki.RED):e>a?(this.img_delay.skin="res/common/comm/img_com_xinhao2.png",this.tf_delay.color=ki.YELLOW):(this.img_delay.skin="res/common/comm/img_com_xinhao1.png",this.tf_delay.color=ki.GREEN)}onDisable(){g.intance.off(f.EVENT_Game_Delay,this,this.onGameDelay)}};aL=h([XM("AhgzWGWoRFetvSMsEOSkSg")],aL);var nL=class extends Laya.Box{};var{regClass:QM}=Laya,rL=class extends nL{constructor(){super();this.showAdd=!1;this.isAddEvent=!1}createChildren(){super.createChildren()}addEvent(){this.isAddEvent||(this.on(Laya.Event.CLICK,this,this.toDetail),this.isAddEvent=!0)}set dataSource(e){super.dataSource=e,this.playerDto=e,this.playerDto&&(this.addEvent(),this.setCurrentOutPut())}set headSkin(e){parseInt(e)>0?this.img_head.skin=S.instance.getPlayerIcon(e):this.setImage(e)}async setCurrentOutPut(){if(!this.playerDto)return;let e=this.playerDto.icon;parseInt(e)>0?this.img_head.skin=S.instance.getPlayerIcon(e):this.setImage(e)}setImage(e){this.clearImage();var i=this;Laya.loader.load(e,Laya.Handler.create(this,()=>{i.destroyed||(this.img_head.skin=e)}),null,Laya.Loader.IMAGE,-1,!0,"1111",!1,!1)}clearImage(){this.img_head&&(this.img_head.texture=null)}destroy(e=!0){this.clearImage(),super.destroy(e)}toDetail(){!this.playerDto||!this.playerDto.needTip||A.intance.openModule(y.RoleInfoDialog)}};rL=h([QM("OPT5t2CoSmuYp2zUJWwUWA")],rL);var sL=class extends Laya.Box{};var{regClass:JM}=Laya,oL=class extends sL{constructor(){super();this.isAddEvent=!1}addEvent(){this.isAddEvent||(this.btn_watch.on(Laya.Event.CLICK,this,this.onWatch),this.btn_join.on(Laya.Event.CLICK,this,this.onJoin),this.btn_view.on(Laya.Event.CLICK,this,this.onView),this.btn_invite.on(Laya.Event.CLICK,this,this.onInvite),this.btn_copy.on(Laya.Event.CLICK,this,this.onCopy),this.isAddEvent=!0)}onCopy(){var e=0,i=this.roomDto.teamDto;i&&(e=i.teamId);var o=this.roomDto.roomId;let a=Ae.instance.onGetNewUrl(o,e);var r=b.instance.playerDto.name,s=B.instance.setRoomAnonymousLabel(this.roomDto.roomName,this.roomDto.anonymous),o=this.roomDto.roomId,l;e?l=m.instance.getLanguage(1630,r,s,o,e,a):l=m.instance.getLanguage(1563,r,s,o,a),doCopy(l),E.instance.notice(m.instance.getLanguage(132))}onEnable(){}async onWatch(){Ae.instance.onCreateAndJoinWithPwd(W.ACTION_WATCH,this.roomDto,"")}onInvite(){var e=this.roomDto.roomId,i=this.roomDto.teamDto.teamId;A.intance.openModule(y.MyFriendDialog,[e,i])}onView(){this.roomDto.startTime>0?this.roomDto.groupId?A.intance.openModule(y.TeamInfoDialog,this.roomDto.roomId):Ae.instance.goBookingCreateRoomDialog(this.roomDto.roomId):Ae.instance.goMatchCreateRoomDialog(this.roomDto.roomId)}async onJoin(){this.roomDto.startTime>0?Ae.instance.goBookingCreateRoomDialog(this.roomDto.roomId):Ae.instance.goMatchCreateRoomDialog(this.roomDto.roomId)}set dataSource(e){super.dataSource=e,this.roomDto=e,this.roomDto&&(this.addEvent(),this.setCurrentOutPut())}async setCurrentOutPut(){if(this.roomDto.leader){let r=this.roomDto.leader.icon;this.playerIcon.headSkin=r,this.tf_union.text=B.instance.setRoomAnonymousLabel(m.instance.getMultiLan(this.roomDto.leader.shortUnionName),this.roomDto.anonymous)}this.btn_watch.disabled=this.roomDto.closeLive==1&&b.instance.playerDto.watchStatus==0,this.tf_name.text=B.instance.setRoomAnonymousLabel(this.roomDto.roomName,this.roomDto.anonymous),this.tf_customName.text=this.roomDto.customName,this.roomDto.customName?this.tf_union.y=66:this.tf_union.y=56;var e=_.intance.m_dicArenaDic.get(this.roomDto.arenaId);if(e?this.tf_arenaName.text=m.instance.getLanguage(e.name):this.tf_arenaName.text="",this.roomDto.groupId){var i=_.intance.m_dicGroupWar.get(this.roomDto.groupId);this.tf_groupName.text=m.instance.getLanguage(i.name),this.tf_teamTitle.visible=!0,this.roomDto.state==W.STATE_START?(this.tf_people.text='<font color="#25ff63">'+this.roomDto.memberCount+"</font>",this.box_people.visible=!0,this.box_team.visible=!1):(this.tf_teamNum.text='<font color="#25ff63">'+this.roomDto.completeTeamNum+"</font>",this.box_people.visible=!1,this.box_team.visible=!0)}else this.tf_groupName.text="",this.tf_people.text='<font color="#25ff63">'+this.roomDto.memberCount+"</font>/"+this.roomDto.maxCount,this.box_people.visible=!0,this.box_team.visible=!1,this.tf_teamTitle.visible=!1;this.img_coin.visible=this.roomDto.coinType!=ge.TYPE_GOLD,this.img_coin.skin=S.instance.getMoneyIcon(this.roomDto.coinType);var a=_.intance.m_dicNodes.get(this.roomDto.nodeId);this.nodeDelaySign.dataSource=a,this.roomDto.startTime>0?(this.roomDto.closeLive!=1&&b.instance.playerDto.watchStatus==0&&(this.btn_watch.disabled=!0),this.box_booking.visible=!0,this.box_match.visible=!1,this.roomDto.groupId?(this.btn_join.visible=!1,this.btn_view.visible=!0,this.btn_invite.visible=!1):(this.btn_join.visible=!0,this.btn_view.visible=!1,this.btn_invite.visible=!1,this.img_suo.visible=this.roomDto.requirePass),this.img_underway.visible=!1,this.tf_utc_startTime.text=se.formatTimeStamp(this.roomDto.startTime,"MT-DD HH:MM",!0),this.tf_local_startTime.text=se.formatTimeStamp(this.roomDto.startTime,"MT-DD HH:MM")):(this.btn_view.visible=!1,this.btn_invite.visible=!1,(this.roomDto.closeLive!=1||b.instance.playerDto.watchStatus==1)&&(this.btn_watch.disabled=!1),this.box_booking.visible=!1,this.box_match.visible=!0,this.roomDto.state!=W.STATE_START?(this.btn_join.visible=!0,this.img_underway.visible=!1,this.tf_seconds.text=se.format(Math.round(this.roomDto.joinCd/1e3),":",!1),this.img_suo.visible=this.roomDto.requirePass):(this.btn_join.visible=!1,this.img_underway.visible=!0,this.tf_seconds.text=se.format(Math.round(this.roomDto.fightEndTime/1e3),":",!1)))}};oL=h([JM("mjmIj9QnSdSPVSuOSeBiLw")],oL);var lL=class extends Laya.Dialog{};var{regClass:ZM}=Laya,cL=class extends lL{constructor(){super(...arguments);this.m_strName="我是OpenSceneRuntime";this.m_iLayerType=C.M_POP;this.m_iPositionType=C.CENTER;this.arenaIndex=1;this.roomInfoData=[["Acquire NFTs: Attain NFTs through the guildís scholarship program, or opt to lease or purchase your own.","Use Professional Tickets: Enter the arena with the Professional Arena Tickets youíve won or purchase actual tickets to amplify your earning potential.","Earnings and Advancement: Compete for major tokens and elevate your gameplay in the Professional Arena, where the stakes are higher and the rewards greater."],["Guild Support: Utilize the NFTs provided by your guild and the Airdrop Arena Tickets you've accumulated to compete.","Climb the Ladder: Demonstrate your abilities in the Airdrop Arena to win Professional Arena Tickets."],["Engage with In-Game NFTs: Start by playing with the gameís NFTs to discover your preferred playstyle and learn the game mechanics in different arena levels.","Skill Improvement: As you play, you'll enhance your abilities and gain experience.","Earn Free Airdrop Arena Tickets: Participate in the Training Arena to earn Airdrop Arena Tickets at no cost.","Level Up and Join a Guild: Progress through skill levels and become part of a guild to access community support and resources."]];this.roomInfoDataZn=[["獲取NFT遊戲角色：經由遊戲公會獎學金獲得或自行購買","專業競技場門票功能：使用專業競技場門票可增加獲勝概率","獎勵：專業競技場內，槓桿更多倍，獎勵更豐厚"],["公會支持：公會可為玩家提供空投競技場門票和NFT贊助","競技攀峰：在空投競技場獲勝玩家可免費獲得專業競技場門票"],["遊戲NFT：選擇遊戲內適合的NFT探索適合自己的競技模式，並了解遊戲機制","技能提升：隨著練習深入，競技技能不斷提升","免費獲得空投競技場門票：在新手練習場打比賽，可免費獲得空投競技場門票","加入公會：選擇一個公會加入，以獲得更多社區和道具支持"]];this.titleData=["Professional Arena","Airdrop Arena","Beginnerís Training Arena"];this.titleDataZn=["專業競技場","空投競技場","新手練習場"];this.playForData=["(Play-to-Earn)","(Play-to-Win)","(Free-to-Play)"];this.playForDataZn=["(邊玩邊賺)","(赢即是赚)","(0門檻)"]}setOpenData(e){e&&(console.log(e),this.arenaIndex=e[0],this.initContainer())}onEnable(){this.btn_join.on(Laya.Event.CLICK,this,this.onClickJoin)}onClose(){this.close()}onDisable(){this.btn_join.off(Laya.Event.CLICK,this,this.onClickJoin)}initContainer(){let e=Laya.LocalStorage.getItem(z.COOKIE_CF_LAN),i=e=="zh"?this.roomInfoDataZn:this.roomInfoData,a=e=="zh"?this.titleDataZn:this.titleData,r=e=="zh"?this.playForDataZn:this.playForData,s=i[this.arenaIndex-1];this.tf_tittle.text=a[this.arenaIndex-1],this.tf_playFor.text=r[this.arenaIndex-1];for(let o=1;o<5;o++){let l=this["tf_"+o],c=s[o-1];l&&c?(l.text=c,l.visible=!0):l.visible=!1}}onClickJoin(){k.instance.arenaType=this.arenaIndex,oe.intance.setCurrentScene(Y.M_SCENE_AIRDROP),this.close()}};cL=h([ZM("KgOqc2ShT_q7kN9EyT8fqQ")],cL);var uL=class extends Laya.Box{};var{regClass:eR}=Laya,mL=class extends uL{constructor(){super();this.isAddEvent=!1}addEvent(){this.isAddEvent||(this.btn_watch.on(Laya.Event.CLICK,this,this.onWatch),this.btn_join.on(Laya.Event.CLICK,this,this.onJoin),this.isAddEvent=!0)}onEnable(){}async onWatch(){Ae.instance.onCreateAndJoinWithPwd(W.ACTION_WATCH,this.roomDto,"")}async onJoin(){if(this.roomDto.requirePass){var e=_.intance.m_dicNodes.get(this.roomDto.nodeId);if(e&&e.dT>800&&z.Debug<2){E.instance.notice(m.instance.getLanguage(1306));return}A.intance.openModule(y.InputPwdDialog,[this.roomDto])}else Ae.instance.onCreateAndJoinWithPwd(W.ACTION_JOIN,this.roomDto,"")}set dataSource(e){super.dataSource=e,this.roomDto=e,this.roomDto&&(this.roomDto.state==0?(this.btn_join.visible=!0,this.img_underway.visible=!1,this.img_suo.visible=this.roomDto.requirePass):(this.btn_join.visible=!1,this.img_underway.visible=!0),this.addEvent(),this.setCurrentOutPut())}async setCurrentOutPut(){let e="10001";this.roomDto.leader&&(e=this.roomDto.leader.icon),this.playerIcon.headSkin=e,this.tf_name.text=B.instance.setRoomAnonymousLabel(this.roomDto.roomName,this.roomDto.anonymous),this.tf_customName.text=this.roomDto.customName,this.roomDto.customName?this.tf_name.y=19:this.tf_name.y=35,this.btn_watch.disabled=this.roomDto.closeLive==1&&b.instance.playerDto.watchStatus==0,this.roomDto.leader?this.tf_union.text=B.instance.setRoomAnonymousLabel(m.instance.getMultiLan(this.roomDto.leader.shortUnionName),this.roomDto.anonymous):this.tf_union.text="",this.tf_people.text='<font color="#25ff63">'+this.roomDto.memberCount+"</font>/"+this.roomDto.maxCount,this.img_coin.visible=this.roomDto.coinType!=ge.TYPE_GOLD,this.img_coin.skin=S.instance.getMoneyIcon(this.roomDto.coinType);var i=_.intance.m_dicNodes.get(this.roomDto.nodeId);this.nodeDelaySign.dataSource=i,this.roomDto.state!=10?(this.btn_join.visible=!0,this.img_underway.visible=!1,this.tf_seconds.text=se.format(Math.round(this.roomDto.joinCd/1e3),":",!1),this.img_suo.visible=this.roomDto.requirePass):(this.btn_join.visible=!1,this.img_underway.visible=!0,this.tf_seconds.text=se.format(Math.round(this.roomDto.fightEndTime/1e3),":",!1))}};mL=h([eR("YoCqj_dyTb2ZIAnhkSds6Q")],mL);var pL=class extends Laya.Box{};var{regClass:tR}=Laya,hL=class extends pL{onEnable(){}notice(e){this.duration=3e3,this.elapsed=0;let i=e;this.label_tf.text=e,console.log("notice: ",e),this.image_bg.width=this.label_tf.textField.textWidth,this.alpha=1,this.visible=!0}get view(){return this}get width(){return this.image_bg.width}update(){this.elapsed+=Laya.timer.delta,this.elapsed>=this.duration&&(this.alpha-=.05,this.alpha<=0&&(this.alpha=0))}isFinished(){return this.alpha<=0}onDisable(){console.log("specialBarrageSpr recover"),Laya.Pool.recover("specialBarrageSpr",this)}};hL=h([tR("O1TfP9clQWS0Yda38eJPHQ")],hL);var dL=class extends Laya.Box{};var{regClass:iR}=Laya,fL=class extends dL{constructor(){super();this.isAddEvent=!1}createChildren(){super.createChildren()}addEvent(){this.isAddEvent||(this.on(Laya.Event.CLICK,this,this.toDetail),this.isAddEvent=!0)}set dataSource(e){if(super.dataSource=e,!!e){if(this.banAccountVo=e,this.roomPlayerDto=this.banAccountVo.roomPlayerDto,this.img_checked.visible=this.banAccountVo.checked,!this.roomPlayerDto){this.img_back.skin="res/matchReady/img_jjc_0.png",this.box_show.visible=!1;return}this.addEvent(),this.setCurrentOutPut()}}async setCurrentOutPut(){if(this.img_back.skin="res/matchReady/img_jjc_1.png",this.tf_name.text=Me.abbreviateString(this.roomPlayerDto.name),this.box_show.visible=!0,this.destroyed)return;let e=this.roomPlayerDto.icon;this.playerIcon.headSkin=e,this.img_sign.visible=this.roomPlayerDto.leader>0,this.tf_banned.visible=this.banAccountVo.isBanned,this.playerIcon.gray=this.banAccountVo.isBanned}toDetail(){console.log("this.banAccountVo.checked: "+this.banAccountVo.checked),this.banAccountVo.isBanned||(this.banAccountVo.checked=!this.banAccountVo.checked),g.intance.event(f.EVENT_REFRESH_BAN_ACCOUNT)}};fL=h([iR("Ic8NGg94R9ufEgwwaCKQlw")],fL);var yL=class{};var bL=class extends Laya.Dialog{};var{regClass:aR}=Laya,Sc=class extends bL{constructor(){super(...arguments);this.m_strName="我是OpenSceneRuntime";this.m_iLayerType=C.M_PANEL;this.m_iPositionType=C.CENTER;this.allPlayerNum=0;this.selectedNum=0}onEnable(){g.intance.on(f.EVENT_REFRESH_BAN_ACCOUNT,this,this.onRefreshPlayer),this.btn_back.on(Laya.Event.CLICK,this,this.onBack),this.btn_ban.on(Laya.Event.CLICK,this,this.onBanPlayer),this.btn_checkBox.on(Laya.Event.CLICK,this,this.onSelectAll),this.list_hero.array=[]}onOpened(e){this.getBanAccounts()}async getBanAccounts(){let e=B.instance.matchDto.members.filter(u=>u.id!==b.instance.playerDto.pid&&!u.npc).map(u=>u.id),i=await v.requestPost("wxgame/player/checkPlayerStatus",{pids:e});var a=[];i&&(a=i.data);let r=a.length;this.playerDatas=[];for(var s=0;s<r;s++){var o=a[s],l=new yL,c=k.instance.matchHeroDic.get(o.pid);l.roomPlayerDto=c,l.checked=!1,l.isBanned=o.status==1,this.playerDatas.push(l)}this.list_hero.array=this.playerDatas,this.updateNum()}onRefreshPlayer(){this.list_hero.refresh(),this.updateNum()}updateNum(){!this.playerDatas||this.playerDatas.length<=0?this.noDataBox.visible=!0:this.noDataBox.visible=!1,this.selectedNum=0,this.playerDatas.forEach(e=>{e&&e.checked&&this.selectedNum++}),this.allPlayerNum=this.playerDatas.length,this.tf_myHeroesNum.text=m.instance.getLanguage(1355,this.playerDatas.length),this.tf_selectedNum.text=m.instance.getLanguage(1223,this.selectedNum)}onSelectAll(){var e=this.btn_checkBox.selected;e&&this.playerDatas.forEach(i=>{i&&(i.checked=!1)}),this.playerDatas.forEach(i=>{i&&(i.isBanned||(i.checked=e))}),this.list_hero.refresh(),this.updateNum()}onBack(){this.close()}onBanPlayer(){var e=[];this.playerDatas.forEach(i=>{if(i.checked){var a=i.roomPlayerDto;e.push(a.id)}}),e.length>0?pe.instance().AlertByType(P.BASEALERTVIEW,m.instance.getLanguage(1779),P.CANCEL,Laya.Handler.create(this,this.onBanPlayerReal,[e])):E.instance.notice(m.instance.getLanguage(1780))}async onBanPlayerReal(e){let i=await v.requestPost("wxgame/player/killPlayers",{killPidList:e});if(i){var a=i.killPidList;this.playerDatas.forEach(r=>{r&&(r.checked=!1,a.includes(r.roomPlayerDto.id)&&(r.isBanned=!0))}),this.btn_checkBox.selected=!1,this.onRefreshPlayer()}}onDisable(){this.removeEvent()}removeEvent(){g.intance.off(f.EVENT_REFRESH_BAN_ACCOUNT,this,this.onRefreshPlayer)}};Sc.chooseNum=0,Sc=h([aR("MyYi8OCtTGGZZdRjMdMAJw")],Sc);var gL=class extends Laya.Box{};var{regClass:nR}=Laya,Mt=class extends gL{init(t,e,i=28){var a,r;switch(t!=0?(r=gt.getRandInRound(-30,30),e&&e.bj?a=Mt.TYPE_Critical:a=Mt.TYPE_Normal):(r=gt.getRandInRound(-30,30),a=Mt.TYPE_Miss),e?this.pos(r,-180):this.pos(r,-220),this.alpha=1,this.scale(1,1),this.tf_damage.visible=!1,this.box_crit.visible=!1,this.img_miss.visible=!1,a){case Mt.TYPE_Normal:this.tf_damage.text=t+"",this.showNormalDamageEffect();break;case Mt.TYPE_Critical:this.fontClip_damage.value=t+"",this.showCriticalDamageEffect();break;case Mt.TYPE_Miss:this.showMissEffect();break;default:break}}showNormalDamageEffect(){this.tf_damage.visible=!0,Laya.Tween.to(this,{y:this.y-50,alpha:0},1e3,Laya.Ease.linearNone,Laya.Handler.create(this,this.onComplete))}showCriticalDamageEffect(){this.box_crit.visible=!0,this.scale(.2,.2),Laya.Tween.to(this,{scaleX:1.3,scaleY:1.3,alpha:1,y:this.y-70},500,Laya.Ease.linearNone,Laya.Handler.create(this,()=>{Laya.Tween.to(this,{scaleX:1,scaleY:1,alpha:0},500,Laya.Ease.linearNone,Laya.Handler.create(this,()=>{this.onComplete()}))}))}showMissEffect(){this.img_miss.visible=!0,Laya.Tween.to(this,{y:this.y-50,alpha:0},1e3,Laya.Ease.linearNone,Laya.Handler.create(this,()=>{this.onComplete()}))}onComplete(){this.removeSelf()}onDisable(){Laya.Pool.recover("damageNumber",this)}};Mt.WHITE="#FFFFFF",Mt.ORANGE="#FFA500",Mt.RED="#FF0000",Mt.GREEN="#119c09",Mt.BLUE="#78cefd",Mt.TYPE_Normal="Normal",Mt.TYPE_Miss="Miss",Mt.TYPE_Critical="Critical",Mt=h([nR("nHp6WKzZRIWvyhguidEfqg")],Mt);var LL=class extends Laya.Box{};var{regClass:rR}=Laya,_L=class extends LL{constructor(){super();this.isAddEvent=!1}createChildren(){super.createChildren()}addEvent(){this.isAddEvent||(this.on(Laya.Event.CLICK,this,this.toDetail),this.isAddEvent=!0)}set dataSource(e){super.dataSource=e;var i=e;if(this.roomPlayer=B.instance.playerJoinDic.get(i),!this.roomPlayer){this.img_back.skin="res/matchReady1/img_com_kawenhao.png",this.box_show.visible=!1;return}this.addEvent(),this.setCurrentOutPut()}async setCurrentOutPut(){var e=this.parent.parent.parent,i=e.roomGroup.no;if(this.img_back.skin="res/matchReady1/img_com_ka"+i+".png",this.tf_name.text=B.instance.setRoomAnonymousLabel(Me.abbreviateString(this.roomPlayer.name)),this.tf_name.color=Ct.noColors[i-1],this.box_show.visible=!0,this.destroyed)return;let a=this.roomPlayer.icon;this.playerIcon.headSkin=a,this.img_sign.visible=this.roomPlayer.leader>0,this.tf_union.text=B.instance.setRoomAnonymousLabel(m.instance.getMultiLan(this.roomPlayer.shortUnionName))}toDetail(){this.roomPlayer.id&&g.intance.event(f.EVENT_CLICK_HERO,this.roomPlayer.name)}};_L=h([rR("560IbDG_RiaXc5KU8Mfx8Q")],_L);var vL=class extends Laya.Box{};var{regClass:sR}=Laya,xL=class extends vL{constructor(){super();this.isAddEvent=!1}addEvent(){this.isAddEvent||(this.isAddEvent=!0)}set dataSource(e){super.dataSource=e,this.roomGroup=e,this.roomGroup&&(this.addEvent(),this.setCurrentOutPut())}async setCurrentOutPut(){this.img_bg.skin="res/matchReady1/img_com_di"+this.roomGroup.no+".png",this.img_bar.skin="res/matchReady1/img_com_bt"+this.roomGroup.no+".png",this.img_flag.skin=S.instance.getTeamFlag(this.roomGroup.no);var e=_.intance.m_dicTeamName.get(this.roomGroup.no);this.tf_teamName.text=m.instance.getLanguage(e.teamName),this.list_members.array=this.roomGroup.members}};xL=h([sR("Wq7qINYUQWu8m5w93OSbdg")],xL);var IL=class extends Laya.Box{};var{regClass:oR}=Laya,EL=class extends IL{set dataSource(t){if(super.dataSource=t,!!t){var e=t[0];this.tf_groupNum.text=m.instance.getLanguage(1364,e);for(var i=t[1],a=0;a<4;a++){var r=i[a],s=this["listItem_"+(a+1)],o=this["img_line_"+(a+1)];r?(s&&(s.visible=!0,s.dataSource=r),o&&(o.visible=!0)):(s&&(s.visible=!1),o&&(o.visible=!1))}}}};EL=h([oR("nt2hpNSsSwWkkun3CZxOCg")],EL);var wL=class extends Laya.Box{};var{regClass:lR}=Laya,TL=class extends wL{constructor(){super();this.isAddEvent=!1}addEvent(){this.isAddEvent||(this.isAddEvent=!0)}set dataSource(e){super.dataSource=e,this.roomGroupDataDto=e,this.roomGroupDataDto&&(this.roomRankPlayerDto=B.instance.playerEndDic.get(this.roomGroupDataDto.pid),this.addEvent(),this.setCurrentOutPut())}async setCurrentOutPut(){this.tf_name.text=Me.abbreviateString(this.roomRankPlayerDto.name);let e=this.roomRankPlayerDto.icon;this.playerIcon.headSkin=e,this.tf_rank.text=m.instance.getLanguage(1365,this.roomRankPlayerDto.rankNum);var i=this.roomGroupDataDto.reward;if(i&&i.length>0){var a=i[0];this.img_reward_icon.skin=S.instance.getItemIcon(a.id),this.tf_reward_num.text=a.count+"",this.box_reward.visible=!0}else this.box_reward.visible=!1;var r=this.roomGroupDataDto.pid==b.instance.playerDto.pid,s=r?"#ffce58":"#96d2fc";this.tf_name.color=this.tf_rank.color=this.tf_reward_num.color=s,this.isFirst=this.roomGroupDataDto.rank==1}set isFirst(e){this.img_no1.visible=e}toDetail(){}};TL=h([lR("aVUehRpFSl-pkUZJISXahg")],TL);var CL=class extends Laya.Box{};var{regClass:cR}=Laya,SL=class extends CL{constructor(){super();this.isAddEvent=!1}addEvent(){this.isAddEvent||(this.isAddEvent=!0)}set dataSource(e){super.dataSource=e,this.roomRankPlayerDto=e,this.roomRankPlayerDto&&(this.addEvent(),this.setCurrentOutPut())}async setCurrentOutPut(){this.roomRankPlayerDto.id==b.instance.playerDto.pid?this.bg.skin="res/matchRank1/img_ranking_bg_me.png":this.roomRankPlayerDto.rankNum<4?this.bg.skin="res/matchRank1/img_ranking_bg_"+this.roomRankPlayerDto.rankNum+".png":this.bg.skin="res/matchRank1/img_ranking_bg_4.png",this.roomRankPlayerDto.rankNum<4?(this.img_rankIcon1.skin="res/matchRank1/img_ranking_"+this.roomRankPlayerDto.rankNum+".png",this.img_rankIcon1.visible=!0,this.img_rankIcon2.visible=!1):(this.roomRankPlayerDto.id==b.instance.playerDto.pid?this.img_rankIcon2.skin="res/matchRank1/img_ranking_ranking_me.png":this.img_rankIcon2.skin="res/matchRank1/img_ranking_ranking_4.png",this.img_rankIcon2.visible=!0,this.img_rankIcon1.visible=!1);let e=this.roomRankPlayerDto.icon;this.playerIcon.headSkin=e,this.playerIcon.gray=this.roomRankPlayerDto.die,this.img_die.visible=this.roomRankPlayerDto.die,this.tf_name.text=this.roomRankPlayerDto.name,this.tf_rank.text=this.roomRankPlayerDto.rankNum+"",this.tf_kill.text=this.roomRankPlayerDto.kill+"",this.tf_score.text=this.roomRankPlayerDto.score+""}};SL=h([cR("vpTYNMB4TfGFK2gaXiPAeg")],SL);var DL=class extends Laya.Dialog{};var{regClass:uR}=Laya,AL=class extends DL{constructor(){super(...arguments);this.m_strName="我是OpenSceneRuntime";this.m_iLayerType=C.M_PANEL;this.m_iPositionType=C.CENTER;this.allItems=[]}onEnable(){this.btn_back.on(Laya.Event.CLICK,this,this.goMatchEnd);var e=B.instance.matchWatcher;e&&(this.btn_back.label=m.instance.getUILang("Exit"))}setOpenData(e){var i=e[0];this.groupData=e[1],this.mcLanList.vScrollBarSkin="",B.instance.playerEndDic=new le,i.forEach(r=>{if(B.instance.playerEndDic.set(r.id,r),r.id==b.instance.playerDto.pid){this.myRank=r;return}}),this.mcLanList.array=i;let a=-1;this.mcLanList.selectedIndex=a,this.showListEffect(),!k.instance.myPlayer||k.instance.myPlayer.hp>0?this.successAni.visible=!0:this.successAni.visible=!1,console.log("setOpenData",this.successAni.visible),He.instance.sendCustumEvent(43)}showListEffect(){this.allItems=[];for(var e=this.mcLanList.array.length,i=0;i<e;i++){var a=this.mcLanList.getCell(i);a?(a.skewX=.5,a.alpha=0,this.allItems.push(a),Laya.timer.once(100+i*500,this,this.startShowItem,[i],!1)):console.log("showListEffect _item is null")}}startShowItem(e){var i=this.allItems[e];if(i==null){console.log("no list item now");return}i.scaleX=0,i.alpha=0,this.mcLanList.tweenTo(e,500),Laya.Tween.to(i,{scaleX:1,alpha:1},100,Laya.Ease.circOut,null,0,!1)}goMatchEnd(){var e=B.instance.matchWatcher;e?this.setToAirdropScene():(A.intance.openModule(y.MatchEndView,[this.myRank,this.groupData]),this.close())}setToAirdropScene(){k.instance.arenaType=B.instance.matchDto.arenaType,oe.intance.setCurrentScene(Y.M_SCENE_AIRDROP)}onDisable(){this.removeEvent(),this.myRank=this.groupData=null}removeEvent(){Laya.Tween.clearAll(this),Laya.timer.clearAll(this)}};AL=h([uR("NlnToPI4TTuxIDhRKLPChg")],AL);var kL=class extends Laya.Box{};var{regClass:mR}=Laya,BL=class extends kL{constructor(){super();this.isAddEvent=!1}addEvent(){this.isAddEvent||(this.isAddEvent=!0)}set dataSource(e){if(super.dataSource=e,this.pid=e,!!this.pid){if(this.roomRankPlayerDto=B.instance.playerEndDic.get(this.pid),!this.roomRankPlayerDto){console.log("this.pid is null! ",this.pid);return}this.addEvent(),this.setCurrentOutPut()}}async setCurrentOutPut(){this.roomRankPlayerDto.id==b.instance.playerDto.pid?this.tf_name.color="#fff373":this.tf_name.color="#ffffff";let e=this.roomRankPlayerDto.icon;this.playerIcon.headSkin=e,this.playerIcon.gray=this.roomRankPlayerDto.die,this.img_die.visible=this.roomRankPlayerDto.die,this.tf_name.text=this.roomRankPlayerDto.name,this.tf_point.text=this.roomRankPlayerDto.score+""}};BL=h([mR("GW4SVqH4Qzu2Kd5pEN_0dQ")],BL);var ML=class extends Laya.Box{};var{regClass:pR}=Laya,RL=class extends ML{constructor(){super();this.isAddEvent=!1}addEvent(){this.isAddEvent||(this.isAddEvent=!0)}set dataSource(e){super.dataSource=e,this.roomTeamDataDto=e,this.roomTeamDataDto&&(this.addEvent(),this.setCurrentOutPut())}async setCurrentOutPut(){this.img_bg.skin="res/matchReady1/img_com_di"+this.roomTeamDataDto.no+".png",this.img_bar.skin="res/matchRank2/img_com_bt"+this.roomTeamDataDto.no+".png",this.roomTeamDataDto.rank<4?(this.img_rankIcon1.skin="res/matchRank1/img_ranking_"+this.roomTeamDataDto.rank+".png",this.img_rankIcon1.visible=!0,this.img_rankIcon2.visible=!1):(this.img_rankIcon2.skin="res/matchRank1/img_ranking_ranking_4.png",this.img_rankIcon2.visible=!0,this.img_rankIcon1.visible=!1),this.img_flag.skin=S.instance.getTeamFlag(this.roomTeamDataDto.no);var e=_.intance.m_dicTeamName.get(this.roomTeamDataDto.no);this.tf_teamName.text=m.instance.getLanguage(e.teamName),this.tf_rank.text=this.roomTeamDataDto.rank+"",this.tf_totalPoint.text=this.roomTeamDataDto.score+"",this.list_members.array=this.roomTeamDataDto.members}};RL=h([pR("u3XTNJZVS0eHpoM_8aiWdw")],RL);var PL=class extends Laya.Dialog{};var{regClass:hR}=Laya,NL=class extends PL{constructor(){super(...arguments);this.m_strName="我是OpenSceneRuntime";this.m_iLayerType=C.M_PANEL;this.m_iPositionType=C.CENTER}onEnable(){this.btn_back.on(Laya.Event.CLICK,this,this.goMatchEnd);var e=B.instance.matchWatcher;e&&(this.btn_back.label=m.instance.getUILang("Exit"))}setOpenData(e){var i=e[0];this.groupData=e[1],this.roomTeamDataDtos=e[2],this.groupId=e[3],B.instance.playerEndDic=new le,i.forEach(d=>{if(B.instance.playerEndDic.set(d.id,d),d.id==b.instance.playerDto.pid){this.myRank=d;return}});var a=_.intance.m_dicGroupWar.get(this.groupId),r=this.list_team.itemTemplate,s=this.list_team.spaceY,o=r.list_members.itemTemplate.height,l=a.groupPer,c=l*o+s*(l-1),u=r.list_members.y+c;console.log("listH: ",o,l,c,u);let p=()=>{var d=Laya.HierarchyParser.parse(this.list_team.itemRender,{skinBaseUrl:this._skinBaseUrl})[0];return d.list_members.height=c,d.img_bg.height=u,d.height=u,d.hideFlags=Laya.HideFlags.HideAndDontSave,d};this.list_team.createItem=p,this.list_team.array=this.roomTeamDataDtos,this.list_team.selectedIndex=-1,!k.instance.myPlayer||k.instance.myPlayer.hp>0?this.successAni.visible=!0:this.successAni.visible=!1,console.log("setOpenData",this.successAni.visible),He.instance.sendCustumEvent(43)}goMatchEnd(){var e=B.instance.matchWatcher;e?this.setToAirdropScene():(A.intance.openModule(y.MatchEndView,[this.myRank,this.groupData,this.groupId]),this.close())}setToAirdropScene(){k.instance.arenaType=B.instance.matchDto.arenaType,oe.intance.setCurrentScene(Y.M_SCENE_AIRDROP)}onDisable(){this.removeEvent(),this.myRank=this.groupData=null}removeEvent(){Laya.Tween.clearAll(this),Laya.timer.clearAll(this)}};NL=h([hR("46cneqM_QNq4VNWjm8AGdw")],NL);var OL=class extends Laya.Dialog{};var{regClass:dR}=Laya,HL=class extends OL{constructor(){super(...arguments);this.m_strName="我是OpenSceneRuntime";this.m_iLayerType=C.M_PANEL;this.m_iPositionType=C.CENTER;this.groupId=0;this.states=[W.MATCHEND_REWARD]}onEnable(){this.btn_next.on(Laya.Event.CLICK,this,this.onNext),this.btn_goBattle.on(Laya.Event.CLICK,this,this.setToAirdropScene),this.btn_abandon.on(Laya.Event.CLICK,this,this.onNext),this.btn_claim.on(Laya.Event.CLICK,this,this.onClaim),this.btn_help.on(Laya.Event.CLICK,this,this.onHelp),g.intance.on(f.EVENT_REFRESH_QUAN_STATUS,this,this.onRefreshQuan),He.instance.sendCustumEvent(43)}onHelp(){Le.commTipWithYes(m.instance.getLanguage("HELP"))}onNext(){this.states.indexOf(W.MATCHEND_REWARD)!=-1?(this.states=this.states.filter(e=>e!==W.MATCHEND_REWARD),this.states.length>0?this.btn_next.label=m.instance.getUILang("Next"):this.btn_next.label=m.instance.getUILang("Go Battle"),this.btn_next.x=this.box_outside.width-this.btn_next.width>>1):this.states.indexOf(W.MATCHEND_QUAN)!=-1?(this.states=this.states.filter(e=>e!==W.MATCHEND_QUAN),this.box_quan.visible=!0,this.box_pvp.visible=!1,this.box_pve.visible=!1,this.list_reward.visible=!1,this.noDataBox1.visible=!1,this.btn_next.visible=!1):this.states.indexOf(W.MATCHEND_DIEJIA)!=-1?(this.states=this.states.filter(e=>e!==W.MATCHEND_DIEJIA),this.groupInfos&&this.groupInfos.length>0&&(this.box_cumulative.visible=!0,this.box_outside.visible=!1),this.btn_claim.visible=!1,this.btn_next.label=m.instance.getUILang("Go Battle")):this.setToAirdropScene()}async onClaim(){var e=1,i=this.roomGameOverPush.loserTid;await er.instance.addTicketLog(e,i)&&(console.log("记录逆袭券日志成功"),this.onClaimed())}onClaimed(){this.btn_claim.label=m.instance.getUILang("Claimed"),this.btn_claim.disabled=!0,this.states.length>0?this.btn_abandon.label=m.instance.getUILang("Next"):this.btn_abandon.label=m.instance.getUILang("Go Battle")}onRefreshQuan(){E.instance.notice(m.instance.getLanguage(2e3))}setToAirdropScene(){k.instance.arenaType=B.instance.matchDto.arenaType,k.instance.arenaType==W.ARENA_TYPE_PVE?oe.intance.setCurrentScene(Y.M_SCENE_PVE):oe.intance.setCurrentScene(Y.M_SCENE_AIRDROP)}setOpenData(e){this.btn_nextLX=this.btn_next.x;var i=B.instance.matchDto;this.myRankPlayerDto=e[0];var a=e[1];if(this.groupId=e[2],this.roomGameOverPush=B.instance.roomGameOverPush,this.box_quan.visible=!1,this.roomGameOverPush&&this.roomGameOverPush.arenaType==W.ARENA_TYPE_PVE){this.tf_challengeDuration.text=se.formatWithSecondByMs(this.roomGameOverPush.battleTime),this.tf_historicalRanking.text=this.roomGameOverPush.personalRank+"",this.tf_overallRanking.text=this.roomGameOverPush.totalRank+"",this.box_pvp.visible=!1,this.box_pve.visible=!0,this.btn_next.visible=!0,this.btn_next.x=this.box_outside.width-this.btn_next.width>>1,this.list_reward.visible=!1;var r=this.roomGameOverPush.reward,s=!1;for(let M of r)if(M.id==ge.TYPE_QUAN_PVE){s=!0;break}s?(this.img_pid.visible=!0,this.tf_pid.text=b.instance.playerDto.pid+""):(this.box_pve.y+=60,this.img_pid.visible=!1)}else{this.box_pve.visible=!1,this.box_pvp.visible=!0;var o=!1;if(this.roomGameOverPush.loserTid){o=!0,this.tf_quanId.text=this.roomGameOverPush.loserTid;var l=_.intance.m_dicItems.get(ge.TYPE_QUAN_MNT),c=m.instance.getLanguage(l.name);this.tf_quanName.text=c}if(this.groupInfos=[],a){var u=1;a.forEach(V=>{this.groupInfos.push([u,V]),u++})}this.myRankPlayerDto.rankNum<4?this.img_rankIcon.skin="res/matchEnd1/img_battleend_ranking_"+this.myRankPlayerDto.rankNum+".png":this.img_rankIcon.skin="res/matchEnd1/img_battleend_ranking_4.png",this.list_reward.vScrollBarSkin="",this.tf_rank.text=this.myRankPlayerDto.rankNum+"";var p=[],d=new le,r=B.instance.reward;r.forEach(V=>{var q=d.get(V.id);q?q.newAddCnt=q.newAddCnt+V.count:(q=new Ne(V.id),q.newAddCnt=V.count,p.push(q),d.set(V.id,q))});var L=this.list_reward.spaceX,x=this.list_reward.itemTemplate.width,w=p.length,I=w*x+L*(w-1);this.list_reward.repeatX=w,this.list_reward.width=I,this.btn_next.visible=!0,this.list_reward.x=this.box_outside.width-this.list_reward.width>>1,this.list_reward.array=p,this.list_reward.visible=!0,!this.list_reward.array||this.list_reward.array.length<=0?this.noDataBox1.visible=!0:this.noDataBox1.visible=!1;let H=-1;this.list_reward.selectedIndex=H,o&&this.states.push(W.MATCHEND_QUAN),this.groupInfos.length>0&&this.states.push(W.MATCHEND_DIEJIA),this.list_group.array=this.groupInfos}this.onNext()}onDisable(){this.removeEvent()}removeEvent(){g.intance.off(f.EVENT_REFRESH_QUAN_STATUS,this,this.onRefreshQuan)}};HL=h([dR("y-nP_lRrQVef9uttVJ0rDw")],HL);var UL=class extends Laya.Box{};var{regClass:fR}=Laya,VL=class extends UL{set dataSource(t){if(super.dataSource=t,!!t){var e=t[0];this.tf_groupNum.text=m.instance.getLanguage(1364,e);var i=t[1];this.list_group_players.array=i}}};VL=h([fR("hRg5i0IfRMaPkSUsg-i-Lg")],VL);var FL=class extends Laya.Box{};var{regClass:yR}=Laya,GL=class extends FL{constructor(){super();this.isAddEvent=!1}createChildren(){super.createChildren()}addEvent(){this.isAddEvent||(this.isAddEvent=!0)}set dataSource(e){if(super.dataSource=e,this.roomPlayer=e,!this.roomPlayer){this.img_back.skin="res/matchReady/img_jjc_0.png",this.box_show.visible=!1;return}this.addEvent(),this.setCurrentOutPut()}async setCurrentOutPut(){if(this.img_back.skin="res/matchReady/img_jjc_1.png",this.tf_name.text=B.instance.setRoomAnonymousLabel(Me.abbreviateString(this.roomPlayer.name)),this.box_show.visible=!0,this.destroyed)return;let e=this.roomPlayer.icon;this.playerIcon.headSkin=e,this.img_sign.visible=this.roomPlayer.leader>0,this.tf_union.text=B.instance.setRoomAnonymousLabel(m.instance.getMultiLan(this.roomPlayer.shortUnionName))}toDetail(){this.heroVo.id}};GL=h([yR("PiGdVEY9T-K8CCfWLChS0w")],GL);var Qe=class{};Qe.TYPE_normal=!1,Qe.TYPE_Monster=!0,Qe.STATE_Idle=1,Qe.STATE_Patrol=2,Qe.STATE_Chase=3,Qe.STATE_Attack=4,Qe.STATE_Flee=5;var KL=class{constructor(){this.lastUsed=0}get isDefensive(){return this.skillItem.type==4}};var qL=class extends Laya.Sprite{};var{regClass:bR}=Laya,WL=class extends qL{constructor(){super();this.isAddEvent=!1;this.isMe=!1;this.inGround=!1;this.speedRate=1;this.moveSpeed=6;this._speed=6;this.biasSpeed=0;this.lastDirectStr="left";this.directStr="left";this._roleDirection=-1;this.inControl=!1;this.isStop=!1;this.isLockAni=!1;this.aniChange=!1;this.beyond=!1;this.displacementType=0;this.timeStamp=0;this.currArea=0;this.isSetDiquan=!1;this.flashCount=0;this.lastX=-1;this.lastY=-1;this.lastRoleDirection1=-1;this.lastSpeed1=-1;this.lastArea=-1;this.lastMoveIndex=-1;this.attackSequence=[5,3,6,1];this.oldMonsterAttackSequence=[5,1,3,1,6];this.oldUsdBigSkillMonsterAttackSequence=[5,1,3,1];this.monsterAttackSequence=[5,1,3,1,6];this.currentAttackIndex=0;this.isUnderAttack=!1;this.exitRange=500;this.showRange=300;this.closeRange=90;this.attackRange=120;this._monsterTime=100;this.isFocusedOnPlayer=!1}get speed(){return this._speed}set speed(e){this._speed=e,this.biasSpeed=Math.round(this.speed*Math.sin(45*Math.PI/180))}get roleDirection(){return this._roleDirection}set roleDirection(e){this._roleDirection=e,e!=-4&&(e>270||e<90?this.directStr="right":e>90&&e<270&&(this.directStr="left"),this.lastDirectStr!=this.directStr&&(this.heroBox.scaleX=this.directStr=="left"?1:-1,this.lastDirectStr=this.directStr))}set myRoleDirection(e){if(this.roleDirection!=e){this.roleDirection=e;let i=28+Math.sin(e*(Math.PI/180))*(28/4),a=24+Math.sin(e*(Math.PI/180))*(14/2),r=this.img_d.width/2+Math.cos(e*(Math.PI/180))*(this.img_d.width/2),s=this.img_d.height/2+ +Math.sin(e*(Math.PI/180))*(this.img_d.height/2);this.img_arrow.pos(r,s),this.img_gj.rotation=e+90,this.img_arrow.rotation=e,this.img_arrow.width=i,this.img_arrow.height=a}}addEvent(){this.isAddEvent||(this.isAddEvent=!0)}set dataSource(e){if(this.roomPlayerDto=e,!!this.roomPlayerDto){if(this.pos(this.roomPlayerDto.x,this.roomPlayerDto.y),this.addEvent(),this.speed=this.roomPlayerDto.speed,this.currArea=this.roomPlayerDto.area,this.heroVo=new Ht,this.roomPlayerDto.heroId?this.heroVo.id=this.roomPlayerDto.heroId:this.heroVo.id=Je.DEFAULT_HERO_ID,this.roomPlayerDto.heroColor?this.heroVo.color=this.roomPlayerDto.heroColor:this.heroVo.color=Je.DEFAULT_HERO_COLOR,this.moveSpeed=this.heroVo.heroItem.mov/30,this.setCurrentOutPut(),this.updataBlood(),this.roomPlayerDto.hp<=0){this._isDead=!0,this.setDead();return}else this._isDead&&this.reLife();this.addDiquanAndBaoqi(),this.applySkillEffect(),this.roomPlayerDto.npc==Qe.TYPE_Monster&&this.initMatchSkill()}}reLife(){console.log("MatchHeroSpr reLife: "+this.isMe),this._isDead=!1,this._isRealDead=!1,this.alpha=1,this.img_deadImg.visible=!1,this.tf_name.visible=!0,this.box_blood.visible=!0,this.spineNodeBack.visible=!0,this.spineNodeFront.visible=!0,this.heroSk.visible=!0,this.getComponent(Laya.RigidBody).mask=-1,this.target=null}setDead(){console.log("MatchHeroSpr setDead: "+this.isMe),this._isRealDead=!0,this.alpha=.5,this.img_deadImg.visible=!0;var e=this.img_deadImg.y;this.tf_name.visible=!1,this.box_blood.visible=!1,this.spineNodeBack.visible=!1,this.spineNodeFront.visible=!1,this.heroSk.visible=!1,this.img_deadImg.y=0,this.img_deadImg.scale(0,0),this.getComponent(Laya.RigidBody).mask=1;var i=this;Laya.Tween.to(this.img_deadImg,{y:e,scaleX:1,scaleY:1},400,Laya.Ease.linearInOut,Laya.Handler.create(this,function(){i.isMe&&g.intance.event(f.EVENT_GameScene_Gray)}))}updataBlood(){this._healthBar.value=this.roomPlayerDto.hp/this.roomPlayerDto.maxHp}addDiquanAndBaoqi(){if(this.destroyed||this.isSetDiquan)return;this.isSetDiquan=!0;var e=this.roomPlayerDto.equips;if(e instanceof Map){let L=Object.fromEntries(e);console.log("equipMap: "+JSON.stringify(L))}let i=_.intance.getGeneralValueById(25);var a=-1,r=0;for(let L=0;L<i.length;L++){let w=i[L][0];var s;if(e instanceof Map?s=e.get(w+""):s=e[w+""],s){r++;var o=new Ne(s.id),l=o.m_iQuality;(a==-1||l<a)&&(a=l)}}if(a!=-1){a<3&&(a=3);var c=Laya.Pool.getItemByCreateFun(ua.aniSkPrefab,k.instance.aniSkPrefab.create,k.instance.aniSkPrefab),u=k.instance["diquanEffect"+a];r>4&&(r=4),c.init(u,"ani_"+r),this.spineNodeBack.addChild(c)}var p=this.heroVo.heroItem.level;if(!this.baoqiSpineSk){if(this.roomPlayerDto.npc==Qe.TYPE_Monster||p<4)return;this.baoqiSpineSk=new Laya.SpineSkeleton,this.spineNodeBack.addChild(this.baoqiSpineSk),this.baoqiSpineSk.animationName="animation";var d=k.instance["baoqiEffect"+p];this.baoqiSpineSk.templet=d}}setCurrentOutPut(){this.roomPlayerDto.hp>0&&(this.heroSk.needChangeAni=!1,this.heroSk.dataSource=this.heroVo,B.instance.matchWatcher&&this.heroSk.on(Laya.Event.CLICK,this,this.onHeroSkClick)),this.roomPlayerDto&&this.roomPlayerDto.no?k.instance.myPlayer&&k.instance.myPlayer.no==this.roomPlayerDto.no?(this.isOneTeam=!0,this.tf_name.color=Mt.BLUE):(this.isOneTeam=!1,this.tf_name.color=Mt.RED):(this.tf_name.color=Ct.qualityColors[this.heroVo.heroItem.quality-1],b.instance.playerDto.pid==this.roomPlayerDto.id?this.isOneTeam=!0:this.isOneTeam=!1),this.roomPlayerDto.npc?this.tf_name.text=xe.getNumberSuffix(this.roomPlayerDto.name):this.tf_name.text=B.instance.setMatchAnonymousLabel(Me.abbreviateString(this.roomPlayerDto.name)),this.roomPlayerDto.country?this.img_country.skin=B.instance.setMatchAnonymousImg(S.instance.getCountryIcon(this.roomPlayerDto.country+"")):this.img_country.visible=!1,this.roomPlayerDto.no?(this.img_flag.skin=S.instance.getTeamFlag(this.roomPlayerDto.no),this.img_flag.visible=!0):this.img_flag.visible=!1,b.instance.playerDto.pid==this.roomPlayerDto.id?this.myRoleDirection=this.roomPlayerDto.dire:this.roleDirection=this.roomPlayerDto.dire}pos(e,i,a){if(super.pos(e,i,a),this.smallHeroImg){var r=k.instance.fromBigToSmall(e,i),s=r[0],o=r[1];this.smallHeroImg.pos(s,o,a)}return this}set visible(e){super.visible=e,this.smallHeroImg&&(this.smallHeroImg.visible=e)}set alpha(e){super.alpha=e,this.smallHeroImg&&(this.smallHeroImg.alpha=e)}onAwake(){}backAni(){}idle(){console.log(`${this.roomPlayerDto.id} 播放 待机 动画`),!this._isDead&&this.heroSk.isReady&&this.heroSk.play(Je.ANI_daiji,!0,!1)}walk(){this._isDead||this.heroSk.isReady&&this.heroSk.play(Je.ANI_xingzou,!0,!1)}run(){console.log(`${this.roomPlayerDto.id} 播放 跑动 动画`),!this._isDead&&this.heroSk.isReady&&this.heroSk.play(Je.ANI_shanbi,!0,!1)}playAttackAnimation(e,i,a,r,s){if(!this._isDead){var o=_.intance.m_dicSkills.get(i);if(console.log(`${this.roomPlayerDto.id} 攻击 , 播放 ${i} 动画`),o.type==1){if(a&&k.instance.onSendAnimation(this.roomPlayerDto.id,i,Je.TYPE_GONGJI),this.isStop=!0,this.heroSk.isReady){var l=this.heroVo.heroItem.quality>3?this.heroVo.heroItem.quality:"";this.heroSk.play(Je.ANI_gongji+l,!1)}if(a){var c=k.instance.getAttackTarget(this,o);if(c&&c.length>0){var u=c[0];u.roomPlayerDto.hp>0&&Laya.timer.frameOnce(1,this,this.onRealAttack,[0,o,u.roomPlayerDto.id])}}Laya.timer.frameOnce(20,this,()=>{this.isStop=!1,s(),this.aniChange=!0}),k.instance.playSound(1)}else if(o.type==2){if(a&&k.instance.onSendAnimation(this.roomPlayerDto.id,i,Je.TYPE_TI),this.isStop=!0,this.heroSk.isReady){var l=this.heroVo.heroItem.quality>3?this.heroVo.heroItem.quality:"";this.heroSk.play(Je.ANI_ti+l,!1)}a&&Laya.timer.frameOnce(17,this,this.onRealAttack,[0,o]),Laya.timer.frameOnce(30,this,()=>{this.isStop=!1,s(),this.aniChange=!0}),k.instance.playSound(2)}else if(o.type==6)a&&k.instance.onSendAnimation(this.roomPlayerDto.id,i,Je.TYPE_DAZHAO),this.isStop=!0,this.heroSk.isReady&&(console.log("EnumHero.ANI_dazhao: "+Je.ANI_dazhao,e),this.heroSk.play(Je.ANI_dazhao,!1)),a&&Laya.timer.frameOnce(30,this,this.onRealAttack,[e,o]),Laya.timer.frameOnce(70,this,()=>{this.isStop=!1,s(),this.aniChange=!0}),k.instance.playSound(2);else if(o.type==7){var p=0;if(a){var c=k.instance.getAttackTarget(this,o);if(c&&c.length>0){var u=c[0];p=u.roomPlayerDto.id,k.instance.onSendAnimation(this.roomPlayerDto.id,i,Je.TYPE_FEI,p)}}else p=r.get("defId");var d=Laya.Pool.getItemByCreateFun("rocketSpr",k.instance.rocketSprPrefab.create,k.instance.rocketSprPrefab),L=k.instance.matchHeroSprDic.get(p);d.init(e,this.x,this.y,L,a),k.instance.box_front.addChild(d),Laya.timer.frameOnce(2,this,()=>{s()}),k.instance.playSound(3)}else if(o.type==5){var x=[];if(this.displacementType=o.displacementType,a){var w=o.displacement>0?o.displacement:50;x=gt.rollCharacterByDir(this.x,this.y,this.roleDirection,w),k.instance.onSendAnimation(this.roomPlayerDto.id,i,Je.TYPE_FEI,-1,x[0],x[1])}else x[0]=r.get("newX"),x[1]=r.get("newY");if(this.isStop=!0,this.heroSk.isReady){var l=this.heroVo.heroItem.quality>3?this.heroVo.heroItem.quality:"";this.heroSk.play(Je.ANI_ti+l,!1)}if(this.heroVo.heroItem.race!=4){var I=k.instance.huaEffect;this.huaSpineSk||(this.huaSpineSk=new Laya.SpineSkeleton,this.spineNodeFront.addChild(this.huaSpineSk)),this.huaSpineSk.templet=null,this.huaSpineSk.animationName="animation",this.huaSpineSk.templet=I,this.huaSpineSk.visible=!0,this.huaSpineSk.scaleX=this.directStr=="left"?1:-1,Laya.timer.frameOnce(15,this,()=>{this.onHuaComplate()})}a&&Laya.timer.frameOnce(17,this,this.onRealAttack,[0,o]),Laya.timer.frameOnce(5,this,this.onRoll,[x]),Laya.timer.frameOnce(20,this,()=>{this.isStop=!1,this.displacementType=0,s(),this.aniChange=!0}),k.instance.playSound(3)}else if(o.type==3){var x=[];if(a){var w=o.displacement>0?o.displacement:350;x=gt.rollCharacterByDir(this.x,this.y,this.roleDirection,w),k.instance.onSendAnimation(this.roomPlayerDto.id,i,Je.TYPE_HUA,-1,x[0],x[1])}else x[0]=r.get("newX"),x[1]=r.get("newY");if(this.getComponent(Laya.BoxCollider).isSensor=!0,this.isStop=!0,this.heroSk.isReady&&this.heroSk.play(Je.ANI_hua,!1),this.heroVo.heroItem.race!=4&&!this.beyond){var I=k.instance.huaEffect;this.huaSpineSk||(this.huaSpineSk=new Laya.SpineSkeleton,this.spineNodeFront.addChild(this.huaSpineSk)),this.huaSpineSk.templet=null,this.huaSpineSk.animationName="animation",this.huaSpineSk.templet=I,this.huaSpineSk.visible=!0,this.huaSpineSk.scaleX=this.directStr=="left"?1:-1,Laya.timer.frameOnce(15,this,()=>{this.onHuaComplate()})}Laya.timer.frameOnce(5,this,this.onRoll,[x]),Laya.timer.frameOnce(20,this,()=>{this.getComponent(Laya.BoxCollider).isSensor=!1,this.isStop=!1,s(),this.aniChange=!0}),k.instance.playSound(3)}else if(o.type==4){a&&(this.isLockAni=!0,k.instance.onSendAnimation(this.roomPlayerDto.id,i,Je.TYPE_DANG)),this.heroSk.isReady&&this.heroSk.play(Je.ANI_dang,!1),this.dunpaiSk||(this.dunpaiSk=k.instance.dunpaiTemplet.buildArmature(0),this.dunpaiSk.x=-45,this.skNode.addChild(this.dunpaiSk)),this.dunpaiSk.play(0,!0);var M=2e3,H=o.buff;if(H.length>2){var V=H[2],q=_.intance.m_dicBuffs.get(V);M=parseInt(q.time+"")}Laya.timer.once(M,this,()=>{this.isLockAni=!1,this.dunpaiSk&&(this.dunpaiSk.stop(),this.dunpaiSk.visible=!1),s(),this.aniChange=!0}),k.instance.playSound(2)}}}parseBuffDto(e,i){if(!this._isDead){var a=_.intance.m_dicSkills.get(e.skillId),r=_.intance.m_dicBuffs.get(e.buffId);if(console.log(`${this.roomPlayerDto.id} 攻击 , 播放 ${e.skillId} 动画, 播放 ${e.buffId} buff`),a.type){var s=e.expireTime;if(s>0){var o=r.buffAni;e.buffId==1008&&(o=a.flightEff);var l=_.intance.m_dicEffects.get(o),c=l.resource,u=Laya.Pool.getItemByCreateFun(ua.aniSkPrefab,k.instance.aniSkPrefab.create,k.instance.aniSkPrefab),p=k.instance[c],d="animation";l.anim&&(d=l.anim),u.init(p,d,l.loop==1),l.layer==2?this.spineNodeBack.addChild(u):l.layer==1?this.skNode.addChild(u):this.spineNodeFront.addChild(u);var L=r.buffEffect;L&&L.length>0&&L.forEach(x=>{var w=x[0],I=x[1],M=x[2];w==1?I==1009&&(this.speedRate=1+M/1e4,k.instance.updateMyRoleSpeed()):w==6&&I==1&&g.intance.event(f.EVENT_UPDATE_REDECE_COOL,[I,M/1e4])}),Laya.timer.once(s,this,()=>{l.animEnd?(u&&u.play(l.animEnd,!1),Laya.timer.once(1e3,this,this.removeBuffDto,[L,u])):this.removeBuffDto(L,u)})}}}}removeBuffDto(e,i){i&&(i.stop(),i.visible=!1,i.removeSelf()),e&&e.length>0&&e&&e.length>0&&e.forEach(a=>{var r=a[0],s=a[1],o=a[2];r==1?s==1009&&(this.speedRate=1,k.instance.updateMyRoleSpeed()):r==6&&s==1&&g.intance.event(f.EVENT_UPDATE_REDECE_COOL,[s,0])})}parseBuffEffect(e){if(!this._isDead){var i=_.intance.m_dicBuffs.get(e.buffId),a=_.intance.m_dicEffects.get(i.buffAni);if(console.log(`${this.roomPlayerDto.id} 元素攻击 , 播放 ${e.buffId} 动画`),a){var r=a.resource,s=Laya.Pool.getItemByCreateFun(ua.aniSkPrefab,k.instance.aniSkPrefab.create,k.instance.aniSkPrefab),o=k.instance[r],l="animation";a.anim&&(l=a.anim),s.init(o,l,a.loop==1),a.layer==2?this.spineNodeBack.addChild(s):a.layer==1?this.skNode.addChild(s):this.spineNodeFront.addChild(s);var c=a.totalSecond*1e3;Laya.timer.once(c,this,()=>{s&&(s.stop(),s.visible=!1,s.removeSelf())})}e.effectType==2?(this.roomPlayerDto.hp+=e.atk,console.log(`${this.roomPlayerDto.id} 变化的血量 ${e.atk} `),this.updateHealthBar()):this.beyond||this.showDamageLabelDetailDelay(e.atk,300,null)}}onRoll(e){this.inGround||Laya.Tween.to(this,{x:e[0],y:e[1]},330,Laya.Ease.linearNone,null,0,!0)}onHuaComplate(){this.huaSpineSk.stop(),this.huaSpineSk.visible=!1}onRealAttack(e,i,a=-1){if(console.log("onRealAttack",e,a,i.id),a>0)k.instance.onSendAttack(this.roomPlayerDto.id,a,1,i.id);else if(i.type==6){var r=k.instance.getAttackTarget(this,i);if(e>0){var s=[];r&&r.length>0&&r.forEach(l=>{l&&l.roomPlayerDto.hp>0&&s.push(l.roomPlayerDto.id)}),k.instance.onSendAttackBig(e,s)}else r&&r.length>0&&r.forEach(l=>{l&&l.roomPlayerDto.hp>0&&k.instance.onSendAttack(this.roomPlayerDto.id,l.roomPlayerDto.id,1,i.id)})}else{var r=k.instance.getAttackTarget(this,i);if(r&&r.length>0){var o=r[0];o.roomPlayerDto.hp>0&&k.instance.onSendAttack(this.roomPlayerDto.id,o.roomPlayerDto.id,1,i.id)}}}playBeijiAnimation(e){this._isDead||(console.log(`${this.roomPlayerDto.id} 播放 被击 动画`),this.heroSk.isReady&&this.heroSk.play(Je.ANI_beiji,!1),Laya.timer.once(1e3,this,()=>{e()}))}playChuShengAnimation(e){this._isDead||(console.log(`${this.roomPlayerDto.id} 播放 出生 动画`),this.heroSk.isReady&&this.heroSk.play(Je.ANI_ruchang,!1),Laya.timer.once(1e3,this,()=>{e()}))}attack(e=0,i=0,a=!0,r=null){if(console.log(`${this.roomPlayerDto.id} 攻击 s`),this._isAttacking||this._isDead){console.log(`${this.roomPlayerDto.id} 没有靠近目标或正在攻击中或技能冷却中或已死亡，无法攻击`);return}this._isAttacking=!0,this.playAttackAnimation(e,i,a,r,()=>{this._isAttacking=!1})}takeDamage(e,i){var a=e.skill,r=e.attackValue,s=e.defHp;console.log(`${this.roomPlayerDto.id} 受到 ${r} 伤害s`),!this._isDead&&(this.roomPlayerDto.hp=s,console.log(`${this.roomPlayerDto.id} 受到 ${r} 伤害`),this.updateHealthBar(i),this.beyond||this.showDamageLabel(a,r,e),this._isAttacking&&(console.log(`${this.roomPlayerDto.id} 正在攻击中，受到攻击中断攻击 暂时没有中断攻击`),Laya.timer.clear(this,this.onRealAttack),this._isAttacking=!1),this._isTakingDamage=!0,this.isLockAni=!0,this.beijiSk||(this.beijiSk=k.instance.beijiTemplet.buildArmature(0),this.skNode.addChild(this.beijiSk)),this.beijiSk.play(0,!1),this.playBeijiAnimation(()=>{this.beijiSk&&(this.beijiSk.stop(),this.beijiSk.visible=!1),this._isTakingDamage=!1,this.isLockAni=!1,this.backAni()}))}die(e=null){if(console.log(`${this.roomPlayerDto.id} 死亡s`),!this._isDead){if(console.log(`${this.roomPlayerDto.id} 死亡`),e){var i=gt.judgePosition(e.x-this.x,e.y-this.y);this.roleDirection=i}this._isDead=!0,this.heroSk.isReady&&this.heroSk.play(Je.ANI_siwang,!1),Laya.timer.once(2e3,this,this.setDead)}}applySkillEffect(){var e=this.roomPlayerDto.buffDtoList;e&&e.length&&(console.log(`${this.roomPlayerDto.id} 受到技能效果: ${e}`),e.forEach(i=>{var a=_.intance.m_dicBuffs.get(i.buffId);a.triggerTiming==1&&this.roomPlayerDto.id==i.pid&&this.parseBuffDto(i,!1)}))}updateHealthBar(e=null){this.roomPlayerDto.hp<=0&&(this.roomPlayerDto.hp=0,this.die(e)),this._healthBar.value=this.roomPlayerDto.hp/this.roomPlayerDto.maxHp}showDamageLabel(e,i,a){if(i.length>1)for(var r=_.intance.m_dicSkills.get(e),s=r.section,o=s,l=0;l<i.length;l++){var c=i[l];this.showDamageLabelDetailDelay(c,o[l][1],a)}else i.length==1&&this.showDamageLabelDetailDelay(i[0],100,a);var u=this;if(a.allAtkValue!=0){var p=200;this.originalBlendMode=this.img_hp_bg.blendMode,this.flashCount=0,Laya.timer.loop(p,this,this.flashBlood)}}flashBlood(){var e=2;this.flashCount<e?this.img_hp_bg.blendMode===this.originalBlendMode?this.img_hp_bg.blendMode="lighter":(this.img_hp_bg.blendMode=this.originalBlendMode,this.flashCount++):(this.img_hp_bg.blendMode=this.originalBlendMode,Laya.timer.clear(this,this.flashBlood))}showDamageLabelDetailDelay(e,i,a){Laya.timer.once(i,this,this.showDamageLabelDetail,[e,a],!1)}showDamageLabelDetail(e,i){var a=Laya.Pool.getItemByCreateFun("damageNumber",k.instance.damageNumPrefab.create,k.instance.damageNumPrefab);a.init(e,i),this.addChild(a)}onSendMoveData(){if(!this._isDead){var e=this.speed,i=this.roleDirection,a=this.x,r=this.y;if(Math.abs(a-this.lastX)>2||Math.abs(r-this.lastY)>2||this.lastRoleDirection1!=i||this.lastSpeed1!=e||this.lastArea!=this.currArea){this.pos(a,r),this.lastX=a,this.lastY=r,this.lastRoleDirection1=i,this.lastSpeed1=e,this.lastArea=this.currArea;var s=b.instance.m_serverTime;this.timeStamp=s,k.instance.onSendMove(s,this.roomPlayerDto.id,e,i,a,r,this.currArea)}}}beiTui(e){var i=this.roomPlayerDto.id,a=this.x,r=this.y;if(Math.abs(a-this.lastX)>2||Math.abs(r-this.lastY)>2){this.lastX=a,this.lastY=r;var s=b.instance.m_serverTime;this.timeStamp=s,k.instance.onSendTargetMove(s,e,i,a,r)}}onPushMoveData(e,i){if(i!=this.lastMoveIndex)this.lastMoveIndex=i;else return;var a=e.time,r=e.speed,s=e.dire,o=e.x,l=e.y,c=e.area,u=e.npc;if(u){var p=B.instance.matchWatcher;if(p){if(this.roleDirection=s,this.speed=r,r==0?this.idle():this.walk(),this.currArea!=c&&(this.currArea=c),a<=this.timeStamp){console.log("位置数据忽略："+a+" < "+this.timeStamp);return}if(Laya.Tween.to(this,{x:o,y:l},this.monsterTime,Laya.Ease.linearNone,null,0,!0),this.smallHeroImg){var d=k.instance.fromBigToSmall(o,l),L=d[0],x=d[1];Laya.Tween.to(this.smallHeroImg,{x:L,y:x},this.monsterTime,Laya.Ease.linearNone,null,0,!0)}}}else{if(this.roleDirection=s,this.speed!=r?(this.speed=r,r==0?this.idle():this.walk()):r>0&&this.heroSk.isReady&&this.heroSk.sk.animationName==Je.ANI_daiji&&this.walk(),this.currArea!=c&&(this.currArea=c),a<=this.timeStamp){console.log("位置数据忽略："+a+" < "+this.timeStamp);return}if(Math.abs(o-this.lastX)>1||Math.abs(l-this.lastY)>1){var w=60;if(Laya.Tween.to(this,{x:o,y:l},w,Laya.Ease.linearNone,null,0,!0),this.smallHeroImg){var d=k.instance.fromBigToSmall(o,l),L=d[0],x=d[1];Laya.Tween.to(this.smallHeroImg,{x:L,y:x},w,Laya.Ease.linearNone,null,0,!0)}this.lastX=o,this.lastY=l}}}onPushTargetMoveData(e,i,a){if(e<=this.timeStamp){console.log("推人数据忽略："+e+" < "+this.timeStamp);return}(Math.abs(i-this.lastX)>2||Math.abs(a-this.lastY)>2)&&(this.pos(i,a),this.lastX=i,this.lastY=a)}sendToServer(e){}initBirth(e){e?this.createBirthSpine():this.onPlayBirthEnd()}createBirthSpine(){this.heroSk.visible=!1,this.tf_name.visible=!1,this.box_blood.visible=!1,this.chushengBackSpineSk||(this.chushengBackSpineSk=new Laya.SpineSkeleton,this.spineNodeBack.addChild(this.chushengBackSpineSk)),this.chushengFrontSpineSk||(this.chushengFrontSpineSk=new Laya.SpineSkeleton,this.spineNodeFront.addChild(this.chushengFrontSpineSk)),this.chushengBackSpineSk.on(Laya.Event.READY,this,this.onBirthReady);var e=k.instance.ruchangEffects[this.getRandomAnimationType()];this.destroyed||(this.chushengBackSpineSk.animationName="animation2",this.chushengBackSpineSk.templet=e,this.chushengFrontSpineSk.animationName="animation1",this.chushengFrontSpineSk.templet=e)}getRandomAnimationType(){return Math.floor(Math.random()*3)}onBirthReady(){Laya.timer.once(500,this,this.onPlayBirth1)}onPlayBirth1(){this.isLockAni=!0,this.heroSk.visible=!0,this.playChuShengAnimation(()=>{this.isLockAni=!1,this.aniChange=!0});try{this.chushengBackSpineSk.visible=!0,this.chushengBackSpineSk.play("animation2",!1),this.chushengFrontSpineSk.visible=!0,this.chushengFrontSpineSk.play("animation1",!1)}catch{}Laya.timer.once(1300,this,this.onPlayBirthEnd)}onPlayBirthEnd(){this.chushengBackSpineSk&&(this.chushengBackSpineSk.off(Laya.Event.READY,this,this.onPlayBirth1),this.chushengBackSpineSk.destroy(),this.chushengBackSpineSk.removeSelf()),this.chushengFrontSpineSk&&(this.chushengFrontSpineSk.destroy(),this.chushengFrontSpineSk.removeSelf()),this.box_d.visible=!0,this.tf_name.visible=!0,this.box_blood.visible=!0}onHeroSkClick(){k.instance.setOtherHero(this)}setFollowIcon(e){this.img_follow.visible=e}onDisable(){this.heroSk&&this.heroSk.off(Laya.Event.CLICK,this,this.onHeroSkClick),this.chushengBackSpineSk&&this.chushengBackSpineSk.off(Laya.Event.READY,this,this.onPlayBirth1),Laya.timer.clearAll(this),Laya.Tween.clearAll(this),this.smallHeroImg=null}get monsterTime(){var e=B.instance.matchCoolDownTime;return e<30?this._monsterTime/.5:e<60?this._monsterTime/.8:this._monsterTime}set monsterTime(e){this._monsterTime=e}detectPlayer(){if(this.isFocusedOnPlayer||this.isPlayerWithinDetectionRange(k.instance.myHeroSpr))return this.target=k.instance.myHeroSpr,this.target!=null;let e=k.instance.matchHeroSprs;var i=-1,a=null;for(let r of e)r!=this&&this.isPlayerWithinDetectionRange(r)&&r.roomPlayerDto.hp>0&&(i==-1||i>r.roomPlayerDto.hp)&&(i=r.roomPlayerDto.hp,a=r);return a?(this.target=a,!0):!1}isPlayerWithoutDetectionRange(e){return gt.distancePoint(this.x,this.y,e.x,e.y)>this.exitRange}isPlayerWithinDetectionRange(e){return gt.distancePoint(this.x,this.y,e.x,e.y)<this.showRange}chaseLogic(e){var i=new Date().getTime();let a=gt.distancePoint(this.x,this.y,e.x,e.y);return this.skills.filter(o=>a<=o.skillItem.distance&&this.canUseSkill(o,i)).length>0}isAttackToPlayer(e){return e?this.chaseLogic(e):!1}initMatchSkill(){this.sharedCooldowns=0,this.skills=[];var e=this.roomPlayerDto.id,i=_.intance.m_dicMonsters.get(e);this.monsterTime=32*1e3/i.mov;var a=i.skillIds;a&&a.length&&a.forEach(r=>{var s=_.intance.m_dicSkills.get(r),o=new KL;o.id=r,o.skillItem=s,this.skills.push(o)})}canUseSkill(e,i){let a=e.lastUsed||0,r=this.sharedCooldowns||0;return i-a>=e.skillItem.cd&&i-r>=e.skillItem.commCd}useSkill(e,i){e.lastUsed=i,this.sharedCooldowns=i,this.attack(0,e.id)}onNpcSendMoveData(e,i){if(!this._isDead){var a=this.speed,r=this.roleDirection;if(Math.abs(e-this.lastX)>2||Math.abs(i-this.lastY)>2||this.lastRoleDirection1!=r||this.lastSpeed1!=a||this.lastArea!=this.currArea){this.lastX=e,this.lastY=i,this.lastRoleDirection1=r,this.lastSpeed1=a,this.lastArea=this.currArea;var s=b.instance.m_serverTime;this.timeStamp=s,k.instance.onNpcSendMove(s,this.roomPlayerDto.id,a,r,e,i,this.currArea)}}}};WL=h([bR("JIaWsVNzTK2dJIUcev60tQ")],WL);var YL=class extends Laya.Box{};var{regClass:gR}=Laya,zL=class extends YL{init(){var t=B.instance.currArenaItem.coinType;this.img_bing.skin="gameIcon/map/1001/img_bing_"+t+".png"}set dataSource(t){super.dataSource=t}};zL=h([gR("W3qDvbUmSa2SFKJ5iEmjsg")],zL);var jL=class extends Laya.Box{};var{regClass:LR}=Laya,$L=class extends jL{init(){var t=B.instance.currArenaItem.coinType;this.img_bing.skin=S.instance.getItemIcon(t),k.instance.allOrders||(k.instance.allOrders=[]),k.instance.allOrders.push(this.img_mtl)}set dataSource(t){super.dataSource=t}};$L=h([LR("UmH7VSkYTd6D8QA2Eu2OYw")],$L);var XL=class extends Laya.Box{};var{regClass:_R}=Laya,QL=class extends XL{constructor(){super();this.isAddEvent=!1}createChildren(){super.createChildren()}addEvent(){this.isAddEvent||(this.isAddEvent=!0)}set dataSource(e){super.dataSource=e;var i=e;this.roomPlayer=B.instance.playerJoinDic.get(i),this.roomPlayer&&(this.addEvent(),this.setCurrentOutPut())}async setCurrentOutPut(){this.tf_name.text=B.instance.setRoomAnonymousLabel(Me.abbreviateString(this.roomPlayer.name));let e=this.roomPlayer.icon;this.playerIcon.headSkin=e;var i=this.roomPlayer.id==b.instance.playerDto.pid,a=i?"#ffce58":"#96d2fc";this.tf_name.color=a}toDetail(){}};QL=h([_R("YQ6pCsb4S0ibRtZ73-V9-Q")],QL);var JL=class extends Laya.Box{};var{regClass:vR}=Laya,ZL=class extends JL{constructor(){super();this.isAddEvent=!1}addEvent(){this.isAddEvent||(this.isAddEvent=!0)}set dataSource(e){super.dataSource=e;var i=e;i&&(this.roomRankPlayerDto=B.instance.playerJoinDic.get(i),this.addEvent(),this.setCurrentOutPut())}async setCurrentOutPut(){this.tf_name.text=B.instance.setRoomAnonymousLabel(Me.abbreviateString(this.roomRankPlayerDto.name));let e=this.roomRankPlayerDto.icon;this.playerIcon.headSkin=e;var i=this.roomRankPlayerDto.id==b.instance.playerDto.pid,a=i?"#ffce58":"#96d2fc";this.tf_name.color=a}toDetail(){}};ZL=h([vR("U8opa1YySD-Mm6RRAvEq9g")],ZL);var e_=class extends Laya.Box{};var{regClass:xR}=Laya,t_=class extends e_{constructor(){super();this.isAddEvent=!1}addEvent(){this.isAddEvent||(this.isAddEvent=!0)}set dataSource(e){this.roomPlayerDto=e,this.roomPlayerDto&&(this.addEvent(),this.setCurrentOutPut())}setCurrentOutPut(){this.tf_rank.text=this.roomPlayerDto.rankNum+"";let e=this.roomPlayerDto.icon;this.playerIcon.headSkin=e,this.roomPlayerDto.npc?this.tf_name.text=xe.getNumberSuffix(this.roomPlayerDto.name):this.tf_name.text=B.instance.setMatchAnonymousLabel(Me.abbreviateString(this.roomPlayerDto.name)),this.tf_kill.text=this.roomPlayerDto.kill+"",k.instance.myPlayer&&this.roomPlayerDto.id==k.instance.myPlayer.id?(this.img_bg.skin="res/match1/img_ph2.png",this.tf_rank.color="#000000",this.tf_name.color="#ffe64b",this.img_kill.filters=[Le.YELLOW],this.tf_kill.color="#ffe64b",this.box_item.x=6):(this.img_bg.skin="res/match1/img_ph.png",this.tf_rank.color="#ffffff",this.tf_name.color="#ffffff",this.img_kill.filters=null,this.tf_kill.color="#ffffff",this.box_item.x=15)}};t_=h([xR("XTVFXeI_R768e0Elv_ePAA")],t_);var i_=class extends Laya.Scene{};var{regClass:IR}=Laya,a_=class extends i_{constructor(){super(...arguments);this.type=1}onAwake(){this.m_iLayerType=C.M_POP,this.m_iPositionType=C.UP}onOpened(e){this.type=e}setToMainScene(){oe.intance.setCurrentScene(Y.M_SCENE_MAIN)}onEnable(){console.log("MatchReadyRT onEnable"),this.btn_back&&this.btn_back.on(Laya.Event.CLICK,this,this.setToMainScene),this.btn_random.on(Laya.Event.CLICK,this,()=>{this.generateName()}),this.btn_enter.on(Laya.Event.CLICK,this,()=>{var e=this.input_username.text;if(console.log("phyBtn"),e==""){alert("用户名不能为空");return}lt.instance.openId=e,lt.instance.initSocket()})}generateRandomName(e){let i="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz",a="";for(let r=0;r<e;r++){let s=Math.floor(Math.random()*i.length);a+=i.charAt(s)}return a}generateName(){this.input_username.text=this.generateRandomName(8)}onDestroy(){}};a_=h([IR("mOlMVGD3TRCKNoddhyUGLw")],a_);var n_=class extends Laya.Dialog{};var{regClass:ER}=Laya,r_=class extends n_{constructor(){super(...arguments);this.m_strName="我是OpenSceneRuntime";this.m_iLayerType=C.M_PANEL;this.m_iPositionType=C.CENTER}onEnable(){}onOpened(e){this.updateBattleCD()}updateBattleCD(){var e=B.instance.matchDto.startTime-B.instance.matchDto.nowTime;console.log("updateBattleCD: "+e),B.instance.startCoolDownTime=Math.round(e/1e3),B.instance.startCoolDownTime>0?(this.onSetCoolTime(),Laya.timer.loop(1e3,this,this.onSetCoolTime)):(Laya.timer.clear(this,this.onSetCoolTime),this.close())}onSetCoolTime(){B.instance.startCoolDownTime>0?(this.fontClip_reduceTime.value=B.instance.startCoolDownTime+"",this.scaleEffect(),B.instance.startCoolDownTime--):(Laya.timer.clear(this,this.onSetCoolTime),B.instance.matchDto.arenaType==W.ARENA_TYPE_PVE?this.close():this.onMatchStartEnd())}scaleEffect(){var e=this;Laya.Tween.to(this.fontClip_reduceTime,{scaleX:1.3,scaleY:1.3},200,Laya.Ease.linearInOut,Laya.Handler.create(this,function(){Laya.Tween.to(e.fontClip_reduceTime,{scaleX:1,scaleY:1},200,Laya.Ease.linearInOut)}))}onMatchStartEnd(){Laya.timer.once(5e3,this,this.close)}onDisable(){this.removeEvent(),B.instance.stopAll=!1}removeEvent(){Laya.timer.clearAll(this),Laya.Tween.clearAll(this)}};r_=h([ER("xpPoFvX_SqiYMO5AaOwGyA")],r_);var s_=class extends Laya.Box{};var{regClass:wR}=Laya,o_=class extends s_{constructor(){super();this.showAdd=!1;this.isAddEvent=!1}createChildren(){super.createChildren()}addEvent(){this.isAddEvent||(this.on(Laya.Event.CLICK,this,this.toDetail),this.isAddEvent=!0)}set dataSource(e){super.dataSource=e,this.itemVo=e,this.itemVo&&(this.addEvent(),this.setCurrentOutPut())}async setCurrentOutPut(){this.itemVo&&(this.knapsackItem.showAdd=!0,this.knapsackItem.dataSource=this.itemVo)}toDetail(){!this.itemVo||!this.itemVo.needTip||(this.itemVo.type===Ge.TYPE_Equipment?A.intance.openModule(y.EquipDetailDialog,this.itemVo):A.intance.openModule(y.KnapsackTipDialog,this.itemVo))}};o_=h([wR("WXpxCvqlQ2mKdcJCYlqOeg")],o_);var l_=class extends Laya.Scene{};var{regClass:TR}=Laya,c_=class extends l_{constructor(){super(...arguments);this.liveNum=0}onAwake(){this.m_iLayerType=C.M_POP,this.m_iPositionType=C.UP,k.instance.init()}onOpened(e){var i=B.instance.matchDto.startTime-B.instance.matchDto.nowTime;i>0&&A.intance.openModule(y.MatchReadyView);var a=B.instance.matchDto.arenaId,r=B.instance.matchWatcher;r&&(this.headBox.visible=!1,this.btn_exit.on(Laya.Event.CLICK,this,this.onExitClick),this.img_kill.visible=!1,this.box_skills.visible=!1,this.img_smallMap.on(Laya.Event.CLICK,this,this.onSmallMapClick),b.instance.playerDto.killStatus==1&&(this.btn_banAccount.visible=!0,this.btn_banAccount.on(Laya.Event.CLICK,this,this.onBanAccountClick))),this.btn_exit.visible=r,this.tf_live.visible=r;var s=_.intance.m_dicArenaDic.get(a);B.instance.currArenaItem=s;var o=B.instance.currArenaItem.mapid,l=Laya.loader.getRes("gameIcon/map/map_"+o+".lh");this.img_smallMap.skin="res/match1/img_map_"+o+".png";var c=Laya.Pool.getItemByCreateFun("MatchMap1001",l.create,l);c.init(),k.instance.gameMap=c,k.instance.box_players=c.box_players,k.instance.box_behind=c.box_behind,k.instance.box_front=c.box_front,this.matchBox.removeChildren(),this.matchBox.addChild(c);var u=b.instance.playerDto;this.tf_roleName.text=u.name;let p=u.icon;this.playerIcon.headSkin=p,k.instance.initMatch(this,this.onInitEnd),He.instance.sendCustumEvent(42);var d=B.instance.matchDto.roomId;if(this.arenaNo.text=d+"",B.instance.roomDto){var L=B.instance.roomDto.nodeId;if(L){var x=_.intance.m_dicNodes.get(L);this.nodeDelaySign.dataSource=x,this.nodeDelaySign.startTest()}}}onSmallMapClick(e){var i=new Laya.Point(e.stageX,e.stageY);let a=this.img_smallMap.globalToLocal(i,!1);k.instance.clickSmallMapToMove(a),console.log("onSmallMapClick: ",e.stageX,e.stageY,"====",a.x,a.y)}onStageClick(e){console.log("onStageClick: ",e.stageX,e.stageY,e)}onInitEnd(e){try{e.updateSkill()}catch(i){console.warn(i)}e.updateKill(),e.updateBattleCD(),Laya.timer.frameLoop(10,e,e.updateCharactersOrder)}onRestoreData(){k.instance.updateMatch(this,this.onInitEnd)}updateSkill(){var e=B.instance.matchWatcher;if(!e){var i=k.instance.myPlayer,a;i.heroId?a=i.heroId:a=Je.DEFAULT_HERO_ID;var r=_.intance.m_dicHeros.get(a),s=r.skillIds;console.log("updateSkill",s);for(var o=s.length,l=0;l<o;l++){var c=s[l],u=_.intance.m_dicSkills.get(c),p=this["matchSkill"+(l+1)];p.keyNum=l+1,p.dataSource=[u,null,null,1];var d;i.skillCd instanceof Map?d=i.skillCd.get(c):d=i.skillCd[c],d&&p.updateSkillCooldown(d),p.updateGlobalCooldown(i.commonCd),p.visible=!0}var L=[],x=i.equips;if(x){let I=_.intance.getGeneralValueById(26);if(I){var w=0;I.forEach(M=>{var H=M[0],V;if(x instanceof Map?V=x.get(H+""):V=x[H+""],V){var q=V.id,X=_.intance.m_dicItems.get(q);X==null&&console.warn("itemItem is null id: "+q);var Z=X.skillId,Q=_.intance.m_dicSkills.get(Z),ee=this["matchSkill"+(o+w+1)];ee.keyNum=o+w+1,ee.dataSource=[Q,X,H,V.count];var ae=i.cardCd.get(H);ae&&ee.updateSkillCooldown(ae),ee.disabled=V.count<=0,ee.visible=!0,w++}})}}}}updateKill(){k.instance.myPlayer&&(this.tf_kill.text=k.instance.myPlayer.kill+""),this.list_rank.array=this.getSortPlayer(k.instance.matchHeroDic.values),this.tf_remainer.text=this.liveNum+"",this.tf_total.text="/ "+k.instance.matchHeroDic.values.length}getSortPlayer(e){var i=e.slice(),a=i.sort((o,l)=>l.score-o.score),r=[];this.liveNum=0;var s=1;return a.forEach(o=>{o.rankNum=s,o.hp>0&&this.liveNum++,(s<4||o.id==b.instance.playerDto.pid)&&r.push(o),s++}),r}updateBattleCD(){B.instance.matchDto.arenaType==W.ARENA_TYPE_PVE?(this.list_rank.visible=!1,B.instance.matchCoolDownTime=Math.round((B.instance.matchDto.nowTime-B.instance.matchDto.startTime)/1e3),this.onSetCoolTime(),Laya.timer.loop(1e3,this,this.onSetCoolTime)):(B.instance.matchCoolDownTime=Math.round(B.instance.matchDto.remainderCd/1e3),B.instance.matchCoolDownTime>0?(this.onSetCoolTime(),Laya.timer.loop(1e3,this,this.onSetCoolTime)):Laya.timer.clear(this,this.onSetCoolTime))}onSetCoolTime(){B.instance.matchDto.arenaType==W.ARENA_TYPE_PVE?(this.fontClip_reduceTime.value=se.format(B.instance.matchCoolDownTime,":",!1),this.fontClip_reduceTime.skin="res/match1/fontClip_1.png",B.instance.stopAll||B.instance.matchCoolDownTime++):B.instance.matchCoolDownTime>=0?(this.fontClip_reduceTime.value=se.format(B.instance.matchCoolDownTime,":",!1),B.instance.matchCoolDownTime>90?this.fontClip_reduceTime.skin="res/match1/fontClip_1.png":B.instance.matchCoolDownTime>10?this.fontClip_reduceTime.skin="res/match1/fontClip_2.png":(this.fontClip_reduceTime.skin="res/match1/fontClip_3.png",this.scaleEffect()),B.instance.stopAll||B.instance.matchCoolDownTime--):(Laya.timer.clear(this,this.onSetCoolTime),Laya.timer.once(1e4,this,this.checkMatchRankData))}checkMatchRankData(){B.instance.checkMatchRankData()}scaleEffect(){var e=this;Laya.Tween.to(this.fontClip_reduceTime,{scaleX:1.3,scaleY:1.3},200,Laya.Ease.linearInOut,Laya.Handler.create(this,function(){Laya.Tween.to(e.fontClip_reduceTime,{scaleX:1,scaleY:1},200,Laya.Ease.linearInOut)}))}updateCharactersOrder(){k.instance.allOrders.sort((e,i)=>e.y-i.y);for(let e=0;e<k.instance.allOrders.length;e++)k.instance.allOrders[e].zOrder=e;Br.instance.update()}onFirstBloodPush(e){var i=e.pid,a=k.instance.matchHeroDic.get(i);let r=a.icon;this.playerIcon_first.headSkin=r,this.img_firstBlood.visible=!0,this.img_firstBlood.alpha=0,this.img_firstBlood.y=-200,Laya.Tween.to(this.img_firstBlood,{y:92,alpha:1},200,Laya.Ease.linearInOut,Laya.Handler.create(this,this.onFirstBlood1))}onFirstBlood1(){this.zi_firstBlood.scale(1,1),Laya.Tween.to(this.zi_firstBlood,{scaleX:1.5,scaleY:1.5},200,Laya.Ease.linearNone,Laya.Handler.create(this,this.onFirstBlood2))}onFirstBlood2(){Laya.Tween.to(this.zi_firstBlood,{scaleX:1,scaleY:1},200,Laya.Ease.linearNone,Laya.Handler.create(this,this.onFirstBlood3))}onFirstBlood3(){Laya.Tween.to(this.img_firstBlood,{y:-200,alpha:0},200,Laya.Ease.linearInOut,Laya.Handler.create(this,this.onFirstBlood4),1500)}onFirstBlood4(){this.img_firstBlood.visible=!1}onMutiKillPush(e){this.fontClip_kill.value=e.kill+"";var i=!1;e.kill>=3?(i=!0,this.img_mutiKill.skin="res/match1/img_kill_3s.png"):this.img_mutiKill.skin="res/match1/img_kill_2s.png";var a=e.pid,r=k.instance.matchHeroDic.get(a);let s=r.icon;this.playerIcon_second.headSkin=s,this.img_mutiKill.visible=!0,this.img_mutiKill.alpha=0,this.img_mutiKill.y=-200,Laya.Tween.to(this.img_mutiKill,{y:175,alpha:1},200,Laya.Ease.linearInOut,Laya.Handler.create(this,this.onMutiKill1,[i]))}onMutiKill1(e){this.zi_mutiKill.scale(1,1),e?Laya.Tween.to(this.zi_mutiKill,{scaleX:1.5,scaleY:1.5},200,Laya.Ease.linearNone,Laya.Handler.create(this,this.onMutiKill2)):this.onMutiKill3(2e3)}onMutiKill2(){Laya.Tween.to(this.zi_mutiKill,{scaleX:1,scaleY:1},200,Laya.Ease.linearNone,Laya.Handler.create(this,this.onMutiKill3,[1500]))}onMutiKill3(e){Laya.Tween.to(this.img_mutiKill,{y:-200,alpha:0},200,Laya.Ease.linearInOut,Laya.Handler.create(this,this.onMutiKill4),e)}onMutiKill4(){this.img_mutiKill.visible=!1}onGameSceneGray(){this.matchBox.gray=!0}onBanAccountClick(){A.intance.openModule(y.BanAccountView)}async onExitClick(){var e=B.instance.matchWatcher;e?await v.requestPost("wxgame/room/leave",{roomId:B.instance.matchDto.roomId})?(lt.instance.isMatching=!1,this.setToAirdropScene()):E.instance.notice(m.instance.getLanguage(135)):console.log("不是观察者，不能退出")}setToAirdropScene(){k.instance.arenaType=B.instance.matchDto.arenaType,k.instance.arenaType==W.ARENA_TYPE_PVE?oe.intance.setCurrentScene(Y.M_SCENE_PVE):oe.intance.setCurrentScene(Y.M_SCENE_AIRDROP)}onEnable(){console.log("MatchScene onEnable"),g.intance.on(f.UPDATE_KILL_NUM,this,this.updateKill),g.intance.on(f.EVENT_RESTORE_DATA,this,this.onRestoreData),g.intance.on(f.EVENT_FirstBlood,this,this.onFirstBloodPush),g.intance.on(f.EVENT_MutiKill,this,this.onMutiKillPush),g.intance.on(f.EVENT_GameScene_Gray,this,this.onGameSceneGray),Laya.stage.on(Laya.Event.FOCUS,this,this.onWindowFocus)}onWindowFocus(){k.instance.sendRestoreData()}onDisable(){g.intance.off(f.UPDATE_KILL_NUM,this,this.updateKill),g.intance.off(f.EVENT_RESTORE_DATA,this,this.onRestoreData),g.intance.off(f.EVENT_FirstBlood,this,this.onFirstBloodPush),g.intance.off(f.EVENT_MutiKill,this,this.onMutiKillPush),g.intance.off(f.EVENT_GameScene_Gray,this,this.onGameSceneGray),Laya.stage.off(Laya.Event.FOCUS,this,this.onWindowFocus),Laya.timer.clearAll(this),B.instance.clearData()}};c_=h([TR("sX0uLhOQSmm8b-_sHNqe5w")],c_);var{regClass:CR,property:$5e}=Laya,Dc=class extends Laya.Script{constructor(){super()}onAwake(){}onStart(){k.instance.playMusic()}onLateUpdate(){k.instance.moveGameWindow()}onDisable(){Laya.timer.clearAll(this)}};Dc=h([CR("Ply19emtSrqrBk7nHXToAQ")],Dc);var u_=class extends Laya.Box{};var{regClass:SR}=Laya,m_=class extends u_{constructor(){super();this.isBig=!1;this.isAddEvent=!1}set dataSource(e){super.dataSource=e,this.skillItem=e,this.skillItem&&(this.txt_num.text="",this.img_icon.skin=S.instance.getMatchSkillIcon(this.skillItem.icon))}};m_=h([SR("iwuFUCOEQRyOjxpy6IkQ2Q")],m_);var p_=class extends Laya.Button{};var{regClass:DR}=Laya,h_=class extends p_{constructor(){super();this.isAddEvent=!1;this.isCanClick=!0;this.skillCooldown=5e3;this.thisGlobalCooldown=1e4;this.globalCooldown=1e4;this.remainingSkillCooldown=0;this.remainingGlobalCooldown=0;this.reduceCooldown=0}onEnable(){this.addEvent()}addEvent(){this.isAddEvent||(g.intance.on(f.EVENT_CLICK_NUM,this,this.onNumberClick),g.intance.on(f.EVENT_UPDATE_ITEM_SKILL_COOL,this,this.updateItemRemainCooldown),g.intance.on(f.EVENT_UPDATE_GLOBAL_COOL,this,this.updateGlobalCooldown),g.intance.on(f.EVENT_UPDATE_REDECE_COOL,this,this.updateReduceCooldown),this.isAddEvent=!0,this.on(Laya.Event.CLICK,this,this.onSkillButtonClick),this.on(Laya.Event.MOUSE_UP,this,this.onSkillButtonUp))}onNumberClick(e){e==this.keyNum&&this.onSkillButtonClick(null)}set dataSource(e){super.dataSource=e,this.skillItem=e[0],this.itemItem=e[1],this.equipPos=e[2],this.count=e[3],this.skillItem&&(this.addEvent(),this.setCurrentOutPut())}async setCurrentOutPut(){this.skillItem&&(this.skillIconItem.isBig=this.skillItem.icon=="1001",this.skillIconItem.dataSource=this.skillItem,this.itemItem?(this.txt_num.visible=!0,this.updateCount(),this.skillCooldown=this.itemItem.cd*1e3):(this.txt_num.visible=!1,this.skillCooldown=this.skillItem.cd),this.thisGlobalCooldown=this.skillItem.commCd,Laya.timer.frameLoop(1,this,this.updateCooldown))}onSkillButtonUp(e){e&&e.stopPropagation(),Qn.clearClickFilter(this)}onSkillButtonClick(e){if(e&&e.stopPropagation(),this.itemItem)if(this.remainingSkillCooldown+this.reduceCooldown<=0){if(console.log("道具技能释放！"),k.instance.myHeroSpr._isDead){console.log("自己已死亡，无法释放道具技能！");return}Laya.Tween.to(this,{scaleX:.8,scaleY:.8},100,Laya.Ease.linearNone,Laya.Handler.create(this,()=>{Laya.Tween.to(this,{scaleX:1,scaleY:1},100,Laya.Ease.linearNone)}));var i=this.itemItem.id;this.skillItem.type==6||this.skillItem.type==7?k.instance.onSendUse(!0,this.equipPos):k.instance.onSendUse(!1,this.equipPos)}else console.log("技能或全局冷却还在进行中，无法释放。");else this.remainingSkillCooldown+this.reduceCooldown<=0&&this.remainingGlobalCooldown+this.reduceCooldown<=0?(console.log("技能释放！"),Laya.Tween.to(this,{scaleX:.8,scaleY:.8},100,Laya.Ease.linearNone,Laya.Handler.create(this,()=>{Laya.Tween.to(this,{scaleX:1,scaleY:1},100,Laya.Ease.linearNone)})),k.instance.myHeroSpr.attack(0,this.skillItem.id),this.updateSkillCooldown(this.skillCooldown),g.intance.event(f.EVENT_UPDATE_GLOBAL_COOL,[this.thisGlobalCooldown])):console.log("技能或全局冷却还在进行中，无法释放。")}updateSkillCooldown(e){this.remainingSkillCooldown=e}updateItemRemainCooldown(e){var i=e[0];console.log("updateItemRemainCooldown _skillId: "+i),this.itemItem&&i==this.skillItem.id&&(this.count=e[1],this.updateCount(),this.updateSkillCooldown(this.skillCooldown))}updateCount(){this.txt_num.text=this.count+"",this.disabled=!this.count}updateReduceCooldown(e,i){console.log("updateReduceCooldown skillType: "+e),this.skillItem&&e==this.skillItem.type&&(this.reduceCooldown=this.skillCooldown*i)}updateGlobalCooldown(e){this.itemItem||(this.globalCooldown=e,this.remainingGlobalCooldown=e)}updateCooldown(){if(this.remainingSkillCooldown+this.reduceCooldown>0){this.remainingSkillCooldown-=Laya.timer.delta;let e=(this.remainingSkillCooldown+this.reduceCooldown)/1e3;this.txt_time.text=e.toFixed(1),this.updateCooldownMask(this.skillCooldownMask,(this.remainingSkillCooldown+this.reduceCooldown)/this.skillCooldown,"#000000"),this.img_djs.visible=!0,this.txt_time.visible=!0}else this.img_djs.visible=!1,this.txt_time.visible=!1;this.remainingGlobalCooldown+this.reduceCooldown>0?(this.remainingGlobalCooldown-=Laya.timer.delta,this.updateCooldownMask(this.globalCooldownMask,(this.remainingGlobalCooldown+this.reduceCooldown)/this.globalCooldown,"#00000036"),this.globalCooldownMask.visible=!0):this.globalCooldownMask.visible=!1,this.skillIconItem.gray=this.remainingSkillCooldown+this.reduceCooldown>0||this.remainingGlobalCooldown+this.reduceCooldown>0}updateCooldownMask(e,i,a){let r=this.width/2,s=this.width/2,o=this.height/2;e.graphics.clear(),e.graphics.drawPie(s,o,r,-90+360*(1-i),270,a)}onDisable(){g.intance.off(f.EVENT_UPDATE_ITEM_SKILL_COOL,this,this.updateItemRemainCooldown),g.intance.off(f.EVENT_UPDATE_GLOBAL_COOL,this,this.updateGlobalCooldown),g.intance.off(f.EVENT_UPDATE_REDECE_COOL,this,this.updateReduceCooldown),g.intance.offAllCaller(this),Laya.timer.clearAll(this)}};h_=h([DR("x6t-z1VuR52yXWju0qxGBg")],h_);var d_=class extends Laya.Box{};var{regClass:AR}=Laya,f_=class extends d_{constructor(){super(...arguments);this.isReady=!1;this.isGo=!1;this.target=null;this.isMe=!1;this.itemPos=0;this.gravity=.5;this.time=0}onEnable(){this.sk.on(Laya.Event.READY,this,this.onSkReady)}onSkReady(){console.log("RocketSpr onSkReady, this.isGo: ",this.isGo),this.isReady=!0,this.isGo==!1&&(this.initRocket(),this.calculateVelocity())}init(e,i,a,r,s){console.log("RocketSpr init, _isMe: ",s,e,this.isReady,this.x,this.y),this.startX=i,this.startY=a,this.target=r,this.isMe=s,this.itemPos=e,this.time=0,this.sk.rotation=270,this.pos(this.startX,this.startY),console.log("RocketSpr init, this.x, this.y: ",this.x,this.y),this.isReady?(this.isGo=!0,this.initRocket(),this.calculateVelocity()):this.isGo=!1}initRocket(){this.sk.play("animation1",!0,!0),Laya.timer.frameLoop(1,this,this.update)}calculateVelocity(){var e,i;this.target?(e=this.target.x,i=this.target.y):(e=this.startX-200,i=this.startY);let a=e-this.startX,r=i-this.startY,s=120;this.vx=a/s,this.vy=(r-.5*this.gravity*s*s)/s}update(){this.time+=1,this.updateTarget(),this.x=this.startX+this.vx*this.time,this.y=this.startY+this.vy*this.time+.5*this.gravity*this.time*this.time,this.updateRotation();var e,i;this.target?(e=this.target.x,i=this.target.y):(e=this.startX-200,i=this.startY),Math.abs(this.x-e)<10&&Math.abs(this.y-i)<10&&this.hitTarget()}updateTarget(){var e,i;this.target?(e=this.target.x,i=this.target.y):(e=this.startX-200,i=this.startY);let a=e-this.startX,r=i-this.startY,s=60;this.vx=a/s,this.vy=(r-.5*this.gravity*s*s)/s}updateRotation(){var e,i;this.target?(e=this.target.x,i=this.target.y):(e=this.startX-200,i=this.startY);let a=Math.atan2(i-this.y,e-this.x);this.sk.rotation=a*(180/Math.PI)}hitTarget(){console.log("Rocket hit the target!"),Laya.timer.clear(this,this.update),this.onRealAttack(),this.playExplosion()}playExplosion(){this.sk.play("animation2",!1,!0),Laya.timer.once(1e3,this,()=>{this.removeSelf()})}onRealAttack(){this.isMe&&this.target&&k.instance.onSendAttackBig(this.itemPos,[this.target.roomPlayerDto.id])}onDisable(){console.log("RocketSpr onDisable!"),Laya.timer.clearAll(this),Laya.Pool.recover("rocketSpr",this),this.target=null}};f_=h([AR("Fa_gpkaEQ3yUIurydSEtrw")],f_);var y_=class extends Laya.Dialog{};var{regClass:kR}=Laya,b_=class extends y_{constructor(){super();this.canClose=!0}onEnable(){this.btn_refresh.on(Laya.Event.CLICK,this,this.onRefresh),this.alertDesc.on(Laya.Event.LINK,this,this.onLink)}onLink(e){console.log("点击了超链接："+e)}onRefresh(){He.instance.reload()}setOpenData(e){if(e){var i=e[0];if(e.length>2?(this.alertTitle.text=e[1],this.alertDesc.text=e[2]):this.alertDesc.text=e[1],i==1){this.canClose=!1;var a=this.getChildByName("close");a.visible=!1,this.btn_refresh.visible=!0}else this.btn_refresh.visible=!1;this.alertDesc.height=this.alertDesc.textField.textHeight+20}}onDisable(){}close(e){this.canClose&&super.close(e)}};b_=h([kR("xATCTfSDSkaGtuYn669ofQ")],b_);var g_=class extends Laya.Dialog{};var{regClass:BR}=Laya,L_=class extends g_{constructor(){super()}onEnable(){this.img_show.on(Laya.Event.CLICK,this,this.close)}setOpenData(t){t&&(this.img_show.skin=t)}onDisable(){}};L_=h([BR("RUMV5hpfRdCRzhO9yBDCzg")],L_);var __=class extends Laya.Dialog{};var{regClass:MR}=Laya,v_=class extends __{constructor(){super();this.canClose=!0}onEnable(){this.btn_refresh.on(Laya.Event.CLICK,this,this.onRefresh),this.alertDesc.on(Laya.Event.LINK,this,this.onLink),this.btn_left.on(Laya.Event.CLICK,this,this.onChangePage,[!1]),this.btn_right.on(Laya.Event.CLICK,this,this.onChangePage,[!0])}onLink(e){console.log("点击了超链接："+e)}onRefresh(){He.instance.reload()}setOpenData(e){if(e){var i=e[0],a=e[1];if(this.list=a.list,this.pageNo=1,this.pageTotal=this.list.length,this.pageTotal<2&&(this.box_page.visible=!1),this.updatePageList(),i==1){this.canClose=!1;var r=this.getChildByName("close");r.visible=!1,this.btn_refresh.visible=!0}else this.btn_refresh.visible=!1}}async onChangePage(e){if(e)this.pageNo++;else{if(this.pageNo<=1)return;this.pageNo--}this.updatePageList()}updatePageList(){this.txt_page.text=this.pageNo+"/"+this.pageTotal,this.btn_left.disabled=this.pageNo<=1,this.btn_right.disabled=this.pageNo>=this.pageTotal,this.setNoticeDetail()}setNoticeDetail(){if(this.pageNo){var e=this.list[this.pageNo-1];e&&(this.alertTitle.text=m.instance.getMultiLan(e.title),this.alertDesc.text=m.instance.getMultiLan(e.contents))}}onDisable(){}close(e){this.canClose&&super.close(e)}};v_=h([MR("iB7UvqEcQ1GFKaVEIy6Bmw")],v_);var x_=class extends Laya.Box{};var{regClass:RR}=Laya,I_=class extends x_{};I_=h([RR("ON5bkSuKSE2gwPDUnRGmrw")],I_);var E_=class extends Laya.Box{};var{regClass:PR}=Laya,w_=class extends E_{onEnable(){}notice(t){this.zOrder=1e7;let e=t;this.label_tf.text=e,this.label_tf.x=68,this.image_bg.width=68*2+this.label_tf.textField.textWidth,e.length/45>1&&(this.image_bg.height=this.label_tf.textField.textHeight+55),this.alpha=1,this.visible=!0}get view(){return this}get width(){return this.image_bg.width}onDisable(){console.log("txtNotice recover"),Laya.Pool.recover("txtNotice",this)}};w_=h([PR("Nm27xWbYSG6mj-EXqPOZ_A")],w_);var T_=class extends Laya.Dialog{};var{regClass:NR}=Laya,C_=class extends T_{constructor(e){super();this.m_iLayerType=C.M_POP;this.m_iPositionType=C.CENTER;this.propValue=1;this.propNum=1;this.propData=null;this.heroPk=null;this.chooseType=1;this.subType=1;this.items=[]}onEnable(){this.txt_num.text="1",this.listPanel1.visible=!1,this.btn_subtract.on(Laya.Event.CLICK,this,this.changePropNum,[!1]),this.btn_add.on(Laya.Event.CLICK,this,this.changePropNum,[!0]),this.listPanel1.selectHandler=new Laya.Handler(this,this.handleSelectProp),this.btn_transfer.on(Laya.Event.CLICK,this,this.onBtnTramsfer),g.intance.on(f.SHOW_EQUIP_TIP,this,this.showEquipTip),this.initPropList()}setOpenData(e){e&&(this.chooseType=e[0],this.subType=e[1],this.chooseType==Ge.CHOOSE_Wallet?(this.btn_transfer.label=m.instance.getUILang("Transfer in"),this.box_count.visible=!0,this.tf_title.text=m.instance.getUILang("Select tickets")):(this.heroPk=e[2],this.btn_transfer.label=m.instance.getUILang("Put on"),this.box_count.visible=!1,this.tf_title.text=m.instance.getUILang("Select equipment")))}changePropNum(e){e?this.propValue+=1:this.propValue=Math.max(this.propValue-1,1),this.txt_num.text=`${this.propValue}`}async initPropList(){await Et.instance.ownerBag();var e=this.getItemByType();this.propData=e,this.listPanel1.array=e,this.listPanel1.selectedIndex=0,this.listPanel1.visible=!0}handleSelectProp(e){if(e!==-1){this.propValue=1,this.txt_num.text="1";let i=this.listPanel1.selectedItem;i&&(this.propNum=Number(i._m_iNum),console.log(this.propNum))}}showEquipTip(e){if(this.chooseType!==Ge.CHOOSE_Wallet){let i=e.data;this.EquipDetailBox.dataSource=i,e.positionX<500?this.EquipDetailBox.x=e.positionX+175:this.EquipDetailBox.x=e.positionX-440,this.EquipDetailBox.visible=!0,this.equipBgBox.visible=!0,this.equipBgBox.on(Laya.Event.CLICK,this,this.hideTips)}}hideTips(){this.EquipDetailBox.visible=!1,this.equipBgBox.visible=!1,this.equipBgBox.off(Laya.Event.CLICK,this,this.hideTips)}async onBtnTramsfer(){let e=this.propData[this.listPanel1.selectedIndex],i=this.propValue,a={amount:this.propValue,propData:e};g.intance.event(f.EVENT_PVE_CHOOSE_PROP,a),this.close()}getItemByType(){this.items=[];let e=_.intance.getArrFromDicItemByKey("subType",12),i=_.intance.getArrFromDicItemByKey("id",1086);return console.log("skillItem",e,"ticketItem",i),[...i,...e].forEach(r=>{var s=new Ne(r.id);s.newAddCnt=1,this.items.push(s)}),this.items}onDisable(){this.btn_subtract.off(Laya.Event.CLICK,this,this.changePropNum),this.btn_add.off(Laya.Event.CLICK,this,this.changePropNum),this.btn_transfer.off(Laya.Event.CLICK,this,this.onBtnTramsfer),this.stage.off(Laya.Event.CLICK,this,this.hideTips),g.intance.off(f.SHOW_EQUIP_TIP,this,this.showEquipTip)}};C_=h([NR("aFkC9qlwTMKGR-gqNwAz2g")],C_);var S_=class extends Laya.Box{};var{regClass:OR}=Laya,D_=class extends S_{constructor(){super()}createChildren(){super.createChildren()}onEnable(){this.btn_copy.on(Laya.Event.CLICK,this,this.onCopy),this.btn_record.on(Laya.Event.CLICK,this,this.onBtnRecord)}set dataSource(e){if(!e)return;this.playerData=e,super.dataSource=e;let i=e.id===b.instance.playerDto.pid,a=e.rank;if(this.tf_name.text=e.name,this.tf_union.text=m.instance.getMultiLan(e.shortUnionName),this.tf_rank.text=a,this.tf_time.text=se.formatWithSecondByMs(e.score),this.playerIcon.headSkin=e.head,e.address?(this.fromBox.visible=!0,this.address=e.address,this.tf_from.text=`${te.shortenString(e.address,7,4)}`):this.fromBox.visible=!1,this.img_flag.skin=S.instance.getCountryIcon(e.country),e.icon){let r=S.instance.getUnionIcon(e.icon);this.img_lvIcon.skin=r,this.img_lvIcon.visible=!0}else this.img_lvIcon.visible=!1;i?this.bg.skin="res/matchRank1/img_ranking_bg_me.png":this.bg.skin=a<4?`res/rank/img_guild_${a}di.png`:"res/rank/img_guild_4di.png",a<4?(this.img_rankIcon1.skin=`res/matchRank1/img_ranking_${a}.png`,this.img_rankIcon1.visible=!0,this.img_rankIcon2.visible=!1):(this.img_rankIcon2.skin=i?"res/matchRank1/img_ranking_ranking_me.png":"res/matchRank1/img_ranking_ranking_4.png",this.img_rankIcon2.visible=!0,this.img_rankIcon1.visible=!1)}onCopy(){let e=this.address;doCopy(e),E.instance.notice(m.instance.getLanguage(132))}onBtnRecord(){this.playerData&&A.intance.openModule(y.PveRecordView,this.playerData)}};D_=h([OR("KfnrNdUwRnGbP3mPsVczIw")],D_);var A_=class extends Laya.Box{};var{regClass:HR}=Laya,k_=class extends A_{constructor(){super();this.isAddEvent=!1}createChildren(){super.createChildren()}addEvent(){this.isAddEvent}set dataSource(e){super.dataSource=e,e&&(this.recordItem=e,this.tf_day.text=se.formatTimeStamps(this.recordItem.time,"YY-MT-DD HH:MM:SS"),this.tf_rank.text=`${this.recordItem.rank}`,this.tf_duration.text=se.formatWithSecondByMs(this.recordItem.duration),this.addEvent())}onDisable(){this.removeEvent()}removeEvent(){}};k_=h([HR("5A7gBlSZRCiXSZqpLgERgg")],k_);var B_=class extends Laya.Dialog{};var M_=class extends Laya.Dialog{};var{regClass:UR}=Laya,ma=class extends M_{constructor(e){super();this.itemIndex=-1;this.heroList=[];this.useHeroList=[];this.chooseType=0}onEnable(){console.log(b.instance.playerDto.fightHeroPk),this.list_hero.visible=!1,this.createHeadList(),this.btn_transfer.on(Laya.Event.CLICK,this,this.onBtnTramsfer)}async setOpenData(e){this.itemIndex=e[0],this.useHeroList=e[1],this.chooseType=e[2],this.chooseType==ma.ChooseType_Pve_Exp&&(this.btn_transfer.label=m.instance.getLanguage(1037))}async onBtnTramsfer(){let e=this.list_hero.selectedIndex;if(e<0){pe.instance().AlertByType(P.BASEALERTVIEW,m.instance.getLanguage(1167),P.YES);return}let i=this.heroList[e];if(this.chooseType==ma.ChooseType_Pve_Exp){if(Ae.instance.inMinWaiting){E.instance.notice(m.instance.getLanguage(1187));return}let a=i.newFightFlag==1?1:0,r=await v.requestPost("wxgame/hero/heroFight",{pk:i.pk,type:a});r?(r.type==1?b.instance.playerDto.newFightHeroPk=r.pk:b.instance.playerDto.fightHeroPk=r.pk,g.intance.event(f.CHANGE_PVE_EXP_HERO),this.close()):E.instance.notice(m.instance.getLanguage(135))}else this.itemIndex!==-1?g.intance.event(f.CHANGE_WALLET_HERO_AIR,[i,this.itemIndex]):g.intance.event(f.CHANGE_WALLET_HERO,i),console.log("onBtnTramsfer",e),this.close()}async createHeadList(){if(!this)return;await Et.instance.ownerHero();let e=b.instance.m_heroData.heroVoDic.values;if(this.chooseType==ma.ChooseType_Pve_Exp?this.heroList=te.filterPVEExpHerosByState(e,0,this.useHeroList):this.heroList=te.filterObjectsByState(e,0,this.useHeroList),this.heroList.sort((i,a)=>{if(i===null&&a!==null)return 1;if(i!==null&&a===null)return-1;if(i!==null&&a!==null){if(i.heroItem.quality!==a.heroItem.quality)return a.heroItem.quality-i.heroItem.quality;if(i.heroItem.icon===null&&a.heroItem.icon!==null)return 1;if(i.heroItem.icon!==null&&a.heroItem.icon===null)return-1;if(i.heroItem.icon!==a.heroItem.icon)return i.heroItem.icon<a.heroItem.icon?-1:1}return 0}),this.heroList){this.list_hero.array=this.heroList,this.list_hero.visible=!0;let i=-1;this.list_hero.selectedIndex=i}}onDisable(){this.btn_transfer.off(Laya.Event.CLICK,this,this.onBtnTramsfer)}};ma.ChooseType_Pve_Exp=3,ma=h([UR("8aIFsnkXTaWPXwTKHxCGpQ")],ma);var R_=class extends Laya.Scene{};var{regClass:VR}=Laya,Ti=class extends R_{constructor(){super(...arguments);this.currTab=0;this.nodeId=-1;this.pageIndex=1;this.nodeIds=[];this.nodeDatas=[];this.pageSize=20;this.scrolLock=!0;this.countryId=999;this.itemId=0;this.arenaId=0;this.ticketTypeDatas=[]}onAwake(){this.m_iLayerType=C.M_POP,this.m_iPositionType=C.UP}async onOpened(e){}onEnable(){Ti.isExp=!1,this.btn_back.on(Laya.Event.CLICK,this,this.setToMainScene),this.box_node.on(Laya.Event.CLICK,this,this.onOpenNode),this.box_country.on(Laya.Event.CLICK,this,this.onOpenCountry),g.intance.on(f.EVENT_CHECK_NODE_SELECT,this,this.onNodeSelected),g.intance.on(f.CHANGE_PVE_EXP_HERO,this,this.initHeroData),this.initNode(),this.initCityNodeCombo(),this.rankLanList.scrollBar.on(Laya.Event.CHANGE,this,this.onScrollBarChange);for(let i=1;i<6;i++)this["btn_"+i].on(Laya.Event.CLICK,this,this.onClickTab,[i]);this.onClickTab(1),this.dayNode=this.dayBox.getChildByName("tf_time"),this.hourNode=this.hourBox.getChildByName("tf_time"),this.minNode=this.minBox.getChildByName("tf_time"),this.secNode=this.secBox.getChildByName("tf_time"),this.msNode=this.msBox.getChildByName("tf_time"),this.initTicketCombo(),this.rankRewardList.array=null,this.rankLanList.visible=!1,this.challenge_room.visible=!1,Laya.LocalStorage.getItem(z.COOKIE_CF_LAN)=="zh"?this.tf_myTeamNum.text='美東時間 2024年11月5日<font color="#fff088">7</font>點':this.tf_myTeamNum.text='Eastern Timer,November 5,2024,<font color="#fff088">7:00</font>AM',this.initCountry(),Laya.timer.loop(1e3,this,this.refreshRoomBtnRed)}onOpenNode(){this.img_node_pad.visible==!1&&(this.img_node_pad.visible=!0,Laya.stage.once(Laya.Event.MOUSE_DOWN,this,this.onHideNode))}onListDown(e){e.stopPropagation()}initNode(){this.list_node.selectHandler=new Laya.Handler(this,this.handleSelectNode),this.createNodeList(),this.btn_trump.on(Laya.Event.CLICK,this,this.onBtnTrump),this.btn_selectOther.on(Laya.Event.CLICK,this,this.onSelectOther),this.btn_ticket.on(Laya.Event.CLICK,this,this.onBtnTicket),this.btn_challenge.on(Laya.Event.CLICK,this,this.onBtnChallenge),this.box_node.on(Laya.Event.CLICK,this,this.onOpenNode),this.list_node.on(Laya.Event.MOUSE_DOWN,this,this.onListDown),this.list_node.mouseHandler=Laya.Handler.create(this,this.onNodeItemMouse,null,!1),this.list_node.renderHandler=Laya.Handler.create(this,this.onNodeItemRender,null,!1),this.list_node.scrollBar&&this.list_node.scrollBar.on(Laya.Event.MOUSE_DOWN,this,this.onScrollBarDown)}initCityNodeCombo(){this.nodeIds=[];var e=_.intance.m_dicNodes.values;this.nodeDatas=[],e.forEach(i=>{this.nodeIds.push(i.id),this.nodeDatas.push([i.id,!0,i])}),this.list_node_city.array=this.nodeDatas}onNodeSelected(){this.nodeIds=[],this.nodeDatas.forEach(e=>{e[1]&&this.nodeIds.push(e[0])}),console.log("您选中了 nodeType"+this.nodeIds),this.initRoomListData(),this.getRoomByType()}async getRoomByType(){}onNodeItemMouse(e,i){e.type===Laya.Event.CLICK&&(this.list_node.selectedIndex=i,this.onHideNode())}onNodeItemRender(e,i){e.onChange(this.list_node.selectedIndex==i)}onScrollBarDown(e){e.stopPropagation()}handleSelectNode(e){if(console.log("handleSelectNode: "+e),e!=-1){let i=this.list_node.selectedItem;this.nodeId=i.id,this.img_node.skin=S.instance.getNodeIcon(i.area),this.tf_node_name.text=m.instance.getLanguage(i.name),this.nodeDelaySign.dataSource=i}}onHideNode(){this.img_node_pad.visible=!1,Laya.stage.off(Laya.Event.MOUSE_DOWN,this,this.onHideNode),this.img_bg.off(Laya.Event.MOUSE_DOWN,this,this.onHideNode)}createNodeList(){let e=_.intance.m_dicNodes;this.list_node.array=e.values,this.list_node.visible=!0;let i=-1,a=0;if(e.values.length>0&&(i=0),this.roomDto)for(let r of e.values){if(r.id==this.roomDto.nodeId){i=a;break}a++}this.list_node.selectedIndex=i}setTab(e){this.currTab=e;for(let i=1;i<6;i++)if(e==i){this["btn_"+i].getChildByName("btn_yellowBg").visible=!0;let a=this["box_"+i];i==4&&(a=this.box_3),a&&(a.visible=!0),this["btn_"+i].getChildByName("Label").color="#143268"}else{this["btn_"+i].getChildByName("btn_yellowBg").visible=!1,this["btn_"+i].getChildByName("Label").color="#ffffff";let a=this["box_"+i];a&&(a.visible=!1)}}onClickTab(e){this.currTab!=e&&(this.setTab(e),Laya.timer.clear(this,this.refreshTime),Laya.timer.clear(this,this.initRoomListData),Laya.timer.clear(this,this.refreshRoomTime),this.box_country.visible=!1,e==1||(e==2?(this.initRoomListData(),Laya.timer.loop(5e3,this,this.initRoomListData),Laya.timer.loop(1e3,this,this.refreshRoomTime)):e==3?(this.pageIndex=1,this.getRankData(!1),this.box_country.visible=!0,this.rankLanList.scrollTo(0)):e==4?(this.pageIndex=1,this.getRankData(!0),this.box_country.visible=!0,this.rankLanList.scrollTo(0)):e==5&&this.getRewardRankData()))}initHeroData(){let e=b.instance.playerDto;this.itemId==Ge.ITEM_PT?(this.fightHero=this.getFightHeroData(e.fightHeroPk),this.btn_trump.visible=!0,this.btn_selectOther.visible=!1):this.itemId==Ge.ITEM_PT_EXP&&(this.fightHero=this.getFightHeroData(e.newFightHeroPk),this.btn_trump.visible=!1,this.btn_selectOther.visible=!0),this.fightHero?(this.img_hero.visible=!0,this.img_hero.skin=this.fightHero.simgurl,this.tf_heroName.text=Me.shortHeroStr(this.fightHero.name)):(this.img_hero.visible=!1,this.tf_heroName.text="無"),console.log(this.fightHero)}getFightHeroData(e){let i=b.instance.m_heroData.heroVoDic.values;for(let a=0;a<i.length;a++)if(e==i[a].pk)return i[a]}onSelectOther(){console.log("onSelectOther");var e=[];this.fightHero&&(e=[this.fightHero.pk]),A.intance.openModule(y.WalletChooseHeroDialog,[-1,e,ma.ChooseType_Pve_Exp])}setToMainScene(){oe.intance.setCurrentScene(Y.M_SCENE_MAIN)}onBtnTrump(){oe.intance.setCurrentScene(Y.M_SCENE_SHOP,[6])}onBtnTicket(){oe.intance.setCurrentScene(Y.M_SCENE_SHOP,[2,5])}async onBtnChallenge(){if(!this.fightHero){E.instance.notice(m.instance.getLanguage(1687));return}console.log(this.fightHero.pk,this.nodeId),this.btn_challenge.disabled=!0,v.requestPost("wxgame/pve/create",{nodeId:this.nodeId,heroPk:this.fightHero.pk,newFight:this.fightHero.newFightFlag,arenaId:this.arenaId}).then(e=>{this.destroyed||(e?(e.roomDto&&(B.instance.roomDto=e.roomDto),e.roomDto?(lt.instance.initSocket(),Laya.timer.once(5e3,this,this.restoreChallengeBtn)):(E.instance.notice(m.instance.getLanguage(135)),this.restoreChallengeBtn())):this.restoreChallengeBtn())}).catch(e=>{this.restoreChallengeBtn()})}restoreChallengeBtn(){this.btn_challenge.disabled=!1}openTimeMechain(){Laya.timer.loop(30,this,this.refreshTime)}refreshTime(){let e=se.getTimeDifference(173079e4,zi.DAYS);this.dayNode&&(this.dayNode.text=`${e.days}`),this.hourNode&&(this.hourNode.text=`${e.hours}`),this.minNode&&(this.minNode.text=`${e.minutes}`),this.secNode&&(this.secNode.text=`${e.seconds}`),this.msNode&&(this.msNode.text=`${e.ms}`)}async initRoomListData(){let e=await v.requestPost("wxgame/pve/list",{nodeIds:this.nodeIds});e&&(this.challenge_room.array=e.roomList,this.challenge_room.array.length>0?this.noDataBox.visible=!1:this.noDataBox.visible=!0,this.challenge_room.visible=!0)}refreshRoomTime(){let e=this.challenge_room.array;if(!(!e||e.length<1)){for(let i=0;i<e.length;i++)if(e[i]){let a=e[i];a.startTimeDiff+=1e3}this.challenge_room.refresh()}}async getRewardRankData(){let e=await v.requestPost("wxgame/pve/pveLuckUsdt",{});console.log(e),e&&(this.rankRewardList.array=e.rankList,this.rankRewardList.visible=!0)}async getRankData(e=!1){Ti.isExp=e;let i;this.countryId==999?i=await v.requestPost("wxgame/pve/rank",{pageSize:this.pageSize,pageNum:this.pageIndex,exp:Ti.isExp}):i=await v.requestPost("wxgame/pve/rank",{pageSize:this.pageSize,pageNum:this.pageIndex,exp:Ti.isExp,country:this.countryId}),console.log(i),i&&(this.rankLanList.array=i.rankList,this.rankLanList.visible=!0)}async loadMoreData(){if(this.scrolLock){this.pageIndex+=1,this.scrolLock=!1,Laya.timer.once(1e4,this,this.refreshLock);let e;if(this.countryId==999?e=await v.requestPost("wxgame/pve/rank",{pageSize:this.pageSize,pageNum:this.pageIndex,exp:Ti.isExp}):e=await v.requestPost("wxgame/pve/rank",{pageSize:this.pageSize,pageNum:this.pageIndex,exp:Ti.isExp,country:this.countryId}),console.log(e),e){this.scrolLock=!0;let i=e.rankList;this.rankLanList.array.push(...i),this.rankLanList.array=this.rankLanList.array,Laya.timer.clear(this,this.refreshLock)}}}onScrollBarChange(){this.rankLanList.scrollBar.value>=this.rankLanList.scrollBar.max&&this.loadMoreData()}refreshLock(){this.scrolLock=!0,console.log("重置锁")}refreshRoomBtnRed(){this.img_red_2.visible=b.instance.getRedDotById(he.instance.ROOM_4_6)}onDisable(){Laya.timer.clear(this,this.refreshLock),Laya.timer.clear(this,this.refreshRoomTime),Laya.timer.clearAll(this),Laya.Tween.clearAll(this),g.intance.off(f.EVENT_CHECK_NODE_SELECT,this,this.onNodeSelected),g.intance.off(f.CHANGE_PVE_EXP_HERO,this,this.initHeroData)}initTicketCombo(){var e=_.intance.getGeneralValueById(32);this.ticketTypeDatas=[],e.forEach(a=>{let r=_.intance.getArrFromDicItemByKey("id",a)[0];this.ticketTypeDatas.push([a,m.instance.getLanguage(r.name)])}),console.log("this.ticketTypeDatas: ",this.ticketTypeDatas),this.ticketCombo.selectHandler=new Laya.Handler(this,this.onSelectedRentalType),this.ticketCombo.dataSource=this.ticketTypeDatas;let i=0;this.ticketCombo.selectedIndex=i}onSelectedRentalType(e){if(e!=-1){this.itemId=this.ticketTypeDatas[e][0];var i=W.ARENA_TYPE_PVE;let a=_.intance.getArenaTypesInSubByItemId(i,this.itemId);a&&(this.arenaId=a.id,this.initHeroData())}}onCountryItemRender(e,i){e.onChange(this.list_country.selectedIndex==i)}initCountry(){this.list_country.selectHandler=new Laya.Handler(this,this.handleSelectCountry),this.createCountryList(),this.box_country.on(Laya.Event.CLICK,this,this.onOpenCountry),this.list_country.on(Laya.Event.MOUSE_DOWN,this,this.onListDown),this.list_country.mouseHandler=Laya.Handler.create(this,this.onCountryItemMouse,null,!1),this.list_country.renderHandler=Laya.Handler.create(this,this.onCountryItemRender,null,!1),this.list_country.scrollBar&&this.list_country.scrollBar.on(Laya.Event.MOUSE_DOWN,this,this.onScrollBarDown)}createCountryList(){let e=_.intance.m_dicCountry,a=[{id:999,name:"All"},...e.values];this.list_country.array=a,this.list_country.visible=!0;let r=-1,s=0;this.countryId=999;for(let o of a){if(o.id==this.countryId){r=s;break}s++}this.list_country.selectedIndex=r}handleSelectCountry(e){if(console.log("handleSelectCountry: "+e),e!=-1){let i=this.list_country.selectedItem;this.countryId=i.id,i.id==999?(this.img_flag.visible=!1,this.tf_country.text=m.instance.getLanguage(i.name)):(this.img_flag.visible=!0,this.img_flag.skin=S.instance.getCountryIcon(i.id),this.tf_country.text=m.instance.getLanguage(i.name)),this.currTab==3?(this.pageIndex=1,this.getRankData(!1)):(this.pageIndex=1,this.getRankData(!0))}}onOpenCountry(){this.img_country_pad.visible==!1&&(this.img_country_pad.visible=!0,Laya.stage.once(Laya.Event.MOUSE_DOWN,this,this.onHideCountry))}onHideCountry(){this.img_country_pad.visible=!1,Laya.stage.off(Laya.Event.MOUSE_DOWN,this,this.onHideCountry)}onCountryItemMouse(e,i){e.type===Laya.Event.CLICK&&(this.list_country.selectedIndex=i,this.onHideCountry())}};Ti.isExp=!0,Ti=h([VR("k5ciB37ORFSIRZc17hoKMA")],Ti);var{regClass:FR}=Laya,P_=class extends B_{constructor(){super(...arguments);this.m_strName="我是OpenSceneRuntime";this.m_iLayerType=C.M_PANEL;this.m_iPositionType=C.CENTER;this.pageIndex=1;this.pageSize=20;this.scrolLock=!0;this.useYlp=!1}onEnable(){this.list_recordLog.visible=!1,this.btn_back.on(Laya.Event.CLICK,this,this.onBack),this.btn_copy.on(Laya.Event.CLICK,this,this.onCopy),this.btn_sponsor.on(Laya.Event.CLICK,this,this.onBtnSponsor),g.intance.on(f.EVENT_PVE_HAVE_PROP,this,this.initPlayerProp),this.list_recordLog.scrollBar.on(Laya.Event.CHANGE,this,this.onScrollBarChange),this.listPanel1.visible=!1}setOpenData(e){this.playerData=e,this.initPlayerProp(),this.initRecord()}setPlayerData(){this.btn_sponsor.disabled=b.instance.playerDto.pid==this.playerData.pid,this.tf_name.text=this.playerData.name,this.tf_union.text=m.instance.getMultiLan(this.playerData.shortUnionName),this.btn_sponsor.visible=this.playerData.rank>10&&b.instance.pveOpen!==1&&this.useYlp,this.playerData.address?(this.fromBox.visible=!0,this.tf_from.text=`${te.shortenString(this.playerData.address,7,4)}`):this.fromBox.visible=!1,this.playerIcon.headSkin=this.playerData.head,this.img_flag.skin=S.instance.getCountryIcon(this.playerData.country)}onCopy(){let e=this.playerData.address;doCopy(e),E.instance.notice(m.instance.getLanguage(132))}onDisable(){this.removeEvent()}removeEvent(){this.btn_back.off(Laya.Event.CLICK,this,this.onBack),this.btn_copy.off(Laya.Event.CLICK,this,this.onCopy),this.btn_sponsor.off(Laya.Event.CLICK,this,this.onBtnSponsor),g.intance.off(f.EVENT_PVE_HAVE_PROP,this,this.initPlayerProp),this.list_recordLog.scrollBar.off(Laya.Event.CHANGE,this,this.onScrollBarChange)}onBtnSponsor(){A.intance.openModule(y.PveSponsorView,this.playerData)}async initPlayerProp(){let e=await v.requestPost("wxgame/pve/pveChallengeInfo",{id:this.playerData.pid});if(e){this.useYlp=e.useYlp;let i=this.transeToItemVo(e.items);this.listPanel1.array=i,this.listPanel1.visible=!0}this.setPlayerData()}transeToItemVo(e){let i=[];for(let r=0;r<e.length;r++){let s=new Ne;var a=e[r];s.m_iId=a.id,a.pk&&(s.m_iPk=a.pk),s.m_iId=a.id,s.m_iNum=a.count,i.push(s)}return i}async initRecord(){let e=await v.requestPost("wxgame/pve/pveChallengeRecords",{pageSize:this.pageSize,pageNum:this.pageIndex,id:this.playerData.pid,exp:Ti.isExp});e&&(this.list_recordLog.array=e.items,this.list_recordLog.visible=!0)}async loadMoreData(){if(this.scrolLock){this.pageIndex+=1,this.scrolLock=!1,Laya.timer.once(1e4,this,this.refreshLock);let e=await v.requestPost("wxgame/pve/pveChallengeRecords",{pageSize:this.pageSize,pageNum:this.pageIndex,id:this.playerData.pid});if(console.log(e),e){this.scrolLock=!0;let i=e.items;this.list_recordLog.array.push(...i),this.list_recordLog.array=this.list_recordLog.array,Laya.timer.clear(this,this.refreshLock)}}}onScrollBarChange(){this.listPanel1.scrollBar.value>=this.listPanel1.scrollBar.max&&this.loadMoreData()}refreshLock(){this.scrolLock=!0,console.log("重置锁")}onBack(){this.close()}};P_=h([FR("1CSNzmbcSdu78dCzj1J-hw")],P_);var N_=class extends Laya.Box{};var{regClass:GR}=Laya,O_=class extends N_{constructor(){super()}createChildren(){super.createChildren()}onEnable(){this.btn_copy.on(Laya.Event.CLICK,this,this.onCopy)}set dataSource(e){if(!e)return;this.playerData=e,super.dataSource=e;let i=e.id===b.instance.playerDto.pid,a=e.rank;if(this.tf_name.text=e.name,this.tf_union.text=m.instance.getMultiLan(e.shortUnionName),this.playerIcon.headSkin=e.head,e.address?(this.fromBox.visible=!0,this.address=e.address,this.tf_from.text=`${te.shortenString(e.address,7,4)}`):this.fromBox.visible=!1,this.img_flag.skin=S.instance.getCountryIcon(e.country),e.icon){let c=S.instance.getUnionIcon(e.icon);this.img_lvIcon.skin=c,this.img_lvIcon.visible=!0}else this.img_lvIcon.visible=!1;i?this.bg.skin="res/matchRank1/img_ranking_bg_me.png":this.bg.skin="res/rank/img_guild_4di.png";var r=_.intance.m_dicPveLuckyDraws.get(a);this.tf_rewardName.text=m.instance.getLanguage(r.name);var s=_.intance.m_dicItems.get(r.token),o=m.instance.getLanguage(s.name),l=xe.formatNumber(r.bonus)+" "+o;this.tf_reward.text=l}onCopy(){let e=this.address;doCopy(e),E.instance.notice(m.instance.getLanguage(132))}};O_=h([GR("rqW6WvFST-agZW2AS9Jy7A")],O_);var H_=class extends Laya.Box{};var{regClass:KR}=Laya,U_=class extends H_{constructor(){super();this.isAddEvent=!1}addEvent(){this.isAddEvent||this.btn_watch.on(Laya.Event.CLICK,this,this.onWatch)}onEnable(){}async onWatch(){Ae.instance.onCreateAndJoinWithPwd(W.ACTION_WATCH,this.roomDto,"")}async onJoin(){}set dataSource(e){super.dataSource=e,this.roomDto=e,this.roomDto&&(this.addEvent(),this.setCurrentOutPut())}async setCurrentOutPut(){let e=this.roomDto.leader.icon;this.playerIcon.headSkin=e,this.tf_name.text=this.roomDto.leader.name;var i=_.intance.m_dicNodes.get(this.roomDto.nodeId);this.nodeDelaySign.dataSource=i,this.tf_seconds.text=se.format(Math.round(this.roomDto.startTimeDiff/1e3),":",!1),this.tf_union.text=B.instance.setRoomAnonymousLabel(m.instance.getMultiLan(this.roomDto.leader.shortUnionName),this.roomDto.anonymous)}};U_=h([KR("rDDOphbOQJKQOTPF-QIsAA")],U_);var V_=class extends Laya.Dialog{};var{regClass:qR}=Laya,F_=class extends V_{constructor(){super(...arguments);this.m_strName="我是OpenSceneRuntime";this.m_iLayerType=C.M_PANEL;this.m_iPositionType=C.CENTER;this.amount=0}onEnable(){this.listPanel1.visible=!1,this.btn_back.on(Laya.Event.CLICK,this,this.onBack),this.btn_confirm.on(Laya.Event.CLICK,this,this.confirmSp),this.btn_prop.on(Laya.Event.CLICK,this,this.onBtnProp),g.intance.on(f.EVENT_PVE_CHOOSE_PROP,this,this.onRefreshProp),this.btn_copy.on(Laya.Event.CLICK,this,this.onCopy)}onOpened(e){}async confirmSp(){let e,i=ge.TYPE_PC;if(!this.propData||this.amount==0)return;let a=this.amount;if(this.propData.itemItem.id==1086){let d=_.intance.m_dicShops.values;e=te.getShopByGoodsId(d,1086).cost[1],console.log("price",e)}else{let d=_.intance.getGeneralValueById(29);e=d[0][2],i=d[0][1]}let r=b.instance.getConsumeValue(ge.TYPE_PC),s=new dt(a),o=new dt(e),l=s.multiply(o).getValue(),c=Number(l),u=_.intance.getArrFromDicItemByKey("id",this.propData.itemItem.id);if(u&&u.length>0){var p=_.intance.getSheetDataByMultiKey(_.intance.m_dicShopMulDic,[6,this.propData.itemItem.id]);console.log(p),r<c?E.instance.notice(m.instance.getLanguage(1686)):await v.requestPost("wxgame/pve/sponsor",{shopId:p.id,num:a,playerId:this.playerData.pid})&&(E.instance.notice(m.instance.getLanguage(1685)),g.intance.event(f.EVENT_PVE_HAVE_PROP),this.close())}}async initPlayerProp(){let e=await v.requestPost("wxgame/pve/pveChallengeInfo",{id:this.playerData.pid});if(e){let i=this.transeToItemVo(e.items);this.listPanel1.array=i,this.listPanel1.visible=!0}}transeToItemVo(e){let i=[];for(let r=0;r<e.length;r++){let s=new Ne;var a=e[r];s.m_iId=a.id,a.pk&&(s.m_iPk=a.pk),s.m_iId=a.id,s.m_iNum=a.count,i.push(s)}return i}onDisable(){this.removeEvent()}removeEvent(){g.intance.off(f.EVENT_PVE_CHOOSE_PROP,this,this.onRefreshProp),this.btn_back.off(Laya.Event.CLICK,this,this.onBack),this.btn_confirm.off(Laya.Event.CLICK,this,this.confirmSp),this.btn_prop.off(Laya.Event.CLICK,this,this.onBtnProp),this.btn_copy.off(Laya.Event.CLICK,this,this.onCopy)}setOpenData(e){this.playerData=e,this.setPlayerData(),this.initPlayerProp()}setPlayerData(){this.tf_name.text=this.playerData.name,this.tf_union.text=m.instance.getMultiLan(this.playerData.shortUnionName),this.playerData.address?(this.fromBox.visible=!0,this.tf_from.text=`${te.shortenString(this.playerData.address,7,4)}`):this.fromBox.visible=!1,this.playerIcon.headSkin=this.playerData.head,this.img_flag.skin=S.instance.getCountryIcon(this.playerData.country)}onBack(){this.close()}onCopy(){let e=this.playerData.address;doCopy(e),E.instance.notice(m.instance.getLanguage(132))}onRefreshProp(e){if(console.log("buyData",e),this.propData=null,this.amount=0,e){this.buyPropItem.visible=!0;let i=e.propData;this.propData=e.propData;let a=e.amount;this.txt_num.text=a,this.buyPropItem.dataSource=i,this.img_ticket_bg.visible=!1,this.txt_num.visible=!0,this.amount=e.amount;let r=0;if(i.itemItem.id==1086){let u=_.intance.m_dicShops.values;r=te.getShopByGoodsId(u,1086).cost[1],console.log("price",r)}else r=_.intance.getGeneralValueById(29)[0][2];let s=new dt(a),o=new dt(r),l=s.multiply(o).getValue(),c=Number(l);console.log(`单价${r},总价${c}`),this.tf_price.text=`${c}PT`}}onBtnProp(){A.intance.openModule(y.PveChoosePropsDialog)}};F_=h([qR("t1ULECejSsWhchCZSP3X-Q")],F_);var G_=class extends Laya.Box{};var{regClass:WR}=Laya,K_=class extends G_{constructor(){super()}createChildren(){super.createChildren()}onEnable(){this.btn_copy.on(Laya.Event.CLICK,this,this.onCopy)}set dataSource(e){if(!e)return;super.dataSource=e;let i=e.id===b.instance.playerDto.pid,a=e.rank;this.tf_name.text=e.name,a<=0?this.tf_rank.text=m.instance.getLanguage(1117):this.tf_rank.text=a,this.playerIcon.headSkin=e.head,e.address?(this.fromBox.visible=!0,this.address=e.address,this.tf_from.text=`${te.shortenString(e.address,7,4)}`):this.fromBox.visible=!1,this.img_flag.skin=S.instance.getCountryIcon(e.country),this.tf_firstLv.text=e.rem1,this.tf_secondLv.text=e.rem2,this.tf_mnt.text=xe.filterNumFormat(e.mntTotal,2,!1,!0),this.tf_pc.text=xe.filterNumFormat(e.pcTotal,2,!1,!0),this.tf_usdt.text=xe.filterNumFormat(e.usdt,2,!1,!0),i?this.bg.skin="res/matchRank1/img_ranking_bg_me.png":this.bg.skin=a>0&&a<4?`res/rank/img_guild_${a}di.png`:"res/rank/img_guild_4di.png",a>0&&a<4?(this.img_rankIcon1.skin=`res/matchRank1/img_ranking_${a}.png`,this.img_rankIcon1.visible=!0,this.img_rankIcon2.visible=!1):(this.img_rankIcon2.skin=i?"res/matchRank1/img_ranking_ranking_me.png":"res/matchRank1/img_ranking_ranking_4.png",this.img_rankIcon2.visible=!0,this.img_rankIcon1.visible=!1)}onCopy(){let e=this.address;doCopy(e),E.instance.notice(m.instance.getLanguage(132))}};K_=h([WR("b3J8_57WRFO1dNr1CaJVpQ")],K_);var q_=class extends Laya.Box{};var{regClass:YR}=Laya,W_=class extends q_{constructor(){super()}createChildren(){super.createChildren()}onEnable(){this.btn_copy.on(Laya.Event.CLICK,this,this.onCopy)}set dataSource(e){if(!e)return;super.dataSource=e;let i=e.id===b.instance.playerDto.pid,a=e.rank;this.tf_name.text=e.name,this.tf_rank.text=a,this.tf_score.text=e.score,this.playerIcon.headSkin=e.head,e.address?(this.fromBox.visible=!0,this.address=e.address,this.tf_from.text=`${te.shortenString(e.address,7,4)}`):this.fromBox.visible=!1,this.img_flag.skin=S.instance.getCountryIcon(e.country),this.tf_num.text=e.remCount,i?this.bg.skin="res/matchRank1/img_ranking_bg_me.png":this.bg.skin=a<4?`res/rank/img_guild_${a}di.png`:"res/rank/img_guild_4di.png",a<4?(this.img_rankIcon1.skin=`res/matchRank1/img_ranking_${a}.png`,this.img_rankIcon1.visible=!0,this.img_rankIcon2.visible=!1):(this.img_rankIcon2.skin=i?"res/matchRank1/img_ranking_ranking_me.png":"res/matchRank1/img_ranking_ranking_4.png",this.img_rankIcon2.visible=!0,this.img_rankIcon1.visible=!1)}onCopy(){let e=this.address;doCopy(e),E.instance.notice(m.instance.getLanguage(132))}};W_=h([YR("MI-m6q1ITuGLG_8y-2GWUw")],W_);var Y_=class extends Laya.Box{};var{regClass:zR}=Laya,z_=class extends Y_{constructor(){super()}createChildren(){super.createChildren()}onEnable(){this.btn_copy.on(Laya.Event.CLICK,this,this.onCopy)}set dataSource(e){if(!e)return;super.dataSource=e;let i=e.id===b.instance.playerDto.pid,a=e.rank;if(this.tf_name.text=e.name,this.tf_union.text=m.instance.getMultiLan(e.shortUnionName),this.tf_rank.text=a,this.tf_score.text=e.score,this.playerIcon.headSkin=e.head,e.address?(this.fromBox.visible=!0,this.address=e.address,this.tf_from.text=`${te.shortenString(e.address,7,4)}`):this.fromBox.visible=!1,this.img_flag.skin=S.instance.getCountryIcon(e.country),e.icon){let r=S.instance.getUnionIcon(e.icon);this.img_lvIcon.skin=r,this.img_lvIcon.visible=!0}else this.img_lvIcon.visible=!1;i?this.bg.skin="res/matchRank1/img_ranking_bg_me.png":this.bg.skin=a<4?`res/rank/img_guild_${a}di.png`:"res/rank/img_guild_4di.png",a<4?(this.img_rankIcon1.skin=`res/matchRank1/img_ranking_${a}.png`,this.img_rankIcon1.visible=!0,this.img_rankIcon2.visible=!1):(this.img_rankIcon2.skin=i?"res/matchRank1/img_ranking_ranking_me.png":"res/matchRank1/img_ranking_ranking_4.png",this.img_rankIcon2.visible=!0,this.img_rankIcon1.visible=!1)}onCopy(){let e=this.address;doCopy(e),E.instance.notice(m.instance.getLanguage(132))}};z_=h([zR("-msKQoZIRI6E80e53qttmw")],z_);var j_=class extends Laya.Scene{};var{regClass:jR}=Laya,tt=class{};tt.playerRank=0,tt.unionRank=1,tt.dailyRank=2,tt.proRank=3,tt.actRank=4;var $_=class extends j_{constructor(){super(...arguments);this.unionRankData=null;this.rankIndex=0;this.maxSubTabIndex=10;this.tabNames={1:"combat scenes",2:"KILL COUNT",3:"number of heroes",4:"damage ranking",5:"wealth ranking"};this.tabNamesDaily={1:"Matches",2:"Matches",3:"Matches",4:"Matches",5:"Matches"};this.btnNames={1:"COMBAT SCENES",2:"KILL COUNT",3:"NUMBER OF HEROES",4:"DAMAGE RANKING",5:"WEALTH RANKING"};this.btnNamesDaily={1:"Total Mathches",2:"Professional Matches",3:"Airdrop Matches",4:"Training RANKING",5:""};this.btnNamesPro={1:"This week",2:"Last week",3:"This month",4:"Last month",5:""};this.currBigTab=0;this.currTab=0;this.nftTabIndex=1}onAwake(){this.m_iLayerType=C.M_POP,this.m_iPositionType=C.UP}onOpened(e){this.list_act.array=[],this.onClickBigTab(5)}onEnable(){this.rankLanList.visible=!1,this.myBox.visible=!1,this.myUnionBox.visible=!1,this.btn_back&&this.btn_back.on(Laya.Event.CLICK,this,this.setToMainScene);for(let e=1;e<6;e++)this["btn_tab_"+e].on(Laya.Event.CLICK,this,this.onClickBigTab,[e]);for(let e=1;e<this.maxSubTabIndex;e++)this["btn_"+e].on(Laya.Event.CLICK,this,this.onClickTab,[e]);this.refreshDailyBtnRed(),g.intance.on(f.REFRESH_ACTIVITY_RED,this,this.refreshDailyBtnRed)}onClickBigTab(e){this.currBigTab!=e&&(this.playerRankBox.visible=!1,this.unionBox.visible=!1,this.actRankBox.visible=!1,this.currBigTab=e,this.setBigTab(e),e==1?(this.rankIndex=tt.playerRank,this.refreshDailyBtnRed(),this.onClickTab(1),this.playerRankBox.visible=!0):e==2?(this.rankIndex=tt.unionRank,this.onClickTab(6),this.unionBox.visible=!0):e==3?(this.rankIndex=tt.dailyRank,this.refreshDailyBtnRed(),this.onClickTab(1),this.playerRankBox.visible=!0):e==4?(this.rankIndex=tt.proRank,this.onClickTab(1),this.playerRankBox.visible=!0):e==5&&(this.rankIndex=tt.actRank,this.onClickTab(7),this.actRankBox.visible=!0))}setBigTab(e){for(let i=1;i<6;i++)e==i?(this["btn_tab_"+i].getChildByName("selectBox").visible=!0,this["btn_tab_"+i].getChildByName("tf_txt").color="#143f6b"):(this["btn_tab_"+i].getChildByName("selectBox").visible=!1,this["btn_tab_"+i].getChildByName("tf_txt").color="#7ff1fe")}onClickTab(e){if(this.currTab===e)return;let i;switch(this.rankIndex){case tt.playerRank:i=this.tabNames,this.rankName.text=i[e];break;case tt.dailyRank:i=this.tabNamesDaily;break;case tt.proRank:i=this.tabNamesDaily;break;case tt.actRank:var a=_.intance.m_dicItems.get(ge.TYPE_MNT),r=_.intance.m_dicItems.get(ge.TYPE_PC);this.tf_mnt.text=m.instance.getLanguage(a.name),this.tf_pc.text=m.instance.getLanguage(r.name);break}this.setTab(e),this.rankIndex==tt.unionRank?this.setGuildListData():this.setListData(e);let s=this["btn_"+e].getChildByName("img_red");(this.rankIndex==tt.dailyRank||this.rankIndex==tt.proRank||this.rankIndex==tt.actRank)&&s&&(s.visible=!1)}setTab(e){let i;switch(this.rankIndex){case tt.playerRank:i=this.btnNames;break;case tt.dailyRank:i=this.btnNamesDaily;break;case tt.proRank:i=this.btnNamesPro;break;case tt.actRank:break}for(let a=1;a<this.maxSubTabIndex;a++)e==a?(this["btn_"+a].getChildByName("selectBox").visible=!0,this["btn_"+a].getChildByName("tf_txt").color="#143f6b"):(this["btn_"+a].getChildByName("selectBox").visible=!1,this["btn_"+a].getChildByName("tf_txt").color="#7ff1fe"),i&&i[a]&&(this["btn_"+a].getChildByName("tf_txt").text=i[a]);this.btn_5.visible=this.rankIndex==tt.playerRank}setToMainScene(){oe.intance.setCurrentScene(Y.M_SCENE_MAIN)}async setListData(e){this.nftTabIndex=e;let i;switch(this.rankIndex){case tt.playerRank:i=await v.requestPost("wxgame/sys/rank",{type:e});break;case tt.dailyRank:i=await v.requestPost("wxgame/sys/playerFightTimesRank",{type:e-1});break;case tt.proRank:i=await v.requestPost("wxgame/sys/proPlayerTimesWeekMonthRank",{type:e});break;case tt.actRank:var a=1;if(e==7?a=1:e==8?a=2:e==9&&(a=0),this.list_act.visible=!1,this.noDataBox.visible=!1,i=await v.requestPost("wxgame/rank/remRank",{type:a}),this.nftTabIndex!=e)return;break}i?(this.updateSelfData(i.self),this.updateRankList(i.rankList)):(console.error("Error fetching data:",i),E.instance.notice(m.instance.getLanguage(135)))}async setGuildListData(){this.unionRankData||(this.unionRankData=await v.requestPost("wxgame/sys/unionRank",{}));let e=[];if(this.unionRankData){let i=this.unionRankData.rankList,a=this.unionRankData.self;a&&this.updateSelfUnionData(a),this.unionRankLanList.scrollTo(0),this.unionRankLanList.visible=!0,this.myUnionBox.visible=!0,this.unionRankLanList.selectedIndex=1,this.unionRankLanList.array=i,this.myUnionBox.visible=!!a}else console.error(`Error fetching data: ${this.unionRankData}`),E.instance.notice(m.instance.getLanguage(135))}updateSelfData(e){if(e){if(this.rankIndex==tt.actRank){this.myActListItem.dataSource=e;return}if(this.tf_name.text=e.name,this.tf_union.text=m.instance.getMultiLan(e.shortUnionName),this.tf_score.text=`${e.score}`,this.playerIcon.headSkin=e.head,this.img_flag.skin=S.instance.getCountryIcon(e.country),e.unionId){let i=S.instance.getUnionIcon(e.icon);this.img_lvIcon.skin=i,this.img_lvIcon.visible=!0}else this.img_lvIcon.visible=!1;if(this.rankIndex==tt.actRank?(this.img_lvIcon.visible=!1,this.tf_ref.visible=!0,this.tf_ref.text=`${e.remCount}`,this.tf_union.visible=!1):(this.tf_ref.visible=!1,this.tf_union.visible=!0),e.rank<=0)this.img_rankIcon1.visible=!1,this.tf_rank.text=m.instance.getLanguage(1117),this.img_rankIcon2.visible=!1,this.tf_rank.visible=!0;else if(e.rank<4)this.img_rankIcon1.skin=`res/matchRank1/img_ranking_${e.rank}.png`,this.img_rankIcon1.visible=!0,this.img_rankIcon2.visible=!1,this.tf_rank.visible=!1;else{let i=e.pid===b.instance.playerDto.pid?"res/matchRank1/img_ranking_ranking_me.png":"res/matchRank1/img_ranking_ranking_4.png";this.img_rankIcon2.skin=i,this.img_rankIcon2.visible=!0,this.img_rankIcon1.visible=!1,this.tf_rank.text=`${e.rank}`,this.tf_rank.visible=!0}}}updateSelfUnionData(e){if(e)if(this.union_name.text=m.instance.getMultiLan(e.unionName),this.unionIcon.dataSource=e,this.union_score.text=e.score+"",e.rank<0)this.img_unionIcon1.visible=!1,this.union_rank.text=m.instance.getLanguage(1117),this.img_unionIcon2.visible=!1;else if(e.rank<4)this.img_unionIcon1.skin=`res/matchRank1/img_ranking_${e.rank}.png`,this.img_unionIcon1.visible=!0,this.img_unionIcon2.visible=!1;else{let i="res/matchRank1/img_ranking_ranking_me.png";this.img_unionIcon2.skin=i,this.img_unionIcon2.visible=!0,this.img_unionIcon1.visible=!1,this.union_rank.text=`${e.rank}`}}updateRankList(e){if(e){let i=e.findIndex(a=>a.pid===b.instance.playerDto.pid);this.rankIndex!==tt.actRank?(this.rankLanList.selectedIndex=1,this.rankLanList.array=e,this.rankLanList.scrollTo(0),this.activeList.visible=!1,this.myBox.visible=!0,this.rankLanList.visible=!0):(this.list_act.selectedIndex=1,this.list_act.array=e,this.list_act.scrollTo(0),this.list_act.visible=!0,!this.list_act.array||this.list_act.array.length<=0?this.noDataBox.visible=!0:this.noDataBox.visible=!1)}}refreshDailyBtnRed(){switch(this.rankIndex){case tt.playerRank:this.btn_1.getChildByName("img_red").visible=!1,this.btn_2.getChildByName("img_red").visible=!1,this.btn_3.getChildByName("img_red").visible=!1,this.btn_4.getChildByName("img_red").visible=!1;break;case tt.dailyRank:this.btn_1.getChildByName("img_red").visible=b.instance.getRedDotById(he.RED_EVERY_RANK_TOTAL),this.btn_2.getChildByName("img_red").visible=b.instance.getRedDotById(he.RED_EVERY_RANK_PRE),this.btn_3.getChildByName("img_red").visible=b.instance.getRedDotById(he.RED_EVERY_RANK_AIR),this.btn_4.getChildByName("img_red").visible=b.instance.getRedDotById(he.RED_EVERY_RANK_TRA);break;case tt.proRank:this.btn_1.getChildByName("img_red").visible=b.instance.getRedDotById(he.PRO_RANK_DAY_FIGHT_1),this.btn_2.getChildByName("img_red").visible=b.instance.getRedDotById(he.PRO_RANK_DAY_FIGHT_2),this.btn_3.getChildByName("img_red").visible=b.instance.getRedDotById(he.PRO_RANK_DAY_FIGHT_3),this.btn_4.getChildByName("img_red").visible=b.instance.getRedDotById(he.PRO_RANK_DAY_FIGHT_4);break;case tt.actRank:break}this.refreshDailyRed(),this.refreshProRed(),this.refreshProAct()}refreshDailyRed(){this.img_red_daily.visible=b.instance.getRedDotById(he.RED_EVERY_RANK_TOTAL)||b.instance.getRedDotById(he.RED_EVERY_RANK_PRE)||b.instance.getRedDotById(he.RED_EVERY_RANK_AIR)||b.instance.getRedDotById(he.RED_EVERY_RANK_TRA)}refreshProRed(){this.img_red_pro.visible=b.instance.getRedDotById(he.PRO_RANK_DAY_FIGHT_1)||b.instance.getRedDotById(he.PRO_RANK_DAY_FIGHT_2)||b.instance.getRedDotById(he.PRO_RANK_DAY_FIGHT_3)||b.instance.getRedDotById(he.PRO_RANK_DAY_FIGHT_4)}refreshProAct(){}onDisable(){this.removeEvent()}removeEvent(){g.intance.offAllCaller(this)}};$_=h([jR("5_oIkEKDQUyqTP8xY9zMUw")],$_);var X_=class extends Laya.Box{};var{regClass:$R}=Laya,Q_=class extends X_{constructor(){super()}createChildren(){super.createChildren()}set dataSource(t){if(!t)return;let e=t.id===b.instance.playerDto.pid,i=t.rank;this.unionIcon.dataSource=t,this.tf_union.text=m.instance.getMultiLan(t.shortUnionName),this.tf_rank.text=i+"",this.tf_score.text=t.score+"",e?this.bg.skin="res/matchRank1/img_ranking_bg_me.png":this.bg.skin=i<4?`res/rank/img_guild_${i}di.png`:"res/rank/img_guild_4di.png",i<4?(this.img_rankIcon1.skin=`res/matchRank1/img_ranking_${i}.png`,this.img_rankIcon1.visible=!0,this.img_rankIcon2.visible=!1):(this.img_rankIcon2.skin=e?"res/matchRank1/img_ranking_ranking_me.png":"res/matchRank1/img_ranking_ranking_4.png",this.img_rankIcon2.visible=!0,this.img_rankIcon1.visible=!1)}};Q_=h([$R("O6o6TJNORIGW9WXbhJf91w")],Q_);var J_=class extends Laya.Box{};var{regClass:XR,property:c4e}=Laya,Z_=class extends J_{constructor(){super();this.isAddEvent=!1}set dataSource(e){if(e){if(super.dataSource=e,this.heroVo=e,!this.heroVo){this.img_back.skin=S.instance.getHeroBackIcon(0),this.box_show.visible=!1;return}this.addEvent(),this.setCurrentOutPut()}}async setCurrentOutPut(){this.img_back.skin=S.instance.getHeroBackIcon(this.heroVo.heroItem.quality),this.img_front.skin=S.instance.getHeroFrontIcon(this.heroVo.heroItem.quality),this.img_hero.skin=this.heroVo.simgurl,this.tf_name.text=Me.shortHeroStr(this.heroVo.name);let e=this.heroVo.heroItem.level+"";ze.instance.setStar(this,e),this.box_show.visible=!0,this.destroyed}onChange(e){e?this.selectBox.visible=!0:this.selectBox.visible=!1}addEvent(){this.isAddEvent||(this.isAddEvent=!0)}toDetail(){this.heroVo.id&&A.intance.openModule(y.HeroDetailDialog,[this.heroVo])}};Z_=h([XR("DixYspEIQnqQazhlHuxLDw")],Z_);var ev=class extends Laya.Dialog{};var{regClass:QR}=Laya,tv=class extends ev{constructor(e){super();this.m_strName="我是OpenSceneRuntime";this.m_iLayerType=C.M_POP;this.m_iPositionType=C.CENTER;this.beforeYearIndex=null;this.beforeMonthIndex=null;this.beforeDayIndex=null;this.beforeHourIndex=null;this.dateOpenState=0;this.dateOpenStateAir=0;this.itemVo=null;this.walletType=0;this.heroPkList=[];this.airWalletDataArray=[];this.currentDate=new Date;this.startDate={year:0,month:0,day:0,hour:0};this.endDate={year:0,month:0,day:0,hour:0};this.heroVo=null}onEnable(){this.box_date.on(Laya.Event.CLICK,this,this.onOpenDate,[this.img_date_pad,this.box_date]),this.box_date2.on(Laya.Event.CLICK,this,this.onOpenDate,[this.img_date_pad,this.box_date2]),this.box_date3.on(Laya.Event.CLICK,this,this.onOpenDateAir,[this.img_date_pad2,this.box_date3]),this.box_date4.on(Laya.Event.CLICK,this,this.onOpenDateAir,[this.img_date_pad2,this.box_date4]),this.yearList.on(Laya.Event.MOUSE_UP,this,this.onListStop,[this.yearList,"year"]),this.monthList.on(Laya.Event.MOUSE_UP,this,this.onListStop,[this.monthList,"month"]),this.dayList.on(Laya.Event.MOUSE_UP,this,this.onListStop,[this.dayList,"day"]),this.hourList.on(Laya.Event.MOUSE_UP,this,this.onListStop,[this.hourList,"hour"]),this.yearList2.on(Laya.Event.MOUSE_UP,this,this.onListStopAir,[this.yearList2,"year"]),this.monthList2.on(Laya.Event.MOUSE_UP,this,this.onListStopAir,[this.monthList2,"month"]),this.dayList2.on(Laya.Event.MOUSE_UP,this,this.onListStopAir,[this.dayList2,"day"]),this.hourList2.on(Laya.Event.MOUSE_UP,this,this.onListStopAir,[this.hourList2,"hour"]),this.yearList.scrollBar.on(Laya.Event.CHANGE,this,this.onScrollBarChange,[this.yearList,"year",this.img_date_pad]),this.monthList.scrollBar.on(Laya.Event.CHANGE,this,this.onScrollBarChange,[this.monthList,"month",this.img_date_pad]),this.dayList.scrollBar.on(Laya.Event.CHANGE,this,this.onScrollBarChange,[this.dayList,"day",this.img_date_pad]),this.hourList.scrollBar.on(Laya.Event.CHANGE,this,this.onScrollBarChange,[this.hourList,"hour",this.img_date_pad]),this.yearList2.scrollBar.on(Laya.Event.CHANGE,this,this.onScrollBarChange,[this.yearList2,"year",this.img_date_pad2]),this.monthList2.scrollBar.on(Laya.Event.CHANGE,this,this.onScrollBarChange,[this.monthList2,"month",this.img_date_pad2]),this.dayList2.scrollBar.on(Laya.Event.CHANGE,this,this.onScrollBarChange,[this.dayList2,"day",this.img_date_pad2]),this.hourList2.scrollBar.on(Laya.Event.CHANGE,this,this.onScrollBarChange,[this.hourList2,"hour",this.img_date_pad2]),this.tf_uid.on(Laya.Event.BLUR,this,this.setPlayerName),this.tf_uid.on(Laya.Event.FOCUS,this,this.uidFocus),g.intance.on(f.CHANGE_WALLET_HERO,this,this.onHeroChange),g.intance.on(f.CHANGE_WALLET_HERO_AIR,this,this.onAirHeroChange),g.intance.on(f.CHANGE_WALLET_PROP,this,this.onPropChange),g.intance.on(f.ADD_AIR_WALLET_ITEM,this,this.addAirWalletItem),g.intance.on(f.ADD_AIR_SUB_WALLET_NAME,this,this.addAirWalletNameItem),g.intance.on(f.AIR_SUB_WALLET_OPENHERO,this,this.airdropOpenHeroView),this.hero_box.on(Laya.Event.CLICK,this,this.onHeroBoxClick),this.Img_prop.on(Laya.Event.CLICK,this,this.onPropClick),this.btn_createSubWallet.on(Laya.Event.CLICK,this,this.onCreateSubWallet),this.btn_createSubWalletAir.on(Laya.Event.CLICK,this,this.onCreateSubWalletAir),this.box_Arean.on(Laya.Event.CLICK,this,this.onOpenType),this.tab1.on(Laya.Event.CLICK,this,this.onTabClick,[1]),this.tab2.on(Laya.Event.CLICK,this,this.onTabClick,[2]),this.yearList.scrollBar.rollRatio=0,this.monthList.scrollBar.rollRatio=0,this.dayList.scrollBar.rollRatio=0,this.hourList.scrollBar.rollRatio=0,this.yearList2.scrollBar.rollRatio=0,this.monthList2.scrollBar.rollRatio=0,this.dayList2.scrollBar.rollRatio=0,this.hourList2.scrollBar.rollRatio=0,this.initTime(),this.showHeroData(),this.initDiciList(),this.initTypeList(),this.box_dividends.on(Laya.Event.CLICK,this,this.onOpeDividends),this.tab1.getChildByName("tf_tit").text=`${m.instance.getLanguage(1261)}`,this.tab2.getChildByName("tf_tit").text=`${m.instance.getLanguage(1260)}`}onDisable(){this.removeEvent()}removeEvent(){this.box_date.off(Laya.Event.CLICK,this,this.onOpenDate),this.box_date2.off(Laya.Event.CLICK,this,this.onOpenDate),this.box_date3.off(Laya.Event.CLICK,this,this.onOpenDateAir),this.box_date4.off(Laya.Event.CLICK,this,this.onOpenDateAir),this.yearList.off(Laya.Event.MOUSE_UP,this,this.onListStop),this.monthList.off(Laya.Event.MOUSE_UP,this,this.onListStop),this.dayList.off(Laya.Event.MOUSE_UP,this,this.onListStop),this.hourList.off(Laya.Event.MOUSE_UP,this,this.onListStop),this.yearList2.off(Laya.Event.MOUSE_UP,this,this.onListStopAir),this.monthList2.off(Laya.Event.MOUSE_UP,this,this.onListStopAir),this.dayList2.off(Laya.Event.MOUSE_UP,this,this.onListStopAir),this.hourList2.off(Laya.Event.MOUSE_UP,this,this.onListStopAir),this.yearList.scrollBar.off(Laya.Event.CHANGE,this,this.onScrollBarChange),this.monthList.scrollBar.off(Laya.Event.CHANGE,this,this.onScrollBarChange),this.dayList.scrollBar.off(Laya.Event.CHANGE,this,this.onScrollBarChange),this.hourList.scrollBar.off(Laya.Event.CHANGE,this,this.onScrollBarChange),this.yearList2.scrollBar.off(Laya.Event.CHANGE,this,this.onScrollBarChange),this.monthList2.scrollBar.off(Laya.Event.CHANGE,this,this.onScrollBarChange),this.dayList2.scrollBar.off(Laya.Event.CHANGE,this,this.onScrollBarChange),this.hourList2.scrollBar.off(Laya.Event.CHANGE,this,this.onScrollBarChange),this.tf_uid.off(Laya.Event.BLUR,this,this.setPlayerName),this.tf_uid.off(Laya.Event.FOCUS,this,this.uidFocus),this.hero_box.off(Laya.Event.CLICK,this,this.onHeroBoxClick),this.Img_prop.off(Laya.Event.CLICK,this,this.onPropClick),this.btn_createSubWallet.off(Laya.Event.CLICK,this,this.onCreateSubWallet),this.box_dividends.off(Laya.Event.CLICK,this,this.onOpeDividends),g.intance.off(f.CHANGE_WALLET_HERO,this,this.onHeroChange),g.intance.off(f.CHANGE_WALLET_HERO_AIR,this,this.onAirHeroChange),g.intance.off(f.CHANGE_WALLET_PROP,this,this.onPropChange),g.intance.off(f.ADD_AIR_WALLET_ITEM,this,this.addAirWalletItem),g.intance.off(f.ADD_AIR_SUB_WALLET_NAME,this,this.addAirWalletNameItem),g.intance.off(f.AIR_SUB_WALLET_OPENHERO,this,this.airdropOpenHeroView),g.intance.offAllCaller(this),this.btn_createSubWalletAir.off(Laya.Event.CLICK,this,this.onCreateSubWalletAir),this.box_Arean.off(Laya.Event.CLICK,this,this.onOpenType),this.tab1.off(Laya.Event.CLICK,this,this.onTabClick),this.tab2.off(Laya.Event.CLICK,this,this.onTabClick)}resetColors(e,i,a){let r=[e,i,a];for(let l of r)for(var s=0;s<l.cells.length;s++){var o=l.cells[s];o.tf_date.color="#357cc0"}}onOpenDate(e,i){this.resetColors(this.yearList,this.monthList,this.dayList),this.onHideDivi(),e.visible==!1?(i==this.box_date?(e.y=306,this.dateOpenState=1):(e.y=20,this.dateOpenState=2),this.getDateInfo(),e.visible=!0,this.img_bg.on(Laya.Event.CLICK,this,this.hideAllPad)):(e.visible=!1,this.dateOpenState=0)}onOpenDateAir(e,i){this.resetColors(this.yearList2,this.monthList2,this.dayList2),this.onHideDivi(),e.visible==!1?(i==this.box_date3?(e.x=125,this.dateOpenState=1):(e.x=664,this.dateOpenState=2),this.getDateInfoAir(),e.visible=!0,this.img_bg.on(Laya.Event.CLICK,this,this.hideAllPad)):(e.visible=!1,this.dateOpenStateAir=0)}hideAllPad(){this.img_date_pad.visible=!1,this.img_date_pad2.visible=!1,this.img_bg.off(Laya.Event.CLICK,this,this.hideAllPad)}initTypeList(){let e=_.intance.getArenaTypesInSub(),i={name:"Professional & Airdrop"};e.push(i),this.list_type.array=e,this.list_type.selectHandler=new Laya.Handler(this,this.handleSelectType),this.list_type.mouseHandler=Laya.Handler.create(this,this.onTypeItemMouse,null,!1),this.list_type.renderHandler=Laya.Handler.create(this,this.onTypeItemRender,null,!1),this.list_type.selectedIndex=0}getDateInfo(){this.renderDateInfo(this.dateOpenState,this.startDate,this.endDate,this.yearList,this.monthList,this.dayList,this.hourList)}getDateInfoAir(){this.renderDateInfo(this.dateOpenState,this.startDate,this.endDate,this.yearList2,this.monthList2,this.dayList2,this.hourList2)}renderDateInfo(e,i,a,r,s,o,l){let c=e==1?i:a;this.fillList(r,c.year,2e3,2050),this.fillList(s,c.month,1,12);let u=new Date().getFullYear(),p=new Date().getMonth()+1,d=te.getDaysInMonth(u,p);this.fillList(o,c.day,1,d),this.fillList(l,c.hour,0,23)}fillList(e,i,a,r){let s=[],o=this.walletType?this.yearList2:this.yearList,l=this.walletType?this.monthList2:this.monthList,c=this.walletType?this.dayList2:this.dayList,u=this.walletType?this.hourList2:this.hourList;for(let d=a;d<=r;d++)s.push(d.toString());for(let d=1;d<=3;d++)s.push("");s=["",...s],e.array=s;let p=s.indexOf(`${i}`);if(p>-1){e.scrollTo(p-1),e.selectedIndex=p-1;let d=e.getCell(p);d.tf_date.color="#ffffff",e==o?this.beforeYearIndex=p:e==l?this.beforeMonthIndex=p:e==c?this.beforeDayIndex=p:e==u&&(this.beforeHourIndex=p)}}onYearChange(e){!this.yearList.array||this.monthList.selectedIndex<0||this.updateDayList(parseInt(this.yearList.array[e]),parseInt(this.monthList.array[this.monthList.selectedIndex]))}onMonthChange(e){!this.yearList.array||this.monthList.selectedIndex<0||this.updateDayList(parseInt(this.yearList.array[this.yearList.selectedIndex]),parseInt(this.monthList.array[e]))}onYearChangeAir(e){!this.yearList2.array||this.monthList2.selectedIndex<0||this.updateDayListAir(parseInt(this.yearList2.array[e]),parseInt(this.monthList2.array[this.monthList.selectedIndex]))}onMonthChangeAir(e){!this.yearList2.array||this.monthList2.selectedIndex<0||this.updateDayListAir(parseInt(this.yearList2.array[this.yearList2.selectedIndex]),parseInt(this.monthList2.array[e]))}updateDayList(e,i){let a=[];for(let r=1;r<=te.getDaysInMonth(e,i);r++)a.push(r.toString());for(let r=1;r<=3;r++)a.push("");a=["",...a],this.dayList.array=a}updateDayListAir(e,i){let a=[];for(let r=1;r<=te.getDaysInMonth(e,i);r++)a.push(r.toString());for(let r=1;r<=3;r++)a.push("");a=["",...a],this.dayList2.array=a}calculateVisibleHeight(e,i){let a=e.getCell(i);return Math.min(a.y+a.height,e.scrollBar.value+e.height)-Math.max(a.y,e.scrollBar.value)}onListStop(e,i){let a=this.dateOpenState==1?this.startDate:this.endDate,r=Math.floor(e.startIndex),s=r+1,o=this.calculateVisibleHeight(e,r),l=this.calculateVisibleHeight(e,s),c=o+14>=l?r:s;(i==="month"||i==="day"||i==="hour")&&(c=Math.min(c,e.array.length-5)),e.scrollTo(c),e.selectedIndex=c;let u=e.getCell(c+1);u.tf_date.color="#ffffff";let p=u.tf_date.text;if(p&&u){switch(i){case"year":this.onYearChange(c+1),a.year=Number(p);break;case"month":this.onMonthChange(c+1),a.month=Number(p);break;case"day":a.day=Number(p);break;default:a.hour=Number(p);break}this.refreshStartTime(this.dateOpenState)}}onListStopAir(e,i){let a=this.dateOpenState==1?this.startDate:this.endDate,r=Math.floor(e.startIndex),s=r+1,o=this.calculateVisibleHeight(e,r),l=this.calculateVisibleHeight(e,s),c=o+14>=l?r:s;(i==="month"||i==="day"||i==="hour")&&(c=Math.min(c,e.array.length-5)),e.scrollTo(c),e.selectedIndex=c;let u=e.getCell(c+1);u.tf_date.color="#ffffff";let p=u.tf_date.text;if(p&&u){switch(i){case"year":this.onYearChangeAir(c+1),a.year=Number(p);break;case"month":this.onMonthChangeAir(c+1),a.month=Number(p);break;case"day":a.day=Number(p);break;default:a.hour=Number(p);break}this.refreshStartTime(this.dateOpenState)}}onScrollBarChange(e,i,a){if(!a.visible)return;let r=this.dateOpenState==1?this.startDate:this.endDate;console.log("startDate",this.startDate);let s=Math.floor(e.startIndex),o=s+1,l=this.calculateVisibleHeight(e,s),c=this.calculateVisibleHeight(e,o),u=l+14>=c?s:o,p=e.getCell(u+1);p.tf_date.color="#ffffff";let d,L;switch(i){case"year":L=this.beforeYearIndex,this.beforeYearIndex=u+1;break;case"month":L=this.beforeMonthIndex,this.beforeMonthIndex=u+1;break;case"day":L=this.beforeDayIndex,this.beforeDayIndex=u+1;break;case"hour":L=this.beforeHourIndex,this.beforeHourIndex=u+1;break}L!==u+1&&(d=e.getCell(L),this.resetListStyle(d));let x=p.tf_date.text;if(p.tf_date.color="#ffffff",x&&p){switch(i){case"year":this.onYearChange(u+1),r.year=Number(x);break;case"month":this.onMonthChange(u+1),r.month=Number(x);break;case"day":r.day=Number(x);break;default:r.hour=Number(x);break}this.refreshStartTime(this.dateOpenState)}}async setPlayerName(){try{if(this.tf_uid.text=="")return;var e=await v.requestPost("wxgame/sys/queryName",{openid:this.tf_uid.text.toLowerCase()});e&&(this.tf_player_name.text=e.name)}catch{}}uidFocus(){this.tf_uid.text="",this.tf_player_name.text=""}resetListStyle(e){e&&(e.tf_date.color="#357cc0")}refreshStartTime(e){let i,a,r;this.walletType==1?(i=e==1?this.startDate:this.endDate,a=e==1?this.tf_startAir:this.tf_startAir2,r=e==1?this.tf_hourAir:this.tf_hourAir2):(i=e==1?this.startDate:this.endDate,a=e==1?this.tf_start:this.tf_start2,r=e==1?this.tf_hour:this.tf_hour2);let s=i.month>=10?i.month:`0${i.month}`,o=i.day>=10?i.day:`0${i.day}`;a.text=`${i.year}-${s}-${o}`,r.text=`${i.hour}:00`}onHeroBoxClick(){A.intance.openModule(y.WalletChooseHeroDialog,[-1])}onPropClick(){this.list_type.selectedIndex!=1&&A.intance.openModule(y.WalletChoosePropsDialog,[Ge.CHOOSE_Wallet])}async onCreateSubWallet(){if(console.log("this.proCheckBox.selected",this.proCheckBox.selected),console.log("this.airCheckBox.selected",this.airCheckBox.selected),Ae.instance.inMinWaiting){E.instance.notice(m.instance.getLanguage(1187));return}if(this.tf_uid.text==F.instance.walletAddress){pe.instance().AlertByType(P.BASEALERTVIEW,m.instance.getLanguage(1162),P.YES),this.tf_uid.text="",this.tf_player_name.text="";return}let e=this.tf_uid.text;if(e.length<=0||this.tf_player_name.text==""){pe.instance().AlertByType(P.BASEALERTVIEW,m.instance.getLanguage(1161),P.YES);return}if(!this.heroVo){pe.instance().AlertByType(P.BASEALERTVIEW,m.instance.getLanguage(1167),P.YES);return}let i,a=Number(this.tf_have.text);if(this.list_type.selectedIndex!==1){if(i=this.itemVo&&this.itemVo.m_iId,this.itemVo&&this.itemVo.itemItem.quality==3&&this.heroVo.heroItem.level!==3){pe.instance().AlertByType(P.BASEALERTVIEW,m.instance.getLanguage(1163),P.YES);return}if((a<1||!this.itemVo)&&this.list_type.selectedIndex==0){pe.instance().AlertByType(P.BASEALERTVIEW,m.instance.getLanguage(1166),P.YES);return}}else a=0,i=0;let r=se.dateStringToTimestamp(this.tf_start.text,`${this.startDate.hour}`),s=se.dateStringToTimestamp(this.tf_start2.text,`${this.endDate.hour}`),o=se.getCurrentDayTimestamp();if(r<o){pe.instance().AlertByType(P.BASEALERTVIEW,m.instance.getLanguage(1164),P.YES);return}if(s<=r){pe.instance().AlertByType(P.BASEALERTVIEW,m.instance.getLanguage(1165),P.YES);return}let l=this.list_type.selectedIndex+1,c=Number(this.tf_div.text.replace("%","")),u=this.heroVo.pk;var p={startTime:r,endTime:s,ticketId:i,ticketCount:a,ratio:c,heroPk:u,openid:e.toLowerCase(),type:l};try{var d=await v.requestPost("wxgame/lease/create",p);d&&(E.instance.notice(m.instance.getLanguage(1168)),this.heroVo.pk==b.instance.playerDto.fightHeroPk&&(b.instance.playerDto.fightHeroPk=""),Laya.timer.once(200,this,()=>{g.intance.event(f.CREATE_SUB_WALLET_SUCCESS)}),this.close())}catch{}}async onCreateSubWalletAir(){let e=se.dateStringToTimestamp(this.tf_startAir.text,`${this.startDate.hour}`),i=se.dateStringToTimestamp(this.tf_startAir2.text,`${this.endDate.hour}`),a=se.getCurrentDayTimestamp(),r=this.getEfficientList(this.airWalletDataArray);if(r.length<=0){pe.instance().AlertByType(P.BASEALERTVIEW,m.instance.getLanguage(1352),P.YES);return}if(e<a){pe.instance().AlertByType(P.BASEALERTVIEW,m.instance.getLanguage(1164),P.YES);return}if(i<=e){pe.instance().AlertByType(P.BASEALERTVIEW,m.instance.getLanguage(1165),P.YES);return}console.log(e,i,a);var s=await v.requestPost("wxgame/lease/mutiCreate",{startTime:e,endTime:i,ratio:0,type:2,data:r});s&&(E.instance.notice(m.instance.getLanguage(1168)),this.close(),Laya.timer.once(200,this,()=>{g.intance.event(f.CREATE_SUB_WALLET_SUCCESS)}))}getEfficientList(e){let i=[];for(let a=0;a<e.length;a++){let r=e[a];r.name.length>0&&r.hero&&i.push({address:r.walletAddress,heroPk:r.hero.pk.toLowerCase()})}return i}showHeroData(){if(this.heroVo){this.img_back.skin=S.instance.getHeroBackIcon(this.heroVo.heroItem.quality),this.img_front.skin=S.instance.getHeroFrontIcon(this.heroVo.heroItem.quality),this.img_hero.skin=this.heroVo.simgurl,this.tf_name.text=Me.shortHeroStr(this.heroVo.name);let e=this.heroVo.heroItem.level+"";ze.instance.setStar(this,e),this.box_show.visible=!0,this.img_back.visible=!0,this.img_noHero.visible=!1}else this.box_show.visible=!1,this.img_back.visible=!1,this.img_noHero.visible=!0}initDiciList(){var e=_.intance.getGeneralValueById(9);this.list_divi.array=e,this.list_divi.selectHandler=new Laya.Handler(this,this.handleSelectDiv),this.list_divi.mouseHandler=Laya.Handler.create(this,this.onCountryItemMouse,null,!1),this.list_divi.renderHandler=Laya.Handler.create(this,this.onCountryItemRender,null,!1),this.list_divi.scrollBar&&this.list_divi.scrollBar.on(Laya.Event.MOUSE_DOWN,this,this.onScrollBarDown),this.list_divi.selectedIndex=0}initDiciList2(e){if(e==1){var i=_.intance.getGeneralValueById(9);this.list_divi.array=i,this.list_divi.selectedIndex=0}else{var i=_.intance.getGeneralValueById(18);this.list_divi.array=i,this.list_divi.selectedIndex=0}this.handleSelectDiv(0)}handleSelectDiv(e){if(e!=-1){let i=this.list_divi.selectedItem;this.tf_div.text=`${i}%`}}handleSelectType(e){if(this.itemVo=null,e!=-1){let i=this.list_type.selectedItem;this.tf_type.text=`${m.instance.getLanguage(i.name)}`,e==0?(this.clearProp(),this.initDiciList2(1),this.img_lock.visible=!1,this.img_jia.visible=!0):e==2?(this.initDiciList2(2),this.clearProp()):(this.initDiciList2(1),this.img_lock.visible=!0,this.tf_div.text="0%",this.img_jia.visible=!1,this.PropBox.visible=!1)}}onCountryItemMouse(e,i){e.type===Laya.Event.CLICK&&(this.list_divi.selectedIndex=i,this.onHideDivi())}onTypeItemMouse(e,i){e.type===Laya.Event.CLICK&&(this.list_type.selectedIndex=i,this.onHideDivi())}onCountryItemRender(e,i){e.onChange(this.list_divi.selectedIndex==i)}onTypeItemRender(e,i){e.onChange(this.list_type.selectedIndex==i)}onOpeDividends(){this.list_type.selectedIndex!=1&&(this.img_divi_pad.visible=!0,this.img_bg.once(Laya.Event.MOUSE_DOWN,this,this.onHideDivi))}onHideDivi(){this.img_divi_pad.visible=!1,this.img_type_pad.visible=!1,this.img_bg.off(Laya.Event.MOUSE_DOWN,this,this.onHideDivi)}onScrollBarDown(e){e.stopPropagation()}onHeroChange(e){this.heroVo=e,this.showHeroData()}onOpenType(){this.img_type_pad.visible=!0,this.img_bg.once(Laya.Event.MOUSE_DOWN,this,this.onHideDivi)}onPropChange(e,i){this.itemVo||this.initDiciList2(1),this.itemVo=e;let a=_.intance.m_dicItems.get(e.itemItem.id.toString());this.PropBox.visible=!0,this.img_jia.visible=!1,a&&(this.img_prop_icon.skin=S.instance.getItemIcon(a.icon),this.img_prop_box.skin="gameIcon/items/itemBg/img_"+a.quality+".png",this.tf_all.text=""+xe.formatNumber(e._m_iNum,2),this.tf_have.text=""+xe.formatNumber(i,2))}clearProp(){this.PropBox.visible=!1,this.img_jia.visible=!0}onTabClick(e){e==1?(this.tab1.getChildByName("tf_tit").color="#143268",this.tab1.skin="res/scholarship/img_transfer_tab2.png",this.tab2.getChildByName("tf_tit").color="#429fdf",this.tab2.skin="res/scholarship/img_transfer_tab1.png",this.airBox.visible=!1,this.proBox.visible=!0,this.walletType=0,this.heroVo=null,this.heroPkList=[],this.showHeroData(),this.initTime()):(this.tab1.getChildByName("tf_tit").color="#429fdf",this.tab1.skin="res/scholarship/img_transfer_tab1.png",this.tab2.getChildByName("tf_tit").color="#143268",this.tab2.skin="res/scholarship/img_transfer_tab2.png",this.proBox.visible=!1,this.airBox.visible=!0,this.walletType=1,this.airWalletDataArray=[],this.initAirSubWallet(),this.initTime())}initTime(){let e=new Date;this.startDate={year:e.getFullYear(),month:e.getMonth()+1,day:e.getDate(),hour:e.getHours()},this.endDate={year:e.getFullYear(),month:e.getMonth()+1,day:e.getDate(),hour:e.getHours()},this.refreshStartTime(1),this.refreshStartTime(2)}initAirSubWallet(){this.airWalletDataArray=[],this.airWalletDataArray.push({hero:0,walletAddress:"",name:"",establish:!0,index:0}),this.airWalletDataArray.push({hero:0,walletAddress:"",name:"",establish:!1,index:1}),this.subAirdropWalletList.array=this.airWalletDataArray}addAirWalletItem(){let e={hero:0,walletAddress:"",name:"",establish:!1,index:this.airWalletDataArray.length};this.subAirdropWalletList.visible=!1,this.airWalletDataArray[this.airWalletDataArray.length-1].establish=!0,this.airWalletDataArray.push(e),this.subAirdropWalletList.array=[],this.subAirdropWalletList.array=this.airWalletDataArray,this.subAirdropWalletList.repeatY=this.airWalletDataArray.length-10,this.subAirdropWalletList.scrollTo(this.airWalletDataArray.length-1),this.subAirdropWalletList.visible=!0}addAirWalletNameItem(e){if(e){let i=e.index;this.airWalletDataArray[i].name=e.name,this.airWalletDataArray[i].walletAddress=e.walletAddress}}airdropOpenHeroView(e){A.intance.openModule(y.WalletChooseHeroDialog,[e,this.heroPkList])}onAirHeroChange(e,i){this.airWalletDataArray[i].hero=e,this.heroPkList.push(e.pk)}};tv=h([QR("_bHe6-EiQc-KiQ-mElnEIQ")],tv);var iv=class extends Laya.ComboBox{};var{regClass:JR}=Laya,av=class extends iv{set defaultLabel(t){}onEnable(){this.getDateInfo()}set dataSource(t){super.dataSource=t;var e=t}set isOpen(t){console.log("isOpen: "+t),this._isOpen!=t&&(this._isOpen=t,this._isOpen?this.img_pad.visible=!0:this.img_pad.visible=!1)}};av=h([JR("A2yeugt8S3Ot7ec482gdhQ")],av);var nv=class extends Laya.Box{};var{regClass:ZR}=Laya,rv=class extends nv{set dataSource(e){super.dataSource=e,this.tf_date.text=e}onDisable(){}};rv=h([ZR("fCHaQKFSQ-ew26uygUCKnQ")],rv);var sv=class extends Laya.Box{};var{regClass:eP}=Laya,ov=class extends sv{set dataSource(e){super.dataSource=e,this.tf_rate.text=`${e}%`}onChange(e){e?(this.selectImg.visible=!0,this.tf_rate.color="#ffffff"):(this.tf_rate.color="#357cc0",this.selectImg.visible=!1)}onDisable(){}};ov=h([eP("TToplFpGQGmUqT5SfNnVIg")],ov);var lv=class extends Laya.Dialog{};var{regClass:tP}=Laya,cv=class extends lv{constructor(){super(...arguments);this.m_strName="我是OpenSceneRuntime";this.m_iLayerType=C.M_POP;this.m_iPositionType=C.CENTER}onEnable(){this.employList.visible=!1,this.btn_back.on(Laya.Event.CLICK,this,this.closeEmployView)}async setOpenData(e){this.employList.vScrollBarSkin="";let i=e.heroData,a="";if(i){let r=se.formatTimeStamp(Number(i.startTime),"YY-MT-DD HH:MM:SS"),s=se.formatTimeStamp(Number(i.endTime),"YY-MT-DD HH:MM:SS");var e=await v.requestPost("wxgame/lease/heroInfo",{heroPk:i.heroPk});if(e&&e.info){let l=_.intance.m_dicShops.values,c=i.leaseType;if(c==0){let q=te.getTitleByGoodsId(l,e.info.ticketId);q&&(a=m.instance.getLanguage(q)),e.info.ticketId==0&&(a=m.instance.getLanguage(1260))}else switch(c){case 1:a=m.instance.getLanguage(1261);break;case 2:a=m.instance.getLanguage(1260);break;case 3:a=`${m.instance.getLanguage(1260)}+${m.instance.getLanguage(1261)}`;break}let u="",p=e.info.allTicketCount,d=e.info.remainTicketCount,L=p-d;L<=0?u="0%":u=`${Math.round(e.info.winTimes/L*100)}%`;let x={Address:e.info.targetAddress,"Proxy player":i.playerName,Arena:a,"Remaining ticket":[i.remainCount,e.info.ticketId],"Combat scene":`${L}`,"Winner probability":`${u}`,Deserter:`${e.info.taopao}`,"Start date":r,"End date":s},I=Object.getOwnPropertyNames(x).map(q=>[q,x[q]]);this.employList.array=I;let M=-1;this.employList.selectedIndex=M,this.employList.visible=!0;let H=b.instance.m_heroData.heroVoDic.get(i.heroPk);if(this.img_back.skin=S.instance.getHeroBackIcon(H.heroItem.quality),this.img_front.skin=S.instance.getHeroFrontIcon(H.heroItem.quality),this.img_hero.skin=H.simgurl,this.tf_name.text=Me.shortHeroStr(H.name),i.reward&&i.reward.length>0){let q=te.findFirstTypeAndNotGold(i.reward);q?(this.tf_score.text=q.count,this.img_money.skin=S.instance.getMoneyIcon(q.id),this.img_money.visible=!0):(this.tf_score.text="0",this.img_money.visible=!1)}else this.tf_score.text="0",this.img_money.visible=!1;let V=H.heroItem.level+"";ze.instance.setStar(this,V)}}}onDisable(){this.removeEvent()}removeEvent(){this.btn_back.off(Laya.Event.CLICK,this,this.closeEmployView)}closeEmployView(){this.close()}};cv=h([tP("4pjAWg8HScmRe8ukNRQsGg")],cv);var uv=class extends Laya.Box{};var{regClass:iP}=Laya,mv=class extends uv{constructor(){super()}createChildren(){super.createChildren()}set dataSource(t){super.dataSource=t,this.setEmploy(t)}setEmploy(t){if(!t)return;let e=t[0],i=t[1];this.item_name.text=e,this.item_value.visible=!0,e!=="Remaining ticket"&&e!=="Received"&&e!=="Bonus"&&(this.moneyImg.visible=!1),this.tf_address.visible=!1,e==="Agent Date"||e==="End Date"?this.item_value.text=se.formatTimeStamp(Number(i),"YY-MT-DD HH:MM:SS"):e=="Remaining ticket"?(this.item_value.text=i[0],this.moneyImg.skin=`gameIcon/items/item/img_${i[1]}.png`):e=="Address"?(this.tf_address.visible=!0,this.item_value.visible=!1,this.tf_address.text=`${te.shortenString(i,8,6)}`,this.btn_copy.on(Laya.Event.CLICK,this,this.onClickCopy,[i])):this.item_value.text=i}onClickCopy(t){t&&(doCopy(t),E.instance.notice(m.instance.getLanguage(132)))}onDisable(){this.removeEvent()}removeEvent(){this.btn_copy.off(Laya.Event.CLICK,this,this.onClickCopy)}};mv=h([iP("TAG-i7slRsKkXRu8SsaWHg")],mv);var pv=class extends Laya.Dialog{};var{regClass:aP}=Laya,hv=class extends pv{constructor(e){super();this.m_strName="我是OpenSceneRuntime";this.m_iLayerType=C.M_POP;this.m_iPositionType=C.CENTER}onEnable(){this.list_rental.visible=!1,this.showRentalData(),this.tf_rentedEarned.text=m.instance.getUILang("Rented-earned"),this.tf_proxyEarned.text=m.instance.getUILang("Proxy-earned"),this.tf_winRate.text=m.instance.getUILang("victory")}async showRentalData(){var e=await v.requestPost("wxgame/lease/listAll",{});this.list_rental.array=e.list,this.list_rental.visible=!0,!e.list||e.list.length<=0?this.noDataBox.visible=!0:this.noDataBox.visible=!1,console.log(e)}onDisable(){this.removeEvent()}removeEvent(){}};hv=h([aP("peF5WS5zQgGqZq82ro5IyQ")],hv);var dv=class extends Laya.Box{};var{regClass:nP}=Laya,fv=class extends dv{constructor(){super()}createChildren(){super.createChildren()}set dataSource(t){super.dataSource=t,this.setEmploy(t)}setEmploy(t){if(!t)return;let e=se.formatDayAndTime(t.startTime),i=se.formatDayAndTime(t.endTime);this.tf_createDate.text=e.date,this.tf_endDate.text=i.date,this.tf_player.text=t.playerName;let a=_.intance.m_dicShops.values,r=t.leaseType;if(r==0){let l=te.getTitleByGoodsId(a,t.ticketId);l&&(this.tf_arena.text=m.instance.getLanguage(l)),t.ticketId==0&&(this.tf_arena.text=m.instance.getLanguage(1260))}else switch(r){case 1:this.tf_arena.text=m.instance.getLanguage(1261);break;case 2:this.tf_arena.text=m.instance.getLanguage(1260);break;case 3:this.tf_arena.text=`${m.instance.getLanguage(1260)}+${m.instance.getLanguage(1261)}`;break}this.tf_dividends.text=`${t.leaseRatio}%`,this.tf_fight.text=`${t.fightTimes}`,this.tf_vic.text=`${t.winRate}%`;let s=t.leaseReward,o=t.proxyReward;if(s&&s.length>0){let l=te.findFirstTypeAndNotGold(s);l&&(this.tf_earned.text=xe.filterNumFormat(l.count,2),this.img_coinType.skin=S.instance.getMoneyIcon(l.id),this.img_coinType.visible=!0)}else this.tf_earned.text="0",this.img_coinType.visible=!1;if(o&&o.length>0){let l=te.findFirstTypeAndNotGold(o);l&&(this.tf_proxy.text=xe.filterNumFormat(l.count,2),this.img_coinType2.skin=S.instance.getMoneyIcon(l.id),this.img_coinType2.visible=!0)}else this.tf_proxy.text="0",this.img_coinType2.visible=!1}};fv=h([nP("bVHWCHZxQDSIcXWzNcq-MA")],fv);var yv=class extends Laya.Box{};var{regClass:rP,property:FVe}=Laya,bv=class extends yv{constructor(){super();this.isAddEvent=!1}set dataSource(e){if(e){if(super.dataSource=e,this.heroVo=e,!this.heroVo){this.img_back.skin=S.instance.getHeroBackIcon(0),this.box_show.visible=!1;return}this.addEvent(),this.setCurrentOutPut()}}async setCurrentOutPut(){this.img_back.skin=S.instance.getHeroBackIcon(this.heroVo.heroItem.quality),this.img_front.skin=S.instance.getHeroFrontIcon(this.heroVo.heroItem.quality),this.img_hero.skin=this.heroVo.simgurl,this.tf_name.text=Me.shortHeroStr(this.heroVo.name);let e=this.heroVo.heroItem.level+"";ze.instance.setStar(this,e),this.box_show.visible=!0,this.heroVo.state==1?(this.img_state.skin="gameIcon/hero/heroDetail/img_hero_state_2.png",this.img_state.visible=!0):this.heroVo.state==2?(this.img_state.skin="gameIcon/hero/heroDetail/img_hero_state_3.png",this.img_state.visible=!0):this.img_state.visible=!1}addEvent(){this.isAddEvent||(this.on(Laya.Event.CLICK,this,this.toDetail),this.isAddEvent=!0)}onDisable(){this.off(Laya.Event.CLICK,this,this.toDetail)}toDetail(){this.heroVo.id&&A.intance.openModule(y.HeroDetailDialog,[this.heroVo])}};bv=h([rP("vJhsY0hvQjyUXjU0-8xV7g")],bv);var gv=class extends Laya.Box{};var{regClass:sP}=Laya,Lv=class extends gv{constructor(){super();this.isAddEvent=!1}addEvent(){this.isAddEvent||(this.isAddEvent=!0)}set dataSource(e){super.dataSource=e,e&&(this.img_coin.skin=S.instance.getMoneyIcon(e.id),this.money_value.text=e.count,this.addEvent())}};Lv=h([sP("TjAZ1yG-QkG5fetB03VUuA")],Lv);var _v=class extends Laya.Scene{};var{regClass:oP,property:l8e}=Laya,vv=class extends _v{constructor(){super(...arguments);this.text=""}onAwake(){this.m_iLayerType=C.M_POP,this.m_iPositionType=C.UP}onEnable(){this.list_hero.vScrollBarSkin="",this.RentalList.visible=!1,this.RevenueList.visible=!1,this.subWalletList.visible=!1,this.btn_sch.on(Laya.Event.CLICK,this,this.onClickSch),this.btn_jia.on(Laya.Event.CLICK,this,this.onClickJia),this.btn_yi.on(Laya.Event.CLICK,this,this.onClickYi),g.intance.on(f.CREATE_SUB_WALLET_SUCCESS,this,this.createSubWalletSuccess),this.btn_subwallet.on(Laya.Event.CLICK,this,this.onClickSubwallet),this.btn_createSubWallet.on(Laya.Event.CLICK,this,this.onClickCreateSubwallet),this.btn_rental.on(Laya.Event.CLICK,this,this.onClickRentalRecord),this.close&&this.btn_back.on(Laya.Event.CLICK,this,this.setToMainScene),this.onClickSch(),this.initHeroData()}async setMoneyData(){let e=await v.requestPost("wxgame/lease/outline",{});if(e&&e.reward){let i=te.processItemsArray(e.reward)[0];this.RentalList.array=i,this.RentalList.visible=!0}if(e&&e.childReward){let i=te.processItemsArray(e.childReward)[0];this.RevenueList.array=i,this.RevenueList.visible=!0}}initContainer(e){this.list_hero.visible=!1,this.list_hero.vScrollBarSkin="",this.createHeadList(e)}async createHeadList(e){if(!this)return;let i=e;if(i){this.list_hero.selectedIndex=1,this.list_hero.array=i,this.list_hero.visible=!0,this.tf_heroTotal.text=`${this.list_hero.array.length}`;let a=-1;this.list_hero.selectedIndex=a}(!i||i.length<=0)&&(this.noDataBox.visible=!0)}async initHeroData(){await Et.instance.ownerHero(!0)}setToMainScene(){oe.intance.setCurrentScene(Y.M_SCENE_MAIN)}setTabState(e,i,a,r){e.getChildByName("selectBox").visible=i,e.getChildByName("tf_txt").color=i?a:r}onClickSch(){this.box_1.visible=!0,this.list_hero.visible=!1,this.subWalletBox.visible=!1,this.noDataBox.visible=!1,this.setTabState(this.btn_sch,!0,"#143f6b","#7ff1fe"),this.setTabState(this.btn_jia,!1,"#143f6b","#7ff1fe"),this.setTabState(this.btn_yi,!1,"#143f6b","#7ff1fe"),this.setTabState(this.btn_subwallet,!1,"#143f6b","#7ff1fe"),this.setMoneyData()}async onClickJia(){await Et.instance.ownerHero(),this.box_1.visible=!1,this.list_hero.visible=!0,this.subWalletBox.visible=!1,this.noDataBox.visible=!1,this.setTabState(this.btn_jia,!0,"#143f6b","#7ff1fe"),this.setTabState(this.btn_sch,!1,"#143f6b","#7ff1fe"),this.setTabState(this.btn_yi,!1,"#143f6b","#7ff1fe"),this.setTabState(this.btn_subwallet,!1,"#143f6b","#7ff1fe");let e=b.instance.m_heroData.heroVoDic.values,i=te.filterObjectsByState(e,1);this.initContainer(i)}async onClickYi(){await Et.instance.ownerHero(),this.box_1.visible=!1,this.list_hero.visible=!0,this.subWalletBox.visible=!1,this.noDataBox.visible=!1;let e=b.instance.m_heroData.heroVoDic.values,i=te.filterObjectsByState(e,2);this.initContainer(i),this.setTabState(this.btn_yi,!0,"#143f6b","#7ff1fe"),this.setTabState(this.btn_sch,!1,"#143f6b","#7ff1fe"),this.setTabState(this.btn_jia,!1,"#143f6b","#7ff1fe"),this.setTabState(this.btn_subwallet,!1,"#143f6b","#7ff1fe")}async onClickSubwallet(){this.box_1.visible=!1,this.list_hero.visible=!1,this.subWalletBox.visible=!0,this.noDataBox.visible=!1,this.setTabState(this.btn_subwallet,!0,"#143f6b","#7ff1fe"),this.setTabState(this.btn_sch,!1,"#143f6b","#7ff1fe"),this.setTabState(this.btn_jia,!1,"#143f6b","#7ff1fe"),this.setTabState(this.btn_yi,!1,"#143f6b","#7ff1fe");var e=await v.requestPost("wxgame/lease/list",{});if(e){let i=e.list;i.sort((r,s)=>s.createTime-r.createTime);let a=e.list.length;for(let r=0;r<i.length;r++)i[r].rank=r+1;if(i){this.subWalletList.selectedIndex=1,i.push(void 0),i.push(void 0),i.push(void 0),this.subWalletList.array=i,this.tf_subTotal.text=`${a}`,this.subWalletList.visible=!0;let r=-1;this.subWalletList.selectedIndex=r}(!i||i.length<=0)&&(this.noDataBox.visible=!0)}}createSubWalletSuccess(){Laya.timer.once(800,this,this.onClickSubwallet)}onClickCreateSubwallet(){A.intance.openModule(y.CreateSubWalletDialog)}onClickRentalRecord(){A.intance.openModule(y.RentalRecordDialog)}onDisable(){this.removeEvent()}removeEvent(){this.btn_back.off(Laya.Event.CLICK,this,this.setToMainScene),this.btn_sch.off(Laya.Event.CLICK,this,this.onClickSch),this.btn_jia.off(Laya.Event.CLICK,this,this.onClickJia),this.btn_yi.off(Laya.Event.CLICK,this,this.onClickYi),this.btn_subwallet.off(Laya.Event.CLICK,this,this.onClickSubwallet),this.btn_createSubWallet.off(Laya.Event.CLICK,this,this.onClickCreateSubwallet),g.intance.offAllCaller(this)}};vv=h([oP("eB5n1zn1RD2i2F-bAki-sQ")],vv);var xv=class extends Laya.Box{};var{regClass:lP}=Laya,Iv=class extends xv{constructor(){super();this.isAddEvent=!1;this.allData=null}set dataSource(e){if(super.dataSource=e,!e){this.visible=!1;return}this.allData=e,g.intance.on(f.CHANGE_WALLET_HERO_AIR,this,this.onAirHeroChange),this.btn_add.on(Laya.Event.CLICK,this,this.onClickAdd,[e]),this.img_noHero.on(Laya.Event.CLICK,this,this.onClickNohero),this.tf_address.on(Laya.Event.BLUR,this,this.setPlayerName),this.setData()}setData(){this.dataBox.visible=this.allData.establish,this.btn_add.visible=!this.allData.establish,this.allData.hero?this.showHeroData(this.allData.hero):(this.box_show.visible=!1,this.img_back.visible=!1,this.img_noHero.visible=!0),this.allData.walletAddress.length>0?this.tf_address.text=this.allData.walletAddress:this.tf_address.text="",this.allData.name.length>0?this.tf_playerName.text=this.allData.name:this.tf_playerName.text=""}onClickAdd(){g.intance.event(f.ADD_AIR_WALLET_ITEM,[this.allData.index])}onClickNohero(){g.intance.event(f.AIR_SUB_WALLET_OPENHERO,[this.allData.index])}onAirHeroChange(e,i){!e||i!==this.allData.index||this.showHeroData(e)}showHeroData(e){this.allData.hero=e,this.box_show.visible=!0,this.img_back.visible=!0,this.img_noHero.visible=!1,this.img_back.skin=S.instance.getHeroBackIcon(e.heroItem.quality),this.img_front.skin=S.instance.getHeroFrontIcon(e.heroItem.quality),this.img_hero.skin=e.simgurl,this.tf_name.text=Me.shortHeroStr(e.name);let i=e.heroItem.level+"";ze.instance.setStar(this,i)}async setPlayerName(){try{if(this.tf_address.text=="")return;if(this.tf_address.text==F.instance.walletAddress){E.instance.notice(m.instance.getLanguage(1162));return}var e=await v.requestPost("wxgame/sys/queryName",{openid:this.tf_address.text.toLowerCase()});e&&(console.log(e),this.tf_playerName.text=e.name,g.intance.event(f.ADD_AIR_SUB_WALLET_NAME,[{name:e.name,walletAddress:this.tf_address.text,index:this.allData.index}]))}catch{console.log("未找到该玩家，请核对地址")}}onDisable(){g.intance.off(f.CHANGE_WALLET_HERO_AIR,this,this.onAirHeroChange),this.btn_add.off(Laya.Event.CLICK,this,this.onClickAdd),this.img_noHero.off(Laya.Event.CLICK,this,this.onClickNohero),this.tf_address.off(Laya.Event.BLUR,this,this.setPlayerName)}};Iv=h([lP("8bSpqI3UR8KoEpwSxDv_7g")],Iv);var Ev=class extends Laya.Box{};var{regClass:cP}=Laya,wv=class extends Ev{constructor(){super();this.isAddEvent=!1;this.heroPk=null}addEvent(){this.isAddEvent||(this.isAddEvent=!0)}set dataSource(e){if(super.dataSource=e,!e){this.visible=!1;return}let{rank:i,heroPk:a,ticketId:r,playerName:s,remainCount:o,reward:l,leaseType:c}=e;this.tf_rank.text=i,this.heroPk=a;let u=_.intance.m_dicShops.values;if(c==0){let p=te.getTitleByGoodsId(u,r);p&&(this.tf_arena.text=m.instance.getLanguage(p)),r==0&&(this.tf_arena.text=m.instance.getLanguage(1260))}else switch(c){case 1:this.tf_arena.text=m.instance.getLanguage(1261);break;case 2:this.tf_arena.text=m.instance.getLanguage(1260);break;case 3:this.tf_arena.text=`${m.instance.getLanguage(1260)}+${m.instance.getLanguage(1261)}`;break}if(this.tf_name.text=s,this.tf_venue.text=o,this.btn_detail.off(Laya.Event.CLICK,this,this.onClickDetail),this.btn_detail.on(Laya.Event.CLICK,this,this.onClickDetail,[e]),this.addEvent(),l&&l.length>0){let p=te.findFirstTypeAndNotGold(l);p&&(this.tf_score.text=p.count,this.img_money.skin=S.instance.getMoneyIcon(p.id),this.img_money.visible=!0)}else this.tf_score.text="0",this.img_money.visible=!1}onClickDetail(e){A.intance.openModule(y.EmployInfoDialog,{heroData:e})}onDisable(){this.btn_detail&&this.btn_detail.off(Laya.Event.CLICK,this,this.onClickDetail)}};wv=h([cP("5iGLLzQkR8mqhVsrdybXCQ")],wv);var Tv=class extends Laya.Box{};var{regClass:uP}=Laya,Cv=class extends Tv{set dataSource(e){e&&(super.dataSource=e,e.name=="Professional & Airdrop"?this.tf_rate.text="Professional & Airdrop":this.tf_rate.text=`${m.instance.getLanguage(e.name)}`)}onChange(e){e?(this.selectImg.visible=!0,this.tf_rate.color="#ffffff"):(this.tf_rate.color="#357cc0",this.selectImg.visible=!1)}onDisable(){}};Cv=h([uP("_iWKrJX7QK6BqGFWXcrKUw")],Cv);var Sv=class extends Laya.Dialog{};var{regClass:mP}=Laya,Dv=class extends Sv{constructor(e){super();this.propValue=1;this.propNum=1;this.propData=null;this.heroPk=null;this.chooseType=1;this.subType=1;this.posNum=1;this.items=[]}onEnable(){this.txt_num.text="1",this.listPanel1.visible=!1,this.btn_subtract.on(Laya.Event.CLICK,this,this.changePropNum,[!1]),this.btn_add.on(Laya.Event.CLICK,this,this.changePropNum,[!0]),this.listPanel1.selectHandler=new Laya.Handler(this,this.handleSelectProp),this.btn_transfer.on(Laya.Event.CLICK,this,this.onBtnTramsfer),g.intance.on(f.SHOW_EQUIP_TIP,this,this.showEquipTip),this.initPropList()}setOpenData(e){e&&(this.chooseType=e[0],this.subType=e[1],this.posNum=e[3],this.equipList=e[4],this.chooseType==Ge.CHOOSE_Wallet?(this.btn_transfer.label=m.instance.getUILang("Transfer in"),this.box_count.visible=!0,this.tf_title.text=m.instance.getUILang("Select tickets")):(this.heroPk=e[2],this.btn_transfer.label=m.instance.getUILang("Put on"),this.box_count.visible=!1,this.tf_title.text=m.instance.getUILang("Select equipment")))}changePropNum(e){e?this.propValue=Math.min(this.propValue+1,this.propNum):this.propValue=Math.max(this.propValue-1,1),this.txt_num.text=`${this.propValue}`}async initPropList(){await Et.instance.ownerBag();var e=this.getItemByType();this.propData=e,this.listPanel1.array=e,this.listPanel1.selectedIndex=0,this.listPanel1.visible=!0}handleSelectProp(e){if(e!==-1){this.propValue=1,this.txt_num.text="1";let i=this.listPanel1.selectedItem;i&&(this.propNum=Number(i._m_iNum),console.log(this.propNum))}}showEquipTip(e){if(this.chooseType!==Ge.CHOOSE_Wallet){let i=e.data;this.EquipDetailBox.dataSource=i,e.positionX<500?this.EquipDetailBox.x=e.positionX+175:this.EquipDetailBox.x=e.positionX-440,this.EquipDetailBox.visible=!0,this.equipBgBox.visible=!0,this.equipBgBox.on(Laya.Event.CLICK,this,this.hideTips)}}hideTips(){this.EquipDetailBox.visible=!1,this.equipBgBox.visible=!1,this.equipBgBox.off(Laya.Event.CLICK,this,this.hideTips)}async onBtnTramsfer(){let e=this.propData[this.listPanel1.selectedIndex],i=this.propValue;if(i<=0||!e){this.chooseType==Ge.CHOOSE_Wallet?pe.instance().AlertByType(P.BASEALERTVIEW,m.instance.getLanguage(1166),P.YES):E.instance.notice(m.instance.getLanguage(1282,m.instance.getLanguage(e.itemItem.name)));return}if(this.chooseType==Ge.CHOOSE_Wallet)g.intance.event(f.CHANGE_WALLET_PROP,[e,i]),this.close();else if(this.heroPk){let a=this.listPanel1.selectedItem,r=this.subType;this.subType==12&&(r=this.posNum);let s=await v.requestPost("wxgame/equip/wear",{heroPk:this.heroPk,bagPk:a.m_iPk,pos:r});s&&(console.log(s),s.cur.pos=s.pos,this.close(),g.intance.event(ri.UPDATE_HERO_EQUIP,s.cur))}}getItemByType(){this.items=[];var e;if(this.chooseType==Ge.CHOOSE_Wallet){this.subType=7;let r=b.instance.m_packageData.getListBySubType(this.subType),s=b.instance.m_packageData.getListBySubType(13);e=[...r,...s]}else e=b.instance.m_packageData.getListBySubType(this.subType);for(var i=0;i<e.length;i++){var a=e[i];this.equipList&&this.equipList.length>0?this.equipList.indexOf(a.itemItem.id)<0&&this.items.push(a):this.items.push(a)}return this.items}onDisable(){this.btn_subtract.off(Laya.Event.CLICK,this,this.changePropNum),this.btn_add.off(Laya.Event.CLICK,this,this.changePropNum),this.btn_transfer.off(Laya.Event.CLICK,this,this.onBtnTramsfer),this.stage.off(Laya.Event.CLICK,this,this.hideTips),g.intance.off(f.SHOW_EQUIP_TIP,this,this.showEquipTip)}};Dv=h([mP("WY66k0UbQfiwaG80emIzjA")],Dv);var Av=class extends Laya.Box{};var{regClass:pP}=Laya,kv=class extends Av{constructor(){super();this.showAdd=!1;this.isAddEvent=!1}createChildren(){super.createChildren()}addEvent(){this.isAddEvent||(this.isAddEvent=!0)}set dataSource(e){super.dataSource=e,this.addEvent(),this.setCurrentOutPut(e)}async setCurrentOutPut(e){if(e){let i=_.intance.m_dicItems.get(e.ticketId.toString());this.txt_num.text=""+xe.formatNumber(e.ticketCount,8),this.img_icon.skin=S.instance.getItemIcon(i.icon),this.img_box.skin="gameIcon/items/itemBg/img_"+i.quality+".png"}else this.txt_num.text="",this.img_icon.skin=null,this.img_box.skin="gameIcon/items/itemBg/img_0.png"}};kv=h([pP("QLIqcx2YSRWf6b4T0P4N6Q")],kv);var Bv=class extends Laya.Box{};var{regClass:hP}=Laya,Mv=class extends Bv{set dataSource(e){super.dataSource=e,e&&(this.tf_data.text=e)}onDisable(){}onChange(e){e?(this.selectImg.visible=!0,this.tf_data.color="#ffffff"):(this.tf_data.color="#357cc0",this.selectImg.visible=!1)}};Mv=h([hP("3viWNkWoRRS9EWM3SzguDg")],Mv);var Rv=class extends Laya.Dialog{};var bo=class n{constructor(){this.lastTime=0}static get instance(){return n._instance||(n._instance=new n),n._instance}async recruitItem(t,e,i,a=void 0){t.chainType>0?await this.buyItemOnChain(t,e,i,a):await this.buyItemNormal(t,e,i,a)}async buyItemNormal(t,e,i,a=void 0){let r=_.intance.m_dicShops.get(e),s=await v.requestPost("wxgame/hero/itemBuy",{shopId:r.id,count:i},!0,!0);s&&(s.reward&&A.intance.openModule(y.RewardGetDialog,s.reward),s.resChange&&b.instance.moneyInfoHander(s.resChange),s.fightHeroPk&&(b.instance.playerDto.fightHeroPk=s.fightHeroPk),de.instance.hideLoading(),a&&a&&a.run())}async buyItemOnChain(t,e,i,a=void 0){var r=new Date().getTime();if(r-this.lastTime<1e3)return;this.lastTime=r;let s=t.coinType;var o=_.intance.getCurrencyByChainType(s,t.chainType),l=o.chainId;de.instance.showLoadingByInfo(m.instance.getLanguage(1119));let c;t.type==2?c=o.tiketAddress:t.type==5&&(c=o.skillAddress);let u=F.instance.walletAddress,p=await F.instance.walletClient.getChainId();try{if(p!==l&&!await F.instance.switchChain(l)){this.onEndItemCallback(),console.log("切换失败，请手动切换");return}let X=o.token;if(!X){this.onEndItemCallback(),E.instance.notice(m.instance.getLanguage(1177,p));return}if(!c){this.onEndItemCallback(),E.instance.notice(m.instance.getLanguage(1174,p));return}var d=0;t.commission&&t.commission.length>1&&(d=t.commission[1]);var L=t.cost[1];let Z=new dt(L),Q=new dt(d),ee=Z.add(Q);var x=new dt(i);let ae=ee.multiply(x),Be=await F.instance.getBalance2(X),we=pi(ae.getValue()+"",o.tokenDecimals);var w=o.token==0?we:pi("0",o.tokenDecimals);if(parseFloat(Be)<parseFloat(we)){this.onEndItemCallback(),Le.moneyNotEnought(s);return}if(console.log("判断授权 tokenAddress: "+X+", chainIDData:"+l),!await F.instance.newAllowanceAddress(c,X))return console.log("未授权"),this.onEndItemCallback(),E.instance.notice(m.instance.getLanguage(15)),de.instance.hideLoading(),!1;let Oe=b.instance.playerDto.pid;var I;if(this.type=t.type,t.type==2){var M=t.goods;this.tid=M,I=await F.instance.walletClient.writeContract({address:c,abi:J.buyTicket_ABI,functionName:"buyTicket",args:[Oe,M,i],account:u,value:w})}else if(t.type==5){var H=t.goods;this.tid=H,I=await F.instance.walletClient.writeContract({address:c,abi:J.buySkillCard_ABI,functionName:"buySkillCard",args:[Oe,H,i],account:u,value:w})}let ce;return ce=await F.instance.publicClient.waitForTransactionReceipt({hash:I,pollingInterval:1e3}),console.log(`Tx with hash: ${I}`,ce),ce&&ce.status=="success"?(this.waitGetQuanReward(l,I),console.log(`Tx successful with hash: ${I}`),I):(this.onEndItemCallback(),Le.TransactionErrorTip(),!1)}catch(X){var V=X.shortMessage;if(V)if(V.indexOf("does not match")!=-1){var q=F.instance.getChainName(l);V=m.instance.getLanguage(1172,q),this.onEndItemCallback()}else V.indexOf("User rejected the request")!=-1&&this.onEndItemCallback();else this.onEndItemCallback();if(console.log(V),E.instance.notice(V),X instanceof K){let Z=X.walk(Q=>Q instanceof vt);if(Z instanceof vt){let Q=Z.data?.errorName??"";console.log("============errorName: "+Q)}}return null}}onEndItemCallback(t=null){de.instance.hideLoading(),t&&g.intance.event(f.EVENT_REFRESH_ITEM_ONCHAIN_STATUS,[t])}waitGetQuanReward(t,e){this.chainId=t,this.hashId=e,Laya.timer.loop(2e3,this,this.getItemReward)}async getItemReward(){if(this.type==2||this.type==5){var t;this.type==2?t=1:this.type==5&&(t=2);var e=await v.requestPost("paWallet/scanBuyBonusCheck",{type:t,chainId:this.chainId,hashId:this.hashId}).catch(a=>{}),i=e.status;i>0&&(Laya.timer.clear(this,this.getItemReward),E.instance.notice(m.instance.getLanguage(2e3)),de.instance.hideLoading(),this.onEndItemCallback(1))}}};var{regClass:dP}=Laya,Pv=class extends Rv{constructor(){super();this.m_iLayerType=C.M_POP;this.m_iPositionType=C.CENTER;this.addL=1}onEnable(){this.btn_plus.clickHandler=new Laya.Handler(this,this.handleClickBtn,[this.btn_plus]),this.btn_reduce.clickHandler=new Laya.Handler(this,this.handleClickBtn,[this.btn_reduce]),this.tf_num.on(Laya.Event.BLUR,this,this.changeItemNum),this.btn_send.on(Laya.Event.CLICK,this,this.buyTicket),g.intance.on(f.EVENT_REFRESH_ITEM_ONCHAIN_STATUS,this,this.onRefreshItemStatus)}setOpenData(e){if(e){console.log(e),this.shopItem=e[0],this.tf_name.text=m.instance.getLanguage(this.shopItem.title),this.tf_des.text=m.instance.getLanguage(this.shopItem.des),this.tf_price.text=`${this.shopItem.cost[1]}`,this.shopItem.commission&&this.shopItem.commission.length>1?this.tf_commission.text=`${this.shopItem.commission[1]}`:(this.tf_des.y=this.box_commission.y,this.box_commission.visible=!1),this.shopItem.chainType>0?(this.tf_tip.visible=!0,this.shopItem.type==2?this.tf_tip.text=m.instance.getLanguage(1836):this.shopItem.type==5&&(this.tf_tip.text=m.instance.getLanguage(1837)),this.addL=10):this.tf_tip.visible=!1,this.img_moneyIcon.skin=S.instance.getMoneyIcon(this.shopItem.cost[0]),this.img_icon.skin=S.instance.getItemIcon(this.shopItem.icon);var i=_.intance.m_dicItems.get(this.shopItem.icon);this.img_box.skin="gameIcon/items/itemBg/img_"+i.quality+".png",this.setItemNum(),b.instance.pveOpen==1&&this.shopItem.id==2041?(this.addL=100,this.btn_plus.disabled=!0,this.btn_reduce.disabled=!0,this.tf_num.disabled=!0,this.setItemNum()):(this.btn_plus.disabled=!1,this.btn_reduce.disabled=!1,this.tf_num.disabled=!1)}}onDisable(){g.intance.off(f.EVENT_REFRESH_ITEM_ONCHAIN_STATUS,this,this.onRefreshItemStatus)}onRefreshItemStatus(){this.close()}handleClickBtn(e){switch(e){case this.btn_reduce:this.addL>1&&this.addL--,this.setItemNum();break;case this.btn_plus:this.addL<99999&&this.addL++,this.setItemNum();break}}setItemNum(){this.tf_num.text=this.addL+"";var e=0;this.shopItem.commission&&this.shopItem.commission.length>1&&(e=this.shopItem.commission[1]);var i=this.shopItem.cost[1];let a=i+e;var r=xe.formatNumber(a);let s=new dt(this.addL),o=new dt(r),l=s.multiply(o).getValue();this.tf_needMoney.text=`${l}`}changeItemNum(){var e=parseInt(this.tf_num.text);(!e||e<1)&&(e=1),this.addL=e,this.setItemNum()}async buyTicket(){let e=Laya.Handler.create(this,()=>{this.close()});await bo.instance.recruitItem(this.shopItem,this.shopItem.id,this.addL,e)}};Pv=h([dP("HVS6mG75Rv-dixx4tHjp2g")],Pv);var Nv=class extends Laya.Box{};var{regClass:fP}=Laya,Ov=class extends Nv{constructor(){super(...arguments);this.coins=[[3022,2],[3001,2],[3011,2],[3013,4],[3010,2],[3007,4],[3006,6],[3015,2],[3016,2],[3005,0]]}onEnable(){let e=(Laya.stage.width-z.DESIGN_WIDTH)/2;this.img_coinsBg.right-=e,console.log("dWidth: "+e),this.updateLocalAssets(),g.intance.on(f.ROLE_INFO_CHANGE,this,this.updateLocalAssets),g.intance.on(ti.UPDATE_LOCAL_WALLET_LIST_EVENT,this,this.updateLocalAssets),this.coins=_.intance.getGeneralValueById(19),this.list_coin.array=this.coins}onDisable(){g.intance.off(f.ROLE_INFO_CHANGE,this,this.updateLocalAssets),g.intance.off(ti.UPDATE_LOCAL_WALLET_LIST_EVENT,this,this.updateLocalAssets)}updateLocalAssets(){this.list_coin.refresh()}};Ov=h([fP("7P9MlqipSaG6QoKpQowDbQ")],Ov);var Hv=class extends Laya.Dialog{};var{regClass:yP}=Laya,Uv=class extends Hv{constructor(e){super();this.m_strName="我是OpenSceneRuntime";this.m_iLayerType=C.M_POP;this.m_iPositionType=C.CENTER;this.heroVo=null;this.rentalDto=null;this.coinType=3001;this.rentalTypeDatas=[];this.coinIds=[]}onEnable(){g.intance.on(f.CHANGE_WALLET_HERO,this,this.onHeroChange),this.hero_box.on(Laya.Event.CLICK,this,this.onHeroBoxClick),this.btn_create.on(Laya.Event.CLICK,this,this.onCreate)}async setOpenData(e){e&&e.length>0&&(this.rentalDto=e[0]),this.initContainer()}initContainer(){if(this.rentalDto){this.alertTitle.text=m.instance.getUILang("Modify rental information"),this.heroVo=new Ht;var e=this.rentalDto.heroDto;ze.instance.setHeroVoByHeroDto(this.heroVo,e),this.input_amount.text=this.rentalDto.amount+"",this.input_minPeriod.text=this.rentalDto.minPeriod+"",this.input_maxPeriod.text=this.rentalDto.maxPeriod+"",this.input_hoursPeriod.text=this.rentalDto.minPeriod+"",this.rentalDto.pwdStr&&(this.input_pwd.text=this.rentalDto.pwdStr+""),this.input_telegram.text=this.rentalDto.hostPlayer.telegram+"",this.btn_create.label=m.instance.getUILang("Modify"),this.box_postPin.visible=!1,this.btn_create.x=412}else{this.alertTitle.text=m.instance.getUILang("Post rental information");var i;if(this.rentalType||this.rentalType==2){i=_.intance.m_dicHeroRent.get(2);var a=i.timeRange;this.input_minPeriod.text=a[0]+"",this.input_maxPeriod.text=a[1]+""}else{i=_.intance.m_dicHeroRent.get(1);var r=i.timeRange;this.input_hoursPeriod.text=r[0]+""}var s=b.instance.playerDto.telegram;s&&(this.input_telegram.text=s+""),this.btn_create.label=m.instance.getUILang("Post rental"),this.btn_create.x=529}this.showHeroData(),this.initRentalTypeCombo(),this.initCoinCombo()}initRentalTypeCombo(){var e=_.intance.m_dicHeroRent.values;this.rentalTypeDatas=[],e.forEach(r=>{r.enable>0&&this.rentalTypeDatas.push([r.type,m.instance.getLanguage(r.name)])}),console.log("this.rentalTypeDatas: ",this.rentalTypeDatas),this.rentalTypeCombo.selectHandler=new Laya.Handler(this,this.onSelectedRentalType),this.rentalTypeCombo.dataSource=this.rentalTypeDatas;let i=-1,a=0;if(this.rentalTypeDatas.length>0&&(i=0),this.rentalDto)for(let r of this.rentalTypeDatas){if(r[0]==this.rentalDto.rentalType){i=a;break}a++}this.rentalTypeCombo.selectedIndex=i}onSelectedRentalType(e){e!=-1&&(this.rentalType=this.rentalTypeDatas[e][0],console.log("您选中了 rentalType"+this.rentalType),this.setRoomInfo())}setRoomInfo(){var e=this.rentalType;if(e==1?(this.input_amount.text="0",this.coinCombo.selectedIndex=0,this.input_amount.disabled=!0,this.coinCombo.disabled=!0,this.box_hour.visible=!0,this.box_day.visible=!1):(this.input_amount.disabled=!1,this.coinCombo.disabled=!1,this.box_hour.visible=!1,this.box_day.visible=!0),!this.rentalDto){var i;if(this.rentalType==2){i=_.intance.m_dicHeroRent.get(2);var a=i.timeRange;this.input_minPeriod.text=a[0]+"",this.input_maxPeriod.text=a[1]+"",this.input_amount.text="1"}else{i=_.intance.m_dicHeroRent.get(1);var r=i.timeRange;this.input_hoursPeriod.text=r[0]+"",this.input_amount.text="0"}}}initCoinCombo(){var e=_.intance.m_dicHeroRent.get(2);this.coinIds=e.rentToken;var i=[];this.coinIds.forEach(s=>{var o=_.intance.m_dicItems.get(s);i.push(m.instance.getLanguage(o.name))}),this.coinCombo.selectHandler=new Laya.Handler(this,this.onSelectCoin),this.coinCombo.dataSource=i;let a=-1,r=0;if(i.length>0&&(a=0),this.rentalDto)for(let s of this.coinIds){if(s==this.rentalDto.coinType){a=r;break}r++}this.coinCombo.selectedIndex=a}onSelectCoin(e){e!=-1&&(this.coinType=this.coinIds[e],console.log("您选中了 coinType"+this.coinType))}onHeroChange(e){this.heroVo=e,this.showHeroData()}onDisable(){this.removeEvent()}removeEvent(){this.hero_box.off(Laya.Event.CLICK,this,this.onHeroBoxClick),this.btn_create.off(Laya.Event.CLICK,this,this.onCreate),g.intance.off(f.CHANGE_WALLET_HERO,this,this.onHeroChange)}onHeroBoxClick(){A.intance.openModule(y.WalletChooseHeroDialog,[-1])}async onCreate(){if(Ae.instance.inMinWaiting){E.instance.notice(m.instance.getLanguage(1187));return}if(!this.heroVo){E.instance.notice(m.instance.getLanguage(1671));return}var e=parseFloat(this.input_amount.text),i;let a=parseInt(this.input_maxPeriod.text);var r;if(this.rentalType==2){if(!(e>0)){E.instance.notice(m.instance.getLanguage(1670));return}i=parseInt(this.input_minPeriod.text),r=_.intance.m_dicHeroRent.get(2);var s=r.timeRange;if(Number.isNaN(i)||i<s[0]){E.instance.notice(m.instance.getLanguage(1667,s[0]));return}if(Number.isNaN(i)||a>s[1]){E.instance.notice(m.instance.getLanguage(1666,s[1]));return}if(a<i){E.instance.notice(m.instance.getLanguage(1668));return}}else{i=parseInt(this.input_hoursPeriod.text),console.log("minPeriod: ",i),r=_.intance.m_dicHeroRent.get(1);var o=r.timeRange;if(Number.isNaN(i)||i<o[0]||i>o[1]){E.instance.notice(m.instance.getLanguage(1669,o[0],o[1]));return}}let l=this.input_telegram.text;if(l==""){E.instance.notice(m.instance.getLanguage(1672));return}let c=this.input_pwd.text,u=this.input_postPin.text,p=this.heroVo.pk;var d=0;if(this.rentalDto)d=this.rentalDto.id;else if(u==""){E.instance.notice(m.instance.getLanguage(1673));return}var L={pk:p,rentalType:this.rentalType,minPeriod:i,maxPeriod:a,amount:e,coinType:this.coinType,telegram:l,pwd:c,postPin:u,rentId:d};try{var x="wxgame/hero/postRental";this.rentalDto&&(x="wxgame/hero/updateRental");var w=await v.requestPost(x,L);w&&(E.instance.notice(m.instance.getLanguage(2e3)),this.heroVo.pk==b.instance.playerDto.fightHeroPk&&(b.instance.playerDto.fightHeroPk=""),Laya.timer.once(200,this,()=>{g.intance.event(f.CREATE_SUB_WALLET_SUCCESS)}),this.close())}catch{}}showHeroData(){if(this.heroVo){this.img_back.skin=S.instance.getHeroBackIcon(this.heroVo.heroItem.quality),this.img_front.skin=S.instance.getHeroFrontIcon(this.heroVo.heroItem.quality),this.img_hero.skin=this.heroVo.simgurl,this.tf_name.text=Me.shortHeroStr(this.heroVo.name);let e=this.heroVo.heroItem.level+"";ze.instance.setStar(this,e),this.box_show.visible=!0,this.img_back.visible=!0,this.img_noHero.visible=!1}else this.box_show.visible=!1,this.img_back.visible=!1,this.img_noHero.visible=!0}};Uv=h([yP("eequnT3KT7SdRQE-AcHqBw")],Uv);var Vv=class extends Laya.Box{};var{regClass:bP}=Laya,Fv=class extends Vv{constructor(){super();this.isAddEvent=!1}addEvent(){this.isAddEvent||(this.isAddEvent=!0)}set dataSource(e){super.dataSource=e,this.heroVo=e,this.heroVo&&(this.addEvent(),this.setCurrentOutPut())}async setCurrentOutPut(){this.heroSk.dataSource=this.heroVo,this.tf_name.text=Me.shortHeroStr(this.heroVo.name);let e=this.heroVo.heroItem.level+"";ze.instance.setStar(this,e)}};Fv=h([bP("IcuwbMwvRKqMyiXxDzW-dA")],Fv);var Gv=class extends Laya.Dialog{};var{regClass:gP}=Laya,Kv=class extends Gv{constructor(e){super();this.m_strName="我是OpenSceneRuntime";this.m_iLayerType=C.M_POP;this.m_iPositionType=C.CENTER}onEnable(){this.initContainer(),Xe.instance.playSoundByName(Xe.soundName32)}initContainer(){var e=ut.instance.getOneItem();e&&this.showItem(e)}showItem(e){let i=this.heroListItem;i.dataSource=e}onDisable(){g.intance.event(f.EVENT_CHECK_REMAIN,y.HeroGetDialog)}};Kv=h([gP("mrqJhWahTxuTjeSGIs559Q")],Kv);var qv=class extends Laya.Dialog{};var{regClass:LP}=Laya,Wv=class extends qv{constructor(e){super();this.m_strName="我是OpenSceneRuntime";this.m_iLayerType=C.M_POP;this.m_iPositionType=C.CENTER;this.rentalDto=null}onEnable(){this.btn_copy.on(Laya.Event.CLICK,this,this.onCopy),this.btn_cancel.on(Laya.Event.CLICK,this,this.onCancel),this.btn_modify.on(Laya.Event.CLICK,this,this.onModify)}async setOpenData(e){e&&(this.rentalDto=e),this.initContainer()}initContainer(){if(this.rentalDto){if(this.rentalHeroListItem.needPop=!0,this.rentalHeroListItem.dataSource=this.rentalDto,this.tf_name.text=this.rentalDto.hostPlayer.name+"",this.rentalDto.rentalType==1)this.tf_amount.text=m.instance.getUILang("FREE"),this.tf_period.text=m.instance.getLanguage(1659,this.rentalDto.minPeriod);else{var e=_.intance.m_dicItems.get(this.rentalDto.coinType),i=m.instance.getLanguage(e.name),a=xe.formatNumber(this.rentalDto.amount)+"",r=m.instance.getLanguage(1657,a,i);this.tf_amount.text=r,this.tf_period.text=m.instance.getLanguage(1658,this.rentalDto.minPeriod,this.rentalDto.maxPeriod)}this.tf_telegram.text="@"+this.rentalDto.hostPlayer.telegram}}onCopy(){let e=this.tf_telegram.text;doCopy(e),E.instance.notice(m.instance.getLanguage(132))}onModify(){A.intance.openModule(y.CreateRentalDialog,[this.rentalDto])}async onCancel(){try{var e=await v.requestPost("wxgame/hero/cancelRental",{rentId:this.rentalDto.id});e&&(E.instance.notice(m.instance.getLanguage(2e3)),this.close())}catch{}}};Wv=h([LP("1SOPEqweRfCcPk1cmtAm_w")],Wv);var Yv=class extends Laya.Dialog{};var zv=class n{constructor(){this.lastTime=0}static get instance(){return n._instance||(n._instance=new n),n._instance}async buyItemOnChain(t,e,i,a=void 0){var r=new Date().getTime();if(r-this.lastTime<1e3)return;this.lastTime=r;let s=t.coinType;var o=_.intance.getRentCurrency(s),l=o.chainId;de.instance.showLoadingByInfo(m.instance.getLanguage(1119));let c=o.rentNftAddress,u=F.instance.walletAddress,p=await F.instance.walletClient.getChainId();try{if(p!==l&&!await F.instance.switchChain(l)){this.onEndItemCallback(),console.log("===>> 切换失败，请手动切换");return}let Oe=o.token;if(!Oe){this.onEndItemCallback(),E.instance.notice(m.instance.getLanguage(1177,p));return}if(!c){this.onEndItemCallback(),E.instance.notice(m.instance.getLanguage(1174,p));return}var d=0,L=t.amount;let ce=new dt(L),ve=new dt(d),Te=ce.add(ve);var x=new dt(i);let N=Te.multiply(x);console.log("===>> 获取当前余额 tokenAddress: "+Oe+", chainIDData:"+l);let We=await F.instance.getBalance2(Oe),Ze=pi(N.getValue()+"",o.tokenDecimals);var w=o.token==0?Ze:pi("0",o.tokenDecimals);if(parseFloat(We)<parseFloat(Ze)){this.onEndItemCallback(),Le.moneyNotEnought(s);return}if(console.log("===>> 判断授权 tokenAddress: "+Oe+", chainIDData:"+l+", need:"+Ze+", have:"+We+", 转换后 need:"+Dt(Ze,o.tokenDecimals)+", have:"+Dt(We,o.tokenDecimals)),!await F.instance.newAllowanceAddress(c,Oe))return console.log("===>> 未授权"),this.onEndItemCallback(),E.instance.notice(m.instance.getLanguage(15)),de.instance.hideLoading(),!1;let ai=b.instance.playerDto.pid;var I={rentId:e.rentId,day:e.day,pwd:e.pwd,telegram:e.telegram,token:o.token,chainId:l};let Ft=await v.requestPost("wxgame/hero/buyRentChain",I).catch(St=>{console.log("===>> 检验失败"),this.onEndItemCallback(),de.instance.hideLoading()});if(!Ft)return!1;var M=Ft.sender,H=Ft.to,V=Ft.token,q=Ft.amount,X=Ft.orderId,Z=e.day,Q=Ft.deadline,ee=Ft.signature,ae=q==Ze;if(console.log("===>> 服务端: amount: "+q+", 客户端: need:"+Ze+", 是否一致:"+ae+", signature:"+ee),!ae||ee==""||X<=0)return E.instance.notice(m.instance.getLanguage(2001)),console.log("===>> 签名失败: 【amount不一致】 或者 【签名为空】 或者 【orderId是0】 orderId:"+X),this.onEndItemCallback(),de.instance.hideLoading(),!1;var Be=await F.instance.walletClient.writeContract({address:c,abi:J.rentNft_ABI,functionName:"rent",args:[M,H,V,q,X,Z,Q,ee],account:u,value:w});let Jt;return Jt=await F.instance.publicClient.waitForTransactionReceipt({hash:Be,pollingInterval:1e3}),console.log(`Tx with hash: ${Be}`,Jt),Jt&&Jt.status=="success"?(this.waitGetQuanReward(l,Be),console.log(`Tx successful with hash: ${Be}`),Be):(this.onEndItemCallback(),Le.TransactionErrorTip(),!1)}catch(Oe){this.onEndItemCallback();var we=Oe.shortMessage;if(we&&we.indexOf("does not match")!=-1){var $=F.instance.getChainName(l);we=m.instance.getLanguage(1172,$)}if(console.log(we),E.instance.notice(we),Oe instanceof K){let ce=Oe.walk(ve=>ve instanceof vt);if(ce instanceof vt){let ve=ce.data?.errorName??"";console.log("===>> ============errorName: "+ve)}}return null}}onEndItemCallback(t=null){de.instance.hideLoading(),t&&g.intance.event(f.EVENT_REFRESH_RENT_HERO_ONCHAIN_STATUS,[t])}waitGetQuanReward(t,e){this.chainId=t,this.hashId=e,Laya.timer.loop(2e3,this,this.getItemReward)}async getItemReward(){var t=3,e=await v.requestPost("paWallet/scanBuyBonusCheck",{type:t,chainId:this.chainId,hashId:this.hashId}).catch(a=>{}),i=e.status;e&&i>0&&(Laya.timer.clear(this,this.getItemReward),this.onEndItemCallback(1))}};var{regClass:_P}=Laya,jv=class extends Yv{constructor(e){super();this.m_strName="我是OpenSceneRuntime";this.m_iLayerType=C.M_POP;this.m_iPositionType=C.CENTER;this.rentalDto=null;this.currencyAddressItem=null;this.addL=1}onEnable(){this.btn_copy.on(Laya.Event.CLICK,this,this.onCopy),this.btn_plus.clickHandler=new Laya.Handler(this,this.handleClickBtn,[this.btn_plus]),this.btn_reduce.clickHandler=new Laya.Handler(this,this.handleClickBtn,[this.btn_reduce]),this.tf_num.on(Laya.Event.BLUR,this,this.changeItemNum),this.btn_rent.on(Laya.Event.CLICK,this,this.onBuyRent),g.intance.on(f.EVENT_REFRESH_RENT_HERO_ONCHAIN_STATUS,this,this.onRefreshRentStatus)}async setOpenData(e){e&&(this.rentalDto=e),this.initContainer()}initContainer(){if(this.rentalDto){if(this.rentalHeroListItem.needPop=!0,this.rentalHeroListItem.dataSource=this.rentalDto,this.tf_name.text=this.rentalDto.hostPlayer.name+"",this.rentalDto.rentalType==1)this.tf_amount.text=m.instance.getUILang("FREE"),this.tf_period.text=m.instance.getLanguage(1659,this.rentalDto.minPeriod);else{var e=_.intance.m_dicItems.get(this.rentalDto.coinType),i=m.instance.getLanguage(e.name),a=xe.formatNumber(this.rentalDto.amount)+"",r=m.instance.getLanguage(1657,a,i);this.tf_amount.text=r,this.tf_period.text=m.instance.getLanguage(1658,this.rentalDto.minPeriod,this.rentalDto.maxPeriod),this.currencyAddressItem=_.intance.getRentCurrency(this.rentalDto.coinType)}if(this.tf_telegram.text="@"+this.rentalDto.hostPlayer.telegram,this.rentalDto.clientPlayer?this.tf_clientAddress.text=this.rentalDto.clientPlayer.address:this.tf_clientAddress.text=F.instance.walletAddress,this.addL=this.rentalDto.minPeriod,this.setItemNum(),this.rentalDto.rentalType==1)this.box_count.disabled=!0,this.tf_days.text=m.instance.getUILang("Hours"),this.img_coinType.visible=!1;else{this.box_count.disabled=!1,this.tf_days.text=m.instance.getUILang("Hours");let o=this.rentalDto.coinType;this.img_coinType.skin=S.instance.getMoneyIcon(o),this.img_coinType.visible=!0}var s=b.instance.playerDto.telegram;s&&(this.input_telegram.text=s+"")}}onCopy(){let e=this.tf_telegram.text;doCopy(e),E.instance.notice(m.instance.getLanguage(132))}handleClickBtn(e){switch(e){case this.btn_reduce:this.addL>1&&this.addL--,this.onBtnchangeItemNum();break;case this.btn_plus:this.addL<99999&&this.addL++,this.onBtnchangeItemNum();break}}onBtnchangeItemNum(){console.log("changeItemNum");var e=this.addL;!e||e<this.rentalDto.minPeriod?e=this.rentalDto.minPeriod:(!e||e>this.rentalDto.maxPeriod)&&(e=this.rentalDto.maxPeriod),this.addL=e,this.setItemNum()}setItemNum(){this.tf_num.text=this.addL+"";let e=new dt(this.addL),i=new dt(this.rentalDto.amount);var a=.05,r=_.intance.m_dicHeroRent.get(2);this.currencyAddressItem?a=0:a=r.commission*.01;let s=new dt(1+a),o=e.multiply(i).multiply(s).getValue();this.rentalDto.rentalType==1?this.tf_needMoney.text=m.instance.getUILang("FREE"):this.tf_needMoney.text=`${o}`}changeItemNum(){console.log("changeItemNum");var e=parseInt(this.tf_num.text);!e||e<this.rentalDto.minPeriod?e=this.rentalDto.minPeriod:(!e||e>this.rentalDto.maxPeriod)&&(e=this.rentalDto.maxPeriod),this.addL=e,this.setItemNum()}async onBuyRent(){let e=this.input_telegram.text;if(e==""){E.instance.notice(m.instance.getLanguage(1672));return}let i=this.input_pwd.text;var a=0;this.rentalDto&&(a=this.rentalDto.id);var r={rentId:a,day:this.addL,pwd:i,telegram:e};if(this.currencyAddressItem){let o=Laya.Handler.create(this,this.onRefreshRentStatus);await zv.instance.buyItemOnChain(this.rentalDto,r,this.addL,o)}else try{var s=await v.requestPost("wxgame/hero/buyRent",r);s&&this.onRefreshRentStatus()}catch{}}onRefreshRentStatus(){E.instance.notice(m.instance.getLanguage(2e3)),this.close()}onDisable(){g.intance.off(f.EVENT_REFRESH_RENT_HERO_ONCHAIN_STATUS,this,this.onRefreshRentStatus)}};jv=h([_P("LmvdC_zJSDCFyZNK7p5Jhw")],jv);var $v=class extends Laya.Dialog{};var{regClass:vP}=Laya,Xv=class extends $v{constructor(e){super();this.m_strName="我是OpenSceneRuntime";this.m_iLayerType=C.M_POP;this.m_iPositionType=C.CENTER;this.rentalDto=null}onEnable(){this.btn_copy.on(Laya.Event.CLICK,this,this.onCopy),this.btn_clientCopy.on(Laya.Event.CLICK,this,this.onClientCopy)}async setOpenData(e){e&&(this.rentalDto=e),this.initContainer()}initContainer(){if(this.rentalDto){if(b.instance.playerDto.pid==this.rentalDto.hostPlayer.id?this.alertTitle.text=m.instance.getUILang("My leased NFT information"):this.rentalDto.clientPlayer&&b.instance.playerDto.pid==this.rentalDto.clientPlayer.id?this.alertTitle.text=m.instance.getUILang("My rented NFT information"):this.alertTitle.text=m.instance.getUILang("Rented NFT information"),this.rentalHeroListItem.needPop=!0,this.rentalHeroListItem.dataSource=this.rentalDto,this.tf_name.text=this.rentalDto.hostPlayer.name+"",this.rentalDto.rentalType==1)this.tf_amount.text=m.instance.getUILang("FREE"),this.tf_period.text=m.instance.getLanguage(1659,this.rentalDto.minPeriod);else{var e=_.intance.m_dicItems.get(this.rentalDto.coinType),i=m.instance.getLanguage(e.name),a=xe.formatNumber(this.rentalDto.amount)+"",r=m.instance.getLanguage(1657,a,i);this.tf_amount.text=r,this.tf_period.text=m.instance.getLanguage(1658,this.rentalDto.minPeriod,this.rentalDto.maxPeriod)}if(this.tf_telegram.text="@"+this.rentalDto.hostPlayer.telegram,this.rentalDto.clientPlayer){this.tf_clientName.text=this.rentalDto.clientPlayer.name,this.tf_clientTelegram.text="@"+this.rentalDto.clientPlayer.telegram,this.tf_clientAddress.text=this.rentalDto.clientPlayer.address;var s=se.formatTimeStamp(this.rentalDto.startTime,"YY-MT-DD HH:MM:SS")+" ~ "+se.formatTimeStamp(this.rentalDto.endTime,"YY-MT-DD HH:MM:SS");if(this.rentalDto.rentalType==1){var o=(this.rentalDto.endTime-this.rentalDto.startTime)/1e3/3600,l=Math.floor(o);this.tf_clientPeriod.text=s+`
(`+m.instance.getLanguage(1659,l)+")",this.tf_clientAmount.text=m.instance.getUILang("FREE"),this.img_coinType.visible=!1}else{var o=(this.rentalDto.endTime-this.rentalDto.startTime)/1e3/3600,l=Math.floor(o);this.tf_clientPeriod.text=s+`
(`+m.instance.getLanguage(1659,l)+")";var e=_.intance.m_dicItems.get(this.rentalDto.coinType),i=m.instance.getLanguage(e.name);this.tf_clientAmount.text=xe.formatNumberStr(this.rentalDto.totalAmount,8)+" "+i,this.img_coinType.visible=!1}var c=(this.rentalDto.endTime-b.instance.m_serverTime)/1e3;c<0&&(c=0),this.tf_clientRemain.text=se.formatWithDay(c)}}}onCopy(){let e=this.tf_telegram.text;doCopy(e),E.instance.notice(m.instance.getLanguage(132))}onClientCopy(){let e=this.tf_clientTelegram.text;doCopy(e),E.instance.notice(m.instance.getLanguage(132))}};Xv=h([vP("fu0MF2szTCSq2tJ6Bpd2Bg")],Xv);var go=class extends Laya.Box{};var{regClass:xP}=Laya,Qv=class extends go{constructor(){super();this.isAddEvent=!1}set dataSource(e){super.dataSource=e,this.shopItem=e,this.shopItem&&(this.addEvent(),this.setCurrentOutPut())}addEvent(){this.isAddEvent||(this.on(Laya.Event.CLICK,this,this.toDetail),this.isAddEvent=!0)}onDisable(){this.off(Laya.Event.CLICK,this,this.toDetail)}async setCurrentOutPut(){let e=this.BagItem.getChildByName("selectBox");e.visible=!1,this.BagItem.dataSource=this.shopItem}toDetail(){console.log(this.x),this.shopItem&&(this.shopItem.type===Ge.TYPE_Equipment||this.shopItem.type===Ge.TYPE_CARD)&&g.intance.event(f.SHOW_EQUIP_SHOP_TIP,{data:this.shopItem,positionX:this.x})}};Qv=h([xP("NeXqnO0GSzGqgAW6thqXMA")],Qv);var Jv=class extends Laya.Box{};var{regClass:IP}=Laya,Zv=class extends Jv{constructor(){super(...arguments);this.isAddEvent=!1;this.needPop=!1}addEvent(){this.isAddEvent||(this.isAddEvent=!0,this.on(Laya.Event.CLICK,this,this.toDetail))}set dataSource(e){super.dataSource=e,this.rentalDto=e,this.rentalDto&&(this.needPop&&this.addEvent(),this.setCurrentOutPut())}setCurrentOutPut(){this.rentalDto.status==0?(this.img_jiaobiao.visible=!0,this.img_jiaobiao.skin="res/shop/img_com_weizu.png",this.tf_status.text=m.instance.getUILang("For rent")):this.rentalDto.status==1?(this.img_jiaobiao.visible=!0,this.img_jiaobiao.skin="res/shop/img_com_yizu.png",this.tf_status.text=m.instance.getUILang("Rented")):this.img_jiaobiao.visible=!1,this.rentalDto&&(this.heroVo=new Ht,ze.instance.setHeroVoByHeroDto(this.heroVo,this.rentalDto.heroDto),this.heroListItem.needPop=!1,this.heroListItem.dataSource=this.heroVo),this.rentalDto.hostPlayer&&(this.hostPid=this.rentalDto.hostPlayer.id),this.rentalDto.clientPlayer&&(this.clientPid=this.rentalDto.clientPlayer.id)}toDetail(){this.heroVo.id&&(console.log("this.hostPid: ",this.hostPid,"this.clientPid: ",this.clientPid),A.intance.openModule(y.HeroDetailDialog,[this.heroVo,this.hostPid,this.clientPid]))}};Zv=h([IP("O6PE6cUjT7yJadU6VROKcg")],Zv);var ex=class extends Laya.Box{};var{regClass:EP}=Laya,tx=class extends ex{constructor(){super();this.isAddEvent=!1;this.needPop=!0}addEvent(){this.isAddEvent||(this.on(Laya.Event.CLICK,this,this.toDetail),this.isAddEvent=!0)}set dataSource(e){super.dataSource=e,this.rentalDto=e,this.rentalDto&&(this.needPop&&this.addEvent(),this.setRentalData())}setRentalData(){if(this.img_my.visible=b.instance.playerDto.pid==this.rentalDto.hostPlayer.id,this.img_lock.visible=this.rentalDto.pwd,this.rentalDto.rentalType==2){this.tf_free.visible=!0;var e=_.intance.m_dicItems.get(this.rentalDto.coinType),i=m.instance.getLanguage(e.name),a=xe.formatNumber(this.rentalDto.amount)+"",r=m.instance.getLanguage(1657,a,i);this.tf_free.text=r;var s=_.intance.getRentCurrency(this.rentalDto.coinType);this.tf_free.color=s?"#fdd378":"#ffffff",this.tf_period.text=m.instance.getLanguage(1658,this.rentalDto.minPeriod,this.rentalDto.maxPeriod)}else this.tf_free.color="#ffffff",this.tf_free.visible=!0,this.tf_free.text=m.instance.getUILang("FREE"),this.tf_period.text=m.instance.getLanguage(1659,this.rentalDto.minPeriod);this.rentalHeroListItem.dataSource=this.rentalDto}toDetail(){var e=this.parent.parent.parent.parent.parent,i=e.nftTabIndex;console.log("nftTabIndex: "+i),this.rentalDto.status==1?A.intance.openModule(y.MyRentedDialog,this.rentalDto):i==4?A.intance.openModule(y.MyLeasedDialog,this.rentalDto):this.rentalDto.status==0&&(b.instance.playerDto.pid==this.rentalDto.hostPlayer.id?A.intance.openModule(y.MyLeasedDialog,this.rentalDto):A.intance.openModule(y.MyRentalBuyDialog,this.rentalDto))}};tx=h([EP("B3yEIK7uQ02c8r0diwvrqg")],tx);var ix=class extends Laya.Box{};var{regClass:wP}=Laya,ax=class extends ix{constructor(){super();this.isAddEvent=!1}set dataSource(e){super.dataSource=e,this.shopItem=e,this.shopItem&&this.setCurrentOutPut()}async setCurrentOutPut(){if(this.tf_name.text=m.instance.getLanguage(this.shopItem.title),this.img_liked.visible=!1,this.img_red_shields_1.visible=!1,this.shopItem.cost.length>1){this.img_const.skin=S.instance.getMoneyIcon(this.shopItem.cost[0]);var e=0;this.shopItem.commission&&this.shopItem.commission.length>1&&(e=this.shopItem.commission[1]);var i=this.shopItem.cost[1];let l=i+e;var a=xe.formatNumber(l);this.tf_const.text=a+"",this.tf_const.color=this.shopItem.chainType>0?"#fdd378":"#ffffff",this.img_const.visible=!0,this.tf_const.visible=!0,this.img_ask.visible=!1,this.shopItem.type==5?this.gray=!1:this.gray=this.shopItem.open==0,this.disabled=!1}else this.disabled=!0,this.img_const.visible=!1,this.tf_const.visible=!1,this.img_ask.visible=!1;if(this.shopItem.type==1)this.tf_name.color=Ct.qualityColors[parseInt(this.shopItem.icon)-1],this.img_bg.skin=S.instance.getHeroQuality(this.shopItem.icon),this.img_icon.skin=S.instance.getHeroEggIcon(this.shopItem.icon);else if(this.shopItem.type==4)this.tf_name.color=Ct.qualityColors[parseInt(this.shopItem.icon)-1],this.img_bg.skin=S.instance.getHeroQuality(this.shopItem.icon),this.img_icon.skin=S.instance.getChestIcon(this.shopItem.icon);else if(this.shopItem.type==5)if(this.shopItem.icon){var r=_.intance.m_dicItems.get(this.shopItem.icon);this.img_bg.skin=S.instance.getHeroQuality(r.quality+""),this.tf_name.color=Ct.qualityColors[r.quality-1],this.img_icon.skin=S.instance.getItemIcon(this.shopItem.icon),this.img_red_shields_1.visible=!1,this.img_liked.visible=!1;var s=this.shopItem.currLike>=this.shopItem.totalLike;this.tf_const.visible=!0}else{var o=6;this.img_bg.skin=S.instance.getHeroQuality(o+""),this.tf_name.color=Ct.qualityColors[o-1],this.img_icon.skin="res/shop/img_com_tub.png"}}};ax=h([wP("awS07ko0RBaxCnxXWqiR4g")],ax);var{regClass:TP}=Laya,nx=class extends go{constructor(){super();this.isAddEvent=!1}set dataSource(e){super.dataSource=e,this.shopItem=e,this.shopItem&&(this.addEvent(),this.setCurrentOutPut())}addEvent(){this.isAddEvent||(this.on(Laya.Event.CLICK,this,this.buyTicket),this.isAddEvent=!0)}async setCurrentOutPut(){this.tf_name.text=m.instance.getLanguage(this.shopItem.title),this.img_const.skin=S.instance.getMoneyIcon(this.shopItem.cost[0]);var e=0;this.shopItem.commission&&this.shopItem.commission.length>1&&(e=this.shopItem.commission[1]);var i=this.shopItem.cost[1];let a=i+e;var r=xe.formatNumber(a);if(this.tf_const.text=r+"",this.tf_const.color=this.shopItem.chainType>0?"#fdd378":"#ffffff",this.shopItem.type==2){var s=_.intance.m_dicItems.get(this.shopItem.icon);this.img_bg.skin=S.instance.getItemQualityIcon(s.quality+""),this.tf_name.color=Ct.qualityColors[s.quality-1],this.img_icon.skin=S.instance.getItemIcon(this.shopItem.icon)}}buyTicket(){A.intance.openModule(y.BuyTicketDialog,[this.shopItem])}};nx=h([TP("din69PYeRbSapMB2H6E06g")],nx);var rx=class extends Laya.Scene{};var{regClass:CP}=Laya,sx=class extends rx{constructor(){super(...arguments);this.currTab=0;this.type=1;this.selectItemId=-1;this.oid=1;this.addL=1;this.price=0;this.isSkReady=!1;this.nftType=1;this.nftTabIndex=1;this.coinTypes=[];this.coinDatas=[]}onAwake(){this.m_iLayerType=C.M_POP,this.m_iPositionType=C.UP}onOpened(e){e&&e.length>0&&(this.type=e[0],e[1]!=null&&(this.selectItemId=e[1]),this.onClickTab(this.type))}onEnable(){g.intance.on(f.SHOW_EQUIP_SHOP_TIP,this,this.showEquipTip),g.intance.on(f.EVENT_HERO_DRAW_BACK,this,this.onDrawBack),g.intance.on(f.EVENT_END_HEROBUY,this,this.onWaitHeroInfoBack),g.intance.on(f.EVENT_CHECK_ICON_SELECT,this,this.onCoinSelected);for(let i=0;i<6;i++)this["tab"+i].on(Laya.Event.CLICK,this,this.onTabClick,[i]);for(let i=1;i<5;i++)this["tab_nft_"+i].on(Laya.Event.CLICK,this,this.onNftTabClick,[i]);this.btn_help.on(Laya.Event.CLICK,this,this.onHelp),this.tf_num.on(Laya.Event.BLUR,this,this.setItemNum),this.btn_recruit.on(Laya.Event.CLICK,this,this.onRecruit),this.btn_like.on(Laya.Event.CLICK,this,this.onLike),this.img_icon.on(Laya.Event.CLICK,this,this.onShowImg),this.btn_reduce.clickHandler=new Laya.Handler(this,this.handleClickBtn,[this.btn_reduce]),this.btn_plus.clickHandler=new Laya.Handler(this,this.handleClickBtn,[this.btn_plus]),this.btn_offers.on(Laya.Event.CLICK,this,this.onOffer),this.btn_create.on(Laya.Event.CLICK,this,this.onCreateRental);for(let i=1;i<7;i++)this["btn_"+i].on(Laya.Event.CLICK,this,this.onClickTab,[i]);this.btn_back&&this.btn_back.on(Laya.Event.CLICK,this,this.setToMainScene),this.listPanel1.vScrollBarSkin="",this.listPanel1.selectHandler=Laya.Handler.create(this,this.onSelectItem,[],!1),this.listPanel2.vScrollBarSkin="",this.listPanel2.selectHandler=Laya.Handler.create(this,this.onSelectItem,[],!1),this.img_sk.on(Laya.Event.PLAYED,this,this.stopAni,[2]),this.box_2.visible=!1,this.initLuckDrawView();let e=(Laya.stage.height-z.DESIGN_HEIGHT)/2;Laya.timer.loop(1e3,this,this.refreshRedDot),this.img_red_offer.visible=b.instance.getRedDotById(he.ROOM_OFFER_CARD)}async onRecruit(){if(this.shopItem.type==1){if(this.shopItem.open==0){E.instance.notice(m.instance.getLanguage(12));return}z.Debug==2?(this.setChou1Ani("animation"+this.shopItem.icon+"_1"),await Et.instance.recruit1(this.shopItem.id)):E.instance.notice(m.instance.getLanguage(12))}else{if(this.shopItem.open==0){E.instance.notice(m.instance.getLanguage(12));return}this.shopItem.type==5?A.intance.openModule(y.BuyTicketDialog,[this.shopItem]):await bo.instance.recruitItem(this.shopItem,this.shopItem.id,this.addL)}}onWaitHeroInfoBack(){this.setChou2Ani("animation"+this.shopItem.icon+"_2"),de.instance.hideLoading()}setTab(e){for(let i=1;i<7;i++)e==i?(this["btn_"+i].getChildByName("selectBox").visible=!0,this["btn_"+i].getChildByName("tf_txt").color="#143f6b",this["btn_"+i].getChildByName("img_tab_icon").skin="res/shop/img_shop_"+i+"_s.png"):(this["btn_"+i].getChildByName("selectBox").visible=!1,this["btn_"+i].getChildByName("tf_txt").color="#7ff1fe",this["btn_"+i].getChildByName("img_tab_icon").skin="res/shop/img_shop_"+i+".png")}async initLuckDrawView(){this.destroyed||(this.type?this.onClickTab(this.type):this.onClickTab(1))}async onClickTab(e){if(this.currTab!=e){if(this.setTab(e),this.box_2.visible=!0,this.btn_help.visible=!1,Laya.timer.clear(this,this.getRoomByType),e==1){this.box_6.visible=!1;var i=this.getItemByType(1);this.shopItems=i[0],this.listPanel1.array=this.shopItems,this.listPanel1.selectedIndex=-1,this.listPanel1.selectedIndex=i[1],this.listPanel1.visible=!0,this.listPanel2.visible=!1,this.listPanel3.visible=!1,this.box_middle.visible=!0,this.box_offers.visible=!1,this.listPanel4.visible=!1}else if(e==2)this.box_6.visible=!1,this.selectItemId==-1?this.onTabClick(5):this.selectItemId==5?this.onTabClick(this.selectItemId):this.onTabClick(0),this.listPanel3.visible=!0,this.listPanel2.visible=!1,this.listPanel1.visible=!1,this.box_middle.visible=!1,this.box_offers.visible=!1,this.listPanel4.visible=!1;else if(e==3){this.box_6.visible=!1;var i=this.getItemByType(4);this.shopItems=i[0],this.listPanel1.dataSource=this.shopItems,this.listPanel1.selectedIndex=-1,this.listPanel1.selectedIndex=i[1],this.listPanel1.visible=!0,this.listPanel3.visible=!1,this.listPanel2.visible=!1,this.box_middle.visible=!0,this.box_offers.visible=!1,this.listPanel4.visible=!1}else if(e==4){this.box_6.visible=!1,this.btn_help.visible=!1,await this.getLikeInfo();var i=this.getItemByType(5);this.shopItems=i[0],this.listPanel1.dataSource=this.shopItems,this.listPanel1.selectedIndex=-1,this.listPanel1.selectedIndex=i[1],this.listPanel1.visible=!0,this.listPanel2.visible=!1,this.box_middle.visible=!0,this.listPanel3.visible=!1,this.box_offers.visible=!1,this.listPanel4.visible=!1}else e==5?(this.box_6.visible=!1,this.showOffer(),this.listPanel1.visible=!1,this.listPanel2.visible=!1,this.box_middle.visible=!1,this.listPanel3.visible=!1,this.box_offers.visible=!0,this.listPanel4.selectedIndex=-1):e==6&&(this.list_hero.array=null,this.initCoinCombo(),this.onNftTabClick(1),this.listPanel3.visible=!1,this.listPanel2.visible=!1,this.listPanel1.visible=!1,this.box_middle.visible=!1,this.box_offers.visible=!1,this.listPanel4.visible=!1,this.box_6.visible=!0);this.tabBox.visible=this.listPanel3.visible}}async showOffer(){let e=await v.requestPost("wxgame/offers/getInfo",{});if(e&&e.itemList){this.oid=e.oid,console.log(e);let r=e.itemList;var i=[];for(let s=0;s<r.length;s++){let o;if(r[s]instanceof Array){o=new xt,o.id=r[s][0],o.count=r[s][1];var a=new Ne(o.id);a.newAddCnt=o.count,i.push(a)}}this.listPanel4.array=i,this.listPanel4.visible=!0,this.btn_offers.disabled=!e.receive,e.receive?this.btn_offers.label="claim with one click":this.btn_offers.label="Claimed"}}async getLikeInfo(){this.likeDic=new le,this.likedDic=new le;let e=await v.requestPost("wxgame/dun/info",{});var i=e.itemInfo,a=e.star;i&&i.forEach(r=>{this.likeDic.set(r[0],r)}),a&&a.forEach(r=>{this.likedDic.set(r,!0)})}async onLike(){let e=await v.requestPost("wxgame/dun/star",{id:this.shopItem.id});if(e){var i=e.id,a=e.star;this.likeDic.set(i,[i,a]),this.likedDic.set(i,!0),this.selectItemId=parseInt(this.shopItem.icon);var r=this.getItemByType(5);this.shopItems=r[0],this.listPanel1.dataSource=this.shopItems,this.listPanel1.selectedIndex=-1,this.listPanel1.selectedIndex=r[1],this.listPanel1.visible=!0,this.listPanel2.visible=!1,this.listPanel4.visible=!1,E.instance.notice(m.instance.getLanguage(2e3))}}getItemByType(e,i=3){var a=_.intance.m_dicShops.values,r=[],s=-1,o=0;return a.forEach(l=>{if(l.type==e){if(e==5){var c=this.likeDic.get(l.id),u=this.likedDic.get(l.id);if(c){var p=c[1];l.currLike=p||0,l.liked=!!u}else l.currLike=0,l.liked=!1}if(e==2&&i!==1){var d=_.intance.m_dicItems.get(l.icon);d.quality==i&&r.push(l)}else r.push(l);this.selectItemId!=-1&&parseInt(l.icon)==this.selectItemId&&(s=o,this.selectItemId=-1),o++}}),s==-1&&r.length>0&&(s=0),[r,s]}onSelectItem(e){if(this.shopItem=this.shopItems[e],console.log(this.shopItem),this.shopItem){if(this.tf_name.text=m.instance.getLanguage(this.shopItem.title),this.tf_des.text=m.instance.getLanguage(this.shopItem.des),this.shopItem.cost.length>1){this.img_const.skin=S.instance.getMoneyIcon(this.shopItem.cost[0]),this.addL=1;var i=0;this.shopItem.commission&&this.shopItem.commission.length>1&&(i=this.shopItem.commission[1]);var a=this.shopItem.cost[1];let o=a+i;this.price=xe.formatNumber(o)}else if(this.shopItem.open==0){E.instance.notice(m.instance.getLanguage(12));return}this.setPriceByNum();var r=this.shopItem.type;if(this.btn_recruit.disabled=!1,this.btn_recruit.visible=!1,this.btn_like.visible=!1,this.img_liked.visible=!1,this.img_const.visible=!1,this.tf_const.visible=!1,this.img_ask.visible=!1,r==1)this.btn_recruit.visible=!0,this.img_const.visible=!0,this.tf_const.visible=!0,z.Debug<2&&(this.btn_recruit.disabled=!0),this.img_icon.visible=!1,this.img_sk.visible=!0,this.setIdleAni("animation"+this.shopItem.icon+"_0"),this.box_count.visible=!1;else if(r==2)this.btn_recruit.visible=!0,this.img_const.visible=!0,this.tf_const.visible=!0,this.img_icon.skin=S.instance.getItemBigIcon(this.shopItem.icon),this.img_icon.y=60,this.img_icon.visible=!0,this.img_sk.visible=!1,this.box_count.visible=!0;else if(r==4)this.btn_recruit.visible=!0,this.img_const.visible=!0,this.tf_const.visible=!0,this.img_icon.skin=S.instance.getChestBigIcon(this.shopItem.icon),this.img_icon.y=110,this.img_icon.visible=!0,this.img_sk.visible=!1,this.box_count.visible=!1;else if(r==5){this.btn_recruit.visible=!0,this.img_const.visible=!0;var s=this.shopItem.currLike<this.shopItem.totalLike||this.shopItem.open==0;this.tf_const.visible=!0,this.img_ask.visible=!1,this.btn_recruit.gray=!1,this.btn_like.visible=!1,this.img_liked.visible=!1,this.img_red_shields_1.visible=!this.shopItem.liked,this.tf_like.text=this.shopItem.currLike+"/"+this.shopItem.totalLike,this.img_icon.skin=S.instance.getItemBigIcon(this.shopItem.icon),this.img_icon.y=80,this.img_icon.visible=!0,this.img_sk.visible=!1,this.box_count.visible=!1}}else this.tf_name.text="",this.tf_des.text="",this.img_icon.visible=!1,this.img_sk.visible=!1,this.box_count.visible=!1,this.btn_recruit.visible=!1}setItemNum(){var e=parseInt(this.tf_num.text);(!e||e<1)&&(e=1),this.addL=e,this.setPriceByNum()}handleClickBtn(e){switch(e){case this.btn_reduce:this.addL>1&&this.addL--,this.setPriceByNum();break;case this.btn_plus:this.addL<99999&&this.addL++,this.setPriceByNum();break}}setPriceByNum(){this.tf_num.text=this.addL+"",this.tf_const.text=xe.filterNumFormat(this.addL*this.price,8,!0)}onShowImg(){if(this.shopItem){var e=this.shopItem.type;if(e==5){var i=S.instance.getItemBigBigIcon(this.shopItem.icon);A.intance.openModule(y.ImgDialog,i)}}}setToMainScene(){oe.intance.setCurrentScene(Y.M_SCENE_MAIN)}stopAni(e){console.log("stopAni: "+e),this.isSkReady||(this.isSkReady=!0,this.callLater(this.stopSk))}stopSk(){this.img_sk.paused(),this.img_sk.stop()}setIdleAni(e){this.isSkReady?(this.img_sk.play(e,!1),this.img_sk.stop()):this.img_sk.animationName=e}setChou1Ani(e){this.isSkReady?this.img_sk.play(e,!0):this.img_sk.animationName=e}setChou2Ani(e){this.isSkReady?this.img_sk.play(e,!1):this.img_sk.animationName=e,Laya.timer.once(800,this,this.openHeroGetView)}openHeroGetView(){ut.instance.autoPop=!0,Li.instance.startShow(),this.setIdleAni("animation"+this.shopItem.icon+"_0")}onDrawBack(e){}refreshRedDot(){this.img_red_shields.visible=b.instance.getRedDotById(he.RED_SHIELDS),this.img_red_6.visible=b.instance.getRedDotById(he.RED_RENTAL)}onHelp(){if(this.shopItem){var e=_.intance.m_dicLikeIt.get(this.shopItem.id),i;e&&(i=e.sign);var a=m.instance.getLanguage(1532),r=m.instance.getLanguage(i);A.intance.openModule(y.HelpDialog,[2,a,r])}}startAni(){this.img_sk.paused(),this.img_sk.play(0,!1)}removeEvent(){Laya.timer.clearAll(this),g.intance.off(f.EVENT_HERO_DRAW_BACK,this,this.onDrawBack),g.intance.off(f.EVENT_END_HEROBUY,this,this.onWaitHeroInfoBack),g.intance.off(f.SHOW_EQUIP_SHOP_TIP,this,this.showEquipTip),g.intance.off(f.EVENT_CHECK_ICON_SELECT,this,this.onCoinSelected)}onTabClick(e){for(let i=0;i<6;i++)e==i?(this["tab"+i].skin="res/shop/img_com_tab_1.png",this["tab"+i].getChildByName("tf_tit").color="#143268",this.getTicketDataByIndex(e+1)):(this["tab"+i].skin="",this["tab"+i].getChildByName("tf_tit").color="#79c7fe")}getTicketDataByIndex(e){var i=this.getItemByType(2,e);this.shopItems=i[0],this.listPanel3.dataSource=this.shopItems,this.listPanel3.selectedIndex=-1,this.listPanel3.selectedIndex=i[1],this.listPanel3.scrollTo(i[1])}async onOffer(){let e=await v.requestPost("wxgame/offers/receive",{oid:this.oid});if(e){if(e.reward.length>0){let i=e.reward,a=[];i.forEach(r=>{var s=new xt;s.id=r.id,s.count=r.count,a.push(s)}),A.intance.openModule(y.RewardGetDialog,a)}this.img_red_offer.visible=!1,this.btn_offers.disabled=!e.receive,e.receive?this.btn_offers.label="claim with one click":this.btn_offers.label="Claimed"}}showEquipTip(e){let i=e.data;this.EquipDetailBox.dataSource=i,e.positionX<418?this.EquipDetailBox.x=e.positionX+200:this.EquipDetailBox.x=e.positionX-460,this.EquipDetailBox.visible=!0,this.equipBgBox.visible=!0,this.equipBgBox.on(Laya.Event.CLICK,this,this.hideTips)}hideTips(){this.EquipDetailBox.visible=!1,this.equipBgBox.visible=!1,this.equipBgBox.off(Laya.Event.CLICK,this,this.hideTips)}onNftTabClick(e){this.list_hero.array=null;for(let i=1;i<5;i++)e==i?(this["tab_nft_"+i].skin="res/shop/img_com_tab (2).png",this["tab_nft_"+i].getChildByName("tf_tit").color="#ffffff",this.getNftDataByIndex(e)):(this["tab_nft_"+i].skin="",this["tab_nft_"+i].getChildByName("tf_tit").color="#84ccff");e==1?this.list_nft_coin.visible=!1:this.list_nft_coin.visible=!1}getNftDataByIndex(e){if(this.btn_create.visible=e==4,this.nftTabIndex=e,e==1){this.nftType=2;var i=this.getRoomByType()}else if(e==2){this.nftType=1;var i=this.getRoomByType()}else if(e==3)var i=this.getRoomByType();else if(e==4)var i=this.getRoomByType();Laya.timer.loop(3e3,this,this.getRoomByType)}showCoinCombo(){this.nftTabIndex==1?this.list_nft_coin.visible=!1:this.list_nft_coin.visible=!1}initCoinCombo(){this.showCoinCombo();var e=_.intance.m_dicHeroRent.get(1),i=e.enable;i||(this.box_tab_3.x=this.tab_nft_2.x,this.tab_nft_2.visible=!1),this.coinTypes=[];var a=_.intance.m_dicHeroRent.get(2),r=a.rentToken;this.coinDatas=[],r.forEach(s=>{this.coinTypes.push(s);var o=_.intance.m_dicItems.get(s);this.coinDatas.push([s,!0,m.instance.getLanguage(o.name)])}),this.list_nft_coin.array=this.coinDatas}onCoinSelected(){this.coinTypes=[],this.coinDatas.forEach(e=>{e[1]&&this.coinTypes.push(e[0])}),console.log("您选中了 coinType"+this.coinTypes),this.getRoomByType()}async getRoomByType(){let e;if(this.nftTabIndex==3){if(e=await v.requestPost("wxgame/hero/myRented",{}),this.destroyed)return}else if(this.nftTabIndex==4){if(e=await v.requestPost("wxgame/hero/myRentedLeased",{}),this.destroyed)return}else if(e=await v.requestPost("wxgame/hero/rentalMarket",{type:this.nftType,coinTypeList:this.coinTypes}),this.destroyed)return;this.list_hero.array=e.list,this.list_hero.array.length>0?this.noDataBox.visible=!1:this.noDataBox.visible=!0}onCreateRental(){A.intance.openModule(y.CreateRentalDialog,[])}onDisable(){Laya.timer.clear(this,this.getRoomByType)}};sx=h([CP("IPCUkD5kRse3Gz5tw0Aovw")],sx);var ox=class extends Laya.Dialog{};var{regClass:SP}=Laya,lx=class extends ox{constructor(e){super();this.m_strName="我是OpenSceneRuntime";this.m_iLayerType=C.M_POP;this.m_iPositionType=C.CENTER}onEnable(){this.list_head.vScrollBarSkin="",this.btn_confirm.on(Laya.Event.CLICK,this,this.onRegister),this.initContainer()}initContainer(){this.list_head.vScrollBarSkin="",this.list_head.selectHandler=new Laya.Handler(this,this.handleSelectHead),this.createHeadList()}handleSelectHead(e){if(e!=-1){let i=this.list_head.selectedItem.id;b.instance.guildIcon=i,this.unionIcon.headSkin=b.instance.guildIcon}}createHeadList(){let e=_.intance.m_dicIconBadge;this.list_head.array=e.values,this.list_head.visible=!0;let i=-1,a=0;this.unionIcon.headSkin=b.instance.guildIcon;for(let r of e.values){if(r.id==b.instance.guildIcon){i=a;break}a++}this.list_head.selectedIndex=i}onRegister(){let e=b.instance.guildIcon;g.intance.event(f.EVENT_MODIFY_HEAD,[e]),this.close()}};lx=h([SP("VhAfw9RDSVu06yGY3eOJbg")],lx);var cx=class extends Laya.Dialog{};var{regClass:DP}=Laya,ux=class extends cx{constructor(){super(...arguments);this.m_strName="我是OpenSceneRuntime";this.m_iLayerType=C.M_PANEL;this.m_iPositionType=C.CENTER}onEnable(){g.intance.on(f.EVENT_MODIFY_HEAD,this,this.onChangeModifyHead),this.btn_back.on(Laya.Event.CLICK,this,this.onBack),this.btn_change.on(Laya.Event.CLICK,this,this.onChangeHead),this.btn_apply.on(Laya.Event.CLICK,this,this.onApply)}setOpenData(e){if(console.log("setOpenData: ",e),e){var i=e[0];this.onSetUnionInfo(i),this.subUnionDto=e[1],this.onSetSubUnionInfo(this.subUnionDto)}}onBack(){this.close()}onSetUnionInfo(e){e&&(this.tf_guildName.text=m.instance.getMultiLan(e.unionName)),this.tf_heroNum.text=b.instance.m_heroData.getCount()+"",this.tf_address.text=Me.formatWalletAddress(F.instance.walletAddress)}onSetSubUnionInfo(e){if(this.subUnionDto){this.input_name.text=m.instance.getMultiLan(e.unionName),this.textArea_des.text=m.instance.getMultiLan(e.desc),this.input_address.text=e.collectionToken,this.unionIcon.headSkin=e.icon;var i=e.status;this.onSetState(i)}else this.unionIcon.headSkin=b.instance.guildIcon,this.onSetState(0)}onSetState(e){e==1?(this.img_underReview.visible=!0,this.img_notPassed.visible=!1,this.btn_apply.visible=!1):e==2?(this.img_underReview.visible=!1,this.img_notPassed.visible=!0,this.btn_apply.visible=!0):(this.img_underReview.visible=!1,this.img_notPassed.visible=!1,this.btn_apply.visible=!0)}onChangeModifyHead(e){b.instance.guildIcon=e,this.unionIcon.headSkin=e}onChangeHead(){A.intance.openModule(y.ChangeUnionIconDialog)}async onApply(){let e=this.input_name.text,i=this.textArea_des.text,a=this.input_address.text;if(e=e.trim(),!b.instance.guildIcon){E.instance.notice(m.instance.getLanguage(1189));return}if(e==""){E.instance.notice(m.instance.getLanguage(31));return}if(i==""){E.instance.notice(m.instance.getLanguage(1190));return}if(a==""){E.instance.notice(m.instance.getLanguage(1191));return}let r={icon:b.instance.guildIcon,name:e,intro:i,recAddress:a};var s=await v.requestPost("wxgame/union/create",r);if(s&&s.unionBaseDto){var o=s.unionBaseDto.status;this.onSetState(o),E.instance.notice(m.instance.getLanguage(1192)),g.intance.event(f.EVENT_SUB_GUILD_UPDATE)}}onDisable(){this.removeEvent()}removeEvent(){g.intance.off(f.EVENT_MODIFY_HEAD,this,this.onChangeModifyHead)}};ux=h([DP("K1XqPbcNQUGnysSD4yhBLQ")],ux);var mx=class extends Laya.Dialog{};var{regClass:AP}=Laya,px=class extends mx{constructor(){super(...arguments);this.m_strName="我是OpenSceneRuntime";this.m_iLayerType=C.M_PANEL;this.m_iPositionType=C.CENTER}onEnable(){this.btn_memberList.on(Laya.Event.CLICK,this,this.onShowMemberList),this.btn_back.on(Laya.Event.CLICK,this,this.onBack),this.btn_applicationList.on(Laya.Event.CLICK,this,this.onShowApplicationList),this.btn_referral.on(Laya.Event.CLICK,this,this.onShowReferralList),this.refreshApplyBtnRed(),Laya.timer.loop(1e3,this,this.refreshApplyBtnRed)}setOpenData(e){if(console.log("setOpenData: ",e),e){var i=e[0];this.onSetUnionInfo(i),this.subUnionDto=e[1],this.onSetSubUnionInfo(this.subUnionDto)}}onShowApplicationList(){A.intance.openModule(y.UnionMemberApplyView,this.subUnionDto.id)}onShowReferralList(){A.intance.openModule(y.UnionReferralView,this.subUnionDto.id)}onBack(){this.close()}onShowMemberList(){this.subUnionDto&&A.intance.openModule(y.UnionMemberView,[this.subUnionDto,!0])}onSetUnionInfo(e){e&&(this.tf_guildName.text=m.instance.getMultiLan(e.unionName)),this.tf_heroNum.text=b.instance.m_heroData.getCount()+"",this.tf_address.text=Me.formatWalletAddress(F.instance.walletAddress)}refreshApplyBtnRed(){this.img_red_1.visible=b.instance.getRedDotById(he.RED_GUILD_APPLY)}onSetSubUnionInfo(e){e?(this.unionIcon.dataSource=e,this.tf_name.text=m.instance.getMultiLan(e.unionName),this.tf_des.text=m.instance.getMultiLan(e.desc),this.tf_lv.text=m.instance.getUILang("LV.")+e.lv,this.tf_num.text="<font color='#25ff63'>"+e.memberNum+"</font>/"+e.maxMemberNum,this.img_lvIcon.skin=S.instance.getUnionLvIcon(e.lv),this.box_show.visible=!0,this.tf_receiveAddress.text=Me.formatWalletAddress(e.collectionToken),this.btn_applicationList.visible=e.leader==b.instance.playerDto.pid,this.btn_referral.visible=e.leader==b.instance.playerDto.pid):this.box_show.visible=!1}onDisable(){Laya.timer.clearAll(this)}};px=h([AP("qhJFEWQoRbixaYt5MGd9TQ")],px);var hx=class extends Laya.Scene{};var{regClass:kP}=Laya,dx=class extends hx{constructor(){super(...arguments);this.currTab=0;this.currUnionId=1;this.createStatus=0}onAwake(){this.m_iLayerType=C.M_POP,this.m_iPositionType=C.UP}onOpened(e){this.box_show.visible=!1,this.currUnionId=e,this.initLuckDrawView()}onEnable(){g.intance.on(f.EVENT_SUB_GUILD_UPDATE,this,this.initSubGuild),this.btn_back&&this.btn_back.on(Laya.Event.CLICK,this,this.setToMainScene),this.btn_apply.on(Laya.Event.CLICK,this,this.onApply),this.btn_memberList.on(Laya.Event.CLICK,this,this.onShowMemberList),this.btn_guildList.on(Laya.Event.CLICK,this,this.onShowGuildList),this.btn_applicationList.on(Laya.Event.CLICK,this,this.onShowApplicationList),this.btn_referral.on(Laya.Event.CLICK,this,this.onShowReferralList),Laya.timer.loop(1e3,this,this.refreshApplyBtnRed)}refreshApplyBtnRed(){!this.btn_apply.disabled&&this.tf_createSub.text==m.instance.getUILang("My Guild")?this.img_red_1.visible=b.instance.getRedDotById(he.RED_GUILD_APPLY):this.img_red_1.visible=!1,this.btn_applicationList.disabled?this.img_red_2.visible=!1:this.img_red_2.visible=b.instance.getRedDotById(he.RED_GUILD_APPLY)}setToMainScene(){oe.intance.setCurrentScene(Y.M_SCENE_MAIN)}onApply(){this.createStatus==2?this.subUnionDto.status==0?A.intance.openModule(y.MySubUnionView,[this.unionDto,this.subUnionDto]):A.intance.openModule(y.CreateSubUnionView,[this.unionDto,this.subUnionDto]):A.intance.openModule(y.CreateSubUnionView,[this.unionDto,this.subUnionDto])}onShowMemberList(){this.unionDto&&A.intance.openModule(y.UnionMemberView,[this.unionDto,!1])}onShowGuildList(){A.intance.openModule(y.UnionListView)}onShowApplicationList(){A.intance.openModule(y.UnionMemberApplyView,this.unionDto.id)}onShowReferralList(){A.intance.openModule(y.UnionReferralView,this.unionDto.id)}async initLuckDrawView(){var e=b.instance.playerDto.union,i=await v.requestPost("wxgame/union/info",{unionId:this.currUnionId});this.unionDto=i.unionDto,this.unionDto?this.onSetUnionInfo(this.unionDto):E.instance.notice(m.instance.getLanguage(135)),this.initSubGuild()}async initSubGuild(){var e=await v.requestPost("wxgame/union/createInfo",{});e?(this.createStatus=e.createStatus,e.unionBaseDto?(this.subUnionDto=e.unionBaseDto,this.btn_apply.disabled=!1,this.tf_createSub.text=m.instance.getUILang("My Guild")):this.createStatus==0?this.btn_apply.disabled=!0:this.createStatus==1?this.btn_apply.disabled=!1:this.createStatus==2&&(e.unionBaseDto.status==0?(this.btn_apply.disabled=!1,this.tf_createSub.text=m.instance.getUILang("My Guild")):(this.btn_apply.disabled=!1,this.tf_createSub.text=m.instance.getUILang("My Guild")))):E.instance.notice(m.instance.getLanguage(135))}onSetUnionInfo(e){e?(this.unionIcon.dataSource=e,this.tf_name.text=m.instance.getMultiLan(e.unionName),this.tf_des.text=m.instance.getMultiLan(e.desc),this.tf_lv.text=m.instance.getUILang("LV.")+e.lv,this.tf_num.text="<font color='#25ff63'>"+e.memberNum+"</font>/"+e.maxMemberNum,this.img_lvIcon.skin=S.instance.getUnionLvIcon(e.lv),this.box_show.visible=!0,e.parentId>0?(this.btn_applicationList.disabled=!0,this.btn_referral.disabled=!0):e.leader!=b.instance.playerDto.pid?(this.btn_applicationList.disabled=!0,this.btn_referral.disabled=!0):this.subUnionDto?(this.btn_applicationList.disabled=!1,this.btn_referral.disabled=!1):(this.btn_applicationList.disabled=!1,this.btn_referral.disabled=!1)):this.box_show.visible=!1}onDisable(){g.intance.off(f.EVENT_SUB_GUILD_UPDATE,this,this.initSubGuild),Laya.timer.clearAll(this)}};dx=h([kP("KR8HZN1dSv2Bz_62yIgOrg")],dx);var fx=class extends Laya.Box{};var{regClass:BP}=Laya,yx=class extends fx{constructor(){super();this.isAddEvent=!1;this.addL=1}createChildren(){super.createChildren()}addEvent(){this.isAddEvent||(this.tf_num.on(Laya.Event.BLUR,this,this.changeItemNum),this.tf_uid.on(Laya.Event.BLUR,this,this.setPlayerName),this.tf_uid.on(Laya.Event.FOCUS,this,this.uidFocus),this.btn_add.on(Laya.Event.CLICK,this,this.onAdd),this.btn_reduce.clickHandler=new Laya.Handler(this,this.handleClickBtn,[this.btn_reduce]),this.btn_plus.clickHandler=new Laya.Handler(this,this.handleClickBtn,[this.btn_plus]),this.isAddEvent=!0)}set dataSource(e){super.dataSource=e,this.ticketMemberAddressVo=e,this.ticketMemberAddressVo?(this.btn_add.visible=!1,this.box_address.visible=!0,this.tf_uid.text=this.ticketMemberAddressVo.openid,this.tf_player_name.text=this.ticketMemberAddressVo.playerName,console.log("data1: ",e),this.knapsackItem.dataSource=this.ticketMemberAddressVo.itemVo,this.tf_num.text=this.ticketMemberAddressVo.num+""):(this.btn_add.visible=!0,this.box_address.visible=!1,console.log("data2: ",e)),this.addEvent()}onAdd(){g.intance.event(f.EVENT_ADD_TICKET_ADDRESS)}async setPlayerName(){try{if(this.tf_uid.text=="")return;this.ticketMemberAddressVo.openid=this.tf_uid.text.toLowerCase();var e=await v.requestPost("wxgame/sys/queryName",{openid:this.tf_uid.text.toLowerCase()});e&&(console.log(e),this.tf_player_name.text=e.name,this.ticketMemberAddressVo.checked=!0,this.ticketMemberAddressVo.playerName=e.name)}catch{console.log("未找到该玩家，请核对地址")}}uidFocus(){this.ticketMemberAddressVo.openid="",this.ticketMemberAddressVo.playerName="",this.ticketMemberAddressVo.checked=!1,this.tf_uid.text="",this.tf_player_name.text=""}changeItemNum(){var e=parseInt(this.tf_num.text);(!e||e<1)&&(e=1),this.addL=e,this.setItemNum()}handleClickBtn(e){switch(e){case this.btn_reduce:this.addL>1&&this.addL--,this.setItemNum();break;case this.btn_plus:this.addL<99999&&this.addL++,this.setItemNum();break}}setItemNum(){this.tf_num.text=this.addL+"",this.ticketMemberAddressVo.num=this.addL}};yx=h([BP("KK3UEIk8ToiricaiUr9L3A")],yx);var bx=class extends Laya.Dialog{};var gx=class{};var{regClass:MP}=Laya,Lx=class extends bx{constructor(){super(...arguments);this.m_strName="我是OpenSceneRuntime";this.m_iLayerType=C.M_PANEL;this.m_iPositionType=C.CENTER}onEnable(){this.btn_back.on(Laya.Event.CLICK,this,this.onBack),this.btn_transfer.on(Laya.Event.CLICK,this,this.onTransferItem),g.intance.on(f.EVENT_ADD_TICKET_ADDRESS,this,this.onAddticketAddress)}setOpenData(e){console.log("setOpenData: ",e),this.itemVo=e,this.itemVo.itemItem.subType==11?this.onAddticketAddress(!0):this.list_address.array=[null]}onBack(){this.close()}async onTransferItem(){var e=[];if(this.list_address.array.forEach(a=>{a&&a.checked&&a.playerName&&a.openid&&a.num>0&&e.push({address:a.openid,num:a.num})}),e.length>0){var i=await v.requestPost("wxgame/equip/ticketTransfer",{list:e,id:this.itemVo.m_iId});if(i){E.instance.notice(m.instance.getLanguage(2e3)),g.intance.event(f.EVENT_REFRESH_KNAPSACK);let a=Laya.Handler.create(this,()=>{this.list_address.array=[null]});pe.instance().AlertByType(P.BASEALERTVIEW,m.instance.getLanguage(1551),P.SURE,a)}else E.instance.notice(m.instance.getLanguage(135))}else E.instance.notice(m.instance.getLanguage(1348))}onAddticketAddress(e=!1){let i=new gx;i.num=1,i.itemVo=this.itemVo,e?this.list_address.array=[i]:(this.list_address.array||(this.list_address.array=[null]),this.list_address.setItem(this.list_address.array.length-1,i),this.list_address.addItem(null),this.list_address.refresh(),this.list_address.tweenTo(this.list_address.array.length-1))}onDisable(){this.removeEvent()}removeEvent(){this.btn_back.off(Laya.Event.CLICK,this,this.onBack),this.btn_transfer.off(Laya.Event.CLICK,this,this.onTransferItem),g.intance.off(f.EVENT_ADD_TICKET_ADDRESS,this,this.onAddticketAddress)}};Lx=h([MP("oLjG6sBpQqemEHt7q1F9GA")],Lx);var _x=class extends Laya.Box{};var{regClass:RP}=Laya,vx=class extends _x{constructor(){super();this.showAdd=!1;this.isAddEvent=!1}createChildren(){super.createChildren()}addEvent(){this.isAddEvent||(this.on(Laya.Event.CLICK,this,this.toDetail),this.isAddEvent=!0)}set dataSource(e){this.unionItem=e,this.unionItem&&(this.addEvent(),this.setCurrentOutPut())}set headSkin(e){this.img_head.skin=S.instance.getUnionIcon(e)}async setCurrentOutPut(){if(!this.unionItem)return;let e=this.unionItem.icon;this.img_head.skin=S.instance.getUnionIcon(e)}toDetail(){}};vx=h([RP("lK37x6YwQ9umJIqReZht4Q")],vx);var xx=class extends Laya.Box{};var{regClass:PP}=Laya,Ix=class extends xx{set dataSource(e){super.dataSource=e,this.iconBadgeItem=e,this.iconBadgeItem&&this.setCurrentOutPut()}async setCurrentOutPut(){this.unionIcon.headSkin=this.iconBadgeItem.id}};Ix=h([PP("TRVoEDtUSRaEW71V6oCpew")],Ix);var Ex=class extends Laya.Box{};var{regClass:NP}=Laya,wx=class extends Ex{constructor(){super();this.isAddEvent=!1}addEvent(){this.isAddEvent||(this.btn_viewMembers.on(Laya.Event.CLICK,this,this.onViewMeber),this.isAddEvent=!0)}onViewMeber(){A.intance.openModule(y.UnionMemberView,[this.unionDto,!1])}set dataSource(e){super.dataSource=e,this.unionDto=e,this.unionDto&&(this.addEvent(),this.setCurrentOutPut())}async setCurrentOutPut(){this.unionIcon.dataSource=this.unionDto,this.tf_name.text=m.instance.getMultiLan(this.unionDto.unionName),this.tf_lv.text=m.instance.getUILang("LV.")+this.unionDto.lv,this.tf_num.text="<font color='#25ff63'>"+this.unionDto.memberNum+"</font>/"+this.unionDto.maxMemberNum,this.tf_pendingMember.text=m.instance.getLanguage(1530,this.unionDto.noJoinNum),this.img_lvBg.skin=S.instance.getUnionLvDiIcon(this.unionDto.lv),this.img_lvIcon.skin=S.instance.getUnionLvIcon(this.unionDto.lv)}onChange(e){e?this.bg.skin="res/union1/img_trade_bg_2.png":this.bg.skin="res/union1/img_trade_bg_1.png"}};wx=h([NP("eauuiADeT9SAqEYe1ms81w")],wx);var Tx=class extends Laya.Dialog{};var{regClass:OP}=Laya,Cx=class extends Tx{constructor(){super(...arguments);this.m_strName="我是OpenSceneRuntime";this.m_iLayerType=C.M_PANEL;this.m_iPositionType=C.CENTER}onEnable(){this.btn_back.on(Laya.Event.CLICK,this,this.onBack)}onOpened(e){this.initLuckDrawView()}setOpenData(e){}async initLuckDrawView(){var e=await v.requestPost("wxgame/union/list",{});if(e){this.list_guild.array=e.unionList;let i=-1;this.list_guild.selectedIndex=i}else E.instance.notice(m.instance.getLanguage(135))}onBack(){this.close()}onDisable(){this.removeEvent()}removeEvent(){Laya.Tween.clearAll(this),Laya.timer.clearAll(this)}};Cx=h([OP("vJwx3qloTmiGGRpFF6Qm1A")],Cx);var Sx=class extends Laya.Box{};var{regClass:HP}=Laya,Dx=class extends Sx{constructor(){super();this.isAddEvent=!1}createChildren(){super.createChildren()}addEvent(){this.isAddEvent||(this.btn_agree.on(Laya.Event.CLICK,this,this.onAgree),this.btn_refuse.on(Laya.Event.CLICK,this,this.onRefuse),this.btn_copy.on(Laya.Event.CLICK,this,this.onCopy),this.isAddEvent=!0)}onCopy(){let e=this.unionApplyMemberDto.address;doCopy(e),E.instance.notice(m.instance.getLanguage(132))}async onAgree(){if(this.unionApplyMemberDto.pid){var e=await v.requestPost("wxgame/union/doAudit",{uid:this.unionApplyMemberDto.uid,playerId:this.unionApplyMemberDto.pid,agree:!0});e&&E.instance.notice(m.instance.getLanguage(1193)),g.intance.event(f.EVENT_UNION_APPLY_MEMBER_UPDATE)}}async onRefuse(){if(this.unionApplyMemberDto.pid){var e=await v.requestPost("wxgame/union/doAudit",{uid:this.unionApplyMemberDto.uid,playerId:this.unionApplyMemberDto.pid,agree:!1});e&&E.instance.notice(m.instance.getLanguage(1194)),g.intance.event(f.EVENT_UNION_APPLY_MEMBER_UPDATE)}}set dataSource(e){super.dataSource=e,this.unionApplyMemberDto=e,this.unionApplyMemberDto&&(this.addEvent(),this.setCurrentOutPut())}async setCurrentOutPut(){let e=this.unionApplyMemberDto.head;this.playerIcon.headSkin=e,this.img_flag.skin=S.instance.getCountryIcon(this.unionApplyMemberDto.country),this.tf_name.text=this.unionApplyMemberDto.name,this.tf_fightTimes.text=this.unionApplyMemberDto.fightTimes+"",this.tf_state.text=se.formatTimeAgo(this.unionApplyMemberDto.lastLoginTime),this.tf_state.color=se.colorTimeAgo(this.unionApplyMemberDto.lastLoginTime),this.tf_address.text=Me.abbreviateString(this.unionApplyMemberDto.address,10)}};Dx=h([HP("FPhs_TdtQbCxXS40Ic50Wg")],Dx);var Ax=class extends Laya.Dialog{};var{regClass:UP}=Laya,kx=class extends Ax{constructor(){super(...arguments);this.m_strName="我是OpenSceneRuntime";this.m_iLayerType=C.M_PANEL;this.m_iPositionType=C.CENTER}onEnable(){this.btn_back.on(Laya.Event.CLICK,this,this.onBack),this.btn_agreeAll.on(Laya.Event.CLICK,this,this.onAgreeAll),g.intance.on(f.EVENT_UNION_APPLY_MEMBER_UPDATE,this,this.onUpdateApplyMember),this.list_member.array=[]}setOpenData(e){console.log("setOpenData: ",e),Number.isInteger(e)&&(this.currUnionId=e,this.onUpdateApplyMember())}async onUpdateApplyMember(){var e=await v.requestPost("wxgame/union/auditList",{unionId:this.currUnionId});e&&e.auditList?this.list_member.array=e.auditList:E.instance.notice(m.instance.getLanguage(135))}onBack(){this.close()}async onAgreeAll(){if(this.list_member.array.length>0){var e=await v.requestPost("wxgame/union/doAudit",{uid:this.currUnionId,playerId:0,agree:!0});e&&E.instance.notice(m.instance.getLanguage(1195)),g.intance.event(f.EVENT_UNION_APPLY_MEMBER_UPDATE)}}onDisable(){this.removeEvent()}removeEvent(){g.intance.off(f.EVENT_UNION_APPLY_MEMBER_UPDATE,this,this.onUpdateApplyMember)}};kx=h([UP("LXw-3_bwSmqCzdUAekakYg")],kx);var Bx=class extends Laya.Box{};var{regClass:VP}=Laya,Mx=class extends Bx{constructor(){super();this.isAddEvent=!1;this.tgUrl=""}createChildren(){super.createChildren()}addEvent(){this.isAddEvent||(this.btn_add.on(Laya.Event.CLICK,this,this.onAdd),this.btn_move.on(Laya.Event.CLICK,this,this.onMoveClick),this.btn_tg.on(Laya.Event.CLICK,this,this.onBtnTgClick),this.isAddEvent=!0)}async onAdd(){if(this.unionMemberDto.isfriend){let e={icon:this.unionMemberDto.head,name:this.unionMemberDto.name,id:this.unionMemberDto.pid};A.intance.openModule(y.PrivateChatDialog,e);return}if(this.unionMemberDto.pid){let e=_.intance.getGeneralValueById(11);if(b.instance.friendNum>=e){pe.instance().AlertByType(P.BASEALERTVIEW,Ee.instance.get(301),P.YES);return}if(this.unionMemberDto.openid==F.instance.walletAddress){pe.instance().AlertByType(P.BASEALERTVIEW,Ee.instance.get(200),P.YES);return}if(this.unionMemberDto.isfriend){pe.instance().AlertByType(P.BASEALERTVIEW,Ee.instance.get(202),P.YES);return}let i=await v.requestPost("wxgame/friend/addFriend",{openid:this.unionMemberDto.openid});console.log(i),i&&pe.instance().AlertByType(P.BASEALERTVIEW,Ee.instance.get(307),P.YES,Laya.Handler.create(this,()=>{this.btn_add.disabled=!0}))}}set dataSource(e){super.dataSource=e,this.unionMemberDto=e,this.unionMemberDto&&(this.addEvent(),this.setCurrentOutPut())}async setCurrentOutPut(){let e=this.unionMemberDto.head;this.playerIcon.headSkin=e,this.img_flag.skin=S.instance.getCountryIcon(this.unionMemberDto.country),this.tf_name.text=this.unionMemberDto.name;let i=this.unionMemberDto.isMy;b.instance.playerDto.unionLeader&&i&&this.unionMemberDto.pid!==b.instance.playerDto.pid?this.btn_move.visible=!0:this.btn_move.visible=!1,this.unionMemberDto.isLeader&&!i?(this.tgUrl=this.unionMemberDto.tgUrl,this.img_hui.visible=!0,this.btn_tg.visible=!0,!this.tgUrl||this.tgUrl.length<=0?this.btn_tg.visible=!1:this.btn_tg.visible=!0):(this.img_hui.visible=!1,this.btn_tg.visible=!1),this.tf_unionName.text=m.instance.getMultiLan(this.unionMemberDto.unionName),this.tf_fightTimes.text=this.unionMemberDto.fightTimes+"",this.tf_state.text=se.formatTimeAgo(this.unionMemberDto.lastLoginTime),this.tf_state.color=se.colorTimeAgo(this.unionMemberDto.lastLoginTime),this.unionMemberDto.openid==F.instance.walletAddress&&(this.btn_add.visible=!1),this.btn_add.label="Add as a friend",this.unionMemberDto.isfriend&&(this.btn_add.label="send msg")}async onMoveClick(){let e=this.unionMemberDto.unionId;await v.requestPost("wxgame/union/doKickOutMember",{unionId:e,playerId:this.unionMemberDto.pid})&&g.intance.event(f.UPDATE_UNION_MEMBER_LIST,this.unionMemberDto.pid)}onBtnTgClick(){this.tgUrl?window.open(this.tgUrl,"_blank"):E.instance.notice(m.instance.getLanguage(1524))}};Mx=h([VP("l73FEB2CRGihzisJBs63MQ")],Mx);var Rx=class extends Laya.Dialog{};var{regClass:FP}=Laya,Px=class extends Rx{constructor(){super(...arguments);this.m_strName="我是OpenSceneRuntime";this.m_iLayerType=C.M_PANEL;this.m_iPositionType=C.CENTER;this.pageIndex=1;this.pages=0;this.currUnionId=0;this.isMy=!1;this.scrolLock=!0;this.pageSize=20}onEnable(){this.btn_back.on(Laya.Event.CLICK,this,this.onBack),g.intance.on(f.UPDATE_UNION_MEMBER_LIST,this,this.updateUnionMemberList),this.list_member.scrollBar.on(Laya.Event.CHANGE,this,this.onScrollBarChange)}async setOpenData(e){this.myFriendData=await v.requestPost("wxgame/friend/friendList",{}),this.myFriendData&&this.myFriendData.list&&(b.instance.friendNum=this.myFriendData.list.length),this.unionData=e[0],this.isMy=e[1],console.log("setOpenData: ",this.unionData);var i=this.unionData.id;this.initLuckDrawView(i)}async initLuckDrawView(e){this.currUnionId=e;var i;this.isMy?i=await v.requestPost("wxgame/union/myUnionMemberPageList",{pageSize:this.pageSize,pageIndex:this.pageIndex}):i=await v.requestPost("wxgame/union/memberPageList",{unionId:e,pageSize:this.pageSize,pageIndex:this.pageIndex});var a=i.list;this.pages=i.pages;var r=i.memberNum,s=i.maxMemberNum;this.tf_num.text="<font color='#25ff63'>"+r+"</font>/"+s;let o=this.isMyFriendData(a,this.myFriendData.list,e);console.log(o),this.list_member.array=o}isMyFriendData(e,i,a){for(let r of e){let s=!1;for(let o of i)if(r.openid===o.openid){s=!0;break}r.isfriend=s,r.unionId=a,r.isMy=this.isMy,r.isLeader=r.pid==this.unionData.leader,r.tgUrl=this.unionData.tgUrl}return e}onBack(){this.close()}updateUnionMemberList(e){console.log(e),console.log(this.list_member.array),this.list_member.array=this.deleteItemByPid(this.list_member.array,e),console.log(this.list_member.array)}deleteItemByPid(e,i){return e.filter(a=>a.pid!==i)}onDisable(){this.removeEvent()}onScrollBarChange(){this.list_member.scrollBar.value>=this.list_member.scrollBar.max&&this.loadMoreData()}refreshLock(){this.scrolLock=!0,console.log("重置锁")}async loadMoreData(){if(this.scrolLock&&(this.scrolLock=!1,console.log("到底了"),Laya.timer.once(1e4,this,this.refreshLock),this.pageIndex<this.pages)){this.pageIndex+=1;var e;if(this.isMy?e=await v.requestPost("wxgame/union/myUnionMemberPageList",{pageSize:this.pageSize,pageIndex:this.pageIndex}):e=await v.requestPost("wxgame/union/memberPageList",{unionId:this.currUnionId,pageSize:this.pageSize,pageIndex:this.pageIndex}),e){var i=e.list;this.pages=e.pages,this.scrolLock=!0;var a=e.memberNum,r=e.maxMemberNum;this.tf_num.text="<font color='#25ff63'>"+a+"</font>/"+r;let s=this.isMyFriendData(i,this.myFriendData.list,this.currUnionId);this.list_member.array.push(...s),this.list_member.array=this.list_member.array,Laya.timer.clear(this,this.refreshLock)}}}removeEvent(){Laya.Tween.clearAll(this),Laya.timer.clearAll(this),g.intance.offAllCaller(this)}};Px=h([FP("439XbfImQxS4I-Vced8JKA")],Px);var Nx=class extends Laya.Box{};var{regClass:GP}=Laya,Ox=class extends Nx{constructor(){super();this.isAddEvent=!1}set dataSource(e){super.dataSource=e,this.unionDto=e,this.unionDto&&this.setCurrentOutPut()}async setCurrentOutPut(){this.unionIcon.dataSource=this.unionDto,this.tf_name.text=m.instance.getMultiLan(this.unionDto.unionName),this.tf_lv.text=m.instance.getUILang("LV.")+this.unionDto.lv,this.tf_num.text="<font color='#25ff63'>"+this.unionDto.memberNum+"</font>/"+this.unionDto.maxMemberNum,this.img_lvBg.skin=S.instance.getUnionLvDiIcon(this.unionDto.lv),this.img_lvIcon.skin=S.instance.getUnionLvIcon(this.unionDto.lv),this.tf_pendingMember.text=m.instance.getLanguage(1530,this.unionDto.noJoinNum)}onChange(e){e?this.bg.skin="res/union1/img_trade_bg_2.png":this.bg.skin="res/union1/img_trade_bg_1.png"}};Ox=h([GP("cbbqawzdSI2g161G69xpUg")],Ox);var Hx=class extends Laya.Box{};var{regClass:KP}=Laya,Ux=class extends Hx{constructor(){super();this.isAddEvent=!1}createChildren(){super.createChildren()}addEvent(){this.isAddEvent||(this.btn_copy.on(Laya.Event.CLICK,this,this.onCopy),this.isAddEvent=!0)}onCopy(){let e=this.unionDto.collectionToken;doCopy(e),E.instance.notice(m.instance.getLanguage(132))}set dataSource(e){super.dataSource=e,this.unionDto=e,this.unionDto&&(this.addEvent(),this.setCurrentOutPut())}async setCurrentOutPut(){this.unionIcon.dataSource=this.unionDto,this.tf_name.text=m.instance.getMultiLan(this.unionDto.unionName),this.tf_lv.text=m.instance.getUILang("LV.")+this.unionDto.lv,this.tf_num.text="<font color='#25ff63'>"+this.unionDto.memberNum+"</font>/"+this.unionDto.maxMemberNum,this.img_lvBg.skin=S.instance.getUnionLvDiIcon(this.unionDto.lv),this.img_lvIcon.skin=S.instance.getUnionLvIcon(this.unionDto.lv),this.tf_address.text=Me.abbreviateString(this.unionDto.collectionToken,24)}};Ux=h([KP("NTRu0sy9SDCKgxglHtnEdw")],Ux);var Vx=class extends Laya.Dialog{};var{regClass:qP}=Laya,Fx=class extends Vx{constructor(){super(...arguments);this.m_strName="我是OpenSceneRuntime";this.m_iLayerType=C.M_PANEL;this.m_iPositionType=C.CENTER}onEnable(){this.btn_back.on(Laya.Event.CLICK,this,this.onBack),this.list_junior.array=[]}setOpenData(e){console.log("setOpenData: ",e),Number.isInteger(e)&&(this.currUnionId=e,this.onUpdateApplyMember())}async onUpdateApplyMember(){var e=await v.requestPost("wxgame/union/unionRelation",{unionId:this.currUnionId});e?(this.tf_referralNum.text=m.instance.getLanguage(1308,e.childUnionNum),this.tf_memberNum.text=m.instance.getLanguage(1309,e.childUnionMemberNum),this.list_senior.array=e.parent?[e.parent]:[],!this.list_senior.array||this.list_senior.array.length<=0?this.noDataBox1.visible=!0:this.noDataBox1.visible=!1,e.childList&&(this.list_junior.array=e.childList),!e.childList||e.childList.length<=0?this.noDataBox.visible=!0:this.noDataBox.visible=!1):E.instance.notice(m.instance.getLanguage(135))}onBack(){this.close()}onDisable(){this.removeEvent()}removeEvent(){}};Fx=h([qP("Ls1FVCY8RxeSChhaMnjcKA")],Fx);var Gx=class extends Laya.Scene{};var{regClass:WP}=Laya,Kx=class extends Gx{constructor(){super(...arguments);this.currTab=0;this.type=1;this.joinStatusDic=new le;this.items=[]}onAwake(){this.m_iLayerType=C.M_POP,this.m_iPositionType=C.UP}onOpened(e){this.type=e}onEnable(){this.btn_search.on(Laya.Event.CLICK,this,this.onSearch),this.btn_join.on(Laya.Event.CLICK,this,this.onJoin),this.btn_back&&this.btn_back.on(Laya.Event.CLICK,this,this.setToMainScene),this.list_union.vScrollBarSkin="",this.list_union.selectHandler=Laya.Handler.create(this,this.onSelectItem,null,!1),this.list_union.renderHandler=Laya.Handler.create(this,this.onItemRender,null,!1),this.box_show.visible=!1,this.box_list.visible=!1,this.initLuckDrawView();let e=(Laya.stage.height-z.DESIGN_HEIGHT)/2}async initLuckDrawView(){var e=await v.requestPost("wxgame/union/list",{});e?this.unionData=e.unionList:E.instance.notice(m.instance.getLanguage(135)),this.getJoinStatus()}async getJoinStatus(){var e=await v.requestPost("wxgame/union/joinStatus",{});e?(this.joinStatusDic=new le,this.joinStatusDic.set(e.unionId,e.joinStatus)):E.instance.notice(m.instance.getLanguage(135)),this.getItemByName(""),this.box_list.visible=!0}getItemByName(e){if(this.list_union.selectedIndex=-1,this.items=[],this.unionData){var i=this.unionData.length;this.tf_totalNum.text=m.instance.getLanguage(1355,i);for(var a=0;a<i;a++){var r=this.unionData[a],s=m.instance.getMultiLan(r.unionName);Me.caseInsensitiveSearchWithRegex(s,e)&&this.items.push(r)}}this.list_union.array=this.items,this.items.length>0?this.list_union.selectedIndex=0:this.list_union.selectedIndex=-1}onSearch(){var e=this.input_search.text;this.getItemByName(e)}onJoin(){this.currUnionDto&&(b.instance.playerDto.union>0?oe.intance.setCurrentScene(Y.M_SCENE_MYUNION,this.currUnionDto.id):pe.instance().AlertByType(P.BASEALERTVIEW,m.instance.getLanguage(141),P.CANCEL,Laya.Handler.create(this,this.onJoinSure)))}async onJoinSure(){if(this.currUnionDto){var e=await v.requestPost("wxgame/union/join",{unionId:this.currUnionDto.id});e.errorCode==0?e.unionId&&e.unionId>0?(b.instance.playerDto.union=e.unionId,oe.intance.setCurrentScene(Y.M_SCENE_MYUNION,b.instance.playerDto.union),E.instance.notice(m.instance.getLanguage(2e3))):E.instance.notice(m.instance.getLanguage(1196)):E.instance.notice(m.instance.getLanguage(135))}}onItemRender(e,i){e.onChange(this.list_union.selectedIndex==i)}onSelectItem(e,i){if(this.currUnionDto=this.items[e],console.log(this.currUnionDto),this.currUnionDto){this.unionIcon.dataSource=this.currUnionDto,this.tf_name.text=m.instance.getMultiLan(this.currUnionDto.unionName),this.tf_des.text=m.instance.getMultiLan(this.currUnionDto.desc),this.tf_lv.text=m.instance.getUILang("LV.")+this.currUnionDto.lv,this.tf_num.text="<font color='#25ff63'>"+this.currUnionDto.memberNum+"</font>/"+this.currUnionDto.maxMemberNum,this.img_lvBg.skin=S.instance.getUnionLvDiIcon(this.currUnionDto.lv),this.img_lvIcon.skin=S.instance.getUnionLvIcon(this.currUnionDto.lv);var a=this.joinStatusDic.get(this.currUnionDto.id);b.instance.playerDto.union>0?this.btn_join.label=m.instance.getUILang("Enter"):a?a==1?this.btn_join.label=m.instance.getLanguage(1210):a==2?this.btn_join.label=m.instance.getUILang("Enter"):this.btn_join.label=m.instance.getUILang("Join"):this.btn_join.label=m.instance.getUILang("Join"),this.box_show.visible=!0}else this.box_show.visible=!1}setToMainScene(){oe.intance.setCurrentScene(Y.M_SCENE_MAIN)}removeEvent(){}};Kx=h([WP("VfpfbqXcSQalDIkuosz8Rw")],Kx);var qx=class extends Laya.Box{};var{regClass:YP}=Laya,Wx=class extends qx{constructor(){super();this.isAddEvent=!1}createChildren(){super.createChildren()}addEvent(){this.isAddEvent||(this.tf_uid.on(Laya.Event.BLUR,this,this.setPlayerName),this.tf_uid.on(Laya.Event.FOCUS,this,this.uidFocus),this.btn_add.on(Laya.Event.CLICK,this,this.onAdd),this.isAddEvent=!0)}set dataSource(e){super.dataSource=e,this.unionMemberAddressVo=e,console.log("data: ",e),this.unionMemberAddressVo?(this.btn_add.visible=!1,this.box_address.visible=!0,this.tf_uid.text=this.unionMemberAddressVo.openid,this.tf_player_name.text=this.unionMemberAddressVo.playerName,console.log("data1: ",e)):(this.btn_add.visible=!0,this.box_address.visible=!1,console.log("data2: ",e)),this.addEvent()}onAdd(){g.intance.event(f.EVENT_ADD_UNIONMEMBER_ADDRESS)}async setPlayerName(){try{if(this.tf_uid.text=="")return;this.unionMemberAddressVo.openid=this.tf_uid.text.toLowerCase();var e=await v.requestPost("wxgame/sys/queryName",{openid:this.tf_uid.text.toLowerCase()});e&&(console.log(e),this.tf_player_name.text=e.name,this.unionMemberAddressVo.checked=!0,this.unionMemberAddressVo.playerName=e.name)}catch{console.log("未找到该玩家，请核对地址")}}uidFocus(){this.unionMemberAddressVo.openid="",this.unionMemberAddressVo.playerName="",this.unionMemberAddressVo.checked=!1,this.tf_uid.text="",this.tf_player_name.text=""}};Wx=h([YP("JU_R7IZ9Q9uq6BU_eahAuQ")],Wx);var Yx=class extends Laya.Box{};var{regClass:zP}=Laya,zx=class extends Yx{constructor(){super();this.isAddEvent=!1}createChildren(){super.createChildren()}addEvent(){this.isAddEvent||(this.on(Laya.Event.CLICK,this,this.onCheck),this.isAddEvent=!0)}set dataSource(e){if(super.dataSource=e,this.unionMemberVo=e,!this.unionMemberVo)return;this.check_coin.selected=this.unionMemberVo.checked,this.unionMemberDto=this.unionMemberVo.unionMemberDto;let i=this.unionMemberDto.head;this.playerIcon.headSkin=i,this.tf_name.text=this.unionMemberDto.name,this.addEvent()}onCheck(){this.unionMemberVo.checked=!this.unionMemberVo.checked,console.log("onCheck: ",this.unionMemberVo.checked),g.intance.event(f.EVENT_REFRESH_UNIONMEMBER_TRANSFER)}};zx=h([zP("gGFdZxctQPm-SO2zLew1hg")],zx);var jx=class{};var $x=class extends Laya.Dialog{};var Xx=class{};var{regClass:jP}=Laya,Qx=class extends $x{constructor(){super(...arguments);this.m_strName="我是OpenSceneRuntime";this.m_iLayerType=C.M_PANEL;this.m_iPositionType=C.CENTER;this.myHeroesNum=0;this.selectedNum=0;this.addL=1}onEnable(){this.tf_num.on(Laya.Event.BLUR,this,this.changeItemNum),this.btn_back.on(Laya.Event.CLICK,this,this.onBack),this.btn_transfer.on(Laya.Event.CLICK,this,this.onTransferItem),this.btn_checkBox.on(Laya.Event.CLICK,this,this.onSelectAll),this.btn_reduce.clickHandler=new Laya.Handler(this,this.handleClickBtn,[this.btn_reduce]),this.btn_plus.clickHandler=new Laya.Handler(this,this.handleClickBtn,[this.btn_plus]),g.intance.on(f.EVENT_REFRESH_UNIONMEMBER_TRANSFER,this,this.onRefreshUnionMemberTransfer),g.intance.on(f.EVENT_ADD_UNIONMEMBER_ADDRESS,this,this.onAddUnionMemberAddress),this.list_members.array=[]}setOpenData(e){console.log("setOpenData: ",e),this.itemVo=e,this.showItem(),this.getUnionMembers(),this.list_address.array=[null]}showItem(){this.knapsackItem.dataSource=this.itemVo}async getUnionMembers(){var e=await v.requestPost("wxgame/union/members",{}),i=e.list;console.log("获得公会成员 unionMemberDtos: ",i),this.unionMemberVos=[],i&&i.length>0&&i.forEach(a=>{if(a&&a.pid!=b.instance.playerDto.pid){var r=new jx;r.unionMemberDto=a,this.unionMemberVos.push(r)}}),this.list_members.array=this.unionMemberVos,this.updateNum()}onAddUnionMemberAddress(){console.log("onAddUnionMemberAddress: ",this.list_address.array),this.list_address.setItem(this.list_address.array.length-1,new Xx),this.list_address.addItem(null),this.list_address.refresh(),this.list_address.tweenTo(this.list_address.array.length-1)}onRefreshUnionMemberTransfer(){this.list_members.refresh(),this.updateNum()}updateNum(){!this.unionMemberVos||this.unionMemberVos.length<=0?this.noDataBox.visible=!0:this.noDataBox.visible=!1,this.selectedNum=0,this.unionMemberVos.forEach(e=>{e&&e.checked&&this.selectedNum++}),this.myHeroesNum=this.unionMemberVos.length,this.tf_selectedNum.text=m.instance.getLanguage(1223,this.selectedNum)}onSelectAll(){var e=this.btn_checkBox.selected;this.unionMemberVos.forEach(i=>{i&&(i.checked=e)}),this.list_members.refresh(),this.updateNum()}changeItemNum(){var e=parseInt(this.tf_num.text);(!e||e<1)&&(e=1),this.addL=e,this.setItemNum()}handleClickBtn(e){switch(e){case this.btn_reduce:this.addL>1&&this.addL--,this.setItemNum();break;case this.btn_plus:this.addL<99999&&this.addL++,this.setItemNum();break}}setItemNum(){this.tf_num.text=this.addL+""}onBack(){this.close()}async onTransferItem(){var e=[];if(this.unionMemberVos.forEach(a=>{a.checked&&e.push(a.unionMemberDto.openid)}),this.list_address.array.forEach(a=>{a&&a.checked&&e.push(a.openid)}),e.length>0){var i=await v.requestPost("wxgame/equip/airdropTicketTransfer",{addressList:e,id:this.itemVo.m_iId,transferNum:this.addL});if(i){E.instance.notice(m.instance.getLanguage(2e3)),g.intance.event(f.EVENT_REFRESH_KNAPSACK);let a=Laya.Handler.create(this,()=>{this.list_address.array=[null],this.getUnionMembers()});pe.instance().AlertByType(P.BASEALERTVIEW,m.instance.getLanguage(1551),P.SURE,a)}else E.instance.notice(m.instance.getLanguage(135))}else E.instance.notice(m.instance.getLanguage(1348))}onDisable(){this.removeEvent()}removeEvent(){g.intance.off(f.EVENT_REFRESH_UNIONMEMBER_TRANSFER,this,this.onRefreshUnionMemberTransfer),g.intance.off(f.EVENT_ADD_UNIONMEMBER_ADDRESS,this,this.onAddUnionMemberAddress)}};Qx=h([jP("xnUTxKqCQUuIl8QBpuYoxg")],Qx);var{regClass:$P,property:tze}=Laya,Ac=class extends Laya.Script{constructor(){super()}onEnable(){this.owner.getComponent(Laya.RigidBody).setVelocity({x:0,y:-10})}onTriggerEnter(t,e,i){this.owner.removeSelf()}onUpdate(){this.owner.y<-10&&this.owner.removeSelf()}onDisable(){Laya.Pool.recover("bullet",this.owner)}};Ac=h([$P("hIXP-u9_RfeIwPLhNGNjGw")],Ac);var{regClass:XP,property:nze}=Laya,kc=class extends Laya.Script{constructor(){super()}onEnable(){this.owner.on(Laya.Event.MOUSE_DOWN,this,this.onClick)}onClick(t){Laya.stage.width=1334,Laya.stage.height=750,Laya.stage.scaleMode=Laya.Stage.SCALE_FIXED_WIDTH,Laya.Scene.open("scenes/Index.ls")}onDisable(){this.owner.off(Laya.Event.MOUSE_DOWN,this)}};kc=h([XP("DQCudilORvOvMM7hTH8i7w")],kc);var{regClass:QP,property:JP}=Laya,ln=class extends Laya.Script{constructor(){super();this.level=1}get itemId(){return this._itemId}set itemId(e){this._itemId=e,this.owner.skin="resources/UI/images/bag/"+e+".png"}onEnable(){this._rig=this.owner.getComponent(Laya.RigidBody),this.level=Math.round(Math.random()*5)+1}onUpdate(){}onCollisionEnter(e){console.log("collision: ",e)}onTriggerEnter(e,i,a){var r=this.owner;if(console.log("owener: ",r),e.label==="buttle"&&r.parent){let s=Laya.Pool.getItemByCreateFun("effect",this.createEffect,this);s.pos(r.x,r.y),r.parent.addChild(s),s.play(0,!0),r.removeSelf(),Laya.SoundManager.playSound("resources/sound/destroy.wav")}}createEffect(){let e=new Laya.Animation;e.loadAnimation("resources/ani/TestAni.ani"),e.on(Laya.Event.COMPLETE,null,i);function i(){e.removeSelf(),Laya.Pool.recover("effect",e)}return e}onDisable(){Laya.Pool.recover("dropBox",this.owner)}};h([JP({type:"number"})],ln.prototype,"level",2),ln=h([QP("3L23NCFLSAieUApqTrVoCQ")],ln);var{regClass:ZP,property:cze}=Laya,Rr=class extends Laya.Script{constructor(){super();this.touchHeroIds=new le;this.touchGlasses=new le;this.updateIndex=0;this.turnSpeed=1;this.turningSpeed=.1;this.lastDirectionAngle=0;this._state=Qe.STATE_Idle;this.lastState=Qe.STATE_Idle;this.isFirst=!1;this.patrolIndex=0;this.lastPath=[];this.thresholdDistance=3}onAwake(){}onEnable(){if(this.owner.roomPlayerDto.npc==Qe.TYPE_Monster){var e=B.instance.matchWatcher;e||Laya.timer.loop(500,this,this.updateMonster)}}onCollisionEnter(e){console.log(this.constructor.name+" onCollisionEnter collision",e)}onCollisionStay(e){console.log(this.constructor.name+" onCollisionStay collision",e)}onCollisionExit(e){console.log(this.constructor.name+" onCollisionExit collision",e)}onTriggerEnter(e,i,a){if(e.label!=="ground"){if(e.label&&e.label.startsWith("grass"))this.owner.isMe&&(e.owner.alpha=.7,this.touchGlasses.set(e.label,!0),this.setMyCurrArea());else if(e.label==="item")this.owner.enterItemId=e.owner.getComponent(ln).itemId;else if(e.label==="role"){var r=e.owner.roomPlayerDto.id;if(this.touchHeroIds.set(r,e.owner),this.owner.displacementType==2){var s=k.instance.canAttack(this.owner,e.owner);s&&Laya.Tween.clearAll(this.owner)}}}}onTriggerStay(e,i,a){}onTriggerExit(e,i,a){if(e.label==="ground")this.owner.inGround=!1;else if(e.label&&e.label.startsWith("grass"))this.owner.isMe&&(e.owner.alpha=1,this.touchGlasses.remove(e.label),this.setMyCurrArea());else if(e.label==="item")this.owner.enterItemId==e.owner.getComponent(ln).itemId&&(this.owner.enterItemId=0);else if(e.label==="role"){var r=e.owner.roomPlayerDto.id;this.touchHeroIds.remove(r)}}setMyCurrArea(){this.touchGlasses.keys.length>0?this.owner.currArea=1:this.owner.currArea=0,this.owner.onSendMoveData()}onLateUpdate(){var e=this.owner.parent,i=e.localToGlobal(Laya.Point.TEMP.setTo(this.owner.x,this.owner.y)),a=100;i.x>=0-a&&i.x<=Laya.stage.width+a&&i.y>=0-a&&i.y<=Laya.stage.height+a?(this.owner.heroSk.resume(),this.owner.beyond=!1):(this.owner.heroSk.paused(),this.owner.beyond=!0)}onUpdate(){if(this.owner.isOneTeam)this.owner.isMe?this.owner._isDead||(k.instance.myHeroSpr.currArea>0?this.owner.alpha=.6:this.owner.alpha=1):this.owner._isRealDead?this.owner.visible=!1:this.owner.currArea>0?(this.owner.visible=!0,this.owner.alpha=.6):(this.owner.visible=!0,this.owner.alpha=1);else{var e=B.instance.matchWatcher;this.owner._isRealDead?e||k.instance.myHeroSpr._isDead?this.owner.visible=!1:this.owner.visible=!1:this.owner.currArea>0?e||k.instance.myHeroSpr.currArea==this.owner.currArea?(this.owner.visible=!0,this.owner.alpha=.6):this.owner.visible=!1:(this.owner.visible=!0,this.owner.alpha=1);return}if(!this.owner.isStop){if(this.owner.speed>0){let i=this.getJoystickDirectionAngle(),a=this.calculateAngleDifference(i,this.lastDirectionAngle);if(Math.abs(a)>10?this.startTurning():this.stopTurning(),this.lastDirectionAngle=i,this.owner.isLockAni||(this.lastSpeed!=this.owner.speed||this.owner.aniChange)&&(this.owner.aniChange=!1,this.owner.heroSk.isReady&&this.owner.walk(),this.lastSpeed=this.owner.speed),this.owner.roleDirection>=0){let r=1*this.owner.speed*this.turnSpeed,s=this.owner.roleDirection*(Math.PI/180),o=r*Math.cos(s),l=r*Math.sin(s);this.owner.pos(Math.round(this.owner.x+o),Math.round(this.owner.y+l))}this.owner.inControl&&!this.owner._isDead&&this.touchHeroIds.values.forEach(r=>{var s=k.instance.canTui(this.owner,r);s&&r.beiTui(this.owner.roomPlayerDto.id)})}else this.owner.isLockAni||(this.lastSpeed!=this.owner.speed||this.owner.aniChange)&&(this.owner.aniChange=!1,this.owner.idle(),this.lastSpeed=this.owner.speed);this.updateIndex==0&&this.owner.onSendMoveData(),this.updateIndex++,this.updateIndex>0&&(this.updateIndex=0)}}getJoystickDirectionAngle(){return this.owner.roleDirection}calculateAngleDifference(e,i){let a=Math.abs(e-i);return a>180?360-a:a}startTurning(){this.turnSpeed*=this.turningSpeed}stopTurning(){this.turnSpeed=1}onDisable(){Laya.timer.clearAll(this)}get state(){return this._state}set state(e){this._state=e}updateMonster(){if(this.owner._isDead||B.instance.stopAll)return;var e=new Date().getTime(),i=!1;this.isFirst=!1,this.lastState!=this.state&&(this.isFirst=!0,this.lastState=this.state,console.log("state: "+this.state)),i&&(this.isUnderAttack=!0,this.handleUnderAttack(e));var a;this.owner.target&&(a=gt.calculateDistance(this.owner,this.owner.target));let r=gt.calculateDistance(this.owner,k.instance.myHeroSpr);switch(this.state){case Qe.STATE_Idle:this.handleIdle();break;case Qe.STATE_Patrol:this.handlePatrol();break;case Qe.STATE_Chase:this.chaseLogic(a,e,r);break;case Qe.STATE_Attack:this.handleAttack(e);break;case Qe.STATE_Flee:this.handleFlee();break}var s=B.instance.matchCoolDownTime;s>30&&this.checkStateTransitions(r)}handleUnderAttack(e){let a=this.owner.skills.filter(r=>r.isDefensive&&this.owner.canUseSkill(r,e));a.length>0&&this.useSkill(a[0],e)}useSkill(e,i){this.owner.useSkill(e,i),console.log(`Using skill ${e.id} on target!`)}handleIdle(){this.owner.detectPlayer()?this.state=Qe.STATE_Chase:this.owner.isFocusedOnPlayer||(this.state=Qe.STATE_Patrol)}handlePatrol(){this.isFirst&&this.randomMove(),this.owner.detectPlayer()&&(this.state=Qe.STATE_Chase)}randomMove(){let e=k.instance.getNodeAt(this.owner.x,this.owner.y),a=k.instance.getNeighbors(e).filter(c=>k.instance.isWalkableAt(c.x,c.y));if(a.length===0)return;let r=Math.floor(Math.random()*a.length),s=a[r],o=s.y*32+16,l=s.x*32+16;this.startPathfinding(o,l)}chaseLogic(e,i,a){let r=e&&e<=this.owner.attackRange,s=a<=this.owner.attackRange;this.owner.isFocusedOnPlayer?s?(this.owner.target=k.instance.myHeroSpr,this.state=Qe.STATE_Attack,this.updateMonster()):this.moveToTarget():s?(this.owner.target=k.instance.myHeroSpr,this.state=Qe.STATE_Attack,this.updateMonster()):r?(this.owner.smallHeroImg&&Laya.Tween.clearAll(this.owner.smallHeroImg),Laya.Tween.clearAll(this.owner),this.state=Qe.STATE_Attack,this.updateMonster()):this.moveToTarget()}moveToTarget(){if(!this.owner.target||this.owner.target._isDead){this.owner.target=null,this.state=Qe.STATE_Idle;return}this.owner.isFocusedOnPlayer?this.moveToTargetDetail():this.owner.isPlayerWithoutDetectionRange(this.owner.target)?this.state=Qe.STATE_Idle:this.moveToTargetDetail()}moveToTargetDetail(){let i=this.owner.target.x,a=this.owner.target.y,r=i-this.owner.x,s=a-this.owner.y,o=Math.sqrt(r*r+s*s),l=Math.atan2(s,r),c=i-Math.cos(l)*90,u=a-Math.sin(l)*90;this.startPathfinding(c,u)}handleAttack(e){if(this.owner.isStop){console.log("handleAttack: this.owner.isStop "+this.owner.isStop);return}if(this.isFirst&&(this.owner.smallHeroImg&&Laya.Tween.clearAll(this.owner.smallHeroImg),Laya.Tween.clearAll(this.owner)),this.isUnderAttack){this.handleUnderAttack(e),this.isUnderAttack=!1;return}if(!this.owner.target||this.owner.target._isDead){this.owner.target=null,this.state=Qe.STATE_Idle;return}var i=gt.judgePosition(this.owner.target.x-this.owner.x,this.owner.target.y-this.owner.y);this.owner.roleDirection=i,this.owner.onNpcSendMoveData(this.owner.x,this.owner.y),this.owner.lastTarget!=this.owner.target&&(this.owner.currentAttackIndex=0,this.owner.monsterAttackSequence=this.owner.oldMonsterAttackSequence);var a,r=!1;this.owner.target==k.instance.myHeroSpr?(a=this.owner.attackSequence,r=!0):a=this.owner.monsterAttackSequence;let s=a[this.owner.currentAttackIndex],o=this.owner.skills.find(u=>u.skillItem.type===s);var l=!1;if(o)if(this.owner.canUseSkill(o,e))if(gt.calculateDistance(this.owner,this.owner.target)<=o.skillItem.distance){var c=!1;s!=6||r?c=!0:Math.random()<.2&&(c=!0,l=!0),c&&this.useSkill(o,e)}else{this.state=Qe.STATE_Chase;return}else{this.owner.currentAttackIndex=(this.owner.currentAttackIndex+1)%a.length,this.state=Qe.STATE_Flee;return}this.owner.currentAttackIndex=(this.owner.currentAttackIndex+1)%a.length,l&&(this.owner.monsterAttackSequence=this.owner.oldUsdBigSkillMonsterAttackSequence),this.owner.lastTarget=this.owner.target}checkStateTransitions(e){e<=this.owner.showRange&&this.owner.target!=k.instance.myHeroSpr&&(this.owner.target=k.instance.myHeroSpr,this.state=Qe.STATE_Chase)}handleFlee(){if(this.isFirst)try{this.runAway()}catch(e){console.warn(e),this.state=Qe.STATE_Idle}else this.state=Qe.STATE_Idle}multiplyByRandomRange(e){let r=Math.random()*.3999999999999999+.8;return e*r*100}runAway(){if(!this.owner.target||this.owner.target._isDead){this.owner.target=null,this.state=Qe.STATE_Idle;return}let e=this.getFleeDirection();console.log("runAway: ",e);var i=this.owner.x+this.multiplyByRandomRange(e.x),a=this.owner.y+this.multiplyByRandomRange(e.y);this.startPathfinding(i,a)}getFleeDirection(){if(!this.owner.target)return new Laya.Point(0,0);let e=this.owner.x-this.owner.target.x,i=this.owner.y-this.owner.target.y,a=Math.sqrt(e*e+i*i);return new Laya.Point(e/a,i/a)}startPathfinding(e,i){try{this.path=k.instance.getEveryPath(new Laya.Point(this.owner.x,this.owner.y),new Laya.Point(e,i))}catch(r){console.warn(r),this.path=[],this.state=Qe.STATE_Idle}let a=this.path;this.lastPath=a,this.moveAlongPath()}shouldUpdatePath(e){if(!e||e.length===0)return!1;let i=this.lastPath[this.lastPath.length-1];if(i){let a=e[e.length-1];return gt.getDistance(i,a)>this.thresholdDistance}else return!0}moveAlongPath(){if(this.path)if(this.path.length>0){let s=this.path.shift(),o=s.y*32+16,l=s.x*32+16;var e=gt.judgePosition(o-this.owner.x,l-this.owner.y);if(this.owner.roleDirection=e,this.owner.smallHeroImg){var i=k.instance.fromBigToSmall(o,l),a=i[0],r=i[1];Laya.Tween.to(this.owner.smallHeroImg,{x:a,y:r},this.owner.monsterTime,Laya.Ease.linearNone,null,0,!0)}this.owner.isLockAni||(this.owner.aniChange=!1,this.owner.heroSk.isReady&&this.owner.walk()),Laya.Tween.to(this.owner,{x:o,y:l},this.owner.monsterTime,Laya.Ease.linearNone,Laya.Handler.create(this,this.moveAlongPath),0,!0),this.owner.onNpcSendMoveData(o,l)}else this.state==Qe.STATE_Patrol&&this.randomMove()}};Rr=h([ZP("DknC7B57SZi-09Mz092daQ")],Rr);var{regClass:eN,property:mD}=Laya,cn=class extends Laya.Script{constructor(){super();this.createBoxInterval=1e3;this._time=0;this._started=!1;this.updateStop=!1}onEnable(){let e=["resources/UI/images/test/b1.png"];Laya.loader.load(e).then(i=>{this._time=Date.now(),this._gameBox=this.owner.getChildByName("gameBox"),Laya.stage.on(Laya.Event.BLUR,this,()=>{this.updateStop=!0}),Laya.stage.on(Laya.Event.FOCUS,this,()=>{this.updateStop=!1}),Laya.stage.on(Laya.Event.MOUSE_DOWN,this,this.onStageClick)})}onStart(){let e=this.owner.getChildByName("ground").getComponent(Laya.BoxCollider);e.width=Laya.stage.width}onUpdate(){if(this.updateStop)return;let e=Date.now();e-this._time>this.createBoxInterval&&this._started&&(this._time=e,this.createBox())}createBox(){let e=Laya.Pool.getItemByCreateFun("dropBox",this.dropBox.create,this.dropBox);e.pos(Math.random()*(Laya.stage.width-100),-100),this._gameBox.addChild(e)}onStageClick(e){e.stopPropagation();let i=Laya.Pool.getItemByCreateFun("bullet",this.bullet.create,this.bullet);i.pos(Laya.stage.mouseX,Laya.stage.mouseY),this._gameBox.addChild(i)}startGame(){this._started||(this._started=!0,this.enabled=!0)}stopGame(){this._started=!1,this.enabled=!1,this.createBoxInterval=1e3,this._gameBox.removeChildren()}};h([mD({type:Laya.Prefab})],cn.prototype,"dropBox",2),h([mD({type:Laya.Prefab})],cn.prototype,"bullet",2),cn=h([eN("5iJgbfCiSn6Rc8upAfHtjA")],cn);var Jx=class extends Laya.Scene{};var{regClass:tN,property:vze}=Laya,Pr=class extends Jx{constructor(){super();Pr.instance=this}onEnable(){this._control=this.getComponent(cn),this.tipLbll.on(Laya.Event.CLICK,this,this.onTipClick)}onTipClick(e){this.tipLbll.visible=!1,this._score=0,this.scoreLbl.text="分数：",this._control.startGame()}addScore(e=1){this._score+=e,this.scoreLbl.text="分数："+this._score,this._control.createBoxInterval>600&&this._score%20==0&&(this._control.createBoxInterval-=20)}stopGame(){this.tipLbll.visible=!0,this.tipLbll.text="游戏结束了，点击屏幕重新开始",this._control.stopGame()}};Pr=h([tN("Y5UkAabiTgWFZQnBL1EpEw")],Pr);var Zx=class extends Laya.Scene{};var{regClass:iN,property:Sze}=Laya,Bc=class extends Zx{constructor(){super()}onOpened(t){t&&(this.msgLab.x=t.point&&t.point.x?t.point.x:Laya.stage.mouseX-50,this.msgLab.y=t.point&&t.point.y?t.point.y:Laya.stage.mouseY-80,this.msgLab.text=t.text,Laya.Tween.to(this.msgLab,{y:this.msgLab.y-100,alpha:0},1e3,Laya.Ease.linearNone))}};Bc=h([iN("9kGOzpbbSOWSAmN0l9VtfQ")],Bc);var e0=class extends Laya.Scene{};var{regClass:aN,property:Bze}=Laya,Mc=class extends e0{constructor(){super()}onEnable(){Laya.Physics2D.I&&(Laya.Physics2D.I.enableDebugDraw=!1),this.tabBindViewStack(),this.topTab.selectedIndex=0,this.item0Tab.selectedIndex=0}onClicked(){let t=this.item2Tab.getChildByName("item2"),e=this.item2Tab.getChildByName("item3"),i=this.item2Tab.getChildByName("item4");t.on(Laya.Event.MOUSE_DOWN,this,()=>{Laya.Scene.open("scenes/uiDemo/page/OpenMainScene.ls",!1)}),e.on(Laya.Event.MOUSE_DOWN,this,()=>{Laya.Scene.open("scenes/uiDemo/page/OpenScene.ls",!1)}),i.on(Laya.Event.MOUSE_DOWN,this,()=>{Laya.Scene.open("scenes/uiDemo/page/Dialog.ls",!1,{title:"弹窗的标题",text:"弹窗的具体文本……"})})}tabBindViewStack(){this.topTab.selectHandler=new Laya.Handler(this,t=>{this.tabPage.selectedIndex=t,t==1&&(this.item1Tab.selectedIndex=0),t==2&&(this.item2Tab.selectedIndex=0),t==3&&(this.item3Tab.selectedIndex=0),t==4&&(this.item4Tab.selectedIndex=0),Laya.Physics2D.I&&(Laya.Physics2D.I.enableDebugDraw=!1),rt.instance.iframeElement&&rt.instance.closeVideo(),t==2&&this.item2Page.selectedIndex==1&&!rt.instance.iframeElement&&rt.instance.createElementVideo()}),this.item0Tab.selectHandler=new Laya.Handler(this,t=>{this.item0Page.selectedIndex=t}),this.item1Tab.selectHandler=new Laya.Handler(this,t=>{this.item1Page.selectedIndex=t,t!==4&&Laya.Physics2D.I?Laya.Physics2D.I.enableDebugDraw=!1:t==4&&Laya.Physics2D.I&&(Laya.Physics2D.I.enableDebugDraw=!0)}),this.item2Tab.selectHandler=new Laya.Handler(this,t=>{switch(this.item2Page.selectedIndex=t,t){case 1:!rt.instance.iframeElement&&rt.instance.createElementVideo();break;case 2:Laya.Scene.open("scenes/uiDemo/page/OpenMainScene.ls",!1);break;case 3:Laya.loader.load("prefab/uiDemo/page/Win.lh").then(e=>{let i=e.create();this.tabPage.parent.addChild(i)});break;case 4:Laya.loader.load("prefab/uiDemo/page/Dialog.lh").then(e=>{e.create().show()});break}t!==1&&rt.instance.iframeElement&&rt.instance.closeVideo()}),this.item3Tab.selectHandler=new Laya.Handler(this,t=>{this.item3Page.selectedIndex=t}),this.item4Tab.selectHandler=new Laya.Handler(this,t=>{this.item4Page.selectedIndex=t})}onDisable(){}};Mc=h([aN("gbAKGLFtQ5WL6-NpVocAEA")],Mc);var{regClass:nN,property:t0}=Laya,un=class extends Laya.Script{constructor(){super(...arguments);this.isPlay=!1}onAwake(){console.log("创建动画模板"),this.createAniTemplate("moveB"),this.createAniTemplate("moveC"),this.createAniTemplate("moveE"),this.createAniTemplate("moveF"),this.createAniTemplate("moveH"),this.createAniTemplate("moveI"),this.createAniTemplate("moveK"),this.createAniTemplate("moveL"),this.aniSource.play(0,!0,"moveB")}onEnable(){this.playAni.on(Laya.Event.MOUSE_DOWN,this,()=>{this.isPlay=!0,this.aniSource.play(0,!0,this.selectAni.selectedLabel)}),this.stopAni.on(Laya.Event.MOUSE_DOWN,this,()=>{this.isPlay=!1,this.aniSource.isPlaying&&this.aniSource.stop()}),this.selectAni.selectHandler=new Laya.Handler(this,()=>{this.isPlay?this.aniSource.play(0,!0,this.selectAni.selectedLabel):this.aniSource.play(0,!1,this.selectAni.selectedLabel)})}createAniTemplate(e,i=8){let a=[];for(let r=0;r<i;r++)a.push("resources/UI/role/atlasAni/139x/"+e+r+".png");Laya.Animation.createFrames(a,e)}onError(e){console.log("加载失败: "+e)}};h([t0({type:Laya.Button})],un.prototype,"playAni",2),h([t0({type:Laya.Button})],un.prototype,"stopAni",2),h([t0({type:Laya.ComboBox})],un.prototype,"selectAni",2),h([t0({type:Laya.Animation})],un.prototype,"aniSource",2),un=h([nN("tmkUlMggQi20FZpy6nC1aw")],un);var{regClass:rN,property:i0}=Laya,mn=class extends Laya.Script{constructor(){super(...arguments);this.isPlay=!1}onEnable(){this.isPlay=!0,this.playAnimation(this.selectAni.selectedLabel),this.playAni.on(Laya.Event.MOUSE_DOWN,this,()=>{this.isPlay=!0,this.playAnimation(this.selectAni.selectedLabel)}),this.stopAni.on(Laya.Event.MOUSE_DOWN,this,()=>{this.isPlay=!1,this.aniSource.isPlaying&&this.aniSource.stop()}),this.selectAni.selectHandler=new Laya.Handler(this,()=>{this.isPlay?this.playAnimation(this.selectAni.selectedLabel):this.playAnimation(this.selectAni.selectedLabel,!1)})}playAnimation(e,i=!0,a=7){let r=[];for(let s=0;s<a;s++)r.push("resources/UI/role/frameAni/"+e+s+".png");this.aniSource.loadImages(r).play(0,i)}};h([i0({type:Laya.Button})],mn.prototype,"playAni",2),h([i0({type:Laya.Button})],mn.prototype,"stopAni",2),h([i0({type:Laya.ComboBox})],mn.prototype,"selectAni",2),h([i0({type:Laya.Animation})],mn.prototype,"aniSource",2),mn=h([rN("8gw7FS4iT1q8EhdN3sWklQ")],mn);var{regClass:sN,property:Fze}=Laya,pD=Laya.Event,oN=Laya.SpineSkeleton,Rc=class extends Laya.Script{constructor(){super(...arguments);this.skinArray=["goblin","goblingirl"];this.skinIndex=0;this.spineAniIndex=6}onEnable(){this.createLayaSpine(),this.createSpine()}createLayaSpine(){this.skeletonNode=this.owner.getChildByName("skeletonNode"),Laya.loader.load("resources/UI/role/spineAni/goblins.sk").then(e=>{this.skeletonAni=e.buildArmature(1),this.skeletonNode.addChild(this.skeletonAni),this.skeletonAni.x=128,this.skeletonAni.y=390,this.spineAniNum=this.skeletonAni.getAnimNum(),this.skeletonAni.play(0,!0),this.changeSkin(),this.skeletonNode.on(pD.CLICK,this,this.changeSkin)})}parseComplete(){}createSpine(){this.spineNode=this.owner.getChildByName("spineNode"),Laya.loader.load("resources/UI/role/spineAni/spineboy-pma.skel",Laya.Loader.SPINE).then(e=>{this.spineAni=new oN,this.spineAni.templet=e,this.spineNode.addChild(this.spineAni),this.spineAni.scale(.3,.3),this.spineAni.pos(220,390),this.spineAniNum=this.spineAni.getAnimNum(),this.spineAni.play(this.spineAniIndex,!0),this.spineNode.on(pD.CLICK,this,this.changeAni)})}spineParseComplete(){}changeAni(){++this.spineAniIndex>=this.spineAniNum&&(this.spineAniIndex=5),this.spineAni.play(this.spineAniIndex,!0,!0)}changeSkin(){this.skeletonAni.showSkinByName(this.skinArray[this.skinIndex]),++this.skinIndex>=this.skinArray.length&&(this.skinIndex=0)}};Rc=h([sN("qTd2xmRXT4i0Re94qly0Lg")],Rc);var{regClass:lN,property:Pc}=Laya,hD=Laya.Event,cN=Laya.Point,Na=class extends Laya.Script{constructor(){super();this.runAniName="runRight,runRDown1,runRDown2,runRDown3,runDown,runLDown3,runLDown2,runLDown1,runLeft,runLUp1,runLUp2,runLUp3,runUp,runRUp3,runRUp2,runRUp1";this.standAniName="right,Rdown,down,Ldown,left,Lup,up,Rup";this.stageMouse=new cN;this.angle=0;this.isMoving=!1;this.isRun=!1}onEnable(){this.createMap(),this.sceneWindow.on(hD.MOUSE_UP,this,this.mouseUp),this.roleAniNode=this.roleAni.create(),this.sceneWindow.addChild(this.roleAniNode),this.roleAniNode.pivot(this.roleAniNode.width/2,this.roleAniNode.height/2+26),this.roleAniNode.scale(.6,.6),this.roleAniNode.x=this.lastX=26*32+16,this.roleAniNode.y=this.lastY=16*32+16,this._animator=this.roleAniNode.getComponent(Laya.Animator2D);let e=this._animator.getDefaultState();console.log(e.name),this.createWallMap()}createWallMap(){Laya.loader.load("resources/tiledMap/map1_32.json").then(()=>{let i=Laya.loader.getRes("resources/tiledMap/map1_32.json").data.layers[2],a=i.data,r=i.width,s=i.height;console.log(a);let o;o=new Array;for(var l=r,c=s,u=0;u<c;u++){o[u]=new Array;for(var p=0;p<l;p++)a[u*l+p]==0?o[u][p]=1:o[u][p]=0}console.log(o),this.graph=new window.Graph(o),this.opts=[],this.opts.closest=!0,this.opts.heuristic=window.astar.heuristics.diagonal})}mouseUp(e){if(this.isMoving)return;this.stageMouse.x=Laya.stage.mouseX,this.stageMouse.y=Laya.stage.mouseY;let i=this.gameMap.globalToLocal(this.stageMouse);console.log(i);var a=this.graph.grid[Math.ceil(this.roleAniNode.y/32)-1][Math.ceil(this.roleAniNode.x/32)-1],r=this.graph.grid[Math.ceil(i.y/32)-1][Math.ceil(i.x/32)-1];console.log(a,r),this._everyPath=window.astar.search(this.graph,a,r,{closest:this.opts.closest}),console.log(this._everyPath),this._everyPath.length>0&&(this.isMoving=!0),Laya.timer.loop(100,this,this.loopfun)}loopfun(){if(this._everyPath.length>0){let e=this._everyPath[0].y*32+16,i=this._everyPath[0].x*32+16;e==this.lastX?i>this.lastY?this.angle=90:this.angle=270:e>this.lastX?this.angle=0:this.angle=180,this.switchAni("run"),this.lastX=e,this.lastY=i,Laya.Tween.to(this.roleAniNode,{x:e,y:i},100),this._everyPath.splice(0,1)}else this.switchAni("stand"),Laya.timer.clear(this,this.loopfun),this.isMoving=!1}createMap(){this.tiledMap=new Laya.TiledMap,this.tiledMap.createMap("resources/tiledMap/map1_32.json",new Laya.Rectangle(0,0,this.sceneWindow.width,this.sceneWindow.height),new Laya.Handler(this,this.completeHandler))}onLoaded(){this.tiledMap.mapSprite().removeSelf(),this.gameMap.addChild(this.tiledMap.mapSprite())}completeHandler(e=null){this.onLoaded()}switchAni(e){if(e=="run"){let i=this.getOrientation(this.angle,this.runAniName);this._animator.play(i),this.isRun=!0}else{this.isRun=!1;let i=this.getOrientation(this.angle,this.standAniName);this.lastAngle!==this.angle&&this._animator.play(i)}}getOrientation(e,i){let a=i.split(","),r=360/a.length;return a[Math.floor(e/r)]}onDisable(){Laya.stage.off(hD.MOUSE_UP,this,this.mouseUp),this.tiledMap&&this.tiledMap.destroy()}};h([Pc({type:Laya.Sprite})],Na.prototype,"gameMap",2),h([Pc({type:Laya.Prefab})],Na.prototype,"roleAni",2),h([Pc({type:"string"})],Na.prototype,"runAniName",2),h([Pc({type:"string"})],Na.prototype,"standAniName",2),h([Pc({type:Laya.Panel})],Na.prototype,"sceneWindow",2),Na=h([lN("zBb5TGy7Swu5_GpFiGzUng")],Na);var{regClass:uN,property:Yze}=Laya,dD=Laya.Rectangle,Nr=class extends Laya.Script{constructor(){super(...arguments);this._rect1=dD.TEMP;this._rect2=dD.TEMP}rectDetection(e,i){return!(e.x>i.x+i.width||e.x+e.width<i.x||e.y>i.y+i.height||e.y+e.height<i.y)}collisionWith(e,i,a){let r=[];if(a==0){var s=Laya.Point.create(),o=e.width/2,l=e.height/2,c=Laya.Point.create(),u,p;s.x=e.x+o,s.y=e.y+l,u=this.rectToRadius(e.width,e.height)}else if(a==2){var d,L;L=this.arrayToPoint(e)}for(let x=0;x<i.length;x++)if(e!=i[x])switch(a){case 0:c.x=i[x].x+i[x].width/2,c.y=i[x].y+i[x].height/2,p=this.rectToRadius(i[x].width,i[x].height),this.circleDetection(s,c,u+p)&&r.push(i[x]);break;case 1:this.rectDetection(e,i[x])&&r.push(i[x]);break;case 2:e.name==="c1"?(d=this.arrayToPoint(i[x]),this.circleAndPolygonDetection(e,d,i[x])&&r.push(i[x])):i[x].name==="c1"?this.circleAndPolygonDetection(i[x],L,e)&&r.push(i[x]):(d=this.arrayToPoint(i[x]),this.polygonDetection(L,d,e,i[x])&&r.push(i[x]));break}return r}circleAndPolygonDetection(e,i,a){let r=this.getSides(i),s=[],o=Laya.Point.create(),l=Laya.Point.create(),c=e.hitArea._hit._cmds[0].radius,u=this.getNodeCoord(i,a);o.x=e.x+e.hitArea._hit._cmds[0].x,o.y=e.y+e.hitArea._hit._cmds[0].y,l=this.getNearestPoint(o,u),s.push(new Laya.Point(l.x-o.x,l.y-o.y));for(let p=0,d=r.length;p<d;p++)s.push(this.perpendicular(r[p]));for(let p=0,d=s.length;p<d;p++){let L=s[p],x=this.getCircleProjection(o,L,c),w=this.getPolygonProjection(u,L);if(!this.isOverlap(x,w))return!1}return!0}getNearestPoint(e,i){let a=i[0],r=this.getDistance(e,a),s,o;for(let l=1;l<i.length;l++)s=i[l],o=this.getDistance(e,s),o<r&&(r=o,a=s);return a}polygonDetection(e,i,a,r){let s=this.getSides(e).concat(this.getSides(i)),o=[],l=this.getNodeCoord(e,a),c=this.getNodeCoord(i,r);for(let u=0,p=s.length;u<p;u++)o.push(this.perpendicular(s[u]));for(let u=0,p=o.length;u<p;u++){let d=o[u],L=this.getPolygonProjection(l,d),x=this.getPolygonProjection(c,d);if(!this.isOverlap(L,x))return!1}return!0}isOverlap(e,i){let a,r;return a=e.min<i.min?e.min:i.min,r=e.max>i.max?e.max:i.max,e.max-e.min+(i.max-i.min)>=r-a}getNodeCoord(e,i){let a=[];for(let r=0;r<e.length;r++){let s=Laya.Point.create();s.x=e[r].x+i.x+i.hitArea._hit._cmds[0].x,s.y=e[r].y+i.y+i.hitArea._hit._cmds[0].y,a.push(s)}return a}getPolygonProjection(e,i){let a=null,r=null;for(let s=0;s<e.length;s++){let o=this.dotProduct(e[s],i)/this.getLength(i);(a===null||o<a)&&(a=o),(r===null||o>r)&&(r=o)}return{min:a,max:r}}getCircleProjection(e,i,a){let r=this.dotProduct(e,i)/this.getLength(i);return{min:r-a,max:r+a}}rectToRadius(e,i){let a;return e==i?a=e/2:a=Math.sqrt(e*e+i*i)/2,a}circleDetection(e,i,a){return Math.sqrt(Math.pow(e.x-i.x,2)+Math.pow(e.y-i.y,2))<=a}circlesCollision(e,i,a,r){let s=this.subtract(e,i),o=this.getCircleProjection(e,s,a),l=this.getCircleProjection(i,s,r);return!!this.isOverlap(o,l)}arrayToPoint(e){let i=[],a=[];if(a=e.hitArea._hit._cmds[0].points,a&&a.length>3)for(let r=0;r<a.length/2;r++)i[r]=Laya.Point.create(),i[r].x=a[r*2],i[r].y=a[r*2+1];return i}perpendicular(e){let i=Laya.Point.create();return i.x=e.y,i.y=-e.x,i}getNormal(e){let i=Math.sqrt(e.x*e.x+e.y*e.y);return new Laya.Point(e.y/i,(0-e.x)/i)}getSides(e){var i=e,a=i.length,r=new Array;if(a>=3){for(var s=1,o=i[0];s<a;s++){let l=i[s];r.push(this.subtract(l,o)),o=l}r.push(this.subtract(i[0],i[a-1]))}return r}getLength(e){return Math.sqrt(e.x*e.x+e.y*e.y)}dotProduct(e,i){return e.x*i.x+e.y*i.y}subtract(e,i){return Laya.Point.create().setTo(e.x-i.x,e.y-i.y)}getDistance(e,i){let a=e.x-i.x,r=e.y-i.y;return Math.sqrt(a*a+r*r)}};Nr=h([uN("naI7Ga3ZQzuwHxZXbiaZEw")],Nr);var a0=class extends Laya.View{};var{regClass:mN,property:Xze}=Laya,pn=class extends a0{constructor(){super();this._detectionType=0;this.collisionNodes=null;pn.i=this}onEnable(){this.collisionNodes=[this.c1,this.p1,this.p2],this._script=this.getComponent(Nr),this.detectionType.selectHandler=new Laya.Handler(this,this.onSelected),this.detectionType.selectedIndex=0}onSelected(e){switch(console.log("onSelected:"+e),this._detectionType=e,e){case 0:this.setCircleLine([this.c11,this.p11,this.p22]);break;case 1:this.setRectLine([this.c11,this.p11,this.p22]);break;case 2:this.c11.graphics.clear(),this.p11.graphics.clear(),this.p22.graphics.clear();break}}collisionWith(e){let i;i=this._script.collisionWith(e,this.collisionNodes,this._detectionType),i.length>0?(i.push(e),this.setLineWidth(i)):this.retsetLineWidth()}setLineWidth(e){for(let i=0;i<e.length;i++)e[i]._graphics._cmds[0].lineWidth=3}retsetLineWidth(){for(let e=0;e<this.collisionNodes.length;e++)this.collisionNodes[e]._graphics._cmds[0].lineWidth=0}setCircleLine(e,i=1,a="#1e00fb"){for(let r=0;r<e.length;r++){e[r].graphics.clear();let s=e[r].width/2,o=e[r].height/2,l=this._script.rectToRadius(e[r].width,e[r].height);e[r].graphics.drawCircle(s,o,l,null,a,i)}}setRectLine(e,i=1,a="#1e00fb"){for(let r=0;r<e.length;r++)e[r].graphics.clear(),e[r].graphics.drawRect(e[r].x,e[r].y,e[r].width,e[r].height,null,a,i)}};pn=h([mN("RrGHZH_SROCrF5XxFa05sg")],pn);var{regClass:pN,property:Lo}=Laya,Or=Laya.Event,fD=Laya.Point,pa=class extends Laya.Script{constructor(){super();this.runAniName="runRight,runRDown1,runRDown2,runRDown3,runDown,runLDown3,runLDown2,runLDown1,runLeft,runLUp1,runLUp2,runLUp3,runUp,runRUp3,runRUp2,runRUp1";this.standAniName="right,Rdown,down,Ldown,left,Lup,up,Rup";this.stageMouse=new fD;this.axisPivot=new fD;this.angle=0;this.radian=0;this.isMoving=!1;this.isRun=!1;this.mLastX=0;this.mLastY=0}onEnable(){this.createMap(),this.joystickAxis=this.joystickBG.getChildByName("joystickAxis"),this.maxDistance=this.joystickBG.width-this.joystickAxis.width,this.axisPivot.x=this.joystickAxis.x,this.axisPivot.y=this.joystickAxis.y,this.sceneWindow.on(Or.MOUSE_DOWN,this,this.mouseDown),this.sceneWindow.on(Or.MOUSE_MOVE,this,this.mouseMove),this.sceneWindow.on(Or.MOUSE_UP,this,this.mouseUp),this.sceneWindow.on(Or.MOUSE_OUT,this,this.mouseUp),this.roleAniNode=this.roleAni.create(),this.sceneWindow.addChild(this.roleAniNode),this.roleAniNode.pivot(this.roleAniNode.width/2,this.roleAniNode.height/2),this.roleAniNode.x=this.sceneWindow.width/2,this.roleAniNode.y=this.sceneWindow.height/2,this._animator=this.roleAniNode.getComponent(Laya.Animator2D);let e=this._animator.getDefaultState();console.log(e.name)}createMap(){this.tiledMap=new Laya.TiledMap,this.tiledMap.createMap("resources/tiledMap/desert_new.json",new Laya.Rectangle(0,0,this.sceneWindow.width,this.sceneWindow.height),new Laya.Handler(this,this.completeHandler))}onLoaded(){this.tiledMap.mapSprite().removeSelf(),this.gameMap.addChild(this.tiledMap.mapSprite())}completeHandler(e=null){this.onLoaded()}mouseDown(e){this.touchId=e.touchId,this.isMoving=!0,this.updateJoystickPoint()}updateJoystickPoint(){this.stageMouse.x=Laya.stage.mouseX,this.stageMouse.y=Laya.stage.mouseY;let e=this.joystickBG.globalToLocal(this.stageMouse),i=e.x-this.joystickAxis.width/2,a=e.y-this.joystickAxis.height/2;this.radian=Math.atan2(a-this.axisPivot.y,i-this.axisPivot.x),this.lastAngle=this.angle,this.angle=Math.round(this.radian*180/Math.PI*10)/10,this.angle<0&&(this.angle+=360),this.getDistance(this.joystickBG.width/2,this.joystickBG.height/2,e.x,e.y)>this.maxDistance&&this.lastAngle!==this.angle?(this.joystickAxis.x=Math.floor(Math.cos(this.radian)*this.maxDistance)+this.axisPivot.x,this.joystickAxis.y=Math.floor(Math.sin(this.radian)*this.maxDistance)+this.axisPivot.y):this.joystickAxis.pos(e.x-this.joystickAxis.width/2,e.y-this.joystickAxis.height/2),this.switchAni("run")}switchAni(e){if(e=="run"){let i=this.getOrientation(this.angle,this.runAniName);i!==this.lastRunAniName&&(this.lastRunAniName=i,this._animator.play(i)),this.isRun=!0}else{this.isRun=!1;let i=this.getOrientation(this.angle,this.standAniName);this.lastAngle!==this.angle&&this._animator.play(i)}}mouseUp(e){e.touchId==this.touchId&&(this.touchId=null,this.isMoving=!1,this.joystickAxis.pos(this.axisPivot.x,this.axisPivot.y),this.switchAni("stand"))}mouseMove(e){e.touchId==this.touchId&&this.updateJoystickPoint()}getOrientation(e,i){let a=i.split(","),r=360/a.length;return a[Math.floor(e/r)]}onUpdate(){this.isMoving&&this.updateRoleMove()}updateRoleMove(){this.switchAni("run");let e=Math.cos(this.radian)*2*5,i=Math.sin(this.radian)*2*5;this.mLastX+=e,this.mLastY+=i,console.log("mLastX: "+this.mLastX,", mLastY: "+this.mLastY),this.tiledMap.moveViewPort(this.mLastX,this.mLastY)}getDistance(e,i,a,r){let s=e-a,o=i-r;return Math.sqrt(s*s+o*o)}onDisable(){Laya.stage.off(Or.MOUSE_DOWN,this,this.mouseDown),Laya.stage.off(Or.MOUSE_UP,this,this.mouseUp),Laya.stage.off(Or.MOUSE_MOVE,this,this.mouseMove),this.tiledMap&&this.tiledMap.destroy()}};h([Lo(Laya.Sprite)],pa.prototype,"gameMap",2),h([Lo(Laya.Prefab)],pa.prototype,"roleAni",2),h([Lo({type:"string"})],pa.prototype,"runAniName",2),h([Lo({type:"string"})],pa.prototype,"standAniName",2),h([Lo({type:Laya.Panel})],pa.prototype,"sceneWindow",2),h([Lo(Laya.Image)],pa.prototype,"joystickBG",2),pa=h([pN("k2DFVaFIQEyMRaElgOWsVw")],pa);var n0=class extends Laya.Box{};var{regClass:hN}=Laya,Nc=class extends n0{constructor(){super();this.lastIndex=-1}onEnable(){let e="resources/json/bagList.json";Laya.loader.fetch(e,"json").then(i=>{i.bagList&&i.bagList.length>0&&(this.bagList.array=i.bagList,this.bagList.renderHandler=new Laya.Handler(this,this.onListRender),this.bagList.selectHandler=new Laya.Handler(this,this.onListSelect),this.bagList.mouseHandler=new Laya.Handler(this,this.onListMouse),this.bagList.vScrollBarSkin="")})}onListRender(e,i){i>this.bagList.array.length||i<0}onListSelect(e){this.tips.visible=!0,this.bagList.array[e].listItemBG={skin:"resources/UI/images/bg/bg100-1.png"},this.lastIndex!==-1&&(this.bagList.array[this.lastIndex].listItemBG={skin:"resources/UI/images/bg/bg100-0.png"}),this.lastIndex=e,this.itemImg.skin=this.bagList.array[e].listItemImg.skin,this.itemNumber.text="数量 "+this.bagList.array[e].listItemNumber.text,this.itemReadme.text=this.bagList.array[e].readme}onListMouse(e,i){}onDisable(){}};Nc=h([hN("fimeRTYXT46eMH6komwhJQ")],Nc);var{regClass:dN,property:sw}=Laya,ir=class extends Laya.Script{constructor(){super()}onEnable(){var e=this.getDataSourece();Laya.loader.load("prefab/ComboList.lh").then(i=>{let a=i.create();this.comboList=a,this.comboList.array=e,this.comboList.repeatY=e.length,this.combo2.list=this.comboList,this.combo2.list.width=this.combo2.width,this.combo2.list.hScrollBarSkin="",this.combo2.selectHandler=new Laya.Handler(this,this.onSelected2)}),this.combo1.selectHandler=new Laya.Handler(this,this.onSelected1)}onSelected1(e){this.selectedText.text="您选中了："+this.combo1.selectedLabel}onSelected2(e){this.selectedText.text="您选中了："+(e<0?"":this.comboList.array[e].label)}getDataSourece(){for(var e=[],i=0;i<10;i++)e[i]={optText:{text:"选项"+(i+1)}};return e}onDisable(){}};h([sw({type:Laya.ComboBox})],ir.prototype,"combo1",2),h([sw({type:Laya.ComboBox})],ir.prototype,"combo2",2),h([sw({type:Laya.Label})],ir.prototype,"selectedText",2),ir=h([dN("M6bGyqDSRCGU3TkvNeqvRw")],ir);var r0=class extends Laya.View{};var{regClass:fN}=Laya,Oc=class extends r0{onEnable(){this.hList.array=this.getListDataSource(),this.hList.scrollTo(1);let e=this.hList.cells[1].getChildByName("icon");e.scaleX=e.scaleY=2,this.hList.scrollBar.on(Laya.Event.CHANGE,this,this.onScrollBarChange),this.leftLimit=this.getLeftLimit(),this.rightLimit=this.getRightLimit()}onScrollBarChange(){var e=this.hList.scrollBar.value,i=this.hList.array;if(e>this.leftLimit){var a=i.shift();i[i.length]=a,this.hList.array=i,this.hList.scrollBar.value=e-this.hList.cells[0].width-this.hList.spaceX,this.iconTweenToLeft()}else e<this.rightLimit&&(a=i.pop(),i.unshift(a),this.hList.array=i,this.hList.scrollBar.value=e+this.hList.cells[0].width+this.hList.spaceX,this.iconTweenToRight())}iconTweenToLeft(e=200){let i=this.hList.cells[0].getChildByName("icon");i.scaleX=i.scaleY=2,Laya.Tween.to(i,{scaleX:1,scaleY:1},e);let a=this.hList.cells[1].getChildByName("icon");a.scaleX=a.scaleY=1,Laya.Tween.to(a,{scaleX:2,scaleY:2},e)}iconTweenToRight(e=200){let i=this.hList.cells[1].getChildByName("icon");i.scaleX=i.scaleY=2,Laya.Tween.to(i,{scaleX:1,scaleY:1},e);let a=this.hList.cells[2].getChildByName("icon");a.scaleX=a.scaleY=1,Laya.Tween.to(a,{scaleX:2,scaleY:2},e)}getRightLimit(){return this.hList.cells[0].width-this.hList.spaceX}getLeftLimit(){return this.hList.cells[0].width*2+this.hList.spaceX}getListDataSource(e=5){let i=[];for(let a=0;a<e;a++)i[a]={},i[a].icon={skin:`resources/UI/role/r${a}.png`};return i}};Oc=h([fN("WFag7yYwR9q-iI31OJUedg")],Oc);var{regClass:yN,property:s0}=Laya,hn=class extends Laya.Script{constructor(){super();this.optStatus=[];this.timestampFormat=(e,i)=>{let a=i?new Date(i):new Date,r={"M+":a.getMonth()+1,"D+":a.getDate(),"h+":a.getHours(),"m+":a.getMinutes(),"s+":a.getSeconds(),"S+":a.getMilliseconds()};new RegExp("(Y+)").test(e)&&(e=e.replace(RegExp.$1,(a.getFullYear()+"").substr(4-RegExp.$1.length)));for(var s in r)new RegExp("("+s+")").test(e)&&(e=e.replace(RegExp.$1,RegExp.$1.length==1?r[s]:("00"+r[s]).substr((""+r[s]).length)));return e}}onEnable(){let e="resources/json/mailList.json";Laya.loader.fetch(e,"json").then(i=>{let a=i.mailList;a&&a.length>0&&(this.mailList.array=a,this.mailList.mouseHandler=new Laya.Handler(this,this.onListMouse),this.mailList.repeatY=a.length,this.mailList.vScrollBarSkin=""),this.addMail.on(Laya.Event.CLICK,this,this.addMialItem),this.selectDel.on(Laya.Event.CLICK,this,this.listSelectDel),this.selectFlag.on(Laya.Event.CLICK,this,this.listSelectFlag)})}listSelectFlag(){if(this.optStatus.length>0){for(let e=0;e<this.optStatus.length;e++){let i=this.optStatus[e];this.mailList.array[i].flag=1,this.mailList.array[i].flagStatus={skin:"resources/UI/images/comp/img_mail_open.png"},this.mailList.array[i].flagBtn={label:"标为未读",labelColors:"#3277f3,#3277f3,#3277f3"}}this.mailList.refresh(),Laya.Scene.open("scenes/uiDemo/Msg.ls",!1,{text:"已成功标记"})}else Laya.Scene.open("scenes/uiDemo/Msg.ls",!1,{text:"没有勾选项，请先勾选"})}listSelectDel(){if(this.optStatus.length>0){this.optStatus.sort(function(e,i){return i-e});for(let e=0;e<this.optStatus.length;e++)this.mailList.array.splice(this.optStatus[e],1);this.optStatus=[],this.mailList.refresh(),Laya.Scene.open("scenes/uiDemo/Msg.ls",!1,{text:"已成功删除"})}else Laya.Scene.open("scenes/uiDemo/Msg.ls",!1,{text:"没有勾选项，请先勾选"})}addMialItem(){var e=this.mailList.startIndex+1;let i={mailTitle:{text:"这里是新增加的邮件"+e},mailDateTime:{text:this.timestampFormat("YYYY-MM-DD hh:mm")},opt:{visible:!1},flagStatus:{skin:"resources/UI/images/comp/img_mail.png"},flagBtn:{label:"标为已读",labelColors:"#000000,#000000,#000000"}};if(this.mailList.array.splice(e,0,i),this.optStatus.length>0)for(let a=0;a<this.optStatus.length;a++)this.optStatus[a]>=e&&(this.optStatus[a]+=1);this.mailList.refresh()}onListMouse(e,i){if(e.type==Laya.Event.CLICK){var a=this.optStatus.indexOf(i);switch(e.target.name){case"optBG":a===-1?(this.mailList.array[i].opt={visible:!0},this.optStatus.push(i)):(this.mailList.array[i].opt={visible:!1},this.optStatus.splice(a,1)),this.mailList.refresh();break;case"mailTitle":Laya.Scene.open("scenes/uiDemo/Dialog.scene",!1,{title:this.mailList.array[i].mailTitle.text,text:"邮件内容，此处省略1000字……………………"}),this.mailList.array[i].flag=1,this.mailList.array[i].flagStatus={skin:"resources/UI/images/comp/img_mail_open.png"},this.mailList.array[i].flagBtn={label:"标为未读",labelColors:"#3277f3,#3277f3,#3277f3"},this.mailList.refresh();break;case"flagBtn":this.mailList.array[i].flag===1?(this.mailList.array[i].flag=0,this.mailList.array[i].flagStatus={skin:"resources/UI/images/comp/img_mail.png"},this.mailList.array[i].flagBtn={label:"标为已读",labelColors:"#000000,#000000,#000000"}):(this.mailList.array[i].flag=1,this.mailList.array[i].flagStatus={skin:"resources/UI/images/comp/img_mail_open.png"},this.mailList.array[i].flagBtn={label:"标为未读",labelColors:"#3277f3,#3277f3,#3277f3"}),this.mailList.refresh();break;case"delBtn":if(this.mailList.array.splice(i,1),a>-1){this.optStatus.splice(a,1);for(let r=a;r<this.optStatus.length;r++)this.optStatus[r]-=1}this.mailList.refresh(),Laya.Scene.open("scenes/uiDemo/Msg.ls",!1,{text:"删除成功"});break}}}};h([s0({type:Laya.List})],hn.prototype,"mailList",2),h([s0({type:Laya.Button})],hn.prototype,"addMail",2),h([s0({type:Laya.Button})],hn.prototype,"selectDel",2),h([s0({type:Laya.Button})],hn.prototype,"selectFlag",2),hn=h([yN("HzpJPDUEQN69Xg1VasHb-w")],hn);var{regClass:bN,property:_o}=Laya,ha=class extends Laya.Script{constructor(){super();this.scrollBarIsStop=!1;this.msgIdNow=1;this.itemIsOpen=!1;this.itemOpenId=-1;this.redHotStatus=[];this.mouseDown=!1}onEnable(){this.refreshList.array=this.createListData(9),this.refreshList.repeatY=this.refreshList.array.length,this.refreshList.vScrollBarSkin="",this.toLine.on(Laya.Event.CLICK,this,this.onToLineBtn),this.toTop.on(Laya.Event.CLICK,this,this.onToTopBtn),this.toBottom.on(Laya.Event.CLICK,this,this.onToBottomBtn),this.refreshList.on(Laya.Event.MOUSE_UP,this,this.stageOnMouseUp),this.refreshList.on(Laya.Event.MOUSE_OUT,this,this.stageOnMouseUp),this.refreshList.scrollBar.stopMoveLimit=this.scrollBarIsStopBind.bind(this),this.refreshLimit("dragTopLimit",80),this.refreshLimit("dragBottomLimit",80,20),this.refreshList.mouseHandler=new Laya.Handler(this,this.onListMouse)}stageOnMouseUp(){this.mouseDown=!1}refreshLimit(e,i,a=0,r=2e3){e==="dragTopLimit"?this.refreshList.scrollBar.topMoveLimit=i:e==="dragBottomLimit"&&(this.refreshList.scrollBar.bottomMoveLimit=i),this.refreshList.scrollBar.on(e,this,()=>{if(console.log("达到了滚动限制:"+e),this.refreshLoading.visible=!0,e==="dragTopLimit"){this.refreshLoading.bottom=NaN,this.refreshLoading.top=a;var s=this.createListData(5,"顶部新增的标题");s=s.concat(this.refreshList.array);var o=0+5,l=0;if(this.redHotStatus.length>0)for(let c=0;c<this.redHotStatus.length;c++)this.redHotStatus[c]+=5}else if(e==="dragBottomLimit"){this.refreshList.scrollBar.disableDrag=!0,this.refreshLoading.top=NaN,this.refreshLoading.bottom=a;var s=this.createListData(5,"底部新增的标题");s=this.refreshList.array.concat(s);var o=this.refreshList.array.length-1,l=o+5}this.scrollBarIsStop=!0,Laya.timer.once(r,this,()=>{this.refreshList.array=s,this.refreshList.scrollTo(l),this.refreshList.selectedIndex=o,this.scrollBarIsStop=!1,this.refreshList.scrollBar.backToNormal(),this.refreshLoading.visible=!1})})}onListMouse(e,i){e.type==Laya.Event.MOUSE_DOWN&&(this.mouseDown=!0,this.itemIsOpen?(this.itemIsOpen=!1,this.itemOpenId=-1,Laya.Tween.to(this.openedItem,{x:0},500,null,Laya.Handler.create(this,()=>{this.refreshList.scrollBar.disableDrag=!1}))):(this.moveLastPos=e.target.globalToLocal(new Laya.Point(Laya.stage.mouseX,Laya.stage.mouseY)),e.target.on(Laya.Event.MOUSE_MOVE,this,this.onItemBoxMouseMove,[e.target,i]))),e.type==Laya.Event.MOUSE_UP&&(this.mouseDown=!1,this.itemOnMouseUp()),e.type==Laya.Event.CLICK&&(e.target.name=="flag"&&this.onClickFlag(i),e.target.name=="del"&&this.onClickDel(i))}itemOnMouseUp(){if(this.itemIsOpen){var e;this.openedItem.x<-80?e=-262:(this.itemIsOpen=!1,e=0),e!==this.openedItem.x&&Laya.Tween.to(this.openedItem,{x:e},500),this.refreshList.scrollBar.disableDrag=!1,this.itemOpenId!==-1&&(this.openedItem.off(Laya.Event.MOUSE_MOVE,this,this.onItemBoxMouseMove),this.itemOpenId=-1)}}onClickFlag(e){var i=this.redHotStatus.indexOf(e);i==-1?(this.refreshList.array[e].avatar={},this.refreshList.array[e].avatar.redHot={visible:!0},this.refreshList.array[e].flag={flagText:{text:"标记已读"}},this.redHotStatus.push(e)):(this.refreshList.array[e].avatar={redHot:{visible:!1}},this.refreshList.array[e].flag={flagText:{text:"标记未读"}},this.redHotStatus.splice(i,1)),this.refreshList.refresh()}onClickDel(e){this.refreshList.array.splice(e,1),this.itemOpenId=-1;var i=this.redHotStatus.indexOf(e);if(i>-1&&this.redHotStatus.splice(e,1),this.redHotStatus.length>0)for(let a=0;a<this.redHotStatus.length;a++)this.redHotStatus[a]>e&&(this.redHotStatus[a]+=1);this.refreshList.refresh()}onItemBoxMouseMove(e,i){if(this.mouseDown){let a=e.globalToLocal(new Laya.Point(Laya.stage.mouseX,Laya.stage.mouseY)),r=this.moveLastPos.x-a.x,s=this.moveLastPos.y-a.y;Math.abs(r)>Math.abs(s)&&!this.itemIsOpen&&(this.openedItem=e,this.itemIsOpen=!0,this.refreshList.scrollBar.disableDrag=!0,this.itemOpenId=i),this.itemIsOpen&&(this.openedItem.x-=r,this.openedItem.x<-262?this.openedItem.x=-262:this.openedItem.x>0&&(this.openedItem.x=0))}else this.refreshList.scrollBar.disableDrag=!1}scrollBarIsStopBind(){return this.scrollBarIsStop}onToLineBtn(){let e=parseInt(this.lineNumber.text)-1;this.refreshList.scrollTo(e),e<this.refreshList.array.length&&(this.refreshList.selectedIndex=e)}onToTopBtn(){this.refreshList.scrollTo(0),this.refreshList.selectedIndex=0}onToBottomBtn(){let e=this.refreshList.array.length-1;this.refreshList.scrollTo(e),this.refreshList.selectedIndex=e}createListData(e=5,i="初始测试标题"){let a=new Date,r=a.getHours()<10?"0"+a.getHours():""+a.getHours(),s=a.getMinutes()<10?"0"+a.getMinutes():""+a.getMinutes();for(var o=[],l=0;l<e;l++){let c={text:r+" : "+s};o[l]={},o[l].msgTime=c,o[l].msgTitle={text:i+(this.msgIdNow+l)},o[l].avatar={redHot:{visible:!1}}}return this.msgIdNow+=l,o}onDisable(){}};h([_o({type:Laya.List})],ha.prototype,"refreshList",2),h([_o({type:Laya.Button})],ha.prototype,"toLine",2),h([_o({type:Laya.Button})],ha.prototype,"toTop",2),h([_o({type:Laya.Button})],ha.prototype,"toBottom",2),h([_o({type:Laya.Box})],ha.prototype,"refreshLoading",2),h([_o({type:Laya.Label})],ha.prototype,"lineNumber",2),ha=h([bN("m0TR8w0gTbWSvHbZTzrORA")],ha);var o0=class extends Laya.View{};var{regClass:gN,property:Lje}=Laya,Hc=class extends o0{onEnable(){this.tree1.xml=this.getTreeData(!0),this.tree2.xml=this.getTreeData(!1)}getTreeData(t){let e="<data>";if(t)e+="<dir itemLabel='一级目录一' isOpen='false'><file itemLabel='二级子项1 '/><file itemLabel='二级子项2 '/><file itemLabel='二级子项3 '/><file itemLabel='二级子项4 '/><file itemLabel='二级子项5 '/></dir><dir itemLabel='一级目录二' isOpen='true'><file itemLabel='二级子项1 '/><file itemLabel='二级子项2 '/><file itemLabel='二级子项3 '/></dir><dir itemLabel='一级目录三' isOpen='false'><file itemLabel='二级子项1 '/><file itemLabel='二级子项2 '/><file itemLabel='二级子项3 '/><file itemLabel='二级子项4 '/><file itemLabel='二级子项5 '/></dir><file itemLabel='一级子项1 '/><file itemLabel='一级子项2 '/>";else for(let i=0;i<5;i++){e+="<item title='目录"+(i+1)+"' isOpen='true'>";for(let a=0;a<5;a++)e+="<subpage title='子项标题"+(a+1)+"' />";e+="</item>"}return e+="</data>",new Laya.XML(e)}};Hc=h([gN("GJWtWFwsQoqNpjA1k42SpQ")],Hc);var l0=class extends Laya.Scene{};var{regClass:LN,property:Eje}=Laya,Uc=class extends l0{onEnable(){}onDisable(){}};Uc=h([LN("JQ1fkq03ThewqQWRXQPgmw")],Uc);var{regClass:_N,property:Cje}=Laya,Hr=class extends Laya.Script{constructor(){super()}baseUI(e){this.window=e,this.searchCloseButton(e)}searchCloseButton(e){for(let i=0;i<e.numChildren;i++){let a=e.getChildAt(i);a instanceof Laya.Button&&a.name=="closeBtn"?(a.on(Laya.Event.MOUSE_DOWN,this,()=>{this.window.close()}),console.log("baseUI 发现closeBtn，统一添加关闭事件")):this.searchCloseButton(a)}}onDisable(){}};Hr=h([_N("7Fkz4T7JQ5ujwNcIx9lGNA")],Hr);var{regClass:vN,property:Aje}=Laya,Vc=class extends Hr{constructor(){super()}onEnable(){this.ui=this.owner,this.baseUI(this.ui)}onDisable(){}};Vc=h([vN("utN7JQs_T3iw6KqWT-beFQ")],Vc);var c0=class extends Laya.Box{};var{regClass:xN,property:Pje}=Laya,yD=Laya.Event,bD=Laya.Mouse,Fc=class extends c0{constructor(){super()}onEnable(){Laya.Browser.onPC?(this.panel.on(yD.MOUSE_OVER,this,()=>{bD.cursor="move"}),this.panel.on(yD.MOUSE_OUT,this,()=>{bD.cursor="auto"})):this.topLab.text="背景可拖拽，双指缩放改变大小"}};Fc=h([xN("9s1SW9WKRrSodo6JY27VSw")],Fc);var{regClass:IN,property:u0}=Laya,dn=class extends Laya.Script{constructor(){super()}onEnable(){this.graphics=this.graphicsSprite.graphics,Laya.timer.loop(2e3,this,()=>{this.changeImgSkin(),this.changeSpriteTexture(),this.changeFillTexture(),this.changeTexture()})}changeImgSkin(){this.Img.skin=this.randomImg()}changeSpriteTexture(){this.spImg.loadImage(this.randomImg(!0,6,5))}changeFillTexture(){this.graphics.clear();let e=this.randomImg(!0,4);Laya.loader.load(e).then(i=>{this.graphics.fillTexture(i,0,0,1,1)})}changeTexture(){this.textureImg.graphics.clear();let e=Laya.loader.getRes(this.randomImg(!0,8));this.textureImg.graphics.drawTexture(e)}randomImg(e=!1,i=8,a=1){let r=Math.floor(Math.random()*(i-a+1))+a;return e?"resources/UI/role/m"+r+".png":"resources/UI/role/w"+r+".png"}onDisable(){}};h([u0({type:Laya.Image})],dn.prototype,"Img",2),h([u0({type:Laya.Sprite})],dn.prototype,"spImg",2),h([u0({type:Laya.Sprite})],dn.prototype,"graphicsSprite",2),h([u0({type:Laya.Sprite})],dn.prototype,"textureImg",2),dn=h([IN("ulgCMWfCQKiihSJynpbJFg")],dn);var m0=class extends Laya.View{};var{regClass:EN,property:Gje}=Laya,p0=Laya.Event,Gc=class extends m0{onEnable(){this._hitArea.on(p0.MOUSE_DOWN,this,()=>{this._hitArea.off(p0.MOUSE_MOVE,this,this.bg3MaskMove),this._hitArea.startDrag(),this._hitArea.on(p0.MOUSE_MOVE,this,this.bg3MaskMove)}),this._mask.on(p0.MOUSE_MOVE,this,this.maskMove)}bg3MaskMove(t){t.stopPropagation(),this.bg3Mask.x=this._hitArea.x,this.bg3Mask.y=this._hitArea.y}maskMove(){let t=this.globalToLocal(new Laya.Point(Laya.stage.mouseX,Laya.stage.mouseY)),e=t.x-this._mask.width/this.bg2.scaleX/2,i=t.y-this._mask.height/this.bg2.scaleY/2;e>80&&i>80&&(this._mask.x=t.x-this._mask.width/this.bg2.scaleX/2,this._mask.y=t.y-this._mask.height/this.bg2.scaleY/2,this.bg2.x=(-t.x-this._mask.width/2)*(this.bg2.scaleX-1),this.bg2.y=(-t.y-this._mask.height/2)*(this.bg2.scaleY-1))}};Gc=h([EN("zt0rBsEST9KVJgcimd7SFA")],Gc);var{regClass:wN,property:Ur}=Laya,ji=class extends Laya.Script{constructor(){super()}onEnable(){this.changeMouseCursor(),this.throughTab.selectHandler=new Laya.Handler(this,this.onSwitchTab)}onSwitchTab(e){switch(e){case 0:this.leftBg.hitTestPrior=!0,this.rightBg.hitTestPrior=!0;break;case 1:this.leftBg.hitTestPrior=!1,this.rightBg.hitTestPrior=!1;break}}changeMouseCursor(){this.leftBg.on(Laya.Event.MOUSE_OVER,this,()=>{Laya.Mouse.cursor="move"}),this.leftBg.on(Laya.Event.MOUSE_OUT,this,()=>{Laya.Mouse.cursor="auto"}),this.rightBg.on(Laya.Event.MOUSE_OVER,this,()=>{Laya.Mouse.cursor="move"}),this.rightBg.on(Laya.Event.MOUSE_OUT,this,()=>{Laya.Mouse.cursor="auto"}),this.leftBg.on(Laya.Event.CLICK,this,()=>{Laya.Scene.open("scenes/uiDemo/Msg.ls",!1,{text:"点击了左侧的可点击区域",point:{x:Laya.stage.mouseX-100}}),console.log("click "+this.leftBg.name)}),this.rightBg.on(Laya.Event.CLICK,this,()=>{Laya.Scene.open("scenes/uiDemo/Msg.ls",!1,{text:"点击了右侧的可点击区域",point:{x:Laya.stage.mouseX-120}}),console.log("click "+this.rightBg.name)}),this.btn1.on(Laya.Event.CLICK,this,e=>{e.stopPropagation(),Laya.Scene.open("scenes/uiDemo/Msg.ls",!1,{text:"点击了测试按钮1"}),console.log("click btn1")}),this.btn2.on(Laya.Event.CLICK,this,e=>{e.stopPropagation(),Laya.Scene.open("scenes/uiDemo/Msg.ls",!1,{text:"点击了测试按钮2"}),console.log("click btn2")}),this.close1.on(Laya.Event.CLICK,this,e=>{e.stopPropagation(),Laya.Scene.open("scenes/uiDemo/Msg.ls",!1,{text:"点击了左侧关闭按钮",point:{x:Laya.stage.mouseX-100}}),console.log("click "+this.close1.name)}),this.close2.on(Laya.Event.CLICK,this,e=>{e.stopPropagation(),Laya.Scene.open("scenes/uiDemo/Msg.ls",!1,{text:"点击了右侧关闭按钮",point:{x:Laya.stage.mouseX-120}}),console.log("click "+this.close2.name)})}onDisable(){}};h([Ur({type:Laya.Tab})],ji.prototype,"throughTab",2),h([Ur({type:Laya.Sprite})],ji.prototype,"leftBg",2),h([Ur({type:Laya.Sprite})],ji.prototype,"rightBg",2),h([Ur({type:Laya.Button})],ji.prototype,"btn1",2),h([Ur({type:Laya.Button})],ji.prototype,"btn2",2),h([Ur({type:Laya.Sprite})],ji.prototype,"close1",2),h([Ur({type:Laya.Sprite})],ji.prototype,"close2",2),ji=h([wN("AmLUThtNSaW6zL9W205gyg")],ji);var{regClass:TN,property:h0}=Laya,fn=class extends Laya.Script{onEnable(){this.bTop.getComponent(Laya.BoxCollider).width=this.bTop.width,this.bBottom.getComponent(Laya.BoxCollider).width=this.bBottom.width,this.bRight.getComponent(Laya.BoxCollider).height=this.bRight.height,this.bLeft.getComponent(Laya.BoxCollider).height=this.bLeft.height}};h([h0({type:Laya.Image})],fn.prototype,"bTop",2),h([h0({type:Laya.Image})],fn.prototype,"bBottom",2),h([h0({type:Laya.Image})],fn.prototype,"bRight",2),h([h0({type:Laya.Image})],fn.prototype,"bLeft",2),fn=h([TN("jp5l8WZtQLuVyfU4ljEFyQ")],fn);var d0=class extends Laya.View{};var{regClass:CN,property:Jje}=Laya,Kc=class extends d0{onEnable(){this.testProgress()}testProgress(){this.loading2.value=.01,this.loadText.text="资源加载中……",Laya.timer.loop(100,this,this.changeProgress)}changeProgress(){this.loading2.value+=.05,this.loading2.value==1&&(this.loadText.text="资源加载完成",Laya.timer.clear(this,this.changeProgress),Laya.timer.once(3e3,this,()=>{this.testProgress()}))}};Kc=h([CN("9w97n2rXRjiACN_vzizQPw")],Kc);var{regClass:SN,property:t$e}=Laya,ar=class extends Laya.Script{constructor(){super()}onStart(){this._anim=this.owner.getComponent(Laya.Animator)}isPlayanimaByName(e=0){let i=this._anim.getControllerLayer(e);if(i==null)return!1;let a=i.getCurrentPlayState();return a==null?!1:a.animatorState.clip.islooping?!0:a._finish}isSameByName(e,i=0){let a=this._anim.getControllerLayer(i);if(a==null)return!1;let r=a.getCurrentPlayState();if(r==null)return!1;if(r.animatorState.name==e)return!0}playAnim(e,i=!1){if(i){if(this.isSameByName(e))return;this._anim.play(e,0,0);return}this.isPlayanimaByName()||this._anim.play(e,0,0)}};ar=h([SN("q0uAMn-DTUm70T4fGtxGlw")],ar);var bt=Laya.InputManager,{regClass:DN,property:c$e}=Laya,qc=class extends Laya.Script{constructor(){super(...arguments);this.currRockerBar=null;this.maxDistance=80;this.isMouseDown=!1;this.mouseDownPosition=new Laya.Point;this._currentMouse=new Laya.Point;this.initRockerBarPosition=new Laya.Point;this.key1Pressed=!1;this.key2Pressed=!1;this.key3Pressed=!1;this.key4Pressed=!1;this.key5Pressed=!1;this.key6Pressed=!1;this.key7Pressed=!1;this.key8Pressed=!1;this.directionOffset=0;this.isKeyRun=!1}onEnable(){Laya.InputManager.multiTouchEnabled=!0}onStart(){this.currRockerBar=this.owner.getChildByName("freebar"),this.img_freebar_arrow=this.owner.getChildByName("img_freebar_arrow"),this.freetrack=this.owner.getChildByName("freetrack"),this.img_arrow_left=this.freetrack.getChildByName("img_arrow_left"),this.img_arrow_right=this.freetrack.getChildByName("img_arrow_right"),this.img_arrow_up=this.freetrack.getChildByName("img_arrow_up"),this.img_arrow_down=this.freetrack.getChildByName("img_arrow_down"),this.img_freebar_arrow.visible=!1,Laya.Browser.onPC?this.freetrack.visible=!0:this.img_arrow_left.visible=this.img_arrow_right.visible=this.img_arrow_up.visible=this.img_arrow_down.visible=!1,this.initialise()}initialise(){this.initRockerBarPosition.setTo(this.currRockerBar.x,this.currRockerBar.y),this.currRockerBar.on(Laya.Event.MOUSE_DOWN,this,this.onMouseDown),Laya.stage.on(Laya.Event.MOUSE_MOVE,this,this.onMouseMove),Laya.stage.on(Laya.Event.MOUSE_UP,this,this.onMouseUp)}onSkillKeyDown(e,i,a){switch(e.stopPropagation(),i){case 1:this.key1Pressed=a;break;case 2:this.key2Pressed=a;break;case 3:this.key3Pressed=a;break}}onMouseDown(e){B.instance.stopAll||(e.stopPropagation(),this.isMouseDown=!0,this.currRockerBar.selected=!0,Laya.Browser.onPC||(this.freetrack.visible=!0),this.mouseDownPosition.setTo(this.owner.mouseX,this.owner.mouseY),console.log("onMouseDown this.owner.mouse: ",this.owner.mouseX,this.owner.mouseY),this.isKeyRun=!1,this.touchId=e.touchId)}onMouseUp(e){this.isMouseDown&&this.endClick(e)}endClick(e){this.isMouseDown=!1,this.currRockerBar.x=this.initRockerBarPosition.x,this.currRockerBar.y=this.initRockerBarPosition.y,this.currRockerBar.selected=!1,this.setDir(-4)}onMouseMove(e){if(!this.isMouseDown||!this.currRockerBar)return;e.stopPropagation(),this._currentMouse.setTo(e.stageX,e.stageY);let i=this.owner.globalToLocal(this._currentMouse,!1),a=i.x-this.mouseDownPosition.x,r=i.y-this.mouseDownPosition.y;if(Math.sqrt(a**2+r**2)<this.maxDistance)this.currRockerBar.x=this.initRockerBarPosition.x+a,this.currRockerBar.y=this.initRockerBarPosition.y+r;else{let o=Math.atan2(a,r);this.currRockerBar.x=Math.sin(o)*this.maxDistance+this.initRockerBarPosition.x,this.currRockerBar.y=Math.cos(o)*this.maxDistance+this.initRockerBarPosition.y}if(Math.abs(a)>this.directionOffset||Math.abs(r)>this.directionOffset){let o=gt.judgePosition(a,r);this.setDir(o)}}onUpdate(){B.instance.stopAll||this.getKeyboardPressed()}setDir(e){if(this.lastDirection!=e&&(k.instance.setMyHeroDirection(e),this.lastDirection=e),e==-4)this.img_freebar_arrow.visible=!1;else{this.img_freebar_arrow.visible=!0;let i=e+90;this.img_freebar_arrow.rotation=i}}getKeyboardPressed(){if(bt.hasKeyDown(Laya.Keyboard.W)&&bt.hasKeyDown(Laya.Keyboard.A)?(this.isKeyRun=!0,this.setDir(225)):bt.hasKeyDown(Laya.Keyboard.W)&&bt.hasKeyDown(Laya.Keyboard.D)?(this.isKeyRun=!0,this.setDir(315)):bt.hasKeyDown(Laya.Keyboard.S)&&bt.hasKeyDown(Laya.Keyboard.A)?(this.isKeyRun=!0,this.setDir(135)):bt.hasKeyDown(Laya.Keyboard.S)&&bt.hasKeyDown(Laya.Keyboard.D)?(this.isKeyRun=!0,this.setDir(45)):bt.hasKeyDown(Laya.Keyboard.W)?(this.isKeyRun=!0,this.setDir(270)):bt.hasKeyDown(Laya.Keyboard.D)?(this.isKeyRun=!0,this.setDir(0)):bt.hasKeyDown(Laya.Keyboard.S)?(this.isKeyRun=!0,this.setDir(90)):bt.hasKeyDown(Laya.Keyboard.A)?(this.isKeyRun=!0,this.setDir(180)):this.isKeyRun&&this.setDir(-4),bt.hasKeyDown(Laya.Keyboard.H)||bt.hasKeyDown(Laya.Keyboard.NUMPAD_1)){if(this.key1Pressed)return;this.key1Pressed=!0,g.intance.event(f.EVENT_CLICK_NUM,1),Laya.timer.once(500,this,this.notKey1Pressed)}if(bt.hasKeyDown(Laya.Keyboard.J)||bt.hasKeyDown(Laya.Keyboard.NUMPAD_2)){if(this.key2Pressed)return;this.key2Pressed=!0,g.intance.event(f.EVENT_CLICK_NUM,2),Laya.timer.once(500,this,this.notKey2Pressed)}if(bt.hasKeyDown(Laya.Keyboard.K)||bt.hasKeyDown(Laya.Keyboard.NUMPAD_3)){if(this.key3Pressed)return;this.key3Pressed=!0,g.intance.event(f.EVENT_CLICK_NUM,3),Laya.timer.once(500,this,this.notKey3Pressed)}if(bt.hasKeyDown(Laya.Keyboard.L)||bt.hasKeyDown(Laya.Keyboard.NUMPAD_4)){if(this.key4Pressed)return;this.key4Pressed=!0,g.intance.event(f.EVENT_CLICK_NUM,4),Laya.timer.once(500,this,this.notKey4Pressed)}if(bt.hasKeyDown(Laya.Keyboard.M)||bt.hasKeyDown(Laya.Keyboard.NUMPAD_5)){if(this.key5Pressed)return;this.key5Pressed=!0,g.intance.event(f.EVENT_CLICK_NUM,5),Laya.timer.once(500,this,this.notKey5Pressed)}if(bt.hasKeyDown(Laya.Keyboard.N)||bt.hasKeyDown(Laya.Keyboard.NUMPAD_6)){if(this.key6Pressed)return;this.key6Pressed=!0,g.intance.event(f.EVENT_CLICK_NUM,6),Laya.timer.once(500,this,this.notKey6Pressed)}if(bt.hasKeyDown(Laya.Keyboard.B)||bt.hasKeyDown(Laya.Keyboard.NUMPAD_7)){if(this.key7Pressed)return;this.key7Pressed=!0,g.intance.event(f.EVENT_CLICK_NUM,7),Laya.timer.once(500,this,this.notKey7Pressed)}if(bt.hasKeyDown(Laya.Keyboard.V)||bt.hasKeyDown(Laya.Keyboard.NUMPAD_8)){if(this.key8Pressed)return;this.key8Pressed=!0,g.intance.event(f.EVENT_CLICK_NUM,8),Laya.timer.once(500,this,this.notKey8Pressed)}}notKey1Pressed(){this.key1Pressed=!1}notKey2Pressed(){this.key2Pressed=!1}notKey3Pressed(){this.key3Pressed=!1}notKey4Pressed(){this.key4Pressed=!1}notKey5Pressed(){this.key5Pressed=!1}notKey6Pressed(){this.key6Pressed=!1}notKey7Pressed(){this.key7Pressed=!1}notKey8Pressed(){this.key8Pressed=!1}getKeyPressed(e){var i=e.toParentPoint(new Laya.Point(e.x,e.y));return i.x>e.x&&i.x<e.x+e.width&&i.y>e.y&&i.y<e.y+e.height}getDistance(e,i,a,r){let s=e-a,o=i-r;return Math.sqrt(s*s+o*o)}onDisable(){Laya.InputManager.multiTouchEnabled=!1}};qc=h([DN("7cTqWb35RwygSkuWy4QkgQ")],qc);var vo=class{static playSkillEffect(t,e,i){var a=["Attack01","Attack02","Attack03","Attack04"],r=a[e];Laya.Sprite3D.load(t,Laya.Handler.create(null,function(s){i.addChild(s);var o=s.getChildByName(r);o.active=!0;var l=o.getComponent(Laya.ShurikenParticleRenderer);l._particleSystem.play(),setTimeout(()=>{s.removeSelf()},1e3)}))}static playEnemyHurtSkillEffect(t,e){Laya.Sprite3D.load(t,Laya.Handler.create(null,function(i){e.addChild(i);var a="Attack",r=i.getChildByName(a),s=r.getComponent(Laya.ShurikenParticleRenderer);if(s._particleSystem.play(),r.numChildren>0)for(let c=0;c<r.numChildren;c++){var o=r.getChildAt(c),l=o.getComponent(Laya.ShurikenParticleRenderer);l._particleSystem.play()}setTimeout(()=>{i.removeSelf()},1e3)}))}static playNormalEffect(t,e){Laya.Sprite3D.load(t,Laya.Handler.create(null,function(i){e.addChild(i);var a=i,r=a.getComponent(Laya.ShurikenParticleRenderer);if(r._particleSystem.play(),a.numChildren>0)for(let l=0;l<a.numChildren;l++){var s=a.getChildAt(l),o=s.getComponent(Laya.ShurikenParticleRenderer);o._particleSystem.play()}setTimeout(()=>{i.removeSelf()},1e3)}))}};var{regClass:AN,property:gD}=Laya,Vr=class extends Laya.Script{constructor(){super();this.followTarget=null;this.speed=.02;this.mLife=5;this.mIsEnd=!1;this.mIsAttack=!1;this.mIsAttackStart=!1;this.mCanPlayFirst=!0;this.mAttackDelayTime=0;this.mCurrentIndex=0;this.followTarget=k.instance.getCurrentHero()}onUpdate(){if(!this.mIsEnd){this.followTarget==null&&(this.followTarget=k.instance.getCurrentHero());var e=new Laya.Vector3(this.followTarget.transform.position.x,0,this.followTarget.transform.position.z),i=new Laya.Vector3(this.owner.transform.position.x,0,this.owner.transform.position.z),a=Laya.Vector3.distance(e,i);if(a<10)if(a<=1)this.mIsAttack?this.isAttackendByPlayer():(this.mCanPlayFirst?(this.mCanPlayFirst=!1,this.attackPlayer()):(this.mAttackDelayTime=this.mAttackDelayTime+Laya.timer.delta,this.mAttackDelayTime>1e3&&(this.mAttackDelayTime=0,this.attackPlayer())),this.mIsAttackStart=!1),k.instance.insertValidList(this.owner);else{this.mAttackDelayTime=0;var r=new Laya.Vector3;Laya.Vector3.subtract(e,i,r),Laya.Vector3.normalize(r,r),this.owner.transform.lookAt(e,Laya.Vector3.Up);var s=this.owner.transform.position;s.vadd(new Laya.Vector3(r.x*this.speed,0,r.z*this.speed),s),this.owner.transform.position=s,this.anim&&this.anim.playAnim("run",!0),this.mCanPlayFirst=!0,this.mIsAttackStart=!1,this.mIsAttack=!1}else this.anim&&this.anim.playAnim("ldle",!0),k.instance.removeValidListByValue(this.owner);this.mLife<=0&&(this.mIsEnd=!0,this.anim&&this.anim.playAnim("die",!0),setTimeout(()=>{k.instance.removeValidListByValue(this.owner),this.owner.removeSelf();var o=k.instance.getCurrentPlane(),l=this.mCurrentIndex;k.instance.createEnemy(o.getChildAt(l),l)},600))}}setCurrentIndex(e){this.mCurrentIndex=e}setLife(e){this.mLife=e}attackPlayer(){vo.playEnemyHurtSkillEffect("resources/prefab/eff_monster.lh",this.owner.getChildAt(0)),k.instance.playSound(2),this.anim&&this.anim.playAnim("attack",!0),setTimeout(()=>{this.mIsEnd||this.anim&&this.anim.playAnim("ldle",!0)},500)}isAttackendByPlayer(){this.mIsAttackStart||(this.anim&&this.anim.playAnim("shouji",!0),vo.playNormalEffect("resources/prefab/eff_shouji.lh",this.owner.getChildAt(0)),setTimeout(()=>{this.mIsEnd||(this.anim&&this.anim.playAnim("shouji",!0),this.mIsAttack=!1)},500),this.mIsAttackStart=!0)}getLife(){return this.mLife}setIsAttack(e){this.mIsAttack=e}};h([gD({type:ar})],Vr.prototype,"anim",2),h([gD({type:"number"})],Vr.prototype,"speed",2),Vr=h([AN("eWO-rqURQ6ag7phXtJPZCA")],Vr);var{regClass:kN,property:Wc}=Laya,Oa=class extends Laya.Script{constructor(){super();this.animname="";this.force=!1;this.isBig=!1;this.isCanClick=!0}onStart(){g.intance.on(f.EVENT_CLICK_NUM3,this,this.onMouseClick)}onMouseClick(e){this.isCanClick&&(Laya.Tween.to(this.btn_pic,{scaleX:1.1,scaleY:1.1},250,Laya.Ease.linearIn,Laya.Handler.create(this,()=>{Laya.Tween.to(this.btn_pic,{scaleX:1,scaleY:1},150,Laya.Ease.linearIn)})),k.instance.myHeroSpr.getComponent(Rr).catchItem(),k.instance.playSound(1),this.anim1&&(this.anim1.playAnim(this.animname,this.force),setTimeout(()=>{this.anim1.playAnim("idle",this.force),this.isCanClick=!0},500)))}onDestroy(){g.intance.offAllCaller(this)}};h([Wc({type:ar})],Oa.prototype,"anim1",2),h([Wc({type:"string"})],Oa.prototype,"animname",2),h([Wc({type:"boolean"})],Oa.prototype,"force",2),h([Wc({type:"boolean"})],Oa.prototype,"isBig",2),h([Wc({type:Laya.Sprite})],Oa.prototype,"btn_pic",2),Oa=h([kN("xovkzdhOSuOc_JJKi_7s2g")],Oa);var{regClass:BN,property:LD}=Laya,Fr=class extends Laya.Script{constructor(){super();this.isBig=!1;this.isCanClick=!0}onStart(){g.intance.on(f.EVENT_CLICK_NUM,this,this.onNumberClick)}onNumberClick(e){e==1?this.isBig||this.onMouseClick(null):this.isBig&&this.onMouseClick(null)}onMouseClick(e){if(this.isCanClick){this.isCanClick&&(this.isCanClick=!1);var i=k.instance.getValidList();Laya.Tween.to(this,{scaleX:1.1,scaleY:1.1},250,Laya.Ease.linearIn,Laya.Handler.create(this,()=>{Laya.Tween.to(this,{scaleX:1,scaleY:1},150,Laya.Ease.linearIn)}));var a=0;this.isBig?(k.instance.myHeroSpr.attack(),k.instance.playSound(3)):(k.instance.myHeroSpr.attack(),k.instance.playSound(1)),setTimeout(()=>{this.isCanClick=!0},500)}}getDistance(e,i){return Math.sqrt(e*e+i*i)}getDistanceByPoint(e,i,a,r){let s=e-a,o=i-r;return Math.sqrt(s*s+o*o)}onDestroy(){g.intance.offAllCaller(this)}};h([LD({type:"boolean"})],Fr.prototype,"isBig",2),h([LD({type:Laya.Sprite})],Fr.prototype,"btn_pic",2),Fr=h([BN("ye1w48wgTbqktuLPDOjmkw")],Fr);var{regClass:MN,property:A$e}=Laya,Yc=class extends Laya.Script{constructor(){super(...arguments);this.maxX=0;this.minX=-90;this.maxY=0;this.minY=-580;this.scaleSize=.1;this.lastDistance=0;this.startedSingleTouchDrag=!1}onEnable(){this.owner.on(Laya.Event.MOUSE_DOWN,this,this.onMouseDown),this.onMouseWheel()}onMouseWheel(){this.owner.on(Laya.Event.MOUSE_WHEEL,this,e=>{let i=this.owner.globalToLocal(new Laya.Point(Laya.stage.mouseX,Laya.stage.mouseY));e.delta>0&&(this.owner.scaleX+=this.scaleSize,this.owner.scaleY+=this.scaleSize),e.delta<0&&(this.owner.scaleX-=this.scaleSize,this.owner.scaleY-=this.scaleSize,this.owner.scaleX<1&&(this.owner.scaleX=1),this.owner.scaleY<1&&(this.owner.scaleY=1));let a=this.owner.globalToLocal(new Laya.Point(Laya.stage.mouseX,Laya.stage.mouseY)),r=(a.x-i.x)*this.owner.scaleX,s=(a.y-i.y)*this.owner.scaleY;r+=this.owner.x,s+=this.owner.y,this.updateLimit(),r>this.maxX?this.owner.x=this.maxX:r<this.minX?this.owner.x=this.minX:this.owner.x=r,s>this.maxY?this.owner.y=this.maxY:s<this.minY?this.owner.y=this.minY:this.owner.y=s})}onStart(){this.updateLimit()}updateLimit(){let e=this.owner.parent;this.minX=Math.min(e.width-this.owner.width*this.owner.scaleX,0),this.minY=Math.min(e.height-this.owner.height*this.owner.scaleY,0)}onMouseDown(e){if(e.stopPropagation(),e.touches&&e.touches.length>1){this.startedSingleTouchDrag&&(this.owner.stopDrag(),this.startedSingleTouchDrag=!1);let i=this.setPivot(e);!i.x||!i.y?console.log("(((((((((((((((((((((((",this.lastPivot,JSON.parse(JSON.stringify(e.touches))):(this.lastDistance=this.getDistance(e),this.lastPivot=i,this.owner.on(Laya.Event.MOUSE_MOVE,this,this.mouseMove))}else this.owner.startDrag(),this.startedSingleTouchDrag=!0}onMouseUp(e){this.owner.off(Laya.Event.MOUSE_MOVE,this,this.mouseMove)}getDistance(e){var i=0;if(e.touches&&e.touches.length>1){let a=e.touches[0].pos.x-e.touches[1].pos.x,r=e.touches[0].pos.y-e.touches[1].pos.y;i=Math.sqrt(a*a+r*r)}return i}mouseMove(e){let i=this.getDistance(e);this.owner.scaleX+=(i-this.lastDistance)*(this.scaleSize/10),this.owner.scaleY+=(i-this.lastDistance)*(this.scaleSize/10),this.owner.scaleX<1&&(this.owner.scaleX=1),this.owner.scaleY<1&&(this.owner.scaleY=1),this.owner.scaleX>5&&(this.owner.scaleX=5),this.owner.scaleY>5&&(this.owner.scaleY=5);let a=this.setPivot(e);if(!a.x||!a.y)console.log("$$$$$$$$$$$",a,JSON.parse(JSON.stringify(e.touches)));else{this.updateLimit();let r=(a.x-this.lastPivot.x)*this.owner.scaleX,s=(a.y-this.lastPivot.y)*this.owner.scaleY;r+=this.owner.x,s+=this.owner.y,r>this.maxX?this.owner.x=this.maxX:r<this.minX?this.owner.x=this.minX:this.owner.x=r,s>this.maxY?this.owner.y=this.maxY:s<this.minY?this.owner.y=this.minY:this.owner.y=s,this.lastDistance=i}}setPivot(e){if(e.touches&&e.touches.length>=2){let i=this.owner.globalToLocal(new Laya.Point(e.touches[0].pos.x,e.touches[0].pos.y)),a=this.owner.globalToLocal(new Laya.Point(e.touches[1].pos.x,e.touches[1].pos.y));return new Laya.Point((i.x+a.x)/2,(i.y+a.y)/2)}return this.lastPivot}onUpdate(){this.owner.x>this.maxX&&(this.owner.x=this.maxX),this.owner.x<this.minX&&(this.owner.x=this.minX),this.owner.y>this.maxY&&(this.owner.y=this.maxY),this.owner.y<this.minY&&(this.owner.y=this.minY)}addTestPoint(e,i="#ff0000",a=2){let r=new Laya.Sprite;r.graphics.drawCircle(0,0,a,i),this.owner.addChild(r),r.pos(e.x,e.y)}};Yc=h([MN("c71-MoP2RIyCrdBAfjnIgw")],Yc);var{regClass:RN,property:PN}=Laya,xo=class extends Laya.Script{constructor(){super(...arguments);this.tipsText="";this.isDown=!1}onEnable(){this.tipsText.replace(/(^\s*)|(\s*$)/g,"")}onMouseDown(){this.owner.startDrag(),this.isDown=!0}onMouseUp(){this.isDown=!1}onMouseMove(){this.isDown&&pn.i.collisionWith(this.owner)}onMouseOver(){Laya.Mouse.cursor="move",this.tipsText!==""&&Laya.Scene.open("scenes/uiDemo/Msg.ls",!1,{text:this.tipsText})}onMouseOut(){Laya.Mouse.cursor="auto"}};h([PN({type:"string"})],xo.prototype,"tipsText",2),xo=h([RN("oWa7FUgoQ6CqtyJh_D1Y2w")],xo);var{regClass:NN,property:zc}=Laya,f0=Laya.Event,_D=Laya.Point,Ha=class extends Laya.Script{constructor(){super();this.runAniName="runRight,runRDown1,runRDown2,runRDown3,runDown,runLDown3,runLDown2,runLDown1,runLeft,runLUp1,runLUp2,runLUp3,runUp,runRUp3,runRUp2,runRUp1";this.standAniName="right,Rdown,down,Ldown,left,Lup,up,Rup";this.stageMouse=new _D;this.axisPivot=new _D;this.angle=0;this.radian=0;this.isMoving=!1;this.isRun=!1}onEnable(){this.joystickBG=this.owner,this.joystickAxis=this.owner.getChildByName("joystickAxis"),this.maxDistance=this.joystickBG.width-this.joystickAxis.width,this.axisPivot.x=this.joystickAxis.x,this.axisPivot.y=this.joystickAxis.y,this.sceneWindow.on(f0.MOUSE_DOWN,this,this.mouseDown),this.sceneWindow.on(f0.MOUSE_MOVE,this,this.mouseMove),this.sceneWindow.on(f0.MOUSE_UP,this,this.mouseUp),this.sceneWindow.on(f0.MOUSE_OUT,this,this.mouseUp),this.roleAniNode=this.roleAni.create(),this.gameMap.addChild(this.roleAniNode),this.roleAniNode.pivot(this.roleAniNode.width/2,this.roleAniNode.height/2),this.roleAniNode.x=this.gameMap.width/2,this.roleAniNode.y=this.gameMap.height/2,this._animator=this.roleAniNode.getComponent(Laya.Animator2D)}mouseDown(e){this.touchId=e.touchId,this.isMoving=!0,this.updateJoystickPoint()}updateJoystickPoint(){this.stageMouse.x=Laya.stage.mouseX,this.stageMouse.y=Laya.stage.mouseY;let e=this.joystickBG.globalToLocal(this.stageMouse),i=e.x-this.joystickAxis.width/2,a=e.y-this.joystickAxis.height/2;this.radian=Math.atan2(a-this.axisPivot.y,i-this.axisPivot.x),this.lastAngle=this.angle,this.angle=Math.round(this.radian*180/Math.PI*10)/10,this.angle<0&&(this.angle+=360),console.log("radian: "+this.radian+", angle: "+this.angle),this.getDistance(this.joystickBG.width/2,this.joystickBG.height/2,e.x,e.y)>this.maxDistance&&this.lastAngle!==this.angle?(this.joystickAxis.x=Math.floor(Math.cos(this.radian)*this.maxDistance)+this.axisPivot.x,this.joystickAxis.y=Math.floor(Math.sin(this.radian)*this.maxDistance)+this.axisPivot.y):this.joystickAxis.pos(e.x-this.joystickAxis.width/2,e.y-this.joystickAxis.height/2),this.switchAni("run")}switchAni(e){if(e=="run"){let i=this.getOrientation(this.angle,this.runAniName);i!==this.lastRunAniName&&(this.lastRunAniName=i,this._animator.play(i)),this.isRun=!0}else{this.isRun=!1;let i=this.getOrientation(this.angle,this.standAniName);this.lastAngle!==this.angle&&this._animator.play(i)}}mouseUp(e){e.touchId==this.touchId&&(this.touchId=null,this.isMoving=!1,this.joystickAxis.pos(this.axisPivot.x,this.axisPivot.y),this.switchAni("stand"))}mouseMove(e){e.touchId==this.touchId&&this.updateJoystickPoint()}getOrientation(e,i){let a=i.split(","),r=360/a.length;return a[Math.floor(e/r)]}onUpdate(){this.isMoving&&this.updateRoleMove()}updateRoleMove(){this.switchAni("run");let e=Math.cos(this.radian)*2,i=Math.sin(this.radian)*2;(e<0&&this.gameMap.x<0||e>0&&this.gameMap.x>this.sceneWindow.width-this.gameMap.width)&&(this.gameMap.x-=e),(i<0&&this.gameMap.y<0||i>0&&this.gameMap.y>this.sceneWindow.height-this.gameMap.height)&&(this.gameMap.y-=i)}getDistance(e,i,a,r){let s=e-a,o=i-r;return Math.sqrt(s*s+o*o)}};h([zc({type:Laya.Prefab})],Ha.prototype,"roleAni",2),h([zc({type:"string"})],Ha.prototype,"runAniName",2),h([zc({type:"string"})],Ha.prototype,"standAniName",2),h([zc({type:Laya.Sprite})],Ha.prototype,"gameMap",2),h([zc({type:Laya.Box})],Ha.prototype,"sceneWindow",2),Ha=h([NN("Pl5-_PonSLe-7mCnxeXfRw")],Ha);var{regClass:ON,property:H$e}=Laya,jc=class extends Laya.Script{constructor(){super();this.isOpen=!0}onEnable(){this.toolbarBG=this.owner.parent,this._owner=this.owner,this.menu=this.owner.parent.getChildByName("menu")}onMouseDown(e){e.stopPropagation(),this.isOpen?(Laya.Tween.to(this.toolbarBG,{width:106},1e3,Laya.Ease.strongOut),Laya.Tween.to(this._owner,{x:52,rotation:540},1e3,Laya.Ease.strongOut,Laya.Handler.create(this,()=>{this.isOpen=!1})),Laya.Tween.to(this.menu,{alpha:0},300,Laya.Ease.strongOut,Laya.Handler.create(this,()=>{this.menu.visible=!1}))):(Laya.Tween.to(this.toolbarBG,{width:460},1e3,Laya.Ease.strongOut),Laya.Tween.to(this._owner,{x:402,rotation:-360},1e3,Laya.Ease.strongOut,Laya.Handler.create(this,()=>{this.isOpen=!0})),Laya.Tween.to(this.menu,{alpha:1},200,Laya.Ease.strongOut,Laya.Handler.create(this,()=>{this.menu.visible=!0})))}onDisable(){}};jc=h([ON("hPkwKQvKQTaeBeEpHxNUEA")],jc);})();
/*! Bundled license information:

@noble/hashes/esm/utils.js:
  (*! noble-hashes - MIT License (c) 2022 Paul Miller (paulmillr.com) *)

@noble/curves/esm/abstract/utils.js:
  (*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) *)

@noble/curves/esm/abstract/modular.js:
  (*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) *)

@noble/curves/esm/abstract/curve.js:
  (*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) *)

@noble/curves/esm/abstract/weierstrass.js:
  (*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) *)

@noble/curves/esm/_shortw_utils.js:
  (*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) *)

@noble/curves/esm/secp256k1.js:
  (*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) *)
*/
